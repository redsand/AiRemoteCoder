{"version": 1, "root": "C:\\Users\\TimShelton\\source\\repos\\AiRemoteCoder", "chunks": [{"corpus": "docs", "source": "README.md", "location": "README.md#Claude Code Connect-Back Gateway", "score": 0.0, "content": "# Claude Code Connect-Back Gateway\n\nA secure, mobile-friendly gateway for remotely monitoring and assisting Claude Code sessions.\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Phone/Browser  \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502    Gateway      \u2502\n\u2502    (UI)         \u2502  HTTPS  \u2502  (Fastify)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                            WebSocket\u2502(Connect-back)\n                                     \u2502\n                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502  Claude Runner  \u2502\n                            \u2502  (wrapper)      \u2502\n                            \u2502  + Claude Code  \u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n", "metadata": {"file": "README.md", "heading": "Claude Code Connect-Back Gateway", "start_line": 1, "end_line": 19}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Features", "score": 0.0, "content": "## Features\n\n- **Real-time Monitoring**: Stream Claude Code output to your phone\n- **Command Execution**: Run allowlisted commands (tests, git operations)\n- **Secure Authentication**: HMAC signatures, TOTP, Cloudflare Access\n- **Connect-Back Only**: No inbound ports required on the Claude machine\n- **Artifact Collection**: Download logs and diffs\n- **Assist Sessions**: Optional tmate terminal sharing\n", "metadata": {"file": "README.md", "heading": "Features", "start_line": 20, "end_line": 28}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Quick Start", "score": 0.0, "content": "## Quick Start\n\n```bash", "metadata": {"file": "README.md", "heading": "Quick Start", "start_line": 29, "end_line": 31}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Start the gateway", "score": 0.0, "content": "# Start the gateway\n./run.sh\n", "metadata": {"file": "README.md", "heading": "Start the gateway", "start_line": 32, "end_line": 34}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Open https://localhost:3100, create admin account", "score": 0.0, "content": "# Open https://localhost:3100, create admin account\n", "metadata": {"file": "README.md", "heading": "Open https://localhost:3100, create admin account", "start_line": 35, "end_line": 36}}, {"corpus": "docs", "source": "README.md", "location": "README.md#From the UI, create a new run and get the run-id/token", "score": 0.0, "content": "# From the UI, create a new run and get the run-id/token\n", "metadata": {"file": "README.md", "heading": "From the UI, create a new run and get the run-id/token", "start_line": 37, "end_line": 38}}, {"corpus": "docs", "source": "README.md", "location": "README.md#On your Claude machine:", "score": 0.0, "content": "# On your Claude machine:\n./wrapper/claude-runner start \\\n  --run-id <id> \\\n  --token <token> \\\n  --cmd \"your prompt\"\n```\n", "metadata": {"file": "README.md", "heading": "On your Claude machine:", "start_line": 39, "end_line": 45}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Remote Access", "score": 0.0, "content": "## Remote Access\n\nFor phone access via Cloudflare Tunnel:\n\n```bash\n./scripts/cloudflare-tunnel.sh\n```\n", "metadata": {"file": "README.md", "heading": "Remote Access", "start_line": 46, "end_line": 53}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Documentation", "score": 0.0, "content": "## Documentation\n\n- [Quickstart Guide](docs/QUICKSTART.md)\n- [DigitalOcean Deployment](docs/DIGITALOCEAN.md)\n- [Security Model](docs/SECURITY.md)\n- [Operations Guide](docs/OPERATIONS.md)\n- [Claude Code Integration](docs/CLAUDE_CODE.md)\n- [Testing Guide](docs/TESTING.md)\n", "metadata": {"file": "README.md", "heading": "Documentation", "start_line": 54, "end_line": 62}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Project Structure", "score": 0.0, "content": "## Project Structure\n\n```\n\u251c\u2500\u2500 gateway/          # Fastify server (API + WebSocket)\n\u251c\u2500\u2500 wrapper/          # Claude Code runner (claude-runner CLI)\n\u251c\u2500\u2500 ui/               # React UI (mobile-friendly)\n\u251c\u2500\u2500 docs/             # Documentation\n\u251c\u2500\u2500 scripts/          # Utility scripts\n\u251c\u2500\u2500 .data/            # Runtime data (gitignored)\n\u2502   \u251c\u2500\u2500 db.sqlite     # SQLite database\n\u2502   \u251c\u2500\u2500 certs/        # TLS certificates\n\u2502   \u251c\u2500\u2500 artifacts/    # Uploaded files\n\u2502   \u2514\u2500\u2500 runs/         # Local logs\n\u251c\u2500\u2500 run.sh            # Start gateway (Linux/macOS)\n\u2514\u2500\u2500 run.ps1           # Start gateway (Windows)\n```\n", "metadata": {"file": "README.md", "heading": "Project Structure", "start_line": 63, "end_line": 79}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Security", "score": 0.0, "content": "## Security\n\n- TLS everywhere\n- HMAC-signed wrapper requests\n- Replay protection with nonces\n- Allowlisted commands only\n- Secret redaction in logs\n- Argon2 password hashing\n- Optional TOTP 2FA\n- Cloudflare Access integration\n\nSee [SECURITY.md](docs/SECURITY.md) for the full threat model.\n", "metadata": {"file": "README.md", "heading": "Security", "start_line": 80, "end_line": 92}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Requirements", "score": 0.0, "content": "## Requirements\n\n- Node.js 20+\n- Claude Code CLI\n- (Optional) cloudflared for remote access\n- (Optional) tmate for assist sessions\n", "metadata": {"file": "README.md", "heading": "Requirements", "start_line": 93, "end_line": 99}}, {"corpus": "docs", "source": "README.md", "location": "README.md#License", "score": 0.0, "content": "## License\n\nMIT", "metadata": {"file": "README.md", "heading": "License", "start_line": 100, "end_line": 102}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Claude Code Connect-Back Gateway", "score": 0.0, "content": "# Claude Code Connect-Back Gateway\n\nA secure, mobile-friendly gateway for remotely monitoring and assisting Claude Code sessions.\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Phone/Browser  \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502    Gateway      \u2502\n\u2502    (UI)         \u2502  HTTPS  \u2502  (Fastify)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                            WebSocket\u2502(Connect-back)\n                                     \u2502\n                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502  Claude Runner  \u2502\n                            \u2502  (wrapper)      \u2502\n                            \u2502  + Claude Code  \u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n", "metadata": {"file": "README.md", "heading": "Claude Code Connect-Back Gateway", "start_line": 1, "end_line": 19}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Features", "score": 0.0, "content": "## Features\n\n- **Real-time Monitoring**: Stream Claude Code output to your phone\n- **Command Execution**: Run allowlisted commands (tests, git operations)\n- **Secure Authentication**: HMAC signatures, TOTP, Cloudflare Access\n- **Connect-Back Only**: No inbound ports required on the Claude machine\n- **Artifact Collection**: Download logs and diffs\n- **Assist Sessions**: Optional tmate terminal sharing\n", "metadata": {"file": "README.md", "heading": "Features", "start_line": 20, "end_line": 28}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Quick Start", "score": 0.0, "content": "## Quick Start\n\n```bash", "metadata": {"file": "README.md", "heading": "Quick Start", "start_line": 29, "end_line": 31}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Start the gateway", "score": 0.0, "content": "# Start the gateway\n./run.sh\n", "metadata": {"file": "README.md", "heading": "Start the gateway", "start_line": 32, "end_line": 34}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Open https://localhost:3100, create admin account", "score": 0.0, "content": "# Open https://localhost:3100, create admin account\n", "metadata": {"file": "README.md", "heading": "Open https://localhost:3100, create admin account", "start_line": 35, "end_line": 36}}, {"corpus": "docs", "source": "README.md", "location": "README.md#From the UI, create a new run and get the run-id/token", "score": 0.0, "content": "# From the UI, create a new run and get the run-id/token\n", "metadata": {"file": "README.md", "heading": "From the UI, create a new run and get the run-id/token", "start_line": 37, "end_line": 38}}, {"corpus": "docs", "source": "README.md", "location": "README.md#On your Claude machine:", "score": 0.0, "content": "# On your Claude machine:\n./wrapper/claude-runner start \\\n  --run-id <id> \\\n  --token <token> \\\n  --cmd \"your prompt\"\n```\n", "metadata": {"file": "README.md", "heading": "On your Claude machine:", "start_line": 39, "end_line": 45}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Remote Access", "score": 0.0, "content": "## Remote Access\n\nFor phone access via Cloudflare Tunnel:\n\n```bash\n./scripts/cloudflare-tunnel.sh\n```\n", "metadata": {"file": "README.md", "heading": "Remote Access", "start_line": 46, "end_line": 53}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Documentation", "score": 0.0, "content": "## Documentation\n\n- [Quickstart Guide](docs/QUICKSTART.md)\n- [DigitalOcean Deployment](docs/DIGITALOCEAN.md)\n- [Security Model](docs/SECURITY.md)\n- [Operations Guide](docs/OPERATIONS.md)\n- [Claude Code Integration](docs/CLAUDE_CODE.md)\n- [Testing Guide](docs/TESTING.md)\n", "metadata": {"file": "README.md", "heading": "Documentation", "start_line": 54, "end_line": 62}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Project Structure", "score": 0.0, "content": "## Project Structure\n\n```\n\u251c\u2500\u2500 gateway/          # Fastify server (API + WebSocket)\n\u251c\u2500\u2500 wrapper/          # Claude Code runner (claude-runner CLI)\n\u251c\u2500\u2500 ui/               # React UI (mobile-friendly)\n\u251c\u2500\u2500 docs/             # Documentation\n\u251c\u2500\u2500 scripts/          # Utility scripts\n\u251c\u2500\u2500 .data/            # Runtime data (gitignored)\n\u2502   \u251c\u2500\u2500 db.sqlite     # SQLite database\n\u2502   \u251c\u2500\u2500 certs/        # TLS certificates\n\u2502   \u251c\u2500\u2500 artifacts/    # Uploaded files\n\u2502   \u2514\u2500\u2500 runs/         # Local logs\n\u251c\u2500\u2500 run.sh            # Start gateway (Linux/macOS)\n\u2514\u2500\u2500 run.ps1           # Start gateway (Windows)\n```\n", "metadata": {"file": "README.md", "heading": "Project Structure", "start_line": 63, "end_line": 79}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Security", "score": 0.0, "content": "## Security\n\n- TLS everywhere\n- HMAC-signed wrapper requests\n- Replay protection with nonces\n- Allowlisted commands only\n- Secret redaction in logs\n- Argon2 password hashing\n- Optional TOTP 2FA\n- Cloudflare Access integration\n\nSee [SECURITY.md](docs/SECURITY.md) for the full threat model.\n", "metadata": {"file": "README.md", "heading": "Security", "start_line": 80, "end_line": 92}}, {"corpus": "docs", "source": "README.md", "location": "README.md#Requirements", "score": 0.0, "content": "## Requirements\n\n- Node.js 20+\n- Claude Code CLI\n- (Optional) cloudflared for remote access\n- (Optional) tmate for assist sessions\n", "metadata": {"file": "README.md", "heading": "Requirements", "start_line": 93, "end_line": 99}}, {"corpus": "docs", "source": "README.md", "location": "README.md#License", "score": 0.0, "content": "## License\n\nMIT", "metadata": {"file": "README.md", "heading": "License", "start_line": 100, "end_line": 102}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Claude Code Integration", "score": 0.0, "content": "# Claude Code Integration\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Claude Code Integration", "start_line": 1, "end_line": 2}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Overview", "score": 0.0, "content": "## Overview\n\nThe claude-runner wrapper launches Claude Code and provides:\n- Real-time output streaming to the gateway\n- Command execution from the UI\n- Artifact upload (logs, diffs)\n- Optional tmate assist sessions\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Overview", "start_line": 3, "end_line": 10}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Architecture", "score": 0.0, "content": "## Architecture\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      claude-runner                           \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502   Claude Code    \u2502\u2500\u2500\u2500\u25ba\u2502   Output Capture             \u2502  \u2502\n\u2502  \u2502   (subprocess)   \u2502    \u2502   - stdout/stderr            \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502   - Markers (start/finish)   \u2502  \u2502\n\u2502                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                     \u2502                       \u2502\n\u2502                                     \u25bc                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502              Gateway Client                           \u2502  \u2502\n\u2502  \u2502   - HMAC-signed requests                             \u2502  \u2502\n\u2502  \u2502   - Event streaming (POST /api/ingest/event)         \u2502  \u2502\n\u2502  \u2502   - Command polling (GET /api/runs/:id/commands)     \u2502  \u2502\n\u2502  \u2502   - Artifact upload (POST /api/ingest/artifact)      \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                     \u2502                       \u2502\n\u2502                                     \u25bc                       \u2502\n\u2502                            Gateway Server                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Architecture", "start_line": 11, "end_line": 36}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Starting a Run", "score": 0.0, "content": "## Starting a Run\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Starting a Run", "start_line": 37, "end_line": 38}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#From UI", "score": 0.0, "content": "### From UI\n1. Click \"New Run\" in the UI\n2. Optionally enter a Claude command/prompt\n3. Copy the run-id and capability token\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "From UI", "start_line": 39, "end_line": 43}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Start Wrapper", "score": 0.0, "content": "### Start Wrapper\n```bash\ncd /path/to/your/project\n\n./wrapper/claude-runner start \\\n  --run-id <run-id> \\\n  --token <token> \\\n  --cmd \"your prompt here\" \\\n  --cwd /optional/working/dir\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Start Wrapper", "start_line": 44, "end_line": 54}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Environment Variables", "score": 0.0, "content": "### Environment Variables\nThe wrapper reads from `.env`:\n```env\nGATEWAY_URL=https://localhost:3100\nHMAC_SECRET=<must match gateway>\nALLOW_SELF_SIGNED=true\nCLAUDE_COMMAND=claude\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Environment Variables", "start_line": 55, "end_line": 63}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Event Types", "score": 0.0, "content": "## Event Types\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Event Types", "start_line": 64, "end_line": 65}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#stdout", "score": 0.0, "content": "### stdout\nStandard output from Claude Code.\n```json\n{\"type\": \"stdout\", \"data\": \"...\", \"sequence\": 1}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "stdout", "start_line": 66, "end_line": 71}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#stderr", "score": 0.0, "content": "### stderr\nError output from Claude Code.\n```json\n{\"type\": \"stderr\", \"data\": \"...\", \"sequence\": 2}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "stderr", "start_line": 72, "end_line": 77}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#marker", "score": 0.0, "content": "### marker\nLifecycle events.\n```json\n{\"type\": \"marker\", \"data\": \"{\\\"event\\\":\\\"started\\\",\\\"command\\\":\\\"...\\\"}\"}\n{\"type\": \"marker\", \"data\": \"{\\\"event\\\":\\\"finished\\\",\\\"exitCode\\\":0}\"}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "marker", "start_line": 78, "end_line": 84}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#info", "score": 0.0, "content": "### info\nInformational messages (command execution, etc.).\n```json\n{\"type\": \"info\", \"data\": \"Executing command: npm test\"}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "info", "start_line": 85, "end_line": 90}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#error", "score": 0.0, "content": "### error\nError messages.\n```json\n{\"type\": \"error\", \"data\": \"Command failed: ...\"}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "error", "start_line": 91, "end_line": 96}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#assist", "score": 0.0, "content": "### assist\nAssist session URL.\n```json\n{\"type\": \"assist\", \"data\": \"{\\\"type\\\":\\\"tmate\\\",\\\"url\\\":\\\"ssh ...\\\"}\"}\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "assist", "start_line": 97, "end_line": 102}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Allowlisted Commands", "score": 0.0, "content": "## Allowlisted Commands\n\nCommands that can be sent from the UI:\n\n| Command | Description |\n|---------|-------------|\n| `npm test` | Run npm tests |\n| `npm run test` | Run npm test script |\n| `pnpm test` | Run pnpm tests |\n| `yarn test` | Run yarn tests |\n| `pytest` | Run Python tests |\n| `pytest -v` | Run Python tests (verbose) |\n| `go test ./...` | Run Go tests |\n| `cargo test` | Run Rust tests |\n| `git diff` | Show unstaged changes |\n| `git diff --cached` | Show staged changes |\n| `git status` | Show working tree status |\n| `git log --oneline -10` | Show recent commits |\n| `ls -la` | List files |\n| `pwd` | Show current directory |\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Allowlisted Commands", "start_line": 103, "end_line": 123}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Adding Custom Commands", "score": 0.0, "content": "### Adding Custom Commands\nIn `.env`:\n```env\nEXTRA_ALLOWED_COMMANDS=make build,make test,./custom-script.sh\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Adding Custom Commands", "start_line": 124, "end_line": 129}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Artifact Types", "score": 0.0, "content": "## Artifact Types\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Artifact Types", "start_line": 130, "end_line": 131}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Automatic Uploads", "score": 0.0, "content": "### Automatic Uploads\n- `claude.log` - Full session log (uploaded on completion)\n- `latest.diff` - Git diff output (when `git diff` command runs)\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Automatic Uploads", "start_line": 132, "end_line": 135}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#File Types", "score": 0.0, "content": "### File Types\n- `.log` - Log files\n- `.txt` - Text files\n- `.json` - JSON files\n- `.diff` / `.patch` - Diff/patch files\n- `.md` - Markdown files\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "File Types", "start_line": 136, "end_line": 142}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Secret Redaction", "score": 0.0, "content": "## Secret Redaction\n\nOutput is scanned for secrets before transmission:\n\n- API keys: `api_key=xxx`, `apiKey: xxx`\n- Tokens: `token=xxx`, `Bearer xxx`\n- Passwords: `password=xxx`\n- OpenAI: `sk-...`\n- GitHub: `ghp_...`, `ghs_...`\n- NPM: `npm_...`\n- Private keys: `-----BEGIN ... KEY-----`\n\nMatches are replaced with `[REDACTED]`.\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Secret Redaction", "start_line": 143, "end_line": 156}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Assist Sessions", "score": 0.0, "content": "## Assist Sessions\n\nFor hands-on terminal access using tmate:\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Assist Sessions", "start_line": 157, "end_line": 160}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Start Assist Session", "score": 0.0, "content": "### Start Assist Session\n```bash\n./wrapper/claude-runner assist \\\n  --run-id <run-id> \\\n  --token <token>\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Start Assist Session", "start_line": 161, "end_line": 167}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#How It Works", "score": 0.0, "content": "### How It Works\n1. Wrapper spawns tmate in background\n2. tmate generates SSH URL\n3. URL posted to gateway as `assist` event\n4. UI displays clickable session URL\n5. You can SSH in from any device\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "How It Works", "start_line": 168, "end_line": 174}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Requirements", "score": 0.0, "content": "### Requirements\n- tmate installed (`brew install tmate` or `apt install tmate`)\n- Optional: `~/.tmate.conf` for custom settings\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Requirements", "start_line": 175, "end_line": 178}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Error Handling", "score": 0.0, "content": "## Error Handling\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Error Handling", "start_line": 179, "end_line": 180}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Exit Codes", "score": 0.0, "content": "### Exit Codes\n- `0` - Success\n- `1` - General error\n- Other - Claude Code specific exit codes\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Exit Codes", "start_line": 181, "end_line": 185}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Automatic Retry", "score": 0.0, "content": "### Automatic Retry\nThe wrapper does not automatically retry on failure. Create a new run instead.\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Automatic Retry", "start_line": 186, "end_line": 188}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Graceful Stop", "score": 0.0, "content": "### Graceful Stop\nWhen stop is requested:\n1. SIGINT sent to Claude Code\n2. 10-second grace period\n3. SIGKILL if still running\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Graceful Stop", "start_line": 189, "end_line": 194}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Debugging", "score": 0.0, "content": "## Debugging\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Debugging", "start_line": 195, "end_line": 196}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Verbose Output", "score": 0.0, "content": "### Verbose Output\n```bash\n./wrapper/claude-runner start --run-id xxx --token xxx 2>&1 | tee debug.log\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Verbose Output", "start_line": 197, "end_line": 201}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Test Gateway Connection", "score": 0.0, "content": "### Test Gateway Connection\n```bash\n./wrapper/claude-runner test-connection\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Test Gateway Connection", "start_line": 202, "end_line": 206}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Show Configuration", "score": 0.0, "content": "### Show Configuration\n```bash\n./wrapper/claude-runner info\n```\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Show Configuration", "start_line": 207, "end_line": 211}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#Local Log Files", "score": 0.0, "content": "### Local Log Files\nLogs are written to `.data/runs/<run-id>/claude.log` before upload.\n", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "Local Log Files", "start_line": 212, "end_line": 214}}, {"corpus": "docs", "source": "docs/CLAUDE_CODE.md", "location": "docs/CLAUDE_CODE.md#V2 Plans: Rev Integration", "score": 0.0, "content": "## V2 Plans: Rev Integration\n\nFuture versions will support rev as an additional runner type:\n\n```\n./rev-runner start \\\n  --run-id <run-id> \\\n  --token <token> \\\n  --cmd \"rev command\"\n```\n\nThe architecture is designed to support multiple runner types:\n- Same gateway API\n- Same authentication model\n- Runner-specific event handling\n- Runner-specific command allowlists\n\nIntegration will be added as a separate runner module without modifying existing Claude Code support.", "metadata": {"file": "docs/CLAUDE_CODE.md", "heading": "V2 Plans: Rev Integration", "start_line": 215, "end_line": 232}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#DigitalOcean Deployment Guide", "score": 0.0, "content": "# DigitalOcean Deployment Guide\n\nDeploy the Connect-Back Gateway on DigitalOcean for remote monitoring of Claude Code sessions. This guide covers Debian/Ubuntu and Oracle Linux droplets with Cloudflare Tunnel for secure remote access (no domain required).\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "DigitalOcean Deployment Guide", "start_line": 1, "end_line": 4}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Architecture Overview", "score": 0.0, "content": "## Architecture Overview\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Phone/Browser  \u2502\u25c4\u2500\u2500\u2500\u2500\u25ba\u2502 Cloudflare Tunnel \u2502\u25c4\u2500\u2500\u2500\u2500\u25ba\u2502   DO Droplet    \u2502\n\u2502     (You)       \u2502 HTTPS\u2502   (No domain)     \u2502 WSS  \u2502   (Gateway)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                            \u2502\n                                                   Connect-back (outbound)\n                                                            \u2502\n                                                   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                                   \u2502  Your Machine   \u2502\n                                                   \u2502  Claude Wrapper \u2502\n                                                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n**Key Points:**\n- Gateway runs on DigitalOcean droplet\n- Cloudflare Tunnel provides secure HTTPS access (no domain needed)\n- Your local machine connects **outbound** to the gateway (connect-back)\n- No inbound ports needed on your development machine\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Architecture Overview", "start_line": 5, "end_line": 28}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Droplet Requirements", "score": 0.0, "content": "## Droplet Requirements\n\n| Resource | Minimum | Recommended |\n|----------|---------|-------------|\n| RAM | 1 GB | 2 GB |\n| vCPUs | 1 | 2 |\n| Storage | 25 GB | 50 GB |\n| Cost | ~$6/month | ~$12/month |\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Droplet Requirements", "start_line": 29, "end_line": 39}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 1: Create Droplet", "score": 0.0, "content": "## Step 1: Create Droplet\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 1: Create Droplet", "start_line": 40, "end_line": 41}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Option A: Debian/Ubuntu (Recommended)", "score": 0.0, "content": "### Option A: Debian/Ubuntu (Recommended)\n\n1. Log in to [DigitalOcean](https://cloud.digitalocean.com)\n2. Click **Create > Droplets**\n3. Choose:\n   - **Region**: Closest to you\n   - **Image**: Ubuntu 24.04 LTS or Debian 12\n   - **Size**: Basic $6/month (1 GB RAM, 1 vCPU)\n   - **Authentication**: SSH key (recommended) or password\n4. Click **Create Droplet**\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Option A: Debian/Ubuntu (Recommended)", "start_line": 42, "end_line": 52}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Option B: Oracle Linux", "score": 0.0, "content": "### Option B: Oracle Linux\n\n1. Same process but select **Oracle Linux 9** from Marketplace\n2. Oracle Linux uses `dnf` instead of `apt`\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Option B: Oracle Linux", "start_line": 53, "end_line": 59}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 2: Initial Server Setup", "score": 0.0, "content": "## Step 2: Initial Server Setup\n\nSSH into your droplet:\n\n```bash\nssh root@YOUR_DROPLET_IP\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 2: Initial Server Setup", "start_line": 60, "end_line": 67}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Debian/Ubuntu", "score": 0.0, "content": "### Debian/Ubuntu\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Debian/Ubuntu", "start_line": 68, "end_line": 70}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Update system", "score": 0.0, "content": "# Update system\napt update && apt upgrade -y\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Update system", "start_line": 71, "end_line": 73}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Install dependencies", "score": 0.0, "content": "# Install dependencies\napt install -y curl git build-essential sqlite3\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Install dependencies", "start_line": 74, "end_line": 76}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Install Node.js 20+", "score": 0.0, "content": "# Install Node.js 20+\ncurl -fsSL https://deb.nodesource.com/setup_20.x | bash -\napt install -y nodejs\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Install Node.js 20+", "start_line": 77, "end_line": 80}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Verify", "score": 0.0, "content": "# Verify\nnode --version  # Should be 20+\nnpm --version\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Verify", "start_line": 81, "end_line": 85}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Oracle Linux", "score": 0.0, "content": "### Oracle Linux\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Oracle Linux", "start_line": 86, "end_line": 88}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Update system", "score": 0.0, "content": "# Update system\ndnf update -y\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Update system", "start_line": 89, "end_line": 91}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Enable EPEL and install dependencies", "score": 0.0, "content": "# Enable EPEL and install dependencies\ndnf install -y epel-release\ndnf install -y curl git gcc gcc-c++ make sqlite\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Enable EPEL and install dependencies", "start_line": 92, "end_line": 95}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Install Node.js 20+", "score": 0.0, "content": "# Install Node.js 20+\ncurl -fsSL https://rpm.nodesource.com/setup_20.x | bash -\ndnf install -y nodejs\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Install Node.js 20+", "start_line": 96, "end_line": 99}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Verify", "score": 0.0, "content": "# Verify\nnode --version  # Should be 20+\nnpm --version\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Verify", "start_line": 100, "end_line": 106}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 3: Create Service User", "score": 0.0, "content": "## Step 3: Create Service User\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 3: Create Service User", "start_line": 107, "end_line": 109}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Create non-root user for the gateway", "score": 0.0, "content": "# Create non-root user for the gateway\nuseradd -m -s /bin/bash aigateway\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Create non-root user for the gateway", "start_line": 110, "end_line": 115}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 4: Install the Gateway", "score": 0.0, "content": "## Step 4: Install the Gateway\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 4: Install the Gateway", "start_line": 116, "end_line": 118}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Switch to service user", "score": 0.0, "content": "# Switch to service user\nsu - aigateway\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Switch to service user", "start_line": 119, "end_line": 121}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Clone the repository", "score": 0.0, "content": "# Clone the repository\ngit clone https://github.com/redsand/AiRemoteCoder.git\ncd AiRemoteCoder\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Clone the repository", "start_line": 122, "end_line": 125}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Run setup (generates secrets, builds all components)", "score": 0.0, "content": "# Run setup (generates secrets, builds all components)\n./run.sh\n```\n\nThe first run will:\n- Generate secure `HMAC_SECRET` and `AUTH_SECRET`\n- Install dependencies\n- Build gateway, wrapper, and UI\n- Generate self-signed TLS certificates\n- Start the gateway\n\nPress `Ctrl+C` to stop the gateway after verifying it starts.\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Run setup (generates secrets, builds all components)", "start_line": 126, "end_line": 140}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 5: Install Cloudflare Tunnel", "score": 0.0, "content": "## Step 5: Install Cloudflare Tunnel\n\nCloudflare Tunnel provides secure remote access without exposing ports or buying a domain.\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 5: Install Cloudflare Tunnel", "start_line": 141, "end_line": 144}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Debian/Ubuntu", "score": 0.0, "content": "### Debian/Ubuntu\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Debian/Ubuntu", "start_line": 145, "end_line": 147}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#As root", "score": 0.0, "content": "# As root\ncurl -L --output cloudflared.deb https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb\ndpkg -i cloudflared.deb\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "As root", "start_line": 148, "end_line": 152}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Oracle Linux", "score": 0.0, "content": "### Oracle Linux\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Oracle Linux", "start_line": 153, "end_line": 155}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#As root", "score": 0.0, "content": "# As root\ncurl -L --output cloudflared.rpm https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-x86_64.rpm\nrpm -i cloudflared.rpm\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "As root", "start_line": 156, "end_line": 162}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 6: Configure Cloudflare Tunnel", "score": 0.0, "content": "## Step 6: Configure Cloudflare Tunnel\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 6: Configure Cloudflare Tunnel", "start_line": 163, "end_line": 164}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Option A: Quick Tunnel (No Account Required)", "score": 0.0, "content": "### Option A: Quick Tunnel (No Account Required)\n\nFor testing, use a temporary tunnel:\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Option A: Quick Tunnel (No Account Required)", "start_line": 165, "end_line": 169}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#As aigateway user", "score": 0.0, "content": "# As aigateway user\nsu - aigateway\ncd AiRemoteCoder\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "As aigateway user", "start_line": 170, "end_line": 173}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Start quick tunnel (gives you a random *.trycloudflare.com URL)", "score": 0.0, "content": "# Start quick tunnel (gives you a random *.trycloudflare.com URL)\ncloudflared tunnel --url https://localhost:3100\n```\n\nCopy the generated URL (e.g., `https://random-name.trycloudflare.com`).\n\n**Note:** Quick tunnels are temporary and change on restart. Use Option B for persistence.\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Start quick tunnel (gives you a random *.trycloudflare.com URL)", "start_line": 174, "end_line": 181}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Option B: Named Tunnel (Recommended for Production)", "score": 0.0, "content": "### Option B: Named Tunnel (Recommended for Production)\n\n1. Create a free Cloudflare account at https://dash.cloudflare.com\n2. Authenticate cloudflared:\n\n```bash\ncloudflared tunnel login\n```\n\n3. Create a named tunnel:\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Option B: Named Tunnel (Recommended for Production)", "start_line": 182, "end_line": 193}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Create tunnel (save the tunnel ID)", "score": 0.0, "content": "# Create tunnel (save the tunnel ID)\ncloudflared tunnel create aigateway\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Create tunnel (save the tunnel ID)", "start_line": 194, "end_line": 196}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Note the tunnel ID and credentials file path shown", "score": 0.0, "content": "# Note the tunnel ID and credentials file path shown\n```\n\n4. Create tunnel config:\n\n```bash\ncat > ~/.cloudflared/config.yml << 'EOF'\ntunnel: YOUR_TUNNEL_ID\ncredentials-file: /home/aigateway/.cloudflared/YOUR_TUNNEL_ID.json\n\ningress:\n  - service: https://localhost:3100\n    originRequest:\n      noTLSVerify: true\nEOF\n```\n\n5. Get your tunnel hostname:\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Note the tunnel ID and credentials file path shown", "start_line": 197, "end_line": 216}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Your tunnel will be accessible at:", "score": 0.0, "content": "# Your tunnel will be accessible at:", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Your tunnel will be accessible at:", "start_line": 217, "end_line": 217}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#https://YOUR_TUNNEL_ID.cfargotunnel.com", "score": 0.0, "content": "# https://YOUR_TUNNEL_ID.cfargotunnel.com", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "https://YOUR_TUNNEL_ID.cfargotunnel.com", "start_line": 218, "end_line": 218}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Or route a domain to it (optional)", "score": 0.0, "content": "# Or route a domain to it (optional)\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Or route a domain to it (optional)", "start_line": 219, "end_line": 223}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 7: Add Cloudflare Access (Optional but Recommended)", "score": 0.0, "content": "## Step 7: Add Cloudflare Access (Optional but Recommended)\n\nAdd authentication in front of your tunnel:\n\n1. Go to https://one.dash.cloudflare.com\n2. Navigate to **Access > Applications**\n3. Click **Add an Application > Self-hosted**\n4. Configure:\n   - **Application name**: AI Gateway\n   - **Session duration**: 24 hours\n   - **Application domain**: `YOUR_TUNNEL_ID.cfargotunnel.com`\n5. Add an Access Policy:\n   - **Policy name**: Allow Me\n   - **Action**: Allow\n   - **Include**: Emails ending in `@yourdomain.com` or specific emails\n6. Save and note the **Application Audience (AUD)** tag\n\nUpdate your `.env`:\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 7: Add Cloudflare Access (Optional but Recommended)", "start_line": 224, "end_line": 243}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Edit as aigateway user", "score": 0.0, "content": "# Edit as aigateway user\nnano /home/aigateway/AiRemoteCoder/.env\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Edit as aigateway user", "start_line": 244, "end_line": 246}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Add:", "score": 0.0, "content": "# Add:\nCF_ACCESS_TEAM=your-team-name\nCF_ACCESS_AUD=your-application-aud\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Add:", "start_line": 247, "end_line": 253}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 8: Create Systemd Service", "score": 0.0, "content": "## Step 8: Create Systemd Service\n\nRun as root to create a persistent service:\n\n```bash\ncat > /etc/systemd/system/aigateway.service << 'EOF'\n[Unit]\nDescription=AI Remote Coder Gateway\nAfter=network.target\n\n[Service]\nType=simple\nUser=aigateway\nWorkingDirectory=/home/aigateway/AiRemoteCoder\nExecStart=/usr/bin/npm run start -w gateway\nRestart=always\nRestartSec=10\nEnvironment=NODE_ENV=production\n\n[Install]\nWantedBy=multi-user.target\nEOF\n```\n\nEnable and start:\n\n```bash\nsystemctl daemon-reload\nsystemctl enable aigateway\nsystemctl start aigateway\nsystemctl status aigateway\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 8: Create Systemd Service", "start_line": 254, "end_line": 288}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 9: Create Cloudflare Tunnel Service", "score": 0.0, "content": "## Step 9: Create Cloudflare Tunnel Service\n\n```bash\ncat > /etc/systemd/system/cloudflared.service << 'EOF'\n[Unit]\nDescription=Cloudflare Tunnel\nAfter=network.target aigateway.service\n\n[Service]\nType=simple\nUser=aigateway\nExecStart=/usr/bin/cloudflared tunnel run\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\nEOF\n```\n\nEnable and start:\n\n```bash\nsystemctl daemon-reload\nsystemctl enable cloudflared\nsystemctl start cloudflared\nsystemctl status cloudflared\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 9: Create Cloudflare Tunnel Service", "start_line": 289, "end_line": 319}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 10: Configure Firewall", "score": 0.0, "content": "## Step 10: Configure Firewall\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 10: Configure Firewall", "start_line": 320, "end_line": 321}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Debian/Ubuntu (UFW)", "score": 0.0, "content": "### Debian/Ubuntu (UFW)\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Debian/Ubuntu (UFW)", "start_line": 322, "end_line": 324}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Only allow SSH (Cloudflare handles HTTPS)", "score": 0.0, "content": "# Only allow SSH (Cloudflare handles HTTPS)\nufw default deny incoming\nufw default allow outgoing\nufw allow ssh\nufw enable\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Only allow SSH (Cloudflare handles HTTPS)", "start_line": 325, "end_line": 331}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Oracle Linux (firewalld)", "score": 0.0, "content": "### Oracle Linux (firewalld)\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Oracle Linux (firewalld)", "start_line": 332, "end_line": 334}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Only allow SSH", "score": 0.0, "content": "# Only allow SSH\nfirewall-cmd --permanent --remove-service=http\nfirewall-cmd --permanent --remove-service=https\nfirewall-cmd --permanent --add-service=ssh\nfirewall-cmd --reload\n```\n\n**Note:** No need to open port 3100 - Cloudflare Tunnel handles all inbound traffic.\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Only allow SSH", "start_line": 335, "end_line": 345}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Step 11: Connect from Your Local Machine", "score": 0.0, "content": "## Step 11: Connect from Your Local Machine\n\n1. Access the gateway UI through Cloudflare:\n   ```\n   https://YOUR_TUNNEL_ID.cfargotunnel.com\n   ```\n\n2. Create an admin account on first visit\n\n3. Create a new run and copy the `run-id` and `token`\n\n4. On your local development machine, set up the wrapper:\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Step 11: Connect from Your Local Machine", "start_line": 346, "end_line": 359}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Clone or copy the wrapper", "score": 0.0, "content": "# Clone or copy the wrapper\ngit clone https://github.com/redsand/AiRemoteCoder.git\ncd AiRemoteCoder\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Clone or copy the wrapper", "start_line": 360, "end_line": 363}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Install and build wrapper only", "score": 0.0, "content": "# Install and build wrapper only\nnpm install -w wrapper\nnpm run build -w wrapper\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Install and build wrapper only", "start_line": 364, "end_line": 367}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Configure environment", "score": 0.0, "content": "# Configure environment\ncat > .env << EOF\nGATEWAY_URL=https://YOUR_TUNNEL_ID.cfargotunnel.com\nHMAC_SECRET=copy-from-droplet-.env\nALLOW_SELF_SIGNED=false\nEOF\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Configure environment", "start_line": 368, "end_line": 374}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Start Claude Code with connect-back", "score": 0.0, "content": "# Start Claude Code with connect-back\n./wrapper/claude-runner start \\\n  --run-id <run-id-from-ui> \\\n  --token <token-from-ui> \\\n  --cmd \"your prompt here\"\n```\n\n**Important:** Copy the `HMAC_SECRET` from your droplet's `.env` file to your local machine.\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Start Claude Code with connect-back", "start_line": 375, "end_line": 385}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Maintenance", "score": 0.0, "content": "## Maintenance\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Maintenance", "start_line": 386, "end_line": 387}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#View Logs", "score": 0.0, "content": "### View Logs\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "View Logs", "start_line": 388, "end_line": 390}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Gateway logs", "score": 0.0, "content": "# Gateway logs\njournalctl -u aigateway -f\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Gateway logs", "start_line": 391, "end_line": 393}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Tunnel logs", "score": 0.0, "content": "# Tunnel logs\njournalctl -u cloudflared -f\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Tunnel logs", "start_line": 394, "end_line": 397}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Update Gateway", "score": 0.0, "content": "### Update Gateway\n\n```bash\nsu - aigateway\ncd AiRemoteCoder\ngit pull\nnpm install\nnpm run build\nexit\nsystemctl restart aigateway\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Update Gateway", "start_line": 398, "end_line": 409}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Backup", "score": 0.0, "content": "### Backup\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Backup", "start_line": 410, "end_line": 412}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Backup data and config", "score": 0.0, "content": "# Backup data and config\nsu - aigateway\ncd AiRemoteCoder\ntar -czf backup-$(date +%Y%m%d).tar.gz .env .data/\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Backup data and config", "start_line": 413, "end_line": 418}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Prune Old Runs", "score": 0.0, "content": "### Prune Old Runs\n\n```bash\nsu - aigateway\ncd AiRemoteCoder\nnpm run prune\n```\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Prune Old Runs", "start_line": 419, "end_line": 428}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Troubleshooting", "score": 0.0, "content": "## Troubleshooting\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Troubleshooting", "start_line": 429, "end_line": 430}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Gateway won't start", "score": 0.0, "content": "### Gateway won't start\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Gateway won't start", "start_line": 431, "end_line": 433}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Check status", "score": 0.0, "content": "# Check status\nsystemctl status aigateway\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Check status", "start_line": 434, "end_line": 436}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#View full logs", "score": 0.0, "content": "# View full logs\njournalctl -u aigateway -n 100\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "View full logs", "start_line": 437, "end_line": 439}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Test manually", "score": 0.0, "content": "# Test manually\nsu - aigateway\ncd AiRemoteCoder\nLOG_LEVEL=debug npm run start -w gateway\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Test manually", "start_line": 440, "end_line": 445}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Tunnel connection issues", "score": 0.0, "content": "### Tunnel connection issues\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Tunnel connection issues", "start_line": 446, "end_line": 448}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Check tunnel status", "score": 0.0, "content": "# Check tunnel status\ncloudflared tunnel info aigateway\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Check tunnel status", "start_line": 449, "end_line": 451}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Test tunnel manually", "score": 0.0, "content": "# Test tunnel manually\ncloudflared tunnel --url https://localhost:3100\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Test tunnel manually", "start_line": 452, "end_line": 454}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Verify credentials", "score": 0.0, "content": "# Verify credentials\nls -la ~/.cloudflared/\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Verify credentials", "start_line": 455, "end_line": 458}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Wrapper can't connect", "score": 0.0, "content": "### Wrapper can't connect\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Wrapper can't connect", "start_line": 459, "end_line": 461}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Test from local machine", "score": 0.0, "content": "# Test from local machine\ncurl -k https://YOUR_TUNNEL_ID.cfargotunnel.com/api/health\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Test from local machine", "start_line": 462, "end_line": 464}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Verify HMAC_SECRET matches", "score": 0.0, "content": "# Verify HMAC_SECRET matches", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Verify HMAC_SECRET matches", "start_line": 465, "end_line": 465}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#On droplet:", "score": 0.0, "content": "# On droplet:\ngrep HMAC_SECRET /home/aigateway/AiRemoteCoder/.env\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "On droplet:", "start_line": 466, "end_line": 468}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#On local machine:", "score": 0.0, "content": "# On local machine:\ngrep HMAC_SECRET .env\n```\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "On local machine:", "start_line": 469, "end_line": 472}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#\"Invalid signature\" errors", "score": 0.0, "content": "### \"Invalid signature\" errors\n\n- Ensure `HMAC_SECRET` is identical on gateway and wrapper\n- Check system clock synchronization (within 5 minutes)\n- Run `timedatectl status` on both machines\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "\"Invalid signature\" errors", "start_line": 473, "end_line": 480}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Security Checklist", "score": 0.0, "content": "## Security Checklist\n\n- [ ] Using named Cloudflare Tunnel (not quick tunnel)\n- [ ] Cloudflare Access enabled with email/IdP authentication\n- [ ] Firewall blocks all inbound except SSH\n- [ ] Gateway running as non-root user\n- [ ] Strong `HMAC_SECRET` (32+ random bytes)\n- [ ] Strong `AUTH_SECRET` (32+ random bytes)\n- [ ] TLS enabled on gateway\n- [ ] SSH key authentication (not password)\n- [ ] Regular updates applied\n- [ ] Backups configured\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Security Checklist", "start_line": 481, "end_line": 495}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Cost Summary", "score": 0.0, "content": "## Cost Summary\n\n| Component | Monthly Cost |\n|-----------|-------------|\n| DigitalOcean Droplet (1GB) | $6 |\n| Cloudflare Tunnel | Free |\n| Cloudflare Access (50 users) | Free |\n| **Total** | **$6/month** |\n\n---\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Cost Summary", "start_line": 496, "end_line": 506}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Quick Reference", "score": 0.0, "content": "## Quick Reference\n\n```bash", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Quick Reference", "start_line": 507, "end_line": 509}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Start/stop gateway", "score": 0.0, "content": "# Start/stop gateway\nsystemctl start aigateway\nsystemctl stop aigateway\nsystemctl restart aigateway\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Start/stop gateway", "start_line": 510, "end_line": 514}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Start/stop tunnel", "score": 0.0, "content": "# Start/stop tunnel\nsystemctl start cloudflared\nsystemctl stop cloudflared\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Start/stop tunnel", "start_line": 515, "end_line": 518}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#View logs", "score": 0.0, "content": "# View logs\njournalctl -u aigateway -f\njournalctl -u cloudflared -f\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "View logs", "start_line": 519, "end_line": 522}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Connect wrapper (from local machine)", "score": 0.0, "content": "# Connect wrapper (from local machine)\n./wrapper/claude-runner start --run-id <id> --token <token> --cmd \"prompt\"\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Connect wrapper (from local machine)", "start_line": 523, "end_line": 525}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Test connection", "score": 0.0, "content": "# Test connection\n./wrapper/claude-runner test-connection\n", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Test connection", "start_line": 526, "end_line": 528}}, {"corpus": "docs", "source": "docs/DIGITALOCEAN.md", "location": "docs/DIGITALOCEAN.md#Health check", "score": 0.0, "content": "# Health check\ncurl https://YOUR_TUNNEL.cfargotunnel.com/api/health\n```", "metadata": {"file": "docs/DIGITALOCEAN.md", "heading": "Health check", "start_line": 529, "end_line": 531}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Operations Guide", "score": 0.0, "content": "# Operations Guide\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Operations Guide", "start_line": 1, "end_line": 2}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Directory Structure", "score": 0.0, "content": "## Directory Structure\n\n```\n.data/\n\u251c\u2500\u2500 db.sqlite          # SQLite database\n\u251c\u2500\u2500 certs/             # TLS certificates\n\u2502   \u251c\u2500\u2500 server.crt\n\u2502   \u2514\u2500\u2500 server.key\n\u251c\u2500\u2500 artifacts/         # Uploaded artifacts per run\n\u2502   \u2514\u2500\u2500 <run-id>/\n\u2502       \u2514\u2500\u2500 <artifact-id>_<filename>\n\u2514\u2500\u2500 runs/              # Local run logs\n    \u2514\u2500\u2500 <run-id>/\n        \u2514\u2500\u2500 claude.log\n```\n\nAll runtime data is stored under `.data/` in the project root.\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Directory Structure", "start_line": 3, "end_line": 22}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Database", "score": 0.0, "content": "## Database\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Database", "start_line": 23, "end_line": 24}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Location", "score": 0.0, "content": "### Location\n`.data/db.sqlite`\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Location", "start_line": 25, "end_line": 27}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Schema", "score": 0.0, "content": "### Schema\n- `runs` - Run records (id, status, timestamps, exit code)\n- `events` - Log events (stdout, stderr, markers)\n- `commands` - Queued commands from UI\n- `artifacts` - Uploaded file metadata\n- `nonces` - Replay protection (auto-pruned)\n- `users` - Local user accounts\n- `sessions` - Active sessions (auto-pruned)\n- `audit_log` - Operator actions\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Schema", "start_line": 28, "end_line": 37}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Backup", "score": 0.0, "content": "### Backup\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Backup", "start_line": 38, "end_line": 39}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Stop gateway first for consistency", "score": 0.0, "content": "# Stop gateway first for consistency\nsqlite3 .data/db.sqlite \".backup .data/backup.sqlite\"\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Stop gateway first for consistency", "start_line": 40, "end_line": 43}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Restore", "score": 0.0, "content": "### Restore\n```bash\ncp .data/backup.sqlite .data/db.sqlite\n```\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Restore", "start_line": 44, "end_line": 50}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Retention and Cleanup", "score": 0.0, "content": "## Retention and Cleanup\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Retention and Cleanup", "start_line": 51, "end_line": 52}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Automatic Pruning", "score": 0.0, "content": "### Automatic Pruning\nRun periodically:\n```bash\nnpm run prune", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Automatic Pruning", "start_line": 53, "end_line": 56}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#or", "score": 0.0, "content": "# or\nnode scripts/prune.mjs\n```\n\nThis removes:\n- Completed/failed runs older than `RUN_RETENTION_DAYS`\n- Associated artifacts and events\n- Orphaned directories\n- Expired nonces and sessions\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "or", "start_line": 57, "end_line": 66}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Manual Cleanup", "score": 0.0, "content": "### Manual Cleanup\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Manual Cleanup", "start_line": 67, "end_line": 68}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Delete specific run", "score": 0.0, "content": "# Delete specific run\nsqlite3 .data/db.sqlite \"DELETE FROM runs WHERE id = 'xxx'\"\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Delete specific run", "start_line": 69, "end_line": 71}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Clear all data (careful!)", "score": 0.0, "content": "# Clear all data (careful!)\nrm -rf .data/db.sqlite .data/artifacts/* .data/runs/*\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Clear all data (careful!)", "start_line": 72, "end_line": 75}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Disk Usage Monitoring", "score": 0.0, "content": "### Disk Usage Monitoring\n```bash\ndu -sh .data/\ndu -sh .data/artifacts/\ndu -sh .data/runs/\n```\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Disk Usage Monitoring", "start_line": 76, "end_line": 84}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Secret Rotation", "score": 0.0, "content": "## Secret Rotation\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Secret Rotation", "start_line": 85, "end_line": 86}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#HMAC_SECRET", "score": 0.0, "content": "### HMAC_SECRET\nUsed for wrapper authentication. To rotate:\n\n1. Generate new secret:\n   ```bash\n   openssl rand -hex 32\n   ```\n\n2. Update `.env` with new `HMAC_SECRET`\n\n3. Restart gateway\n\n4. Update all wrappers with new secret\n\n5. All existing runs will fail authentication (expected)\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "HMAC_SECRET", "start_line": 87, "end_line": 102}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#AUTH_SECRET", "score": 0.0, "content": "### AUTH_SECRET\nUsed for session cookies. To rotate:\n\n1. Update `.env` with new `AUTH_SECRET`\n\n2. Restart gateway\n\n3. All existing sessions invalidated (users must re-login)\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "AUTH_SECRET", "start_line": 103, "end_line": 111}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#User Passwords", "score": 0.0, "content": "### User Passwords\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "User Passwords", "start_line": 112, "end_line": 113}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Via UI (admin only)", "score": 0.0, "content": "# Via UI (admin only)", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Via UI (admin only)", "start_line": 114, "end_line": 114}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Or directly in database (emergency):", "score": 0.0, "content": "# Or directly in database (emergency):\nsqlite3 .data/db.sqlite \"DELETE FROM users WHERE username = 'xxx'\"", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Or directly in database (emergency):", "start_line": 115, "end_line": 116}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Then re-run setup or create user via API", "score": 0.0, "content": "# Then re-run setup or create user via API\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Then re-run setup or create user via API", "start_line": 117, "end_line": 119}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#TOTP Secret", "score": 0.0, "content": "### TOTP Secret\nIf a user loses their authenticator:\n```bash\nsqlite3 .data/db.sqlite \"UPDATE users SET totp_secret = NULL WHERE username = 'xxx'\"\n```\nUser must then set up TOTP again.\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "TOTP Secret", "start_line": 120, "end_line": 128}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#TLS Certificate Management", "score": 0.0, "content": "## TLS Certificate Management\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "TLS Certificate Management", "start_line": 129, "end_line": 130}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Development Certificates", "score": 0.0, "content": "### Development Certificates\n```bash\n./scripts/dev-cert.sh\n```\nSelf-signed, valid for 365 days.\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Development Certificates", "start_line": 131, "end_line": 136}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Production (Let's Encrypt)", "score": 0.0, "content": "### Production (Let's Encrypt)\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Production (Let's Encrypt)", "start_line": 137, "end_line": 138}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Using certbot", "score": 0.0, "content": "# Using certbot\ncertbot certonly --standalone -d your-domain.com\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Using certbot", "start_line": 139, "end_line": 141}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Copy to project", "score": 0.0, "content": "# Copy to project\ncp /etc/letsencrypt/live/your-domain.com/fullchain.pem .data/certs/server.crt\ncp /etc/letsencrypt/live/your-domain.com/privkey.pem .data/certs/server.key\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Copy to project", "start_line": 142, "end_line": 145}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Set permissions", "score": 0.0, "content": "# Set permissions\nchmod 600 .data/certs/server.key\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Set permissions", "start_line": 146, "end_line": 149}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Certificate Renewal", "score": 0.0, "content": "### Certificate Renewal\n```bash\ncertbot renew", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Certificate Renewal", "start_line": 150, "end_line": 152}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Then copy new certs and restart gateway", "score": 0.0, "content": "# Then copy new certs and restart gateway\n```\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Then copy new certs and restart gateway", "start_line": 153, "end_line": 157}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Monitoring", "score": 0.0, "content": "## Monitoring\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Monitoring", "start_line": 158, "end_line": 159}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Health Check", "score": 0.0, "content": "### Health Check\n```bash\ncurl -k https://localhost:3100/api/health\n```\n\nResponse:\n```json\n{\n  \"status\": \"ok\",\n  \"timestamp\": \"2024-01-15T10:00:00.000Z\",\n  \"connections\": {\n    \"clients\": 2,\n    \"subscriptions\": 1\n  }\n}\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Health Check", "start_line": 160, "end_line": 176}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Audit Log", "score": 0.0, "content": "### Audit Log\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Audit Log", "start_line": 177, "end_line": 178}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Recent actions", "score": 0.0, "content": "# Recent actions\nsqlite3 .data/db.sqlite \"SELECT * FROM audit_log ORDER BY timestamp DESC LIMIT 50\"\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Recent actions", "start_line": 179, "end_line": 181}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Actions by user", "score": 0.0, "content": "# Actions by user\nsqlite3 .data/db.sqlite \"SELECT * FROM audit_log WHERE user_id = 'xxx'\"\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Actions by user", "start_line": 182, "end_line": 184}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Failed logins", "score": 0.0, "content": "# Failed logins\nsqlite3 .data/db.sqlite \"SELECT * FROM audit_log WHERE action LIKE 'login.failed%'\"\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Failed logins", "start_line": 185, "end_line": 188}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Active Runs", "score": 0.0, "content": "### Active Runs\n```bash\nsqlite3 .data/db.sqlite \"SELECT id, status, created_at FROM runs WHERE status = 'running'\"\n```\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Active Runs", "start_line": 189, "end_line": 195}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Scaling Considerations", "score": 0.0, "content": "## Scaling Considerations\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Scaling Considerations", "start_line": 196, "end_line": 197}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Single Instance (Default)", "score": 0.0, "content": "### Single Instance (Default)\n- SQLite works well for single-node deployment\n- WebSocket connections maintained in memory\n- Suitable for personal/small team use\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Single Instance (Default)", "start_line": 198, "end_line": 202}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Multi-Instance (Future)", "score": 0.0, "content": "### Multi-Instance (Future)\nIf scaling beyond single node:\n1. Replace SQLite with PostgreSQL\n2. Use Redis for WebSocket pub/sub\n3. Use shared storage (S3/NFS) for artifacts\n4. Deploy gateway behind load balancer\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Multi-Instance (Future)", "start_line": 203, "end_line": 211}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Troubleshooting", "score": 0.0, "content": "## Troubleshooting\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Troubleshooting", "start_line": 212, "end_line": 213}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Gateway won't start", "score": 0.0, "content": "### Gateway won't start\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Gateway won't start", "start_line": 214, "end_line": 215}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Check port in use", "score": 0.0, "content": "# Check port in use\nlsof -i :3100\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Check port in use", "start_line": 216, "end_line": 218}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Check logs", "score": 0.0, "content": "# Check logs\nLOG_LEVEL=debug npm run start -w gateway\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Check logs", "start_line": 219, "end_line": 222}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Wrapper can't connect", "score": 0.0, "content": "### Wrapper can't connect\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Wrapper can't connect", "start_line": 223, "end_line": 224}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Test connectivity", "score": 0.0, "content": "# Test connectivity\n./wrapper/claude-runner test-connection\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Test connectivity", "start_line": 225, "end_line": 227}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Check gateway URL", "score": 0.0, "content": "# Check gateway URL\n./wrapper/claude-runner info\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Check gateway URL", "start_line": 228, "end_line": 231}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Database locked", "score": 0.0, "content": "### Database locked\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Database locked", "start_line": 232, "end_line": 233}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Check for stale locks", "score": 0.0, "content": "# Check for stale locks\nfuser .data/db.sqlite\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Check for stale locks", "start_line": 234, "end_line": 236}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Force close (careful with data loss)", "score": 0.0, "content": "# Force close (careful with data loss)\nkill -9 $(fuser .data/db.sqlite)\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Force close (careful with data loss)", "start_line": 237, "end_line": 240}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Certificate errors", "score": 0.0, "content": "### Certificate errors\n```bash", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Certificate errors", "start_line": 241, "end_line": 242}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Regenerate development certs", "score": 0.0, "content": "# Regenerate development certs\nrm -f .data/certs/*\n./scripts/dev-cert.sh\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Regenerate development certs", "start_line": 243, "end_line": 246}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Check certificate", "score": 0.0, "content": "# Check certificate\nopenssl x509 -in .data/certs/server.crt -text -noout\n```\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Check certificate", "start_line": 247, "end_line": 252}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Upgrading", "score": 0.0, "content": "## Upgrading\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Upgrading", "start_line": 253, "end_line": 254}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Standard Upgrade", "score": 0.0, "content": "### Standard Upgrade\n```bash\ngit pull\nnpm install\nnpm run build", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Standard Upgrade", "start_line": 255, "end_line": 259}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Restart gateway", "score": 0.0, "content": "# Restart gateway\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Restart gateway", "start_line": 260, "end_line": 262}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Database Migrations", "score": 0.0, "content": "### Database Migrations\nCurrently no migration system. For breaking changes:\n1. Backup database\n2. Delete `.data/db.sqlite`\n3. Restart (new schema created automatically)\n4. Historical data will be lost\n\n---\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Database Migrations", "start_line": 263, "end_line": 271}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Disaster Recovery", "score": 0.0, "content": "## Disaster Recovery\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Disaster Recovery", "start_line": 272, "end_line": 273}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Full Backup", "score": 0.0, "content": "### Full Backup\n```bash\ntar -czf backup-$(date +%Y%m%d).tar.gz \\\n  .env \\\n  .data/db.sqlite \\\n  .data/certs/ \\\n  .data/artifacts/\n```\n", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Full Backup", "start_line": 274, "end_line": 282}}, {"corpus": "docs", "source": "docs/OPERATIONS.md", "location": "docs/OPERATIONS.md#Full Restore", "score": 0.0, "content": "### Full Restore\n```bash\ntar -xzf backup-YYYYMMDD.tar.gz\nnpm install\nnpm run build\n./run.sh\n```", "metadata": {"file": "docs/OPERATIONS.md", "heading": "Full Restore", "start_line": 283, "end_line": 289}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Quickstart Guide", "score": 0.0, "content": "# Quickstart Guide\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Quickstart Guide", "start_line": 1, "end_line": 2}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Prerequisites", "score": 0.0, "content": "## Prerequisites\n\n- Node.js 20+\n- Claude Code CLI installed and authenticated\n- (Optional) Cloudflare account for secure remote access\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Prerequisites", "start_line": 3, "end_line": 8}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Local Development Setup", "score": 0.0, "content": "## Local Development Setup\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Local Development Setup", "start_line": 9, "end_line": 10}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#1. Start the Gateway", "score": 0.0, "content": "### 1. Start the Gateway\n\n```bash", "metadata": {"file": "docs/QUICKSTART.md", "heading": "1. Start the Gateway", "start_line": 11, "end_line": 13}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Linux/macOS", "score": 0.0, "content": "# Linux/macOS\n./run.sh\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Linux/macOS", "start_line": 14, "end_line": 16}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Windows", "score": 0.0, "content": "# Windows\n.\\run.ps1\n```\n\nThis will:\n- Generate secure secrets in `.env` (first run)\n- Install dependencies\n- Build the gateway, wrapper, and UI\n- Generate self-signed TLS certificates\n- Start the gateway on https://localhost:3100\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Windows", "start_line": 17, "end_line": 27}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#2. Access the UI", "score": 0.0, "content": "### 2. Access the UI\n\nOpen https://localhost:3100 in your browser.\n\nOn first access, you'll be prompted to create an admin account:\n1. Choose a username (alphanumeric, 3+ chars)\n2. Set a strong password (12+ chars)\n3. Optionally enable TOTP two-factor auth\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "2. Access the UI", "start_line": 28, "end_line": 36}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#3. Create a Run", "score": 0.0, "content": "### 3. Create a Run\n\n1. Click \"New Run\" in the UI\n2. Optionally enter a Claude command/prompt\n3. Copy the displayed run-id and token\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "3. Create a Run", "start_line": 37, "end_line": 42}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#4. Start Claude Code", "score": 0.0, "content": "### 4. Start Claude Code\n\nIn a terminal on the machine with Claude Code:\n\n```bash\ncd /path/to/your/project\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "4. Start Claude Code", "start_line": 43, "end_line": 49}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Run the wrapper", "score": 0.0, "content": "# Run the wrapper\n./wrapper/claude-runner start \\\n  --run-id <run-id> \\\n  --token <token> \\\n  --cmd \"your prompt here\"\n```\n\nOr to run interactively:\n```bash\n./wrapper/claude-runner start \\\n  --run-id <run-id> \\\n  --token <token>\n```\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Run the wrapper", "start_line": 50, "end_line": 63}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#5. Monitor from UI", "score": 0.0, "content": "### 5. Monitor from UI\n\n- View real-time output in the log viewer\n- Run allowlisted commands (npm test, git diff, etc.)\n- Download artifacts (logs, diffs)\n- Request graceful stop\n\n---\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "5. Monitor from UI", "start_line": 64, "end_line": 72}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Remote Access with Cloudflare Tunnel", "score": 0.0, "content": "## Remote Access with Cloudflare Tunnel\n\nFor secure access from your phone:\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Remote Access with Cloudflare Tunnel", "start_line": 73, "end_line": 76}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#1. Install cloudflared", "score": 0.0, "content": "### 1. Install cloudflared\n\n```bash", "metadata": {"file": "docs/QUICKSTART.md", "heading": "1. Install cloudflared", "start_line": 77, "end_line": 79}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#macOS", "score": 0.0, "content": "# macOS\nbrew install cloudflared\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "macOS", "start_line": 80, "end_line": 82}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Linux (Debian/Ubuntu)", "score": 0.0, "content": "# Linux (Debian/Ubuntu)\ncurl -L --output cloudflared.deb https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb\nsudo dpkg -i cloudflared.deb\n```\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Linux (Debian/Ubuntu)", "start_line": 83, "end_line": 87}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#2. Start the Tunnel", "score": 0.0, "content": "### 2. Start the Tunnel\n\n```bash\n./scripts/cloudflare-tunnel.sh\n```\n\nFirst time: Follow the browser prompt to authenticate with Cloudflare.\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "2. Start the Tunnel", "start_line": 88, "end_line": 95}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#3. Add Cloudflare Access (Recommended)", "score": 0.0, "content": "### 3. Add Cloudflare Access (Recommended)\n\n1. Go to https://one.dash.cloudflare.com\n2. Navigate to **Access > Applications**\n3. Create a new application:\n   - Type: Self-hosted\n   - URL: Your tunnel hostname\n   - Configure identity provider (Google, GitHub, etc.)\n   - Set access policies (who can access)\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "3. Add Cloudflare Access (Recommended)", "start_line": 96, "end_line": 105}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#4. Update Gateway Config", "score": 0.0, "content": "### 4. Update Gateway Config\n\nAdd to `.env`:\n```env\nCF_ACCESS_TEAM=your-team-name\nCF_ACCESS_AUD=your-application-aud\n```\n\nThe gateway will now validate Cloudflare Access headers.\n\n---\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "4. Update Gateway Config", "start_line": 106, "end_line": 117}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Environment Variables", "score": 0.0, "content": "## Environment Variables\n\n| Variable | Description | Default |\n|----------|-------------|---------|\n| `GATEWAY_PORT` | Gateway HTTP port | 3100 |\n| `GATEWAY_HOST` | Gateway bind address | 0.0.0.0 |\n| `HMAC_SECRET` | HMAC signing key (32+ chars) | Auto-generated |\n| `AUTH_SECRET` | Session signing key | Auto-generated |\n| `TLS_ENABLED` | Enable HTTPS | true |\n| `CF_ACCESS_TEAM` | Cloudflare Access team | (none) |\n| `CF_ACCESS_AUD` | Cloudflare Access AUD | (none) |\n| `RUN_RETENTION_DAYS` | Keep runs for N days | 30 |\n| `GATEWAY_URL` | Gateway URL for wrapper | https://localhost:3100 |\n| `ALLOW_SELF_SIGNED` | Allow self-signed certs | true |\n\n---\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Environment Variables", "start_line": 118, "end_line": 134}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Assist Sessions (tmate)", "score": 0.0, "content": "## Assist Sessions (tmate)\n\nFor hands-on terminal access:\n\n1. Install tmate:\n   ```bash\n   # macOS\n   brew install tmate\n\n   # Linux\n   apt install tmate\n   ```\n\n2. From the wrapper:\n   ```bash\n   ./wrapper/claude-runner assist \\\n     --run-id <run-id> \\\n     --token <token>\n   ```\n\n3. The session URL will appear in the UI under \"Assist Session Active\"\n\n---\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Assist Sessions (tmate)", "start_line": 135, "end_line": 158}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#Troubleshooting", "score": 0.0, "content": "## Troubleshooting\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "Troubleshooting", "start_line": 159, "end_line": 160}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#\"Cannot connect to gateway\"", "score": 0.0, "content": "### \"Cannot connect to gateway\"\n- Check the gateway is running\n- Verify GATEWAY_URL in environment\n- For self-signed certs, set ALLOW_SELF_SIGNED=true\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "\"Cannot connect to gateway\"", "start_line": 161, "end_line": 165}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#\"Invalid signature\"", "score": 0.0, "content": "### \"Invalid signature\"\n- Ensure HMAC_SECRET matches between gateway and wrapper\n- Check system clocks are synchronized (within 5 minutes)\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "\"Invalid signature\"", "start_line": 166, "end_line": 169}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#\"Authentication required\"", "score": 0.0, "content": "### \"Authentication required\"\n- Create an account at /api/auth/setup\n- Or configure Cloudflare Access\n", "metadata": {"file": "docs/QUICKSTART.md", "heading": "\"Authentication required\"", "start_line": 170, "end_line": 173}}, {"corpus": "docs", "source": "docs/QUICKSTART.md", "location": "docs/QUICKSTART.md#TLS certificate errors", "score": 0.0, "content": "### TLS certificate errors\n- Regenerate certs: `./scripts/dev-cert.sh`\n- For production, use Let's Encrypt or a trusted CA", "metadata": {"file": "docs/QUICKSTART.md", "heading": "TLS certificate errors", "start_line": 174, "end_line": 176}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Security Model", "score": 0.0, "content": "# Security Model\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Security Model", "start_line": 1, "end_line": 2}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Threat Model", "score": 0.0, "content": "## Threat Model\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Threat Model", "start_line": 3, "end_line": 4}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Assets to Protect", "score": 0.0, "content": "### Assets to Protect\n1. **Claude Code output** - May contain sensitive code, secrets, or business logic\n2. **Gateway authentication** - Prevents unauthorized access to runs and commands\n3. **Command execution** - Prevents arbitrary code execution on the wrapper host\n4. **User credentials** - Admin passwords and TOTP secrets\n5. **Session tokens** - Prevents session hijacking\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Assets to Protect", "start_line": 5, "end_line": 11}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Threat Actors", "score": 0.0, "content": "### Threat Actors\n1. **Network attackers** - Can intercept traffic, attempt MITM\n2. **Unauthorized users** - Attempt to access UI without credentials\n3. **Compromised wrapper** - Attacker gains access to a wrapper's credentials\n4. **Replay attackers** - Capture and replay valid requests\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Threat Actors", "start_line": 12, "end_line": 19}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Security Controls", "score": 0.0, "content": "## Security Controls\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Security Controls", "start_line": 20, "end_line": 21}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#1. Transport Layer Security (TLS)", "score": 0.0, "content": "### 1. Transport Layer Security (TLS)\n\n**Threat**: Network eavesdropping, MITM attacks\n\n**Mitigations**:\n- All gateway communications use HTTPS/WSS\n- Self-signed certificates for development\n- Production should use trusted CA certificates\n- HSTS headers enforced\n\n**Configuration**:\n```env\nTLS_ENABLED=true\n```\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "1. Transport Layer Security (TLS)", "start_line": 22, "end_line": 38}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#2. Wrapper Authentication (Connect-Back)", "score": 0.0, "content": "### 2. Wrapper Authentication (Connect-Back)\n\n**Threat**: Unauthorized wrapper connections, request forgery\n\n**Mitigations**:\n- HMAC-SHA256 signature over:\n  - HTTP method\n  - Request path\n  - Body hash (SHA256)\n  - Unix timestamp\n  - Random nonce\n  - Run ID\n  - Capability token\n- Clock skew limited to \u00b15 minutes\n- Nonce stored in SQLite with TTL (prevents replay)\n- Per-run capability tokens (limits blast radius)\n\n**Request Headers**:\n```\nX-Signature: <hmac-hex>\nX-Timestamp: <unix-seconds>\nX-Nonce: <random-hex>\nX-Run-Id: <run-id>\nX-Capability-Token: <token>\n```\n\n**Verification Algorithm**:\n```\nmessage = method + \"\\n\" + path + \"\\n\" + sha256(body) + \"\\n\" + timestamp + \"\\n\" + nonce + \"\\n\" + runId + \"\\n\" + capabilityToken\nexpected = hmac_sha256(secret, message)\nvalid = timing_safe_equal(signature, expected)\n```\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "2. Wrapper Authentication (Connect-Back)", "start_line": 39, "end_line": 73}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#3. UI Authentication", "score": 0.0, "content": "### 3. UI Authentication\n\n**Threat**: Unauthorized UI access\n\n**Mitigations**:\n", "metadata": {"file": "docs/SECURITY.md", "heading": "3. UI Authentication", "start_line": 74, "end_line": 79}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Option A: Cloudflare Access (Recommended)", "score": 0.0, "content": "#### Option A: Cloudflare Access (Recommended)\n- Zero-trust identity verification\n- SSO with Google, GitHub, etc.\n- Access policies per application\n- Headers validated by gateway:\n  - `Cf-Access-Authenticated-User-Email`\n  - `Cf-Access-Jwt-Assertion`\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Option A: Cloudflare Access (Recommended)", "start_line": 80, "end_line": 87}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Option B: Local Authentication", "score": 0.0, "content": "#### Option B: Local Authentication\n- Password hashed with Argon2id:\n  - Memory: 64 MB\n  - Iterations: 3\n  - Parallelism: 4\n- Optional TOTP two-factor authentication\n- Session tokens: 48 random bytes\n- Session duration: 24 hours\n- HTTPOnly, Secure, SameSite=Strict cookies\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Option B: Local Authentication", "start_line": 88, "end_line": 99}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#4. Authorization", "score": 0.0, "content": "### 4. Authorization\n\n**Threat**: Privilege escalation\n\n**Mitigations**:\n- Role-based access control:\n  - `admin`: Full access, user management\n  - `operator`: Start/stop runs, send commands\n  - `viewer`: Read-only access to runs and logs\n- Role checked on every protected endpoint\n- Audit log of all operator actions\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "4. Authorization", "start_line": 100, "end_line": 113}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#5. Command Safety", "score": 0.0, "content": "### 5. Command Safety\n\n**Threat**: Arbitrary code execution via commands\n\n**Mitigations**:\n- **Allowlist-only execution**: Only pre-approved commands run\n- Default allowlist:\n  ```\n  npm test, npm run test\n  pnpm test, pnpm run test\n  yarn test\n  pytest, pytest -v\n  go test ./...\n  cargo test\n  git diff, git diff --cached\n  git status\n  git log --oneline -10\n  ls -la, pwd\n  ```\n- Commands run in repo working directory only\n- No shell metacharacters (commands are not passed through shell)\n- Configurable via `EXTRA_ALLOWED_COMMANDS`\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "5. Command Safety", "start_line": 114, "end_line": 138}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#6. Secret Redaction", "score": 0.0, "content": "### 6. Secret Redaction\n\n**Threat**: Secrets leaked in logs\n\n**Mitigations**:\n- Output scanned before transmission\n- Redaction patterns:\n  - API keys, tokens, passwords (common formats)\n  - OpenAI keys: `sk-[a-zA-Z0-9]{20,}`\n  - GitHub tokens: `ghp_`, `ghs_`\n  - NPM tokens: `npm_`\n  - PEM private keys\n- Configurable patterns in config\n- Redaction also applied on gateway side\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "6. Secret Redaction", "start_line": 139, "end_line": 155}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#7. Rate Limiting", "score": 0.0, "content": "### 7. Rate Limiting\n\n**Threat**: DoS, brute force attacks\n\n**Mitigations**:\n- 100 requests per minute per IP\n- Uses Cloudflare headers for true client IP\n- Configurable limits\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "7. Rate Limiting", "start_line": 156, "end_line": 166}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#8. Input Validation", "score": 0.0, "content": "### 8. Input Validation\n\n**Threat**: Injection attacks, malformed input\n\n**Mitigations**:\n- Zod schema validation on all endpoints\n- Maximum body size: 10 MB\n- Maximum artifact size: 50 MB\n- File type restrictions for uploads\n- Path traversal prevention for artifacts\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "8. Input Validation", "start_line": 167, "end_line": 179}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Security Checklist for Production", "score": 0.0, "content": "## Security Checklist for Production\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Security Checklist for Production", "start_line": 180, "end_line": 181}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Required", "score": 0.0, "content": "### Required\n- [ ] Use production TLS certificates (Let's Encrypt or CA-signed)\n- [ ] Set strong, unique HMAC_SECRET (32+ random bytes)\n- [ ] Set strong, unique AUTH_SECRET (32+ random bytes)\n- [ ] Enable Cloudflare Access or strong local auth\n- [ ] Review and restrict allowlisted commands\n- [ ] Set appropriate RUN_RETENTION_DAYS\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Required", "start_line": 182, "end_line": 189}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Recommended", "score": 0.0, "content": "### Recommended\n- [ ] Run gateway behind reverse proxy (nginx, Caddy)\n- [ ] Enable Cloudflare Access with MFA requirement\n- [ ] Restrict gateway network access (firewall)\n- [ ] Monitor audit logs\n- [ ] Set up log aggregation\n- [ ] Regular security updates (npm audit)\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Recommended", "start_line": 190, "end_line": 197}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Network", "score": 0.0, "content": "### Network\n- [ ] Wrapper connects outbound only (no inbound ports)\n- [ ] Gateway exposed only through Cloudflare Tunnel\n- [ ] No direct exposure to internet if possible\n\n---\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Network", "start_line": 198, "end_line": 204}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Incident Response", "score": 0.0, "content": "## Incident Response\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Incident Response", "start_line": 205, "end_line": 206}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Compromised Wrapper Token", "score": 0.0, "content": "### Compromised Wrapper Token\n1. Immediately invalidate the run in the database\n2. Rotate HMAC_SECRET\n3. Kill any running processes\n4. Review audit logs for unauthorized commands\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Compromised Wrapper Token", "start_line": 207, "end_line": 212}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Compromised User Account", "score": 0.0, "content": "### Compromised User Account\n1. Delete/disable the user account\n2. Rotate AUTH_SECRET to invalidate all sessions\n3. Review audit logs\n4. Reset TOTP if applicable\n", "metadata": {"file": "docs/SECURITY.md", "heading": "Compromised User Account", "start_line": 213, "end_line": 218}}, {"corpus": "docs", "source": "docs/SECURITY.md", "location": "docs/SECURITY.md#Suspected Data Breach", "score": 0.0, "content": "### Suspected Data Breach\n1. Disable gateway access\n2. Export and review audit logs\n3. Check for unauthorized data access\n4. Notify affected parties as required", "metadata": {"file": "docs/SECURITY.md", "heading": "Suspected Data Breach", "start_line": 219, "end_line": 223}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Test Coverage Plan", "score": 0.0, "content": "# Test Coverage Plan\n", "metadata": {"file": "docs/TESTING.md", "heading": "Test Coverage Plan", "start_line": 1, "end_line": 2}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Overview", "score": 0.0, "content": "## Overview\n\nThis document outlines the comprehensive test coverage for the Connect-Back Gateway.\n", "metadata": {"file": "docs/TESTING.md", "heading": "Overview", "start_line": 3, "end_line": 6}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Running Tests", "score": 0.0, "content": "## Running Tests\n\n```bash", "metadata": {"file": "docs/TESTING.md", "heading": "Running Tests", "start_line": 7, "end_line": 9}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#All tests", "score": 0.0, "content": "# All tests\nnpm test\n", "metadata": {"file": "docs/TESTING.md", "heading": "All tests", "start_line": 10, "end_line": 12}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Gateway tests only", "score": 0.0, "content": "# Gateway tests only\nnpm test -w gateway\n", "metadata": {"file": "docs/TESTING.md", "heading": "Gateway tests only", "start_line": 13, "end_line": 15}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Wrapper tests only", "score": 0.0, "content": "# Wrapper tests only\nnpm test -w wrapper\n", "metadata": {"file": "docs/TESTING.md", "heading": "Wrapper tests only", "start_line": 16, "end_line": 18}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#With coverage report", "score": 0.0, "content": "# With coverage report\nnpm test -- --coverage\n```\n", "metadata": {"file": "docs/TESTING.md", "heading": "With coverage report", "start_line": 19, "end_line": 22}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Test Structure", "score": 0.0, "content": "## Test Structure\n\n```\ngateway/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 utils/\n\u2502   \u2502   \u2514\u2500\u2500 crypto.test.ts       # HMAC, hashing, nonces, redaction\n\u2502   \u251c\u2500\u2500 services/\n\u2502   \u2502   \u2514\u2500\u2500 database.test.ts     # Schema, CRUD, cascades\n\u2502   \u251c\u2500\u2500 middleware/\n\u2502   \u2502   \u2514\u2500\u2500 auth.test.ts         # Signature verification, RBAC\n\u2502   \u2514\u2500\u2500 routes/\n\u2502       \u2514\u2500\u2500 runs.test.ts         # Command allowlist validation\n\nwrapper/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 utils/\n\u2502   \u2502   \u2514\u2500\u2500 crypto.test.ts       # Client-side signing\n\u2502   \u2514\u2500\u2500 services/\n\u2502       \u251c\u2500\u2500 gateway-client.test.ts  # HTTP client, error handling\n\u2502       \u2514\u2500\u2500 claude-runner.test.ts   # Process management, commands\n```\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "Test Structure", "start_line": 23, "end_line": 47}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Coverage by Component", "score": 0.0, "content": "## Coverage by Component\n", "metadata": {"file": "docs/TESTING.md", "heading": "Coverage by Component", "start_line": 48, "end_line": 49}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#1. Cryptographic Functions (`gateway/src/utils/crypto.ts`)", "score": 0.0, "content": "### 1. Cryptographic Functions (`gateway/src/utils/crypto.ts`)\n\n| Function | Test Coverage |\n|----------|--------------|\n| `createSignature()` | \u2705 Consistency, all components included |\n| `verifySignature()` | \u2705 Valid/invalid signatures, timing-safe |\n| `hashBody()` | \u2705 Strings, buffers, consistency |\n| `generateNonce()` | \u2705 Uniqueness, format (32 hex chars) |\n| `generateCapabilityToken()` | \u2705 Uniqueness, format (64 hex chars) |\n| `isTimestampValid()` | \u2705 Current, within skew, outside skew |\n| `redactSecrets()` | \u2705 API keys, passwords, tokens, safe content |\n\n**Key Test Cases:**\n- Signature changes when any input component changes\n- Timing-safe comparison prevents timing attacks\n- Clock skew within \u00b15 minutes accepted\n- All secret patterns properly redacted\n", "metadata": {"file": "docs/TESTING.md", "heading": "1. Cryptographic Functions (`gateway/src/utils/crypto.ts`)", "start_line": 50, "end_line": 67}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#2. Database Schema (`gateway/src/services/database.ts`)", "score": 0.0, "content": "### 2. Database Schema (`gateway/src/services/database.ts`)\n\n| Table | Test Coverage |\n|-------|--------------|\n| `runs` | \u2705 Create, update status, JSON metadata |\n| `events` | \u2705 Auto-increment, cascade delete, ordering |\n| `commands` | \u2705 Insert, status update, ack |\n| `artifacts` | \u2705 Metadata storage, path handling |\n| `nonces` | \u2705 Uniqueness constraint, cleanup |\n| `users` | \u2705 Unique username, password hash storage |\n| `sessions` | \u2705 Expiry, cascade delete |\n| `audit_log` | \u2705 Entries, ordering |\n\n**Key Test Cases:**\n- Foreign key constraints enforced\n- Cascade delete removes child records\n- Index performance for common queries\n- JSON storage and retrieval\n", "metadata": {"file": "docs/TESTING.md", "heading": "2. Database Schema (`gateway/src/services/database.ts`)", "start_line": 68, "end_line": 86}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#3. Authentication Middleware (`gateway/src/middleware/auth.ts`)", "score": 0.0, "content": "### 3. Authentication Middleware (`gateway/src/middleware/auth.ts`)\n\n| Feature | Test Coverage |\n|---------|--------------|\n| Wrapper HMAC auth | \u2705 Valid requests, header validation |\n| Timestamp validation | \u2705 Expired, future, within skew |\n| Replay protection | \u2705 Nonce tracking, expiry |\n| Capability tokens | \u2705 Per-run validation |\n| UI session auth | \u2705 Session lookup, expiry |\n| Cloudflare Access | \u2705 Header extraction |\n| Role-based access | \u2705 Admin, operator, viewer |\n\n**Key Test Cases:**\n- Tampered requests rejected (method, path, body)\n- Replay attacks detected\n- Role permissions enforced correctly\n- Session expiry handled\n", "metadata": {"file": "docs/TESTING.md", "heading": "3. Authentication Middleware (`gateway/src/middleware/auth.ts`)", "start_line": 87, "end_line": 104}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#4. Command Allowlist (`gateway/src/routes/runs.ts`)", "score": 0.0, "content": "### 4. Command Allowlist (`gateway/src/routes/runs.ts`)\n\n| Category | Test Coverage |\n|----------|--------------|\n| Test commands | \u2705 npm/pnpm/yarn/pytest/go/cargo |\n| Git commands | \u2705 diff, status, log (read-only) |\n| Blocked commands | \u2705 rm, curl, git push, etc. |\n| Injection attempts | \u2705 Semicolons, pipes, backticks |\n| Edge cases | \u2705 Whitespace, case sensitivity |\n\n**Key Test Cases:**\n- Only exact matches or prefix+space allowed\n- Dangerous git commands blocked\n- Command injection patterns blocked\n- Special `__STOP__` command recognized\n", "metadata": {"file": "docs/TESTING.md", "heading": "4. Command Allowlist (`gateway/src/routes/runs.ts`)", "start_line": 105, "end_line": 120}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#5. Gateway Client (`wrapper/src/services/gateway-client.ts`)", "score": 0.0, "content": "### 5. Gateway Client (`wrapper/src/services/gateway-client.ts`)\n\n| Feature | Test Coverage |\n|---------|--------------|\n| Request signing | \u2705 All required headers |\n| Run auth headers | \u2705 runId, capabilityToken |\n| Event types | \u2705 All 6 types validated |\n| Error handling | \u2705 HTTP errors, network errors, timeout |\n| Health check | \u2705 Success/failure detection |\n\n**Key Test Cases:**\n- Headers properly formatted\n- Body hash included in signature\n- Marker events structured correctly\n- Graceful error handling\n", "metadata": {"file": "docs/TESTING.md", "heading": "5. Gateway Client (`wrapper/src/services/gateway-client.ts`)", "start_line": 121, "end_line": 136}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#6. Claude Runner (`wrapper/src/services/claude-runner.ts`)", "score": 0.0, "content": "### 6. Claude Runner (`wrapper/src/services/claude-runner.ts`)\n\n| Feature | Test Coverage |\n|---------|--------------|\n| Command validation | \u2705 Allowlist check |\n| Output processing | \u2705 stdout/stderr chunks |\n| Secret redaction | \u2705 Before sending |\n| Lifecycle events | \u2705 start/finish markers |\n| Event sequencing | \u2705 Incremental sequence |\n| Stop handling | \u2705 Graceful vs force |\n| Log files | \u2705 Path construction, format |\n| Working directory | \u2705 Validation, safety |\n| Tmate assist | \u2705 URL parsing |\n| Result handling | \u2705 Capture, truncation |\n\n**Key Test Cases:**\n- Non-allowlisted commands blocked\n- Secrets redacted from output\n- Exit codes properly reported\n- Path traversal prevented\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "6. Claude Runner (`wrapper/src/services/claude-runner.ts`)", "start_line": 137, "end_line": 159}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Security Test Matrix", "score": 0.0, "content": "## Security Test Matrix\n\n| Threat | Test File | Assertions |\n|--------|-----------|------------|\n| HMAC forgery | crypto.test.ts | Signature tampering detected |\n| Replay attack | auth.test.ts | Nonce reuse blocked |\n| Clock manipulation | crypto.test.ts | Timestamp bounds enforced |\n| Command injection | runs.test.ts | Metacharacters blocked |\n| Secret leakage | crypto.test.ts | Patterns redacted |\n| Path traversal | claude-runner.test.ts | Outside-project paths blocked |\n| Privilege escalation | auth.test.ts | Role checks enforced |\n| Session hijacking | database.test.ts | Session expiry works |\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "Security Test Matrix", "start_line": 160, "end_line": 174}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Performance Considerations", "score": 0.0, "content": "## Performance Considerations\n\n| Area | Test Approach |\n|------|---------------|\n| Nonce lookup | Database index test |\n| Event streaming | Sequence ordering test |\n| Log throughput | Chunk handling test |\n| Large artifacts | Size limit test |\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "Performance Considerations", "start_line": 175, "end_line": 185}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Running Specific Tests", "score": 0.0, "content": "## Running Specific Tests\n\n```bash", "metadata": {"file": "docs/TESTING.md", "heading": "Running Specific Tests", "start_line": 186, "end_line": 188}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Run tests matching pattern", "score": 0.0, "content": "# Run tests matching pattern\nnpm test -w gateway -- --grep \"crypto\"\n", "metadata": {"file": "docs/TESTING.md", "heading": "Run tests matching pattern", "start_line": 189, "end_line": 191}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Run single test file", "score": 0.0, "content": "# Run single test file\nnpm test -w gateway -- src/utils/crypto.test.ts\n", "metadata": {"file": "docs/TESTING.md", "heading": "Run single test file", "start_line": 192, "end_line": 194}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Run with verbose output", "score": 0.0, "content": "# Run with verbose output\nnpm test -w gateway -- --reporter=verbose\n", "metadata": {"file": "docs/TESTING.md", "heading": "Run with verbose output", "start_line": 195, "end_line": 197}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Watch mode during development", "score": 0.0, "content": "# Watch mode during development\nnpm run test:watch -w gateway\n```\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "Watch mode during development", "start_line": 198, "end_line": 203}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Adding New Tests", "score": 0.0, "content": "## Adding New Tests\n\nWhen adding new functionality:\n\n1. **Identify the component** - gateway vs wrapper\n2. **Determine test type** - unit vs integration\n3. **Follow existing patterns** - see similar tests\n4. **Cover edge cases** - empty input, max size, invalid format\n5. **Test security implications** - injection, bypass, leakage\n", "metadata": {"file": "docs/TESTING.md", "heading": "Adding New Tests", "start_line": 204, "end_line": 213}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Test Template", "score": 0.0, "content": "### Test Template\n\n```typescript\nimport { describe, it, expect, beforeEach } from 'vitest';\n\ndescribe('ComponentName', () => {\n  describe('functionName', () => {\n    it('should handle normal case', () => {\n      // Arrange\n      const input = 'valid input';\n\n      // Act\n      const result = functionName(input);\n\n      // Assert\n      expect(result).toBe('expected output');\n    });\n\n    it('should handle edge case', () => {\n      expect(() => functionName('')).toThrow();\n    });\n\n    it('should reject invalid input', () => {\n      expect(functionName('invalid')).toBe(false);\n    });\n  });\n});\n```\n\n---\n", "metadata": {"file": "docs/TESTING.md", "heading": "Test Template", "start_line": 214, "end_line": 244}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#CI/CD Integration", "score": 0.0, "content": "## CI/CD Integration\n\n```yaml", "metadata": {"file": "docs/TESTING.md", "heading": "CI/CD Integration", "start_line": 245, "end_line": 247}}, {"corpus": "docs", "source": "docs/TESTING.md", "location": "docs/TESTING.md#Example GitHub Actions workflow", "score": 0.0, "content": "# Example GitHub Actions workflow\ntest:\n  runs-on: ubuntu-latest\n  steps:\n    - uses: actions/checkout@v4\n    - uses: actions/setup-node@v4\n      with:\n        node-version: '20'\n    - run: npm ci\n    - run: npm test\n    - run: npm run test -- --coverage\n    - uses: codecov/codecov-action@v3\n```", "metadata": {"file": "docs/TESTING.md", "heading": "Example GitHub Actions workflow", "start_line": 248, "end_line": 260}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#Project Memory (Rev)", "score": 0.0, "content": "# Project Memory (Rev)\n\nThis file is maintained automatically by Rev.\nIt is intentionally concise and operational.\n", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "Project Memory (Rev)", "start_line": 1, "end_line": 5}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#What This Repo Is", "score": 0.0, "content": "## What This Repo Is\n- Rev: agentic CI/CD + refactoring assistant focused on safe, verifiable changes.\n", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "What This Repo Is", "start_line": 6, "end_line": 8}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#Current Architecture", "score": 0.0, "content": "## Current Architecture\n- Execution modes: linear executor and sub-agent orchestrator.\n- WorkspaceResolver: canonical path validation for tools/verifiers.\n- ContextBuilder: Select pipeline (code/docs/tools/memory) with tool retrieval.\n- Artifacts: tool outputs persisted under `.rev/artifacts/` (redacted).\n- CompressionPolicy: centralized tool-output compression knobs.\n", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "Current Architecture", "start_line": 9, "end_line": 15}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#Known Failure Modes + Fixes", "score": 0.0, "content": "## Known Failure Modes + Fixes\n- (none recorded)\n", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "Known Failure Modes + Fixes", "start_line": 16, "end_line": 18}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#Conventions", "score": 0.0, "content": "## Conventions\n- Prefer package exports (`__init__.py`) over mass explicit imports.\n- Don\u2019t re-run tests unless something changed; prefer smoke imports for import-only validation.\n", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "Conventions", "start_line": 19, "end_line": 22}}, {"corpus": "docs", "source": ".rev/memory/project_summary.md", "location": ".rev/memory/project_summary.md#Recently Changed Files", "score": 0.0, "content": "## Recently Changed Files\n- (none recorded)", "metadata": {"file": ".rev/memory/project_summary.md", "heading": "Recently Changed Files", "start_line": 23, "end_line": 24}}]}